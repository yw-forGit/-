<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="07_Kafka.files/filelist.xml">
<link rel=Edit-Time-Data href="07_Kafka.files/editdata.mso">
<link rel=themeData href="07_Kafka.files/themedata.thmx">
<link rel=colorSchemeMapping href="07_Kafka.files/colorschememapping.xml">

<link href="./css/treemenu.css" rel="stylesheet" type="text/css">
<!-- GitHub Pages只认./js/xxx这种相对定位，不认js/xxx这种 -->
<script src="./js/jquery-3.4.1.min.js"></script>
<script src="./js/test.js"></script>
<script src="./js/treemenu.js"></script>
</head>

<body lang=ZH-CN link="#0563C1" vlink="#954F72" style='tab-interval:21.0pt;
text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<div id="noScroll" class="divcss5-right">
	<ul id="menuId" class="tree">
	</ul>
	<div style="font-size: 10px; color: #161FB0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 （Ctrl+滚动鼠标可缩放页面）</div>
</div> 

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:22.0pt;line-height:125%;font-family:
宋体'>Kafka<o:p></o:p></span></b></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>参考：尚硅谷</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>
<!--
<p class=MsoNormal align=right style='text-align:right;word-break:break-all'><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>制作日期：</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>2019-06-29 - 2019-07-10<o:p></o:p></span></p> -->

<p class=MsoNormal align=right style='text-align:right'><span style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>制作人：小</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>邹</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>[yw_forgit@163.com]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>版本：</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>2.3.0</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>、</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>0.11.0.2<o:p></o:p></span></p>

<h1><span lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>概述</span></h1>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>消息队列</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="图片_x0020_1" o:spid="_x0000_i1146" type="#_x0000_t75"
 style='width:459.75pt;height:276.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image001.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=613 height=369
src="07_Kafka.files/image001.png" v:shapes="图片_x0020_1"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2" o:spid="_x0000_i1145" type="#_x0000_t75" style='width:185.25pt;
 height:186pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image003.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=247 height=248
src="07_Kafka.files/image003.png" v:shapes="图片_x0020_2"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>什么是</span><span
lang=EN-US>Kafka</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_3" o:spid="_x0000_i1144" type="#_x0000_t75" style='width:378pt;
 height:212.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image005.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=504 height=283
src="07_Kafka.files/image005.png" v:shapes="图片_x0020_3"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>架构</span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>整体架构图</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_6" o:spid="_x0000_i1143" type="#_x0000_t75" style='width:402pt;
 height:224.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image007.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=536 height=299
src="07_Kafka.files/image007.png" v:shapes="图片_x0020_6"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>流程看起来很复杂，学完再来看就都能明白</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_7" o:spid="_x0000_i1142" type="#_x0000_t75" style='width:566.25pt;
 height:292.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image009.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=755 height=390
src="07_Kafka.files/image009.png" v:shapes="图片_x0020_7"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>单个功能描述</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_8" o:spid="_x0000_i1141" type="#_x0000_t75" style='width:441.75pt;
 height:258.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image011.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=589 height=345
src="07_Kafka.files/image011.png" v:shapes="图片_x0020_8"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_9" o:spid="_x0000_i1140" type="#_x0000_t75" style='width:434.25pt;
 height:164.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image013.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=579 height=219
src="07_Kafka.files/image013.png" v:shapes="图片_x0020_9"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群部署</span></h1>

<p class=MsoNormal><span lang=EN-US>Kafka</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>需要</span><span
lang=EN-US>zk</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群的基础。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>下载安装</span></h2>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>去官网下载，当前最新是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>2.3.0</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，注意对应着</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Scala</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的两个不同的版本</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_4" o:spid="_x0000_i1139" type="#_x0000_t75" style='width:452.25pt;
 height:303.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image015.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=603 height=405
src="07_Kafka.files/image015.png" v:shapes="图片_x0020_4"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上传压缩包到三台机器上，并且解压缩</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_11" o:spid="_x0000_i1138" type="#_x0000_t75" style='width:567.75pt;
 height:233.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image017.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=757 height=311
src="07_Kafka.files/image017.png" v:shapes="图片_x0020_11"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>改一下名称</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_12" o:spid="_x0000_i1137" type="#_x0000_t75" style='width:567pt;
 height:253.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image019.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=756 height=338
src="07_Kafka.files/image019.png" v:shapes="图片_x0020_12"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>配置文件</span></h2>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进入</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>目录，创建</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>logs</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件夹，除了日志，数据也是放这目录存放的。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_13" o:spid="_x0000_i1136" type="#_x0000_t75" style='width:566.25pt;
 height:271.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image021.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=755 height=362
src="07_Kafka.files/image021.png" v:shapes="图片_x0020_13"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>看下配置文件</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_14" o:spid="_x0000_i1135" type="#_x0000_t75" style='width:425.25pt;
 height:198.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image023.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=567 height=265
src="07_Kafka.files/image023.png" v:shapes="图片_x0020_14"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>编辑</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>server.properties<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_15" o:spid="_x0000_i1134" type="#_x0000_t75" style='width:254.25pt;
 height:101.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image024.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=339 height=135
src="07_Kafka.files/image024.png" v:shapes="图片_x0020_15"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>broker.id</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>修改</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>broker.id </span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，三台的机子的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>id</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>要唯一</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_16" o:spid="_x0000_i1133" type="#_x0000_t75" style='width:567pt;
 height:327pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image025.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=756 height=436
src="07_Kafka.files/image025.png" v:shapes="图片_x0020_16"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>log.dirs</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>改</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>log.dirs</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>属性，即数据、日志存放的地方，默认是</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>/tmp/kafka-logs</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>，这是临时目录，改为上面创建的</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>logs</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>文件夹的目录。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_17" o:spid="_x0000_i1132" type="#_x0000_t75" style='width:567pt;
 height:300.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image027.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=756 height=401
src="07_Kafka.files/image027.png" v:shapes="图片_x0020_17"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>瞄一眼两个配置</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_18" o:spid="_x0000_i1131" type="#_x0000_t75" style='width:567pt;
 height:242.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image029.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=756 height=323
src="07_Kafka.files/image029.png" v:shapes="图片_x0020_18"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>zookeeper.connect</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>找到</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>zookeeper.connect=localhost:2181</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>，修改为自己的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>zk</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>slaveX</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>是在</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>/etc/hosts</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>文件映射过的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_25" o:spid="_x0000_i1130" type="#_x0000_t75" style='width:566.25pt;
 height:287.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image031.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=755 height=383
src="07_Kafka.files/image031.png" v:shapes="图片_x0020_25"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><a name="_delete.topic.enable"></a><span lang=EN-US>delete.topic.enable</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>配上</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>delete.topic.enable=true</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>，</span><span lang=EN-US><a
href="#_删除topic"><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'><span lang=EN-US>否则删除主题之后，又新建该主题名，会提示主题已存在</span></span></a></span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>。（我以为配置文件没有该属性就不需要配置了，结果还是要）</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_42" o:spid="_x0000_i1129" type="#_x0000_t75" style='width:567pt;
 height:264.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image033.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=353
src="07_Kafka.files/image033.png" v:shapes="图片_x0020_42"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>看一眼</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>bin</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的文件，框出来的都是常用的，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>xxx-console-xxx.sh</span><span style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>是测试用的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape id="图片_x0020_20"
 o:spid="_x0000_i1128" type="#_x0000_t75" style='width:541.5pt;height:148.5pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image035.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=722 height=198
src="07_Kafka.files/image035.png" v:shapes="图片_x0020_20"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>启动</span><span
lang=EN-US>Zookeeper</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>集群</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_21" o:spid="_x0000_i1127" type="#_x0000_t75" style='width:567pt;
 height:257.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image036.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=343
src="07_Kafka.files/image036.png" v:shapes="图片_x0020_21"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>启动</span><span
lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>集群</span></h2>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>[root@slave1 kafka]#
bin/kafka-server-start.sh config/server.properties<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_22" o:spid="_x0000_i1126" type="#_x0000_t75" style='width:567pt;
 height:239.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image038.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=319
src="07_Kafka.files/image038.png" v:shapes="图片_x0020_22"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这是前台进程，会一直输出日志，如下图，如果需要写脚本就要到</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>-damon</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>参数，后台守护启动</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_26" o:spid="_x0000_i1125" type="#_x0000_t75" style='width:567pt;
 height:324pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image040.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=432
src="07_Kafka.files/image040.png" v:shapes="图片_x0020_26"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>报错问题</span></h2>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>写</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>zk</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>集群时，逗号写成了分号</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_19" o:spid="_x0000_i1124" type="#_x0000_t75" style='width:566.25pt;
 height:294pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image042.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=392
src="07_Kafka.files/image042.png" v:shapes="图片_x0020_19"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>然后在</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>slave3</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>启动</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>kafka</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>就报错了，其他两台不报错</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_24" o:spid="_x0000_i1123" type="#_x0000_t75" style='width:567pt;
 height:194.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image044.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=259
src="07_Kafka.files/image044.png" v:shapes="图片_x0020_24"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>重新开三个窗口，查看</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的进程</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_27" o:spid="_x0000_i1122" type="#_x0000_t75" style='width:567pt;
 height:263.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image046.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=351
src="07_Kafka.files/image046.png" v:shapes="图片_x0020_27"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>生产环境中，可能会有很多人用集群，所以要记录下自己的集群的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>id</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>。</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>jps -l </span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>是显示包名</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_28" o:spid="_x0000_i1121" type="#_x0000_t75" style='width:567pt;
 height:215.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image048.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=287
src="07_Kafka.files/image048.png" v:shapes="图片_x0020_28"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>关闭集群</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_75" o:spid="_x0000_i1120" type="#_x0000_t75" style='width:450pt;
 height:50.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image050.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=600 height=67
src="07_Kafka.files/image050.png" v:shapes="图片_x0020_75"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>命令行简单操作</span></h2>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>创建</span><span lang=EN-US>topic</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>随便用</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>slave1</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>（</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>bin</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>下的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>sh</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>脚本可以用任意一台节点来运行，后续不再提示）来创建</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>topic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_29" o:spid="_x0000_i1119" type="#_x0000_t75" style='width:567pt;
 height:94.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image052.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=126
src="07_Kafka.files/image052.png" v:shapes="图片_x0020_29"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'>bin/kafka-topics.sh --create --zookeeper slave1:2181 --partitions 2
  --replication-factor 2 --topic first<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>显示</span><span lang=EN-US>topic</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_30" o:spid="_x0000_i1118" type="#_x0000_t75" style='width:405.75pt;
 height:51pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image054.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=541 height=68
src="07_Kafka.files/image054.png" v:shapes="图片_x0020_30"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'>bin/kafka-topics.sh --list --zookeeper slave1:2181<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>查看文件情况，可以看到</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>slave2</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>上有</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>first</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>这</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>topic</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的两个分区，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>slave1</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>、</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>slave3</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>分别有不同分区的副本</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_31" o:spid="_x0000_i1117" type="#_x0000_t75" style='width:567pt;
 height:282.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image055.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=377
src="07_Kafka.files/image055.png" v:shapes="图片_x0020_31"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>注意点，副本数不能超过集群的节点数</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_32" o:spid="_x0000_i1116" type="#_x0000_t75" style='width:567pt;
 height:80.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image057.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=107
src="07_Kafka.files/image057.png" v:shapes="图片_x0020_32"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>发送、接收消息</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动生产者（</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>随便找台节点，可在任意一台节点启动，后续不再提示</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>），注意端口号是</span><span lang=EN-US>9092</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，这是连接</span><span
lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群，下图已经启动，</span><span
lang=EN-US>&gt; </span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>后面可以直接跟消息内容了，回车表示发送</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_33" o:spid="_x0000_i1115" type="#_x0000_t75" style='width:490.5pt;
 height:87.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image059.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=654 height=117
src="07_Kafka.files/image059.png" v:shapes="图片_x0020_33"><![endif]></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'>bin/kafka-console-producer.sh --broker-list slave1:9092 --topic first<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动消费者（随便找台节点，可在任意一台节点启动，后续不再提示），注意新版本的消费者只能连接</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>集群（</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>--bootstrap-server
+</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:
125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群节点）进行消费，不能连接</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>zk</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>（</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>--zookeeper +</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>集群节点）集群进行消费了</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_34" o:spid="_x0000_i1114" type="#_x0000_t75" style='width:521.25pt;
 height:94.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image060.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=695 height=126
src="07_Kafka.files/image060.png" v:shapes="图片_x0020_34"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'>bin/kafka-console-consumer.sh --bootstrap-server slave1:9092 --topic
  first<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>发送、接收消息</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_35" o:spid="_x0000_i1113" type="#_x0000_t75" style='width:567pt;
 height:60pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image061.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=80
src="07_Kafka.files/image061.png" v:shapes="图片_x0020_35"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>多发一个，顺便提示一下，生产者生产消息敲错了，想删除要按</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Ctrl+Backspace<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_36" o:spid="_x0000_i1112" type="#_x0000_t75" style='width:567pt;
 height:88.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image063.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=118
src="07_Kafka.files/image063.png" v:shapes="图片_x0020_36"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>默认只能接收最新的消息，即消费者要在消息生产之前就监听着，当然加</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'> --from-beginning </span><span style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>参数就能消费以前的消息。如下图，重新起一个消费者</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_37" o:spid="_x0000_i1111" type="#_x0000_t75" style='width:567pt;
 height:51pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image065.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=68
src="07_Kafka.files/image065.png" v:shapes="图片_x0020_37"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群维护</span><span
lang=EN-US>offset</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在集群本地</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>新版的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的消费者直接跟</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Kafka</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群交互，不再通过</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>zk</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>来交互，减少消耗（</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Kafka</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>就不用另起线程维护</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>offset</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>到</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>zk</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>集群了），</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>offset</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>（消息消费到哪里了）就直接在</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>集群本地维护。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>连接</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>集群消费过消息之后，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>topic</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就多了一个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>offset</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，这就是</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Kafka</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>集群本地维护的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>offset</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>保存数据都是通过</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>topic</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>来保存的。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_38" o:spid="_x0000_i1110" type="#_x0000_t75" style='width:395.25pt;
 height:47.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image067.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=527 height=63
src="07_Kafka.files/image067.png" v:shapes="图片_x0020_38"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>查看</span><span lang=EN-US>topic</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>详情</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_39" o:spid="_x0000_i1109" type="#_x0000_t75" style='width:495pt;
 height:54pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image068.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=660 height=72
src="07_Kafka.files/image068.png" v:shapes="图片_x0020_39"><![endif]></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'>bin/kafka-topics.sh --zookeeper slave1:2181 --describe --topic first<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:6.5pt;font-family:
  "Courier New";color:black;background:white;mso-highlight:white;mso-font-kerning:
  0pt'>Topic:first</span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:red;background:white;mso-highlight:white;mso-font-kerning:0pt'>（名称）</span><span
  lang=EN-US style='font-size:6.5pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><span
  style='mso-tab-count:1'>    </span>PartitionCount:2</span><span
  style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>（分区数）</span><span lang=EN-US style='font-size:
  6.5pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'><span style='mso-tab-count:1'>   </span>ReplicationFactor:2</span><span
  style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>（副本数）</span><span lang=EN-US style='font-size:
  6.5pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'><span style='mso-tab-count:1'>      </span>Configs:</span><span
  style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>（具体配置详情）</span><span lang=EN-US style='font-size:
  6.5pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:5.5pt;font-family:
  "Courier New";color:black;background:white;mso-highlight:white;mso-font-kerning:
  0pt'><span style='mso-tab-count:1'>       </span>Topic: first<span
  style='mso-tab-count:1'> </span>Partition: 0</span><span style='font-size:
  5.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:red;background:white;mso-highlight:white;mso-font-kerning:0pt'>（</span><span
  lang=EN-US style='font-size:5.0pt;font-family:"Courier New";color:red;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>0</span><span
  style='font-size:5.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>分区）</span><span lang=EN-US style='font-size:6.5pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'><span style='mso-tab-count:1'> </span>Leader: 0</span><span
  style='font-size:5.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>（</span><span lang=EN-US style='font-size:5.0pt;
  font-family:"Courier New";color:red;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>0</span><span style='font-size:5.0pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:red;background:white;mso-highlight:white;mso-font-kerning:0pt'>分区的</span><span
  lang=EN-US style='font-size:5.0pt;font-family:"Courier New";color:red;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>leader</span><span
  style='font-size:5.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>是</span><span lang=EN-US style='font-size:5.0pt;
  font-family:"Courier New";color:red;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>broker.id=0</span><span style='font-size:5.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:red;background:white;mso-highlight:white;mso-font-kerning:0pt'>的主机，即</span><span
  lang=EN-US style='font-size:5.0pt;font-family:"Courier New";color:red;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>slave1</span><span
  style='font-size:5.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>）</span><span lang=EN-US style='font-size:5.5pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'><span style='mso-tab-count:1'> </span>Replicas: 0,1</span><span
  style='font-size:5.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>（</span><span lang=EN-US style='font-size:5.0pt;
  font-family:"Courier New";color:red;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>0</span><span style='font-size:5.0pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:red;background:white;mso-highlight:white;mso-font-kerning:0pt'>分区的副本在</span><span
  lang=EN-US style='font-size:5.0pt;font-family:"Courier New";color:red;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>slave1</span><span
  style='font-size:5.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>、</span><span lang=EN-US style='font-size:5.0pt;
  font-family:"Courier New";color:red;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>slave2</span><span style='font-size:5.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:red;background:white;mso-highlight:white;mso-font-kerning:0pt'>）</span><span
  lang=EN-US style='font-size:3.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><span
  style='mso-spacerun:yes'>   </span></span><span lang=EN-US style='font-size:
  5.5pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>Isr: 0,1</span><span style='font-size:5.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:red;background:white;mso-highlight:white;mso-font-kerning:0pt'>（跟副本一样，</span><span
  lang=EN-US style='font-size:5.0pt;font-family:"Courier New";color:red;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>leader</span><span
  style='font-size:5.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>挂了选择</span><span lang=EN-US style='font-size:
  5.0pt;font-family:"Courier New";color:red;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>leader</span><span style='font-size:5.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:red;background:white;mso-highlight:white;mso-font-kerning:0pt'>用）</span><span
  lang=EN-US style='font-size:6.5pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";color:black;background:white;
  mso-highlight:white;mso-font-kerning:0pt'><span style='mso-tab-count:1'>      </span></span><span
  lang=EN-US style='font-size:5.5pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>Topic: first<span
  style='mso-tab-count:1'> </span>Partition: 1<span style='mso-tab-count:1'> </span>Leader:
  1<span style='mso-tab-count:1'>    </span>Replicas: 1,2<span
  style='mso-tab-count:1'>       </span>Isr: 1,2</span><span lang=EN-US
  style='font-size:6.5pt;mso-fareast-font-family:宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对照这个看</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_40" o:spid="_x0000_i1108" type="#_x0000_t75" style='width:490.5pt;
 height:244.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image055.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=654 height=326
src="07_Kafka.files/image068.png" v:shapes="图片_x0020_40"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Isr</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的作用：</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>follower</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>会自己拉取数据备份，但是拉取数据有快慢，谁的数据跟</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>leader</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>最接近，就排前面，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>leader</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>挂了就顶他上去。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><a name="_删除topic"></a><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>删除</span><span
lang=EN-US>topic</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_41" o:spid="_x0000_i1107" type="#_x0000_t75" style='width:463.5pt;
 height:49.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image070.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=618 height=66
src="07_Kafka.files/image070.png" v:shapes="图片_x0020_41"><![endif]></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US>bin/kafka-topics.sh
  --delete --zookeeper slave1:2181 --topic first</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>又新创建一个</span><span
lang=EN-US>first</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主题，如果没有配置</span><a
name="_Hlk12797887"></a><a href="#_delete.topic.enable"><span style='mso-bookmark:
_Hlk12797887'><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;mso-fareast-font-family:宋体'>delete.topic.enable=true</span></span><span
style='mso-bookmark:_Hlk12797887'></span></a><span style='mso-bookmark:_Hlk12797887'></span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>，就会出现这样的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_43" o:spid="_x0000_i1106" type="#_x0000_t75" style='width:567pt;
 height:46.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image071.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=62
src="07_Kafka.files/image071.png" v:shapes="图片_x0020_43"><![endif]></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US>bin/kafka-topics.sh
  --create --zookeeper slave1:2181 --partitions 1 --replication-factor 3
  --topic first</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>重新配置</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>delete.topic.enable=true</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>，重启集群之后，需要重新删除一遍</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>first</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>主题（不知道为什么用原来的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>xshell</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>窗口也是无效，换一个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>xshell</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>窗口就行了）</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_44" o:spid="_x0000_i1105" type="#_x0000_t75" style='width:477.75pt;
 height:47.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image073.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=637 height=63
src="07_Kafka.files/image073.png" v:shapes="图片_x0020_44"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>重新创建，一个分区、</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>3</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>个副本</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_45" o:spid="_x0000_i1104" type="#_x0000_t75" style='width:567pt;
 height:27pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image074.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=36
src="07_Kafka.files/image074.png" v:shapes="图片_x0020_45"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>bin/kafka-topics.sh
--create --zookeeper slave1:2181 --partitions 1 --replication-factor 3 --topic
first<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>工作流程分析</span></h1>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_46" o:spid="_x0000_i1103" type="#_x0000_t75" style='width:566.25pt;
 height:292.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image009.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=390
src="07_Kafka.files/image075.png" v:shapes="图片_x0020_46"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>生产过程分析</span></h2>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>写入方式</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_47" o:spid="_x0000_i1102" type="#_x0000_t75" style='width:443.25pt;
 height:41.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image077.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=591 height=55
src="07_Kafka.files/image077.png" v:shapes="图片_x0020_47"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>分区（</span><span lang=EN-US>Partition</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>）</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_48" o:spid="_x0000_i1101" type="#_x0000_t75" style='width:439.5pt;
 height:43.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image079.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=586 height=58
src="07_Kafka.files/image079.png" v:shapes="图片_x0020_48"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_49" o:spid="_x0000_i1100" type="#_x0000_t75" style='width:366pt;
 height:220.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image081.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=488 height=294
src="07_Kafka.files/image081.png" v:shapes="图片_x0020_49"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_50" o:spid="_x0000_i1099" type="#_x0000_t75" style='width:5in;
 height:176.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image083.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=480 height=235
src="07_Kafka.files/image083.png" v:shapes="图片_x0020_50"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_51" o:spid="_x0000_i1098" type="#_x0000_t75" style='width:410.25pt;
 height:40.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image085.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=547 height=54
src="07_Kafka.files/image085.png" v:shapes="图片_x0020_51"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_52" o:spid="_x0000_i1097" type="#_x0000_t75" style='width:412.5pt;
 height:184.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image087.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=550 height=246
src="07_Kafka.files/image087.png" v:shapes="图片_x0020_52"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>副本（</span><span lang=EN-US>Replication</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>）</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_53" o:spid="_x0000_i1096" type="#_x0000_t75" style='width:411pt;
 height:131.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image089.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=548 height=175
src="07_Kafka.files/image089.png" v:shapes="图片_x0020_53"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>写入流程</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Producer</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>写入消息流程如下：</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_55" o:spid="_x0000_i1095" type="#_x0000_t75" style='width:567pt;
 height:282.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image091.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=377
src="07_Kafka.files/image091.png" v:shapes="图片_x0020_55"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Broker</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>保存消息</span></h2>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>存储方式</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_56" o:spid="_x0000_i1094" type="#_x0000_t75" style='width:451.5pt;
 height:71.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image093.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=602 height=95
src="07_Kafka.files/image093.png" v:shapes="图片_x0020_56"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>给</span><span
lang=EN-US>first</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主题发送数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_58" o:spid="_x0000_i1093" type="#_x0000_t75" style='width:492pt;
 height:116.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image095.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=656 height=155
src="07_Kafka.files/image095.png" v:shapes="图片_x0020_58"><![endif]></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>查看数据文件</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_57" o:spid="_x0000_i1092" type="#_x0000_t75" style='width:567pt;
 height:208.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image096.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=278
src="07_Kafka.files/image096.png" v:shapes="图片_x0020_57"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>存储策略</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_59" o:spid="_x0000_i1091" type="#_x0000_t75" style='width:451.5pt;
 height:126.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image098.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=602 height=169
src="07_Kafka.files/image098.png" v:shapes="图片_x0020_59"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>数据在</span><span lang=EN-US>Zookeeper</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>的存储结构</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>连上</span><span
lang=EN-US>zk</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群查看</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_61" o:spid="_x0000_i1090" type="#_x0000_t75" style='width:567pt;
 height:194.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image100.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=259
src="07_Kafka.files/image100.png" v:shapes="图片_x0020_61"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_62" o:spid="_x0000_i1089" type="#_x0000_t75" style='width:415.5pt;
 height:267pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image102.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=554 height=356
src="07_Kafka.files/image102.png" v:shapes="图片_x0020_62"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主要是两条线</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_60" o:spid="_x0000_i1088" type="#_x0000_t75" style='width:567pt;
 height:278.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image103.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=371
src="07_Kafka.files/image103.png" v:shapes="图片_x0020_60"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>消费过程分析</span></h2>

<p class=MsoNormal><span lang=EN-US>Kafka</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>提供了两套</span><span
lang=EN-US>consumerAPI</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>：高级</span><span
lang=EN-US>ConsumerAPI</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和低级</span><span
lang=EN-US>ConsumerAPI</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。（注意不是新旧版本的</span><span
lang=EN-US>API</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US>console</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>用的是低级</span><span
lang=EN-US>API</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，公司一般也是用低级的）</span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>高级</span><span lang=EN-US>API</span></h3>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>优点</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_63" o:spid="_x0000_i1087" type="#_x0000_t75" style='width:429pt;
 height:167.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image105.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=572 height=223
src="07_Kafka.files/image105.png" v:shapes="图片_x0020_63"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>缺点</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>可以通过重新给消费者换一个组实现重复消费</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_64" o:spid="_x0000_i1086" type="#_x0000_t75" style='width:273pt;
 height:56.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image107.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=364 height=75
src="07_Kafka.files/image107.png" v:shapes="图片_x0020_64"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>低级</span><span lang=EN-US>API</span></h3>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>优点</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_65" o:spid="_x0000_i1085" type="#_x0000_t75" style='width:411pt;
 height:88.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image109.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=548 height=118
src="07_Kafka.files/image109.png" v:shapes="图片_x0020_65"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>缺点</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_66" o:spid="_x0000_i1084" type="#_x0000_t75" style='width:391.5pt;
 height:25.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image111.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=522 height=34
src="07_Kafka.files/image111.png" v:shapes="图片_x0020_66"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>消费者组</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_67" o:spid="_x0000_i1083" type="#_x0000_t75" style='width:427.5pt;
 height:189pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image113.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=570 height=252
src="07_Kafka.files/image113.png" v:shapes="图片_x0020_67"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_68" o:spid="_x0000_i1082" type="#_x0000_t75" style='width:431.25pt;
 height:162.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image115.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=575 height=217
src="07_Kafka.files/image115.png" v:shapes="图片_x0020_68"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>消费方式</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_69" o:spid="_x0000_i1081" type="#_x0000_t75" style='width:473.25pt;
 height:264.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image117.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=631 height=353
src="07_Kafka.files/image117.png" v:shapes="图片_x0020_69"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>消费者组案例</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>测试同一个消费者组中的消费者，同一时刻只能有一个消费者消费。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>修改</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>config/<span style='color:red'>consumer</span>.properties</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>文件，默认</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>group.id=test-consumer-group</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，就用这个测试</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_70" o:spid="_x0000_i1080" type="#_x0000_t75" style='width:567pt;
 height:166.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image119.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=222
src="07_Kafka.files/image119.png" v:shapes="图片_x0020_70"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不指定</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>group.id</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>（即启动消费者不带配置文件），默认会给每个消费者随机生成一个。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>带</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>consumer.properties</span><span style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>配置文件启动一个组的两个消费者</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_72" o:spid="_x0000_i1079" type="#_x0000_t75" style='width:566.25pt;
 height:60.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image121.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=81
src="07_Kafka.files/image121.png" v:shapes="图片_x0020_72"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>bin/kafka-console-consumer.sh --bootstrap-server slave1:9092 --topic
  first --consumer.config config/consumer.properties</span><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>生产者发送一个消息，只看到一个消费者消费了（当然是轮着消费的）</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_73" o:spid="_x0000_i1078" type="#_x0000_t75" style='width:567.75pt;
 height:126pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image123.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=757 height=168
src="07_Kafka.files/image123.png" v:shapes="图片_x0020_73"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>杀死其中一个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_74" o:spid="_x0000_i1077" type="#_x0000_t75" style='width:567.75pt;
 height:177pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image125.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=757 height=236
src="07_Kafka.files/image125.png" v:shapes="图片_x0020_74"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>4</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>Kafka API</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>实战</span></h1>

<h2><span lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>生产者</span><span
lang=EN-US>Java API</span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>生产者没有高级、低级</span><span
lang=EN-US>API</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>之分。</span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>创建生产者（带回调）</span></h3>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>代码</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_82" o:spid="_x0000_i1076" type="#_x0000_t75" style='width:318pt;
 height:199.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image127.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=424 height=266
src="07_Kafka.files/image127.png" v:shapes="图片_x0020_82"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>pom.xml</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  background:white'><i><span lang=EN-US style='font-size:10.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>&lt;?</span></i><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>xml version</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;1.0&quot; </span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>encoding</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;UTF-8&quot;</span></b><i><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>?&gt;<br>
  </span></i><span lang=EN-US style='font-size:10.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;background:#EFEFEF;mso-font-kerning:0pt'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>project </span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>xmlns</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;http://maven.apache.org/POM/4.0.0&quot;<br>
  <span style='mso-spacerun:yes'>         </span></span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>xmlns:</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;background:#EFEFEF;mso-font-kerning:0pt'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br>
  <span style='mso-spacerun:yes'>         </span></span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;background:#EFEFEF;mso-font-kerning:0pt'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>:schemaLocation</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;http://maven.apache.org/POM/4.0.0
  http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>4.0.0<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>com.ywforwhat<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>02_Kafka<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>1.0-SNAPSHOT<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>artifactId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>kafka-clients<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>          </span><span
  style='mso-spacerun:yes'>  </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>2.3.0<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>&lt;!-- 2.12</span></i><i><span style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>是<span
  lang=EN-US>Scala</span>的版本，后面<span lang=EN-US>2.3.0</span>才是<span lang=EN-US>Kafka</span>的版本<span
  lang=EN-US> --&gt;<br>
  <span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>kafka_2.12<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>version</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>2.3.0<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>project</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>CustomerProducer</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:8.0pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:8.0pt;
  color:black'>producer;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.kafka.clients.producer.*;<br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.kafka.common.serialization.StringSerializer;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>java.util.Properties;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:8.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/1.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:8.0pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>CustomerProducer {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>public static void </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>main(String[] args) {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>配置信息<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>Properties properties = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>Properties();<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Kafka</span></i><i><span
  style='font-size:8.0pt;color:gray'>集群<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;bootstrap.servers&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;slave1:9092&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>应答级别。<span lang=EN-US>acks=-1(all)</span>、<span lang=EN-US>0</span>、<span
  lang=EN-US>1<br>
<span style='mso-spacerun:yes'>        </span>//properties.put(&quot;acks&quot;, &quot;all&quot;); // all</span>或者<span
  lang=EN-US>-1<br>
<span style='mso-spacerun:yes'>        </span>// ProducerConfig</span>有<span
  lang=EN-US>Producer</span>的所有属性，<span lang=EN-US>ProducerConfig.ACKS_CONFIG=acks<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(ProducerConfig.</span><b><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>ACKS_CONFIG</span></i></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;all&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>重试次数<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;retries&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  8.0pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// &gt;&gt; </span></i><i><span
  style='font-size:8.0pt;color:gray'>满足这两个条件之一才发送数据，先存起来<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span>// </span>发送一条数据的缓存大小<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;batch.size&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>16384</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>);<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// 16K<br>
<span style='mso-spacerun:yes'>        </span>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>提交延迟（不会立马提交）<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;linger.ms&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>1</span><span lang=EN-US style='font-size:
  8.0pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>整个<span lang=EN-US>Producer</span>的缓存<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;buffer.memory&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>33554432</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Key</span></i><i><span
  style='font-size:8.0pt;color:gray'>的序列化类<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;key.serializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Value</span></i><i><span
  style='font-size:8.0pt;color:gray'>的序列化类<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;value.serializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
  <br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>创建生产者对象。 泛型是数据的<span lang=EN-US>k</span>、<span lang=EN-US>v</span>类型<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>KafkaProducer&lt;String, String&gt; producer = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>KafkaProducer&lt;String, String&gt;(properties);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>循环发送数据<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>for </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>(</span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>int </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>i=</span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  8.0pt;color:black'>; i&lt;</span><span lang=EN-US style='font-size:8.0pt;
  color:blue'>5</span><span lang=EN-US style='font-size:8.0pt;color:black'>; i++) {<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// i&lt;10<br>
<span style='mso-spacerun:yes'>            </span>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>将变量<span lang=EN-US>i</span>的值作为数据，发送到<span
  lang=EN-US>first</span>（一个分区，<span lang=EN-US>3</span>个备份）。 没有回调<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span>//producer.send(new ProducerRecord&lt;String, String&gt;(&quot;first&quot;, String.valueOf(i)));<br>
<span style='mso-spacerun:yes'>            </span>// </span>发送完毕有回调。<span
  lang=EN-US>topic</span>为<span lang=EN-US>first</span>（一个分区，<span lang=EN-US>3</span>个备份），<span
  lang=EN-US>topic</span>改为<span lang=EN-US>second</span>（<span lang=EN-US>3</span>个分区，<span
  lang=EN-US>2</span>个备份）可以测试轮询分区进行消费<span lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>producer.send(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>ProducerRecord&lt;String, String&gt;(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;first&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, String.<i>valueOf</i>(i)), </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>Callback() {<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// second<br>
<span style='mso-spacerun:yes'>                </span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>public void </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>onCompletion(RecordMetadata recordMetadata, Exception e) {<br>
<span style='mso-spacerun:yes'>               </span><span style='mso-spacerun:yes'>     </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// Exception</span></i><i><span
  style='font-size:8.0pt;color:gray'>为空表示发送成功<span lang=EN-US><br>
<span style='mso-spacerun:yes'>                    </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>if</span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>(e == </span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>null</span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>                        </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>打印消费的分区、偏移量<span lang=EN-US><br>
<span style='mso-spacerun:yes'>                        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>System.</span><b><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;partition=&quot; </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>+ recordMetadata.partition() + </span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;--offset&quot; </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>+ recordMetadata.offset());<br>
<span style='mso-spacerun:yes'>                    </span>} </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>else </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>{<br>
<span style='mso-spacerun:yes'>                        </span>System.</span><b><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;</span></b><b><span
  style='font-size:8.0pt;color:green'>发送失败<span lang=EN-US>&quot;</span></span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>                    </span>}<br>
<span style='mso-spacerun:yes'>                </span>}<br>
<span style='mso-spacerun:yes'>            </span>});<br>
<span style='mso-spacerun:yes'>        </span>}<br>
  <br>
<span style='mso-spacerun:yes'>        </span>producer.close();<br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>测试</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>起一个消费者</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_23" o:spid="_x0000_i1075" type="#_x0000_t75" style='width:521.25pt;
 height:81pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image128.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=695 height=108
src="07_Kafka.files/image128.png" v:shapes="图片_x0020_23"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>跑起程序，由于</span><span
lang=EN-US>first</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主题只有一个分区，故就一直都是</span><span
lang=EN-US>0</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US>offset</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>由于有测试数据了，故不是从</span><span
lang=EN-US>0</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>开始</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_10" o:spid="_x0000_i1074" type="#_x0000_t75" style='width:402pt;
 height:192pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image129.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=536 height=256
src="07_Kafka.files/image129.png" v:shapes="图片_x0020_10"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>消费者打印，看紫色部分，其他是别的测试数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_54" o:spid="_x0000_i1073" type="#_x0000_t75" style='width:483pt;
 height:167.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image131.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=644 height=223
src="07_Kafka.files/image131.png" v:shapes="图片_x0020_54"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>新创建一个</span><span
lang=EN-US>topic</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US>second</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>有</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个分区，</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个副本</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_71" o:spid="_x0000_i1072" type="#_x0000_t75" style='width:567pt;
 height:36pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image133.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=48
src="07_Kafka.files/image133.png" v:shapes="图片_x0020_71"><![endif]></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US>bin/kafka-topics.sh
  --zookeeper slave1:2181 --create --topic second --partitions 3
  --replication-factor 2</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>稍微改一下代码，把</span><span
lang=EN-US>topic</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数由</span><span
lang=EN-US>first</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>改为</span><span
lang=EN-US>second</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US>for</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>循环改为</span><span
lang=EN-US>10</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>（数据多一点）</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_79" o:spid="_x0000_i1071" type="#_x0000_t75" style='width:567pt;
 height:270pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image135.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=360
src="07_Kafka.files/image135.png" v:shapes="图片_x0020_79"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行程序，</span><span
lang=EN-US>second</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>有</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个分区，可以看到下图是轮询</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个分区消费数据的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_80" o:spid="_x0000_i1070" type="#_x0000_t75" style='width:533.25pt;
 height:267.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image137.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=711 height=357
src="07_Kafka.files/image137.png" v:shapes="图片_x0020_80"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>再看监听的消费者所获取的数据，不是从</span><span
lang=EN-US>0-9</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的，而是先把一个分区的所有数据都拉回来，再拉下一个分区的数据。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_81" o:spid="_x0000_i1069" type="#_x0000_t75" style='width:516.75pt;
 height:192pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image138.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=689 height=256
src="07_Kafka.files/image138.png" v:shapes="图片_x0020_81"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>自定义分区生产者</span></h3>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>代码</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_84" o:spid="_x0000_i1068" type="#_x0000_t75" style='width:351pt;
 height:214.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image139.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=468 height=286
src="07_Kafka.files/image139.png" v:shapes="图片_x0020_84"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>pom.xml</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件不变</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>CustomerProducer</span><span lang=EN-US style='color:black;mso-color-alt:
windowtext'> </span><span style='color:black;mso-color-alt:windowtext'>跟前面的差不多，除了 </span><i><span
style='color:gray'>指定自定义分区的类名</span></i><span style='color:black;mso-color-alt:
windowtext'> 之外，数据放<span lang=EN-US>second<o:p></o:p></span></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:8.0pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:8.0pt;
  color:black'>producer;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.kafka.clients.producer.*;<br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.kafka.common.serialization.StringSerializer;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>java.util.Properties;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:8.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/1.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:8.0pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>CustomerProducer {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>public static void </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>main(String[] args) {<br>
<span style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>      </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>配置信息<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>Properties properties = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>Properties();<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Kafka</span></i><i><span
  style='font-size:8.0pt;color:gray'>集群<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;bootstrap.servers&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;slave1:9092&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>应答级别。<span lang=EN-US>acks=-1(all)</span>、<span lang=EN-US>0</span>、<span
  lang=EN-US>1<br>
<span style='mso-spacerun:yes'>        </span>//properties.put(&quot;acks&quot;, &quot;all&quot;); // all</span>或者<span
  lang=EN-US>-1<br>
<span style='mso-spacerun:yes'>        </span>// ProducerConfig</span>有<span
  lang=EN-US>Producer</span>的所有属性，<span lang=EN-US>ProducerConfig.ACKS_CONFIG=acks<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(ProducerConfig.</span><b><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>ACKS_CONFIG</span></i></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;all&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>重试次数<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;retries&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  8.0pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// &gt;&gt; </span></i><i><span
  style='font-size:8.0pt;color:gray'>满足这两个条件之一才发送数据，先存起来<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span>// </span>发送一条数据的缓存大小<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;batch.size&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>16384</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>);<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// 16K<br>
<span style='mso-spacerun:yes'>        </span>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>提交延迟（不会立马提交）<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;linger.ms&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>1</span><span lang=EN-US style='font-size:
  8.0pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>整个<span lang=EN-US>Producer</span>的缓存<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;buffer.memory&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>33554432</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Key</span></i><i><span
  style='font-size:8.0pt;color:gray'>的序列化类<span lang=EN-US><br>
<span style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'>     </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;key.serializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Value</span></i><i><span
  style='font-size:8.0pt;color:gray'>的序列化类<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;value.serializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>指定自定义分区的类名<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:red'>properties.put(&quot;partitioner.class&quot;, &quot;producer.CustomerPartitioner&quot;);</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'><br>
  <br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>创建生产者对象。 泛型是数据的<span lang=EN-US>k</span>、<span lang=EN-US>v</span>类型<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>KafkaProducer&lt;String, String&gt; producer = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>KafkaProducer&lt;String, String&gt;(properties);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>循环发送数据<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>for </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>(</span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>int </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>i=</span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  8.0pt;color:black'>; i&lt;</span><span lang=EN-US style='font-size:8.0pt;
  color:blue'>5</span><span lang=EN-US style='font-size:8.0pt;color:black'>; i++) {<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// i&lt;5 i&lt;10<br>
<span style='mso-spacerun:yes'>            </span>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>将变量<span lang=EN-US>i</span>的值作为数据，发送到<span
  lang=EN-US>first</span>（一个分区，<span lang=EN-US>3</span>个备份）。 没有回调<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span>//producer.send(new ProducerRecord&lt;String, String&gt;(&quot;first&quot;, String.valueOf(i)));<br>
<span style='mso-spacerun:yes'>            </span>// </span>发送完毕有回调。<span
  lang=EN-US>topic</span>为<span lang=EN-US>first</span>（一个分区，<span lang=EN-US>3</span>个备份），<span
  lang=EN-US>topic</span>改为<span lang=EN-US>second</span>（<span lang=EN-US>3</span>个分区，<span
  lang=EN-US>2</span>个备份）可以测试轮询分区进行消费<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span><span style='mso-spacerun:yes'>      </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>producer.send(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>ProducerRecord&lt;String, String&gt;(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;</span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:red'>second</span></b><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, String.<i>valueOf</i>(i)), </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>Callback() {<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// first second<br>
<span style='mso-spacerun:yes'>                </span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>public void </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>onCompletion(RecordMetadata recordMetadata, Exception e) {<br>
<span style='mso-spacerun:yes'>                    </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// Exception</span></i><i><span
  style='font-size:8.0pt;color:gray'>为空表示发送成功<span lang=EN-US><br>
<span style='mso-spacerun:yes'>         </span><span style='mso-spacerun:yes'>           </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>if</span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>(e == </span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>null</span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>                        </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>打印消费的分区、偏移量<span lang=EN-US><br>
<span style='mso-spacerun:yes'>                        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>System.</span><b><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;partition=&quot; </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>+ recordMetadata.partition() + </span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;--offset&quot; </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>+ recordMetadata.offset());<br>
<span style='mso-spacerun:yes'>                    </span>} </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>else </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>{<br>
<span style='mso-spacerun:yes'>                        </span>System.</span><b><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;</span></b><b><span
  style='font-size:8.0pt;color:green'>发送失败<span lang=EN-US>&quot;</span></span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>                    </span>}<br>
<span style='mso-spacerun:yes'>                </span>}<br>
<span style='mso-spacerun:yes'>            </span>});<br>
<span style='mso-spacerun:yes'>        </span>}<br>
  <br>
<span style='mso-spacerun:yes'>        </span>producer.close();<br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>CustomerPartitioner</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:9.0pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:9.0pt;
  color:black'>producer;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:9.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>org.apache.kafka.clients.producer.Partitioner;<br>
  </span><b><span lang=EN-US style='font-size:9.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>org.apache.kafka.common.Cluster;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:9.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>java.util.Map;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:9.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* </span></i><i><span style='font-size:
  9.0pt;color:gray'>自定义分区类<span lang=EN-US><br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/1.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:9.0pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>CustomerPartitioner </span><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>implements </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>Partitioner {<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>private </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>Map </span><b><span lang=EN-US
  style='font-size:9.0pt;color:#660E7A'>configMap </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>= </span><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>null</span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>;<br>
  <br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>public int </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>partition(String topic, Object key, </span><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>byte</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>[] keyBytes, Object o1, </span><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>byte</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>[] valueBytes, Cluster cluster) {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>实际做分区就是拿到这些参数做<span lang=EN-US>hash</span>等，然后模于分区数就可以<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>return </span></b><span
  lang=EN-US style='font-size:9.0pt;color:blue'>0</span><span lang=EN-US
  style='font-size:9.0pt;color:black'>;<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:9.0pt;color:gray'>// </span></i><i><span
  style='font-size:9.0pt;color:gray'>这里返回<span lang=EN-US>0</span>，即数据都放<span
  lang=EN-US>0</span>分区<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:9.0pt;color:black'>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>public void </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>close() {<br>
  <br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>     </span>* </span></i><i><span
  style='font-size:9.0pt;color:gray'>该方法一般在<span lang=EN-US>partition</span>分区方法需要用到配置的时候，这样子用的，虽然<span
  lang=EN-US>configure</span>方法也可以设置分区。<span lang=EN-US><br>
<span style='mso-spacerun:yes'>     </span>* <b>@param </b></span></span></i><b><i><span
  lang=EN-US style='font-size:9.0pt;color:#3D3D3D'>configs<br>
<span style='mso-spacerun:yes'>     </span></span></i></b><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>*/<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>public void </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>configure(Map&lt;String, ?&gt; configs) {<br>
<span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:9.0pt;color:#660E7A'>configMap </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>= configs;<br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>测试</span></h4>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行程序，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>topic</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>为</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>second</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>有</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>3</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:
125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个分区，本来是要轮询分区的，现在都是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>0</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>分区了</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_83" o:spid="_x0000_i1067" type="#_x0000_t75" style='width:567pt;
 height:210pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image140.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=280
src="07_Kafka.files/image140.png" v:shapes="图片_x0020_83"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>消费的值也是按顺序了</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_85" o:spid="_x0000_i1066" type="#_x0000_t75" style='width:538.5pt;
 height:129.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image142.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=718 height=173
src="07_Kafka.files/image142.png" v:shapes="图片_x0020_85"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>消费者</span><span
lang=EN-US>Java API</span></h2>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>高级</span><span lang=EN-US>API</span></h3>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>代码</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_89" o:spid="_x0000_i1065" type="#_x0000_t75" style='width:276pt;
 height:185.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image143.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=368 height=247
src="07_Kafka.files/image143.png" v:shapes="图片_x0020_89"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>pom.xml</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件不变</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>CustomerConsumer</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:7.5pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:7.5pt;
  color:black'>consumer;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>org.apache.kafka.clients.consumer.ConsumerConfig;<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>org.apache.kafka.clients.consumer.ConsumerRecord;<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>org.apache.kafka.clients.consumer.ConsumerRecords;<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>org.apache.kafka.clients.consumer.KafkaConsumer;<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>org.apache.kafka.clients.producer.ProducerConfig;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>java.time.Duration;<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>java.util.Arrays;<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>java.util.Collections;<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>java.util.Properties;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:7.5pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/1.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:7.5pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>CustomerConsumer {<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:7.5pt;color:navy'>public static void </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>main(String[] args) {<br>
<span style='mso-spacerun:yes'>        </span>Properties properties = </span><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>Properties();<br>
<span style='mso-spacerun:yes'>    </span><span style='mso-spacerun:yes'>    </span></span><i><span
  lang=EN-US style='font-size:7.5pt;color:gray'>// &gt;&gt;</span></i><i><span
  style='font-size:7.5pt;color:gray'>消费者的所有配置都在<span lang=EN-US>ConsumerConfig<br>
<span style='mso-spacerun:yes'>        </span>// Kafka</span>集群<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>properties.put(ConsumerConfig.</span><b><i><span
  lang=EN-US style='font-size:7.5pt;color:#660E7A'>BOOTSTRAP_SERVERS_CONFIG</span></i></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:7.5pt;color:green'>&quot;slave1:9092&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>);<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:7.5pt;color:gray'>// </span></i><i><span
  style='font-size:7.5pt;color:gray'>即<span lang=EN-US>bootstrap.servers<br>
<span style='mso-spacerun:yes'>        </span>// </span>消费者组<span lang=EN-US>id<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;group.id&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:7.5pt;color:green'>&quot;test&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>设置自动提交<span lang=EN-US>offset<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;enable.auto.commit&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:7.5pt;color:green'>&quot;true&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>提交延时。从<span lang=EN-US>topic</span>拿到数据之后，过了多久才提交<span
  lang=EN-US>offset</span>。正常流程是：消费数据<span lang=EN-US> -- </span>业务处理<span
  lang=EN-US> -- </span>提交<span lang=EN-US>offset</span>，假如提交数据之前挂了，重启之后，<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span>// </span>就会重复消费，因为这个<span
  lang=EN-US>offset</span>没有提交返回给<span lang=EN-US>Kafka</span>，所以这里一般用低级<span
  lang=EN-US>API</span>管理，在处理完数据之后，才提交<span lang=EN-US>offset</span>，保证数据与<span
  lang=EN-US>offset</span>一致。<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;auto.commit.interval.ms&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:7.5pt;color:green'>&quot;1000&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// Key</span></i><i><span
  style='font-size:7.5pt;color:gray'>的反序列化类<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;key.deserializer&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:7.5pt;color:green'>&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// Value</span></i><i><span
  style='font-size:7.5pt;color:gray'>的反序列化类<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;value.deserializer&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:7.5pt;color:green'>&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>);<br>
  <br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>创建消费者对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>KafkaConsumer&lt;String, String&gt; consumer = </span><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>KafkaConsumer&lt;String, String&gt;(properties);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>单个<span lang=EN-US>topic<br>
<span style='mso-spacerun:yes'>        </span>//consumer.subscribe(Collections.singletonList(&quot;second&quot;));<br>
<span style='mso-spacerun:yes'>        </span>// </span>指定<span lang=EN-US>Topic</span>。多个<span
  lang=EN-US>topic</span>，哪怕<span lang=EN-US>topic</span>不存在也没有影响<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>consumer.subscribe(Arrays.<i>asList</i>(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;second&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:7.5pt;color:green'>&quot;first&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:7.5pt;color:green'>&quot;third&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>));<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>一直接收，测试而已<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>while </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>(</span><b><span lang=EN-US
  style='font-size:7.5pt;color:navy'>true</span></b><span lang=EN-US
  style='font-size:7.5pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>隔多久主动拉取数据<span lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>ConsumerRecords&lt;String, String&gt; consumerRecords = consumer.poll(Duration.<i>ofMillis</i>(</span><span
  lang=EN-US style='font-size:7.5pt;color:blue'>100</span><span lang=EN-US
  style='font-size:7.5pt;color:black'>)); </span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// 100ms<br>
  <br>
<span style='mso-spacerun:yes'>            </span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>for </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>(ConsumerRecord&lt;String, String&gt; record : consumerRecords) {<br>
<span style='mso-spacerun:yes'>                </span>System.</span><b><i><span
  lang=EN-US style='font-size:7.5pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;topic=&quot; </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>+ record.topic() + </span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot; - partition=&quot; </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>+ record.partition() + </span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot; - dataValue=&quot; </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>+ record.value());<br>
<span style='mso-spacerun:yes'>            </span>}<br>
<span style='mso-spacerun:yes'>        </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>测试</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>先运行代码程序</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>命令行启动生产者，发送消息到</span><span
lang=EN-US>first</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_87" o:spid="_x0000_i1064" type="#_x0000_t75" style='width:491.25pt;
 height:103.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image145.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=655 height=138
src="07_Kafka.files/image145.png" v:shapes="图片_x0020_87"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>命令行启动另一个生产者，发送消息到</span><span
lang=EN-US>second</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_88" o:spid="_x0000_i1063" type="#_x0000_t75" style='width:498pt;
 height:100.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image146.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=664 height=134
src="07_Kafka.files/image146.png" v:shapes="图片_x0020_88"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>然后就能看到消费的结果了，这里注意一下，多次启动代码程序而不关闭，消费者会轮询消费，导致这里“</span><span
lang=EN-US>helloyw</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>”这信息没有在下图打印出来，而在另一个控制台打印，表面感觉好像不会消费一样，注意哦</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_86" o:spid="_x0000_i1062" type="#_x0000_t75" style='width:501.75pt;
 height:89.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image147.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=669 height=119
src="07_Kafka.files/image147.png" v:shapes="图片_x0020_86"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>注意点</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_96" o:spid="_x0000_i1061" type="#_x0000_t75" style='width:397.5pt;
 height:222pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image148.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=530 height=296
src="07_Kafka.files/image148.png" v:shapes="图片_x0020_96"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_97" o:spid="_x0000_i1060" type="#_x0000_t75" style='width:411.75pt;
 height:91.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image150.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=549 height=122
src="07_Kafka.files/image150.png" v:shapes="图片_x0020_97"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>以及</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_98" o:spid="_x0000_i1059" type="#_x0000_t75" style='width:396.75pt;
 height:225.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image152.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=529 height=301
src="07_Kafka.files/image152.png" v:shapes="图片_x0020_98"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>低级</span><span lang=EN-US>API</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法都是自定义的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_90" o:spid="_x0000_i1058" type="#_x0000_t75" style='width:456.75pt;
 height:201.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image154.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=609 height=269
src="07_Kafka.files/image154.png" v:shapes="图片_x0020_90"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>findNewLeader()</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>：</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>第一次找主副本的时候，把三个副本记下来，如果</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>leader</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>挂了，就直接从其他俩选出一个</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>leader</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，就不用重新从众多集群中找了，但本教程没有实现。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>本教程用的是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>2.3.0</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，这个版本实在是太新了，很少资料，而且我看了官网也没有看到操作</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>API</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>的官方案例，而且现在最新版已经没有这个低级</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>API</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>了，无奈之下，就回退到</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>kafka_2.11-0.11.0.2</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>（与原教程一样）版本吧</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>代码</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>新建一个工程，因为</span><span
lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的版本不一样</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_95" o:spid="_x0000_i1057" type="#_x0000_t75" style='width:230.25pt;
 height:129.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image156.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=307 height=173
src="07_Kafka.files/image156.png" v:shapes="图片_x0020_95"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>pom.xml</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><i><span lang=EN-US style='font-size:10.0pt;
  color:black'>&lt;?</span></i><b><span lang=EN-US style='font-size:10.0pt;
  color:blue;background:#EFEFEF'>xml version</span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;1.0&quot; </span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:blue;background:#EFEFEF'>encoding</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;UTF-8&quot;</span></b><i><span
  lang=EN-US style='font-size:10.0pt;color:black'>?&gt;<br>
  </span></i><span lang=EN-US style='font-size:10.0pt;color:black;background:
  #EFEFEF'>&lt;</span><b><span lang=EN-US style='font-size:10.0pt;color:navy;
  background:#EFEFEF'>project </span></b><b><span lang=EN-US style='font-size:
  10.0pt;color:blue;background:#EFEFEF'>xmlns</span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://maven.apache.org/POM/4.0.0&quot;<br>
<span style='mso-spacerun:yes'>         </span></span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:blue;background:#EFEFEF'>xmlns:</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:#660E7A;background:#EFEFEF'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br>
<span style='mso-spacerun:yes'>         </span></span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:#660E7A;background:#EFEFEF'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:blue;background:#EFEFEF'>:schemaLocation</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>4.0.0<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>modelVersion</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>com.ywforwhat<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>02_Kafka_0.11.0.2<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>1.0-SNAPSHOT<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>kafka-clients<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>0.11.0.2<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:10.0pt;color:gray'>&lt;!-- 2.11</span></i><i><span
  style='font-size:10.0pt;color:gray'>是<span lang=EN-US>Scala</span>的版本，后面<span
  lang=EN-US>0.11.0.2</span>才是<span lang=EN-US>Kafka</span>的版本<span lang=EN-US> --&gt;<br>
<span style='mso-spacerun:yes'>            </span>&lt;!-- 0.11.0.2 --&gt;<br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>kafka_2.11<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>0.11.0.2<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <span style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>project</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>LowerConsumer</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:6.5pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:6.5pt;
  color:black'>consumer;<br>
  <br>
  <br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>kafka.api.FetchRequest;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>kafka.api.FetchRequestBuilder;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>kafka.cluster.BrokerEndPoint;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>kafka.javaapi.*;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>kafka.javaapi.consumer.SimpleConsumer;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>kafka.javaapi.message.ByteBufferMessageSet;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>kafka.message.MessageAndOffset;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>java.nio.ByteBuffer;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>java.util.ArrayList;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>java.util.Collections;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>java.util.List;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:6.5pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* </span></i><i><span style='font-size:
  6.5pt;color:gray'>该类用的<span lang=EN-US>Kafka</span>版本为<span lang=EN-US>kafka_2.11-0.11.0.2<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/1.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:6.5pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>LowerConsumer {<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>public static void </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>main(String[] args) {<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>定义相关参数<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>ArrayList&lt;String&gt; brokers = </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>ArrayList&lt;String&gt;(); </span><i><span
  lang=EN-US style='font-size:6.5pt;color:gray'>// Kafka</span></i><i><span
  style='font-size:6.5pt;color:gray'>集群<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>brokers.add(</span><b><span
  lang=EN-US style='font-size:6.5pt;color:green'>&quot;slave1&quot;</span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span>brokers.add(</span><b><span
  lang=EN-US style='font-size:6.5pt;color:green'>&quot;slave2&quot;</span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span>brokers.add(</span><b><span
  lang=EN-US style='font-size:6.5pt;color:green'>&quot;slave3&quot;</span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>端口<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>int </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>port = </span><span
  lang=EN-US style='font-size:6.5pt;color:blue'>9092</span><span lang=EN-US
  style='font-size:6.5pt;color:black'>;<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>主题<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>String topic = </span><b><span
  lang=EN-US style='font-size:6.5pt;color:green'>&quot;second&quot;</span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>;<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>分区<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>int </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>partition = </span><span
  lang=EN-US style='font-size:6.5pt;color:blue'>0</span><span lang=EN-US
  style='font-size:6.5pt;color:black'>;<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// offset<br>
<span style='mso-spacerun:yes'>        </span></span></i><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>long </span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>offset = </span><span lang=EN-US
  style='font-size:6.5pt;color:blue'>2</span><span lang=EN-US style='font-size:
  6.5pt;color:black'>;<br>
  <br>
  <br>
<span style='mso-spacerun:yes'>        </span>LowerConsumer lowerConsumer = </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>LowerConsumer();<br>
<span style='mso-spacerun:yes'>        </span>lowerConsumer.getData(brokers, port, topic, partition, offset);<br>
  <br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>找分区<span lang=EN-US>leader<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>private </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>BrokerEndPoint findLeader(List&lt;String&gt; brokers, </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>int </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>port, String topic, </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>int </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>partition) {<br>
<span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>for</span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>(String broker : brokers) {<br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>创建获取分区<span lang=EN-US>leader</span>的消费者对象。<span
  lang=EN-US>1000</span>是超时时间，<span lang=EN-US>1024 * 4</span>是缓冲区大小，<span
  lang=EN-US>getLeader</span>是为该消费者取一个名字而已<span lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>SimpleConsumer getLeader = </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>SimpleConsumer(broker, port, </span><span
  lang=EN-US style='font-size:6.5pt;color:blue'>1000</span><span lang=EN-US
  style='font-size:6.5pt;color:black'>, </span><span lang=EN-US
  style='font-size:6.5pt;color:blue'>1024 </span><span lang=EN-US
  style='font-size:6.5pt;color:black'>* </span><span lang=EN-US
  style='font-size:6.5pt;color:blue'>4</span><span lang=EN-US style='font-size:
  6.5pt;color:black'>, </span><b><span lang=EN-US style='font-size:6.5pt;
  color:green'>&quot;getLeader&quot;</span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>创建一个主题元数据信息请求。找<span lang=EN-US>topic -- </span>找分区<span
  lang=EN-US> -- </span>找<span lang=EN-US>leader<br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>TopicMetadataRequest topicMetadataRequest = </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>TopicMetadataRequest(Collections.<i>singletonList</i>(topic));<br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>获取主题元数据返回值<span lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>TopicMetadataResponse topicMetadataResponse = getLeader.send(topicMetadataRequest);<br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>解析元数据返回值。上面传递多个<span lang=EN-US>topic</span>，这里就会返回多个<span
  lang=EN-US>topic</span>的元数据<span lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>List&lt;TopicMetadata&gt; topicMetadataList = topicMetadataResponse.topicsMetadata();<br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>遍历主题元数据。 主题元数据信息<span lang=EN-US>topicMetadata<br>
<span style='mso-spacerun:yes'>            </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>for</span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>(TopicMetadata topicMetadata : topicMetadataList) {<br>
<span style='mso-spacerun:yes'>                </span></span><i><span
  lang=EN-US style='font-size:6.5pt;color:gray'>// </span></i><i><span
  style='font-size:6.5pt;color:gray'>获取多个分区的元数据信息<span lang=EN-US><br>
<span style='mso-spacerun:yes'>                </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>List&lt;PartitionMetadata&gt; partitionMetadataList = topicMetadata.partitionsMetadata();<br>
<span style='mso-spacerun:yes'>                </span></span><i><span
  lang=EN-US style='font-size:6.5pt;color:gray'>// </span></i><i><span
  style='font-size:6.5pt;color:gray'>遍历分区元数据<span lang=EN-US><br>
<span style='mso-spacerun:yes'>                </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>for </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>(PartitionMetadata partitionMetadata : partitionMetadataList) {<br>
<span style='mso-spacerun:yes'>                    </span></span><i><span
  lang=EN-US style='font-size:6.5pt;color:gray'>// </span></i><i><span
  style='font-size:6.5pt;color:gray'>获取指定分区的<span lang=EN-US>leader<br>
<span style='mso-spacerun:yes'>                    </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>if</span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>(partitionMetadata.partitionId() == partition) {<br>
<span style='mso-spacerun:yes'>                        </span></span><i><span
  lang=EN-US style='font-size:6.5pt;color:gray'>// </span></i><i><span
  style='font-size:6.5pt;color:gray'>返回该分区的<span lang=EN-US>leader<br>
<span style='mso-spacerun:yes'>                        </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>return </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>partitionMetadata.leader();<br>
<span style='mso-spacerun:yes'>                    </span>}<br>
<span style='mso-spacerun:yes'>                </span>}<br>
<span style='mso-spacerun:yes'>            </span>}<br>
<span style='mso-spacerun:yes'>        </span>}<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>return null</span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>;<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>获取数据<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>private void </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>getData(List&lt;String&gt; brokers, </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>int </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>port, String topic, </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>int </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>partition, </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>long </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>offset) {<br>
<span style='mso-spacerun:yes'>        </span>BrokerEndPoint leader = findLeader(brokers, port, topic, partition);<br>
<span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>if</span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>(leader == </span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>null</span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>            </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>return</span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>;<br>
<span style='mso-spacerun:yes'>        </span>}<br>
  <br>
<span style='mso-spacerun:yes'>        </span>String leaderHost = leader.host();<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>获取数据的消费者对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>SimpleConsumer getData = </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>SimpleConsumer(leaderHost, port, </span><span
  lang=EN-US style='font-size:6.5pt;color:blue'>1000</span><span lang=EN-US
  style='font-size:6.5pt;color:black'>, </span><span lang=EN-US
  style='font-size:6.5pt;color:blue'>1024 </span><span lang=EN-US
  style='font-size:6.5pt;color:black'>* </span><span lang=EN-US
  style='font-size:6.5pt;color:blue'>4</span><span lang=EN-US style='font-size:
  6.5pt;color:black'>, </span><b><span lang=EN-US style='font-size:6.5pt;
  color:green'>&quot;getData&quot;</span></b><span lang=EN-US style='font-size:
  6.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>创建获取数据的对象。<span lang=EN-US> 100=</span>一次抓取数据的缓存大小，不是数据的条数<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>FetchRequest fetchRequest = </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>FetchRequestBuilder().addFetch(topic, partition, offset, </span><span
  lang=EN-US style='font-size:6.5pt;color:blue'>100</span><span lang=EN-US
  style='font-size:6.5pt;color:black'>).build();<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:6.5pt;color:gray'>// </span></i><i><span
  style='font-size:6.5pt;color:gray'>可以多次调用<span lang=EN-US>addFetch</span>传递多个<span
  lang=EN-US>topic<br>
<span style='mso-spacerun:yes'>        </span>// </span>获取数据返回值<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>FetchResponse fetchResponse = getData.fetch(fetchRequest);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>解析返回值，解析的时候再传具体的<span lang=EN-US>topic</span>进行解析<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:6.5pt;color:black'>ByteBufferMessageSet messageAndOffsets = fetchResponse.messageSet(topic, partition);<br>
<span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>for</span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>(MessageAndOffset messageAndOffset : messageAndOffsets) {<br>
<span style='mso-spacerun:yes'>            </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>long </span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>offset1 = messageAndOffset.offset();<br>
<span style='mso-spacerun:yes'>            </span>ByteBuffer payload = messageAndOffset.message().payload();<br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>模仿反序列化过程<span lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>byte</span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>[] bytes = </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>new byte</span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>[payload.limit()];<br>
<span style='mso-spacerun:yes'>            </span>payload.get(bytes);<br>
  <br>
<span style='mso-spacerun:yes'>            </span>System.</span><b><i><span
  lang=EN-US style='font-size:6.5pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:6.5pt;color:green'>&quot;offset=&quot; </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>+ offset1 + </span><b><span
  lang=EN-US style='font-size:6.5pt;color:green'>&quot; -- data=&quot; </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>+ </span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>String(bytes));<br>
<span style='mso-spacerun:yes'>        </span>}<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>测试</span></h4>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不管运行多少次，都是只消费分区为</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>2</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>、</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>offset=2</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>这条数据，这就是指定</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>topic</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>partition</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>、</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>offset</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>读取数据</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_94" o:spid="_x0000_i1056" type="#_x0000_t75" style='width:567pt;
 height:129pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image158.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=172
src="07_Kafka.files/image158.png" v:shapes="图片_x0020_94"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>5</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>Kafka Producer</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>拦截器</span></h1>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>注意是生产者的拦截器。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>拦截器原理</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_99" o:spid="_x0000_i1055" type="#_x0000_t75" style='width:368.25pt;
 height:151.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image160.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=491 height=202
src="07_Kafka.files/image160.png" v:shapes="图片_x0020_99"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_100" o:spid="_x0000_i1054" type="#_x0000_t75" style='width:368.25pt;
 height:183pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image162.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=491 height=244
src="07_Kafka.files/image162.png" v:shapes="图片_x0020_100"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_101" o:spid="_x0000_i1053" type="#_x0000_t75" style='width:363.75pt;
 height:72.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image164.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=485 height=97
src="07_Kafka.files/image164.png" v:shapes="图片_x0020_101"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>拦截器案例</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_102" o:spid="_x0000_i1052" type="#_x0000_t75" style='width:363.75pt;
 height:71.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image166.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=485 height=95
src="07_Kafka.files/image166.png" v:shapes="图片_x0020_102"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这样可以与逻辑分开，形成一个拦截器链来操作，统计这些就不属于主逻辑。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_103" o:spid="_x0000_i1051" type="#_x0000_t75" style='width:363pt;
 height:192pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image168.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=484 height=256
src="07_Kafka.files/image168.png" v:shapes="图片_x0020_103"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>代码</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_107" o:spid="_x0000_i1050" type="#_x0000_t75" style='width:277.5pt;
 height:218.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image170.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=370 height=291
src="07_Kafka.files/image170.png" v:shapes="图片_x0020_107"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>pom.xml</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><i><span lang=EN-US style='font-size:10.0pt;
  color:black'>&lt;?</span></i><b><span lang=EN-US style='font-size:10.0pt;
  color:blue;background:#EFEFEF'>xml version</span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;1.0&quot; </span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:blue;background:#EFEFEF'>encoding</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;UTF-8&quot;</span></b><i><span
  lang=EN-US style='font-size:10.0pt;color:black'>?&gt;<br>
  </span></i><span lang=EN-US style='font-size:10.0pt;color:black;background:
  #EFEFEF'>&lt;</span><b><span lang=EN-US style='font-size:10.0pt;color:navy;
  background:#EFEFEF'>project </span></b><b><span lang=EN-US style='font-size:
  10.0pt;color:blue;background:#EFEFEF'>xmlns</span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://maven.apache.org/POM/4.0.0&quot;<br>
<span style='mso-spacerun:yes'>         </span></span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:blue;background:#EFEFEF'>xmlns:</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:#660E7A;background:#EFEFEF'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br>
<span style='mso-spacerun:yes'>         </span></span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:#660E7A;background:#EFEFEF'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:blue;background:#EFEFEF'>:schemaLocation</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>4.0.0<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>modelVersion</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>com.ywforwhat<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>02_Kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>1.0-SNAPSHOT<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>kafka-clients<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>2.3.0<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:10.0pt;color:gray'>&lt;!-- 2.12</span></i><i><span
  style='font-size:10.0pt;color:gray'>是<span lang=EN-US>Scala</span>的版本，后面<span
  lang=EN-US>2.3.0</span>才是<span lang=EN-US>Kafka</span>的版本<span lang=EN-US> --&gt;<br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>kafka_2.12<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>2.3.0<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <span style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>project</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>TimeIntercetor</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:6.5pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:6.5pt;
  color:black'>interceptor;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>org.apache.kafka.clients.producer.ProducerInterceptor;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>org.apache.kafka.clients.producer.ProducerRecord;<br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>org.apache.kafka.clients.producer.RecordMetadata;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:6.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>java.util.Map;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:6.5pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/2.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:6.5pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>TimeIntercetor </span><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>implements </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>ProducerInterceptor&lt;String, String&gt; {<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>public </span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>ProducerRecord&lt;String, String&gt; onSend(ProducerRecord&lt;String, String&gt; producerRecord) {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:6.5pt;color:gray'>// </span></i><i><span style='font-size:
  6.5pt;color:gray'>其他都不变，就只改变一下<span lang=EN-US>value</span>的值为<span
  lang=EN-US>System.currentTimeMillis() + &quot;,&quot; + producerRecord.value()<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:6.5pt;color:navy'>return new </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>ProducerRecord&lt;String, String&gt;(producerRecord.topic(), producerRecord.key(), System.<i>currentTimeMillis</i>() + </span><b><span
  lang=EN-US style='font-size:6.5pt;color:green'>&quot;,&quot; </span></b><span
  lang=EN-US style='font-size:6.5pt;color:black'>+ producerRecord.value());<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>public void </span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>onAcknowledgement(RecordMetadata recordMetadata, Exception e) {<br>
  <br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>public void </span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>close() {<br>
  <br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:6.5pt;color:navy'>public void </span></b><span lang=EN-US
  style='font-size:6.5pt;color:black'>configure(Map&lt;String, ?&gt; map) {<br>
  <br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>CountIntercetor</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:10.5pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:10.5pt;
  color:black'>interceptor;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>org.apache.kafka.clients.producer.ProducerInterceptor;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>org.apache.kafka.clients.producer.ProducerRecord;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>org.apache.kafka.clients.producer.RecordMetadata;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>java.util.Map;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:10.5pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/2.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:10.5pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>CountIntercetor </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>implements </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>ProducerInterceptor&lt;String, String&gt; {<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>成功、失败的次数<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>private int </span></b><b><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>successCount </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>= </span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>0</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>;<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>private int </span></b><b><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>errorCount </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>= </span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>0</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>;<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>每条数据过来都会调用一次<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>public </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>ProducerRecord&lt;String, String&gt; onSend(ProducerRecord&lt;String, String&gt; producerRecord) {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>不对数据进行处理，故要原封不动返回，而不是返回<span lang=EN-US>null<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>return </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>producerRecord;<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>每条数据过来都会调用一次<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>public void </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>onAcknowledgement(RecordMetadata recordMetadata, Exception e) {<br>
<span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>if</span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>(e == </span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>null</span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>            </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:#660E7A'>successCount </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>++;<br>
<span style='mso-spacerun:yes'>        </span>} </span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>else </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>{<br>
<span style='mso-spacerun:yes'>            </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:#660E7A'>errorCount </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>++;<br>
<span style='mso-spacerun:yes'>        </span>}<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>生产完消息之后，就调用<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>public void </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>close() {<br>
<span style='mso-spacerun:yes'>        </span>System.</span><b><i><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:10.5pt;color:green'>&quot;</span></b><b><span
  style='font-size:10.5pt;color:green'>发送成功：<span lang=EN-US>&quot; </span></span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>+ </span><b><span lang=EN-US
  style='font-size:10.5pt;color:#660E7A'>successCount </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>+ </span><b><span lang=EN-US
  style='font-size:10.5pt;color:green'>&quot; </span></b><b><span
  style='font-size:10.5pt;color:green'>条<span lang=EN-US>&quot;</span></span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span>System.</span><b><i><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:10.5pt;color:green'>&quot;</span></b><b><span
  style='font-size:10.5pt;color:green'>发送失败：<span lang=EN-US>&quot; </span></span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>+ </span><b><span lang=EN-US
  style='font-size:10.5pt;color:#660E7A'>errorCount </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>+ </span><b><span lang=EN-US
  style='font-size:10.5pt;color:green'>&quot; </span></b><b><span
  style='font-size:10.5pt;color:green'>条<span lang=EN-US>&quot;</span></span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>public void </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>configure(Map&lt;String, ?&gt; map) {<br>
  <br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>CustomerProducer</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:8.0pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:8.0pt;
  color:black'>producer;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.kafka.clients.producer.*;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>java.util.ArrayList;<br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>java.util.Properties;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:8.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/1.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:8.0pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>CustomerProducer {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>public static void </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>main(String[] args) {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>配置信息<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>Properties properties = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>Properties();<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Kafka</span></i><i><span
  style='font-size:8.0pt;color:gray'>集群<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;bootstrap.servers&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;slave1:9092&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>应答级别。<span lang=EN-US>acks=-1(all)</span>、<span lang=EN-US>0</span>、<span
  lang=EN-US>1<br>
<span style='mso-spacerun:yes'>        </span>//properties.put(&quot;acks&quot;, &quot;all&quot;); // all</span>或者<span
  lang=EN-US>-1<br>
<span style='mso-spacerun:yes'>        </span>// ProducerConfig</span>有<span
  lang=EN-US>Producer</span>的所有属性，<span lang=EN-US>ProducerConfig.ACKS_CONFIG=acks<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(ProducerConfig.</span><b><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>ACKS_CONFIG</span></i></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;all&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>重试次数<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;retries&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  8.0pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// &gt;&gt; </span></i><i><span
  style='font-size:8.0pt;color:gray'>满足这两个条件之一才发送数据，先存起来<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span>// </span>发送一条数据的缓存大小<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;batch.size&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>16384</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>);<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// 16K<br>
<span style='mso-spacerun:yes'>        </span>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>提交延迟（不会立马提交）<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;linger.ms&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>1</span><span lang=EN-US style='font-size:
  8.0pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>整个<span lang=EN-US>Producer</span>的缓存<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;buffer.memory&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>33554432</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Key</span></i><i><span
  style='font-size:8.0pt;color:gray'>的序列化类<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;key.serializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Value</span></i><i><span
  style='font-size:8.0pt;color:gray'>的序列化类<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;value.serializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>       </span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:black'><span style='mso-spacerun:yes'> </span></span></b><b><i><span
  lang=EN-US style='font-size:10.0pt;color:gray'>// </span></i></b><b><i><span
  style='font-size:10.0pt;color:gray'>指定自定义分区的类名，不需要则注释即可<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span>//properties.put(&quot;partitioner.class&quot;, &quot;producer.CustomerPartitioner&quot;);</span></span></i></b><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'><br>
  <br>
<span style='mso-spacerun:yes'>        </span></span></i><b><i><span
  lang=EN-US style='font-size:11.0pt;color:gray'>// </span></i></b><b><i><span
  style='font-size:11.0pt;color:gray'>拦截器类，不需要则注释即可<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>ArrayList&lt;String&gt; list = </span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>ArrayList&lt;String&gt;();<br>
<span style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>      </span></span></b><b><i><span
  lang=EN-US style='font-size:11.0pt;color:gray'>// </span></i></b><b><i><span
  style='font-size:11.0pt;color:gray'>谁先添加就先执行谁<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>list.add(</span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;interceptor.TimeIntercetor&quot;</span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span>list.add(</span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;interceptor.CountIntercetor&quot;</span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span>properties.put(ProducerConfig.</span></b><b><i><span
  lang=EN-US style='font-size:11.0pt;color:#660E7A'>INTERCEPTOR_CLASSES_CONFIG</span></i></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>, list);</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>创建生产者对象。 泛型是数据的<span lang=EN-US>k</span>、<span lang=EN-US>v</span>类型<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>KafkaProducer&lt;String, String&gt; producer = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>KafkaProducer&lt;String, String&gt;(properties);<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>循环发送数据<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>for </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>(</span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>int </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>i=</span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  8.0pt;color:black'>; i&lt;</span><span lang=EN-US style='font-size:8.0pt;
  color:blue'>5</span><span lang=EN-US style='font-size:8.0pt;color:black'>; i++) {<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// i&lt;5 i&lt;10<br>
<span style='mso-spacerun:yes'>            </span>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>将变量<span lang=EN-US>i</span>的值作为数据，发送到<span
  lang=EN-US>first</span>（一个分区，<span lang=EN-US>3</span>个备份）。 没有回调<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span>//producer.send(new ProducerRecord&lt;String, String&gt;(&quot;first&quot;, String.valueOf(i)));<br>
<span style='mso-spacerun:yes'>            </span>// </span>发送完毕有回调。<span
  lang=EN-US>topic</span>为<span lang=EN-US>first</span>（一个分区，<span lang=EN-US>3</span>个备份），<span
  lang=EN-US>topic</span>改为<span lang=EN-US>second</span>（<span lang=EN-US>3</span>个分区，<span
  lang=EN-US>2</span>个备份）可以测试轮询分区进行消费<span lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>producer.send(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>ProducerRecord&lt;String, String&gt;(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;second&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, String.<i>valueOf</i>(i)), </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>Callback() {<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// first second<br>
<span style='mso-spacerun:yes'>      </span><span style='mso-spacerun:yes'>          </span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>public void </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>onCompletion(RecordMetadata recordMetadata, Exception e) {<br>
<span style='mso-spacerun:yes'>                    </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// Exception</span></i><i><span
  style='font-size:8.0pt;color:gray'>为空表示发送成功<span lang=EN-US><br>
<span style='mso-spacerun:yes'>                    </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>if</span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>(e == </span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>null</span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>                        </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>打印消费的分区、偏移量<span lang=EN-US><br>
<span style='mso-spacerun:yes'>                        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>System.</span><b><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;partition=&quot; </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>+ recordMetadata.partition() + </span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;--offset&quot; </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>+ recordMetadata.offset());<br>
<span style='mso-spacerun:yes'>                    </span>} </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>else </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>{<br>
<span style='mso-spacerun:yes'>                        </span>System.</span><b><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;</span></b><b><span
  style='font-size:8.0pt;color:green'>发送失败<span lang=EN-US>&quot;</span></span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>                    </span>}<br>
<span style='mso-spacerun:yes'>                </span>}<br>
<span style='mso-spacerun:yes'>            </span>});<br>
<span style='mso-spacerun:yes'>        </span>}<br>
  <br>
<span style='mso-spacerun:yes'>        </span>producer.close();<br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>注意</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_106" o:spid="_x0000_i1049" type="#_x0000_t75" style='width:566.25pt;
 height:360.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image172.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=481
src="07_Kafka.files/image172.png" v:shapes="图片_x0020_106"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>测试</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>先起一个消费者</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_108" o:spid="_x0000_i1048" type="#_x0000_t75" style='width:541.5pt;
 height:72.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image174.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=722 height=97
src="07_Kafka.files/image174.png" v:shapes="图片_x0020_108"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span style='color:black;mso-color-alt:windowtext'>运行<span
lang=EN-US style='background:#E4E4FF'>CustomerProducer</span><span lang=EN-US> </span>可以看到统计数<span
lang=EN-US><o:p></o:p></span></span></pre>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_104" o:spid="_x0000_i1047" type="#_x0000_t75" style='width:371.25pt;
 height:161.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image175.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=495 height=215
src="07_Kafka.files/image175.png" v:shapes="图片_x0020_104"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就可以看到数据前面加了时间戳</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_105" o:spid="_x0000_i1046" type="#_x0000_t75" style='width:536.25pt;
 height:140.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image177.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=715 height=187
src="07_Kafka.files/image177.png" v:shapes="图片_x0020_105"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>6</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>Kafka Streams</span></h1>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Kafka</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的流式处理</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Streams</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>没有</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>厉害</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Kafka Streams</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_109" o:spid="_x0000_i1045" type="#_x0000_t75" style='width:407.25pt;
 height:39.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image178.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=543 height=53
src="07_Kafka.files/image178.png" v:shapes="图片_x0020_109"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Kafka Streams</span><span style='font-family:宋体;
mso-ascii-font-family:"Calibri Light";mso-ascii-theme-font:major-latin;
mso-fareast-theme-font:major-fareast;mso-hansi-font-family:"Calibri Light";
mso-hansi-theme-font:major-latin'>特点</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_111" o:spid="_x0000_i1044" type="#_x0000_t75" style='width:198.75pt;
 height:204.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image180.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=265 height=273
src="07_Kafka.files/image180.png" v:shapes="图片_x0020_111"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_112" o:spid="_x0000_i1043" type="#_x0000_t75" style='width:338.25pt;
 height:118.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image182.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=451 height=158
src="07_Kafka.files/image182.png" v:shapes="图片_x0020_112"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>为什么要有</span><span
lang=EN-US>Kafka Streams</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_113" o:spid="_x0000_i1042" type="#_x0000_t75" style='width:438.75pt;
 height:197.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image184.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=585 height=263
src="07_Kafka.files/image184.png" v:shapes="图片_x0020_113"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_114" o:spid="_x0000_i1041" type="#_x0000_t75" style='width:433.5pt;
 height:112.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image186.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=578 height=150
src="07_Kafka.files/image186.png" v:shapes="图片_x0020_114"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_115" o:spid="_x0000_i1040" type="#_x0000_t75" style='width:426pt;
 height:119.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image188.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=568 height=159
src="07_Kafka.files/image188.png" v:shapes="图片_x0020_115"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_116" o:spid="_x0000_i1039" type="#_x0000_t75" style='width:6in;
 height:69.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image190.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=576 height=93
src="07_Kafka.files/image190.png" v:shapes="图片_x0020_116"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_117" o:spid="_x0000_i1038" type="#_x0000_t75" style='width:435pt;
 height:259.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image192.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=580 height=346
src="07_Kafka.files/image192.png" v:shapes="图片_x0020_117"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Kafka Streams</span><span style='font-family:宋体;
mso-ascii-font-family:"Calibri Light";mso-ascii-theme-font:major-latin;
mso-fareast-theme-font:major-fareast;mso-hansi-font-family:"Calibri Light";
mso-hansi-theme-font:major-latin'>数据清洗案例</span></h2>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>实时处理单词带有“</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>&gt;&gt;&gt;</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>”前缀的内容，例如输入“</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>atguigu&gt;&gt;&gt;ximenqing</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>”，最终处理为“</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>ximenqing</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>”。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_118" o:spid="_x0000_i1037" type="#_x0000_t75" style='width:534.75pt;
 height:200.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image194.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=713 height=267
src="07_Kafka.files/image194.png" v:shapes="图片_x0020_118"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>依赖</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_119" o:spid="_x0000_i1036" type="#_x0000_t75" style='width:455.25pt;
 height:197.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image196.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=607 height=263
src="07_Kafka.files/image196.png" v:shapes="图片_x0020_119"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><span lang=EN-US style='color:black;background:#EFEFEF'>&lt;</span><b><span
  lang=EN-US style='color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='color:black'>org.apache.kafka<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='color:black'>kafka-streams<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='color:black'>0.11.0.2<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='color:black'><br>
  <span style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='color:navy;background:#EFEFEF'>dependency</span></b><span lang=EN-US
  style='color:black;background:#EFEFEF'>&gt;</span><span lang=EN-US
  style='color:black'><o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>代码</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>版本用</span><span
lang=EN-US>0.11.0.2</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_122" o:spid="_x0000_i1035" type="#_x0000_t75" style='width:285pt;
 height:167.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image198.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=380 height=223
src="07_Kafka.files/image198.png" v:shapes="图片_x0020_122"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>pom.xml</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><i><span lang=EN-US style='font-size:10.0pt;
  color:black'>&lt;?</span></i><b><span lang=EN-US style='font-size:10.0pt;
  color:blue;background:#EFEFEF'>xml version</span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;1.0&quot; </span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:blue;background:#EFEFEF'>encoding</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;UTF-8&quot;</span></b><i><span
  lang=EN-US style='font-size:10.0pt;color:black'>?&gt;<br>
  </span></i><span lang=EN-US style='font-size:10.0pt;color:black;background:
  #EFEFEF'>&lt;</span><b><span lang=EN-US style='font-size:10.0pt;color:navy;
  background:#EFEFEF'>project </span></b><b><span lang=EN-US style='font-size:
  10.0pt;color:blue;background:#EFEFEF'>xmlns</span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://maven.apache.org/POM/4.0.0&quot;<br>
<span style='mso-spacerun:yes'>         </span></span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:blue;background:#EFEFEF'>xmlns:</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:#660E7A;background:#EFEFEF'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br>
<span style='mso-spacerun:yes'>         </span></span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:#660E7A;background:#EFEFEF'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:blue;background:#EFEFEF'>:schemaLocation</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>4.0.0<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>modelVersion</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>  </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>com.ywforwhat<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>02_Kafka_0.11.0.2<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>1.0-SNAPSHOT<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>kafka-clients<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>0.11.0.2<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:10.0pt;color:gray'>&lt;!-- 2.11</span></i><i><span
  style='font-size:10.0pt;color:gray'>是<span lang=EN-US>Scala</span>的版本，后面<span
  lang=EN-US>0.11.0.2</span>才是<span lang=EN-US>Kafka</span>的版本<span lang=EN-US> --&gt;<br>
<span style='mso-spacerun:yes'>            </span>&lt;!-- 0.11.0.2 --&gt;<br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>kafka_2.11<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>0.11.0.2<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>kafka-streams<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>0.11.0.2<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <span style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>project</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>KafkaStream</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:8.0pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:8.0pt;
  color:black'>Streams;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.kafka.streams.KafkaStreams;<br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.kafka.streams.processor.Processor;<br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.kafka.streams.processor.ProcessorSupplier;<br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.kafka.streams.processor.TopologyBuilder;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>java.util.Properties;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:8.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/3.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:8.0pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>KafkaStream {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>public static void </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>main(String[] args) {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>创建拓扑对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>TopologyBuilder builder = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>TopologyBuilder();<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>创建配置文件<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>Properties properties = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>Properties();<br>
<span style='mso-spacerun:yes'>        </span>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;bootstrap.servers&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;slave1:9092&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
<span style='mso-spacerun:yes'>        </span>properties.put(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;application.id&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;kafkaStream&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
  <br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// &gt;&gt; </span></i><i><span
  style='font-size:8.0pt;color:gray'>构建拓扑结构<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span>// </span>数据源在<span lang=EN-US>topic first</span>，即从<span
  lang=EN-US>first</span>拿数据来清洗。 参数：<span lang=EN-US>name, topics<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>builder.addSource(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;SOURCE&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;first&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>                </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>//<span style='mso-spacerun:yes'>  </span></span></i><i><span
  style='font-size:8.0pt;color:gray'>参数：<span lang=EN-US>name,supplier,parentNames=</span>上面的<span
  lang=EN-US>SOURCE<br>
<span style='mso-spacerun:yes'>                </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>.addProcessor(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;PROCESSOR&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>ProcessorSupplier() {<br>
<span style='mso-spacerun:yes'>                    </span></span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>public </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>Processor get() {<br>
<span style='mso-spacerun:yes'>                        </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>数据进来是经过序列化的，但是到了这里没有经过反序列化（消费的时候才有），故<span
  lang=EN-US>LogProcessor</span>的泛型类型用<span lang=EN-US>byte<br>
<span style='mso-spacerun:yes'>                        </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>return new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>LogProcessor(){};<br>
<span style='mso-spacerun:yes'>                    </span>}<br>
<span style='mso-spacerun:yes'>                </span>}, </span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;SOURCE&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>            </span><span style='mso-spacerun:yes'>    </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>//<span style='mso-spacerun:yes'>  </span></span></i><i><span
  style='font-size:8.0pt;color:gray'>清洗完放入<span lang=EN-US>second</span>。 参数名称：<span
  lang=EN-US>name,topic,parentNames<br>
<span style='mso-spacerun:yes'>                </span></span></span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>.addSink(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;SINK&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;second&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;PROCESSOR&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span>KafkaStreams kafkaStreams = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>KafkaStreams(builder, properties);<br>
<span style='mso-spacerun:yes'>        </span>kafkaStreams.start();<br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>LogProcessor</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:10.5pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:10.5pt;
  color:black'>Streams;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>org.apache.kafka.streams.processor.Processor;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>org.apache.kafka.streams.processor.ProcessorContext;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:10.5pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/3.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:10.5pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>LogProcessor </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>implements </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>Processor&lt;</span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>byte</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>[], </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>byte</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>[]&gt; {<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>private </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>ProcessorContext </span><b><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>context</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>;<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>public void </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>init(ProcessorContext processorContext) {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>上下文环境<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>context </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>= processorContext;<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>参数分别是<span lang=EN-US>Key</span>、<span lang=EN-US>Value<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>public void </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>process(</span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>byte</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>[] bytes, </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>byte</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>[] bytes2) {<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>获取一行数据。反序列化<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>String line = </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>String(bytes2);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>去除“<span lang=EN-US>&gt;&gt;&gt;</span>”<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>line = line.replaceAll(</span><b><span
  lang=EN-US style='font-size:10.5pt;color:green'>&quot;&gt;&gt;&gt;&quot;</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:10.5pt;color:green'>&quot;&quot;</span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>);<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>序列化<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>bytes2 = line.getBytes();<br>
  <br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>把数据写出去<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>context</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>.forward(bytes, bytes2);<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>public void </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>punctuate(</span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>long </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>l) {<br>
  <br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>public void </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>close() {<br>
  <br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>测试</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_120" o:spid="_x0000_i1034" type="#_x0000_t75" style='width:567pt;
 height:119.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image200.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=159
src="07_Kafka.files/image200.png" v:shapes="图片_x0020_120"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>生产者发送数据之后，消费者就能直接消费清洗过的数据。代码实现与清洗案例的图有点出入，即“</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>ximenqing</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>”，只是没有把前面的字符串去掉而已。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_121" o:spid="_x0000_i1033" type="#_x0000_t75" style='width:566.25pt;
 height:59.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image202.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=79
src="07_Kafka.files/image202.png" v:shapes="图片_x0020_121"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>太复杂的操作</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>做不了，但是清洗还是可以的。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>7</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、扩展</span></h1>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>与</span><span
lang=EN-US>Flume</span><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>比较</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_5" o:spid="_x0000_i1032" type="#_x0000_t75" style='width:342.75pt;
 height:184.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image204.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=457 height=246
src="07_Kafka.files/image204.png" v:shapes="图片_x0020_5"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Flume</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>与</span><span
lang=EN-US>Kafka</span><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>集成</span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>流程：日志文件</span><span
lang=EN-US> --&gt; Flume --&gt; Kafka</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Flume</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的使用参考</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Flume</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>教程。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>配置</span><span lang=EN-US>Flume</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>看下</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Flume</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>官网的文档，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Kafka</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>作为</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Flume</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Sink<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_78" o:spid="_x0000_i1031" type="#_x0000_t75" style='width:566.25pt;
 height:356.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image206.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=475
src="07_Kafka.files/image206.png" v:shapes="图片_x0020_78"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>使用</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>slave1</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>主机创建</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>flume-logger-kafka.conf</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>（</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>job</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>目录是自己创建的）</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_110" o:spid="_x0000_i1030" type="#_x0000_t75" style='width:268.5pt;
 height:109.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image208.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=358 height=146
src="07_Kafka.files/image208.png" v:shapes="图片_x0020_110"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>编辑</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># &gt;&gt; Agent<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sources </span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'> r1<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sinks </span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>=</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'> k1<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>channels </span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'> c1<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># &gt;&gt; Source</span><span style='font-size:11.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>。使用</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>tail</span><span
  style='font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:#804000;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>命令监听日志文件</span><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:#804000;background:white;mso-highlight:
  white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sources</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>r1</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>type </span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'> exec<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sources</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>r1</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>command </span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:navy;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'> tail </span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>-</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>F </span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>-</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>c </span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>+</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#FF8000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>0</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'> </span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>/</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>usr</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>/</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>local</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>/</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>flume</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>/</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>flume_kafka</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>.</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>log<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sources</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>r1</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>shell </span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:navy;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'> <b>/bin/bash</b> </span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>-</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>c<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># &gt;&gt; Sink</span><span style='font-size:11.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>。直接复制官网案例改</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sinks</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>k1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>type </span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>=</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'> org</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>apache</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>flume</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sink</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>kafka</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>KafkaSink<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># </span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>数据传输给</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>Kafka</span><span
  style='font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:#804000;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>的</span><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>first</span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>主题</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sinks</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>k1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>kafka</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>topic </span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>=</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'> first<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># Kafka</span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>的集群</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sinks</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>k1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>kafka</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>bootstrap</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>servers </span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:navy;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'> slave1</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>:</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#FF8000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>9092</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>,</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>slave2</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>:</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#FF8000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>9092</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>,</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>slave3</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>:</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#FF8000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>9092</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sinks</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>k1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>kafka</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>flumeBatchSize </span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:navy;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'> </span><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:#FF8000;background:
  white;mso-highlight:white;mso-font-kerning:0pt'>20</span><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sinks</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>k1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>kafka</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>producer</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>acks </span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'> </span><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#FF8000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>1</span><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sinks</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>k1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>kafka</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>producer</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>linger</span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:navy;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'>ms </span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>=</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'> </span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#FF8000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>1</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># &gt;&gt; channel</span><span style='font-size:11.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>的内存</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># a1</span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>的</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>channel</span><span
  style='font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:#804000;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>类型是</span><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>memory</span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>内存型</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>channels</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>c1</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>type </span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'> memory<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># a1</span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>的</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>channel</span><span
  style='font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:#804000;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>总容量</span><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>1000</span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>个</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>event<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>channels</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>c1</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>capacity </span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:navy;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'> </span><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:#FF8000;background:
  white;mso-highlight:white;mso-font-kerning:0pt'>1000</span><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># a1</span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>的</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>channel</span><span
  style='font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:#804000;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>传输时收集到了</span><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:#804000;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>100</span><span style='font-size:11.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>条</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>event</span><span
  style='font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:"Courier New";color:#804000;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>以后再去提交事务</span><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:#804000;background:white;mso-highlight:
  white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>channels</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>c1</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>transactionCapacity </span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:navy;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'> </span><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:#FF8000;background:
  white;mso-highlight:white;mso-font-kerning:0pt'>100</span><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># &gt;&gt; </span><span style='font-size:11.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>拓扑结构</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># put</span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>过程。</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>a1</span><b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:navy;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:black;background:white;mso-highlight:white;
  mso-font-kerning:0pt'>sources</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>r1</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:navy;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US style='font-size:
  11.0pt;font-family:"Courier New";color:black;background:white;mso-highlight:
  white;mso-font-kerning:0pt'>channels </span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:navy;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>=</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'> c1<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
  none;text-autospace:none'><span lang=EN-US style='font-size:11.0pt;
  font-family:"Courier New";color:#804000;background:white;mso-highlight:white;
  mso-font-kerning:0pt'># take</span><span style='font-size:11.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
  color:#804000;background:white;mso-highlight:white;mso-font-kerning:0pt'>过程。</span><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:#804000;
  background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'>a1</span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:navy;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>.</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'>sinks</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>.</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>k1</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>.</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>channel </span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:navy;
  background:white;mso-highlight:white;mso-font-kerning:0pt'>=</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:"Courier New";color:black;
  background:white;mso-highlight:white;mso-font-kerning:0pt'> c1</span><span
  lang=EN-US style='font-size:11.0pt;mso-fareast-font-family:宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>启动</span><span lang=EN-US>Flume</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>任务（命令可以简写）</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_123" o:spid="_x0000_i1029" type="#_x0000_t75" style='width:404.25pt;
 height:66pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image209.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=539 height=88
src="07_Kafka.files/image209.png" v:shapes="图片_x0020_123"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>保证</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>zk</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>、</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Kafka</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>集群都启动了</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>启动一个消费者</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>监听</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>first</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>主题</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_124" o:spid="_x0000_i1028" type="#_x0000_t75" style='width:452.25pt;
 height:65.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image211.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=603 height=87
src="07_Kafka.files/image211.png" v:shapes="图片_x0020_124"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>测试</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>创建日志文件，模拟日志生成</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_125" o:spid="_x0000_i1027" type="#_x0000_t75" style='width:227.25pt;
 height:22.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image213.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=303 height=30
src="07_Kafka.files/image213.png" v:shapes="图片_x0020_125"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>追加日志（其他都是测试的）</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_126" o:spid="_x0000_i1026" type="#_x0000_t75" style='width:314.25pt;
 height:100.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image214.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=419 height=134
src="07_Kafka.files/image214.png" v:shapes="图片_x0020_126"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>消费者很快就能消费</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_127" o:spid="_x0000_i1025" type="#_x0000_t75" style='width:363.75pt;
 height:91.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="07_Kafka.files/image216.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=485 height=122
src="07_Kafka.files/image216.png" v:shapes="图片_x0020_127"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>公司实际应用就是这样子，日志文件有了新的数据，就直接通过</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Flume</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>给到</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Kafka</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>，然后实时被消费者消费。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

</div>

</body>

</html>
