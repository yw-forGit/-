<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="Hive.files/filelist.xml">
<link rel=Edit-Time-Data href="Hive.files/editdata.mso">
<link rel=OLE-Object-Data href="Hive.files/oledata.mso">
<link rel=themeData href="Hive.files/themedata.thmx">
<link rel=colorSchemeMapping href="Hive.files/colorschememapping.xml">

<link href="./css/treemenu.css" rel="stylesheet" type="text/css">
<!-- GitHub Pages只认./js/xxx这种相对定位，不认js/xxx这种 -->
<script src="./js/jquery-3.4.1.min.js"></script>
<script src="./js/test.js"></script>
<script src="./js/treemenu.js"></script>
</head>

<body lang=ZH-CN link=blue vlink=purple style='tab-interval:21.0pt;text-justify-trim:
punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<div id="noScroll" class="divcss5-right">
	<ul id="menuId" class="tree">
	</ul>
	<div style="font-size: 10px; color: #161FB0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 （Ctrl+滚动鼠标可缩放页面）</div>
</div> 

<p class=MsoNormal align=center style='text-align:center;mso-line-height-alt:
11.0pt'><span lang=EN-US style='font-size:22.0pt'>Hive<o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right;mso-line-height-alt:
11.0pt'><span lang=EN-US style='font-size:12.0pt'>(</span><span
style='font-size:12.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>作者：尚硅谷大数据研发部</span><span lang=EN-US
style='font-size:12.0pt'>)<o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right;mso-line-height-alt:
11.0pt'><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>整理：小邹</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt'>[yw_forgit@163.com]</span><span
lang=EN-US style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;mso-line-height-alt:
11.0pt'><span lang=EN-US style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;mso-line-height-alt:
11.0pt'><span style='font-size:12.0pt;font-family:"微软雅黑","sans-serif";
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:微软雅黑;mso-font-kerning:0pt'>版本：</span><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:微软雅黑;mso-bidi-font-family:微软雅黑;
mso-font-kerning:0pt'>V1.3</span><span lang=EN-US style='font-size:12.0pt'><o:p></o:p></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>1</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'> Hive</span><span style='font-size:
15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>入门</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>1.1 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>什么是</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>Hive<o:p></o:p></span></h2>

<p class=MsoListParagraph style='mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：由</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Facebook</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>开源用于解决海量结构化日志的数据统计。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoListParagraph style='mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是基于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的一个<span
style='color:red'>数据仓库工具</span>，可以将<span style='color:red'>结构化的数据文件映射为一张表</span>，并提供<span
style='color:red'>类</span></span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>SQL</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>查询功能。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoListParagraph style='mso-char-indent-count:0;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>本质是：将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>HQL</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>转化成</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>MapReduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>程序</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'><o:p></o:p></span></p>

<p class=MsoListParagraph style='mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red;
mso-no-proof:yes'><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75"
 o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:400.8pt;
 height:225pt;mso-position-horizontal-relative:page;
 mso-position-vertical-relative:page' o:ole="">
 <img src="Hive.files/image001.png" o:title="" embosscolor="white"/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1025"
  DrawAspect="Content" ObjectID="_1629836124">
 </o:OLEObject>
</xml><![endif]--></span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:red'><span style='mso-tab-count:1'>      </span><o:p></o:p></span></p>

<p class=MsoListParagraph style='mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>处理的数据存储在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>HDFS<span
style='color:red'><o:p></o:p></span></span></p>

<p class=MsoListParagraph style='mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分析数据底层的实现是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>MapReduce<o:p></o:p></span></p>

<p class=MsoListParagraph style='mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>3</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）执行程序运行在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Yarn</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>上</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoListParagraph style='mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>就相当于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的客户端，安装也就只需要安装一个就够了，不涉及集群，但可以安装多个客户端。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>1.2 Hive</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的优缺点</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.2.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>优点</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:-21.0pt;mso-list:l6 level1 lfo16'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Times New Roman"'><span
style='mso-list:Ignore'>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>操作接口采用类</span><span
lang=EN-US>SQL</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>语法，提供快速开发的能力（简单、容易上手）。</span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:-21.0pt;mso-list:l6 level1 lfo16'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Times New Roman"'><span
style='mso-list:Ignore'>2)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>避免了去写</span><span
lang=EN-US>MapReduce</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，减少开发人员的学习成本。</span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:-21.0pt;mso-list:l6 level1 lfo16'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Times New Roman"'><span
style='mso-list:Ignore'>3)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的执行延迟比较高，因此</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>常用于数据分析，对实时性要求不高的场合。</span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:-21.0pt;mso-list:l6 level1 lfo16'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Times New Roman"'><span
style='mso-list:Ignore'>4)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>优势在于处理大数据，对于处理小数据没有优势，因为</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的执行延迟比较高。</span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:-21.0pt;mso-list:l6 level1 lfo16'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Times New Roman"'><span
style='mso-list:Ignore'>5)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>支持用户自定义函数，用户可以根据自己的需求来实现自己的函数。</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.2.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>缺点</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>的</span><span lang=EN-US>HQL</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>表达能力有限</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）迭代式算法无法表达（就是多个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>MR</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>串联，这也是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>MR</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>不擅长的）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）数据挖掘方面不擅长（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>主要是用分析的）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>的效率比较低</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>自动生成的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>MapReduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>作业，通常情况下不够智能化</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>调优比较困难，粒度较粗</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>1.3 Hive</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>架构原理</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoListParagraph align=center style='text-align:center;text-indent:
0cm;mso-char-indent-count:0;line-height:150%'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="_x0000_i1026" type="#_x0000_t75" style='width:300pt;
 height:279pt;mso-position-horizontal-relative:page;
 mso-position-vertical-relative:page' o:ole="">
 <img src="Hive.files/image002.png" o:title="" embosscolor="white"/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Visio.Drawing.15" ShapeID="_x0000_i1026"
  DrawAspect="Content" ObjectID="_1629836125">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoListParagraph align=center style='text-align:center;text-indent:
0cm;mso-char-indent-count:0;line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US>6-1 Hive</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>架构原理</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．用户接口：</span><span
lang=EN-US>Client</span></p>

<p class=MsoListParagraph style='mso-char-indent-count:0;line-height:150%'><span
lang=EN-US>CLI</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>hive shell</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）、</span><span lang=EN-US>JDBC/ODBC(java</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>访问</span><span lang=EN-US>hive)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span><span lang=EN-US>WEBUI</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（浏览器访问</span><span
lang=EN-US>hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．元数据：</span><span
lang=EN-US>Metastore</span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:0cm;mso-char-indent-count:
0;line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>元数据包括：表名、表所属的数据库（默认是</span><span
lang=EN-US>default</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）、表的拥有者、列</span><span
lang=EN-US>/</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分区字段、表的类型（是否是外部表）、表的数据所在目录等；</span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:0cm;mso-char-indent-count:
0;line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>默认存储在自带的</span><span
lang=EN-US style='color:red'>derby</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>数据库中，推荐使用</span><span lang=EN-US style='color:red'>MySQL</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>存储</span><span lang=EN-US style='color:red'>Metastore</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>。因为</span><span lang=EN-US style='color:red'>derby</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>只能但客户端访问，比如，无法开两个</span><span lang=EN-US
style='color:red'>hive shell</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>窗口进行访问，但使用</span><span
lang=EN-US style='color:red'>MySQL</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>就可以多客户端访问。</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Hadoop</span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:0cm;mso-char-indent-count:
0;line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>使用</span><span lang=EN-US>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进行存储，使用</span><span lang=EN-US>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进行计算。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．驱动器：</span><span
lang=EN-US>Driver</span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:0cm;mso-char-indent-count:
0;line-height:150%'><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>1</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）解析器（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>SQL Parser</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）：将</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>SQL</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>字符串转换成抽象语法树</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>AST</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，这一步一般都用第三方工具库完成，比如</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>antlr</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；对</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>AST</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>进行语法分析，比如表是否存在、字段是否存在、</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SQL</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>语义是否有误。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:0cm;mso-char-indent-count:
0;line-height:150%'><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>2</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）编译器（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>Physical Plan</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）：将</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>AST</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>编译生成逻辑执行计划。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:0cm;mso-char-indent-count:
0;line-height:150%'><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>3</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）优化器（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>Query Optimizer</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）：对逻辑执行计划进行优化。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoListParagraph style='text-indent:18.0pt;mso-char-indent-count:0;
line-height:150%'><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>4</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）执行器（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>Execution</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）：把逻辑执行计划转换成可以运行的物理计划。对于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>来说，就是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>MR/Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoListParagraph style='text-indent:18.0pt;mso-char-indent-count:0;
line-height:150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="_x0000_i1027"
 type="#_x0000_t75" style='width:358.2pt;height:201.6pt;
 mso-position-horizontal-relative:page;mso-position-vertical-relative:page'
 o:ole="">
 <img src="Hive.files/image003.png" o:title="" embosscolor="white"/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1027"
  DrawAspect="Content" ObjectID="_1629836126">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Hive</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>通过给用户提供的一系列交互接口，接收到用户的指令</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>(SQL)</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>，使用自己的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Driver</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>，结合元数据</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>(MetaStore)</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>，将这些指令翻译成</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>MapReduce</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>，提交到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Hadoop</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>中执行，最后，将执行返回的结果输出到用户交互接口。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt;tab-stops:247.8pt'><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>1.4
Hive</span><span style='font-size:14.0pt;line-height:172%;font-family:黑体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>和数据库比较</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>由于</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>&nbsp;Hive&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>采用了类似</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>SQL&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的查询语言</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>&nbsp;HQL(<a name="OLE_LINK1">Hive
Query Language</a>)</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>，因此很容易将</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>&nbsp;Hive&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>理解为数据库。其实从结构上来看，</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>Hive&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>和数据库除了拥有类似的查询语言，再无类似之处。本文将从多个方面来阐述</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>&nbsp;Hive&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>和数据库的差异。数据库可以用在</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>&nbsp;Online&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的应用中，但是</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>Hive&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>是为数据仓库而设计的，清楚这一点，有助于从应用角度理解</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>&nbsp;Hive&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的特性。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.4.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询语言</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>由于</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>SQL</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>被广泛的应用在数据仓库中，因此，专门针对</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的特性设计了类</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>SQL</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的查询语言</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>HQL</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>。熟悉</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>SQL</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>开发的开发者可以很方便的使用</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>进行开发。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.4.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据存储位置</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Hive&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>是建立在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>&nbsp;Hadoop&nbsp;</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>之上的，所有</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>&nbsp;Hive&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>的数据都是存储在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>&nbsp;HDFS&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>中的。而数据库则可以将数据保存在块设备或者本地文件系统中。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.4.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据更新</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>由于</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>是针对数据仓库应用设计的，而</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;background:white'>数据仓库的内容是读多写少的。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>因此，</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:red;background:white'>Hive</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;background:white'>中不建议对数据的改写（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red;
background:white'>Hadoop</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;background:white'>只能追加数据，改写的需要删除重写入），所有的数据都是在加载的时候确定好的。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>而数据库中的数据通常是需要经常进行修改的，因此可以使用</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>&nbsp;INSERT&nbsp;INTO&nbsp;…&nbsp;&nbsp;VALUES&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>添加数据，使用</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>&nbsp;UPDATE&nbsp;…&nbsp;SET</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>修改数据。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.4.4 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>索引</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Hive</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>在加载数据的过程中不会对数据进行任何处理，甚至不会对数据进行扫描，因此也<span
style='background:yellow;mso-highlight:yellow'>没有对数据中的某些</span></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:yellow;mso-highlight:yellow;mso-shading:white'>Key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:yellow;mso-highlight:yellow;mso-shading:white'>建立索引</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>要访问数据中满足条件的特定值时，需要</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;background:white'>暴力扫描整个数据</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>，因此访问延迟较高。由于</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>&nbsp;MapReduce&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的引入，</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>&nbsp;Hive&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>可以并行访问数据，因此即使没有索引，对于</span><span lang=EN-US><a
href="http://lib.csdn.net/base/hadoop" target="_blank" title=Hadoop知识库><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black;background:white;text-decoration:none;text-underline:none'><span
lang=EN-US>大数据</span></span></a></span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>量的访问，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Hive&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>仍然可以体现出优势。数据库中，通常会针对一个或者几个列建立索引，因此对于少量的特定条件的数据的访问，数据库可以有很高的效率，较低的延迟。由于数据的访问延迟较高，决定了</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>&nbsp;Hive&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>不适合在线数据查询。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.4.5 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>执行</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Hive</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>中大多数查询的执行是通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>&nbsp;Hadoop&nbsp;</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>提供的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>&nbsp;MapReduce&nbsp;</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>来实现的。而数据库通常有自己的执行引擎。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.4.6 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>执行延迟</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Hive&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>在查询数据的时候，由于没有索引，需要扫描整个表，因此延迟较高。另外一个导致</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>&nbsp;Hive&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>执行延迟高的因素是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>&nbsp;MapReduce</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>框架。由于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>MapReduce&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>本身具有较高的延迟，因此在利用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>MapReduce&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>执行</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Hive</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>查询时，也会有较高的延迟。相对的，数据库的执行延迟较低。当然，这个低是有条件的，即数据规模较小，当数据规模大到超过数据库的处理能力的时候，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Hive</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>的并行计算显然能体现出优势。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.4.7 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可扩展性</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>由于</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>是建立在</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>之上的，因此</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的可扩展性是和</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的可扩展性是一致的（世界上最大的</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>Hadoop&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>集群在</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>&nbsp;Yahoo!</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>，</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>2009</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>年的规模在</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>4000&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>台节点左右）。而数据库由于</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>&nbsp;ACID&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>语义的严格限制，扩展行非常有限。目前最先进的并行数据库</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>&nbsp;</span><span
lang=EN-US><a href="http://lib.csdn.net/base/oracle" target="_blank"
title=Oracle知识库><span style='mso-bidi-font-size:10.5pt;line-height:150%;
color:black;background:white;text-decoration:none;text-underline:none'>Oracle</span></a></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>&nbsp;</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>在理论上的扩展能力也只有</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>100</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>台左右。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.4.8 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据规模</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>由于</span><span lang=EN-US>Hive</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>建立在集群上并可以利用</span><span
lang=EN-US>MapReduce</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>进行并行计算，因此可以支持很大规模的数据；对应的，数据库可以支持的数据规模较小。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>2</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'> Hive</span><span style='font-size:
15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>安装</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>2.1 Hive</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>安装地址</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>官网地址</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><a
name="OLE_LINK10"></a><a name="OLE_LINK9"></a><a name="OLE_LINK8"><span
style='mso-bookmark:OLE_LINK9'><span style='mso-bookmark:OLE_LINK10'><span
lang=EN-US>http://hive.apache.org/</span></span></span></a></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>hive</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图标就说明</span><span
lang=EN-US>hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．文档查看地址</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>https://cwiki.apache.org/confluence/display/Hive/GettingStarted</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．下载地址</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>http://archive.apache.org/dist/hive/</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>github</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>地址</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>https://github.com/apache/hive</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>2.2 Hive</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>安装部署</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>安装及配置</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）把</span><span lang=EN-US>apache-hive-1.2.1-bin.tar.gz</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上传到</span><span lang=EN-US>linux</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span><span lang=EN-US>/opt/software</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>目录下</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）解压</span><span lang=EN-US>apache-hive-1.2.1-bin.tar.gz</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>到</span><span lang=EN-US>/opt/module/</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>目录下面</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 software]$
tar -zxvf apache-hive-1.2.1-bin.tar.gz -C /opt/module/</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）修改</span><span lang=EN-US>apache-hive-1.2.1-bin.tar.gz</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的名称为</span><span lang=EN-US>hive</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 module]$ mv
apache-hive-1.2.1-bin/ hive</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）修改</span><span lang=EN-US>/opt/module/hive/conf</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>目录下的</span><span lang=EN-US>hive-env.sh.template</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>名称为</span><span lang=EN-US>hive-env.sh</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 conf]$ mv
hive-env.sh.template hive-env.sh</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>5</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）配置</span><span lang=EN-US>hive-env.sh</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%;tab-stops:21.0pt 42.0pt 63.0pt 84.0pt 105.0pt 126.0pt 147.0pt 168.0pt 189.0pt'><span
lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>a</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）配置</span><span
lang=EN-US>HADOOP_HOME</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>路径</span></p>

<p class=a align=left style='margin-left:52.5pt;mso-para-margin-left:5.0gd;
text-align:left;text-indent:10.5pt;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>export HADOOP_HOME=/opt/module/hadoop-2.7.2</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>b</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）配置</span><span
lang=EN-US>HIVE_CONF_DIR</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>路径</span></p>

<p class=a align=left style='margin-left:52.5pt;mso-para-margin-left:5.0gd;
text-align:left;text-indent:10.5pt;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>export HIVE_CONF_DIR=/opt/module/hive/conf</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Hadoop</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>集群配置</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）必须启动</span><span lang=EN-US>hdfs</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><span lang=EN-US>yarn</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102
hadoop-2.7.2]$ sbin/start-dfs.sh</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop103
hadoop-2.7.2]$ sbin/start-yarn.sh </span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（</span><span
lang=EN-US>hive</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>会调用</span><span lang=EN-US>yarn</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US>HDFS</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>上创建</span><span
lang=EN-US>/tmp</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span><span lang=EN-US>/user/hive/warehouse</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>两个目录并修改他们的同组权限可写（不创建也行，会自动创建的，但权限问题可能会受限，公司中可能其他人访问不了，所以可以设置权限组）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102
hadoop-2.7.2]$ bin/hadoop fs -mkdir /tmp</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 hadoop-2.7.2]$
bin/hadoop fs -mkdir -p /user/hive/warehouse</span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102
hadoop-2.7.2]$ bin/hadoop fs -chmod g+w /tmp</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102
hadoop-2.7.2]$ bin/hadoop fs -chmod g+w /user/hive/warehouse</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>基本操作</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）启动</span><span lang=EN-US>hive</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 hive]$
bin/hive</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）查看数据库</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; show databases;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）打开默认数据库</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; use default;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）显示</span><span lang=EN-US>default</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据库中的表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; show tables;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）创建一张表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; create table
student(id int, name string);</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）显示数据库中有几张表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; show tables;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>7</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）查看表的结构</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; desc student;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>8</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）向表中插入数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; insert into student
values(1000,&quot;ss&quot;);</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>9</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）查询表中数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; select * from student;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>10</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）退出</span><span lang=EN-US>hive</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; quit;</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>2.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将本地文件导入</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>Hive</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span style='font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>需求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>将本地</span><span lang=EN-US>/opt/module/datas/student.txt</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>这个目录下的数据导入到</span><span lang=EN-US>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span><span lang=EN-US>student(id int, name string)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>表中。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．数据准备</span></p>

<p class=MsoNormal style='margin-left:18.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在</span><span lang=EN-US>/opt/module/datas</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>这个目录下准备数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US>/opt/module/</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>目录下创建</span><span lang=EN-US>datas</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 module]$
mkdir datas</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US>/opt/module/datas/</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>目录下创建</span><span lang=EN-US>student.txt</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件并添加数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 datas]$
touch student.txt</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 datas]$ vi
student.txt</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><a name="OLE_LINK3"></a><a name="OLE_LINK2"><span
style='mso-bookmark:OLE_LINK3'><span lang=EN-US>1001<span style='mso-tab-count:
1'>   </span>zhangshan</span></span></a></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK2'><span
style='mso-bookmark:OLE_LINK3'><span lang=EN-US>1002<span style='mso-tab-count:
1'>   </span>lishi</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK2'><span
style='mso-bookmark:OLE_LINK3'><span lang=EN-US>1003<span style='mso-tab-count:
1'>   </span>zhaoliu</span></span></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>注意以</span><span lang=EN-US>tab</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>键间隔。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>实际操作</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）启动</span><span lang=EN-US>hive</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 hive]$ bin/hive</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）显示数据库</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; show databases;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）使用</span><span lang=EN-US>default</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据库</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; use default;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）显示</span><span lang=EN-US>default</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据库中的表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; show tables;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）删除已创建的</span><span lang=EN-US>student</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; drop table student;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）创建</span><span lang=EN-US>student</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表</span><span lang=EN-US>, </span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>并声明文件分隔符</span><span
lang=EN-US>’\t’</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（不声明分隔符也能导入数据，但是可能数据都为</span><span
lang=EN-US>null</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，这是因为字段都没有对应上）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; create table
student(id int, name string) ROW FORMAT DELIMITED FIELDS TERMINATED</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>BY '\t';</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>7</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）加载</span><span lang=EN-US>/opt/module/datas/student.txt </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件到</span><span lang=EN-US>student</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据库表中。</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; load data local inpath
'/opt/module/datas/student.txt' into table student;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>8</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>Hive</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>查询结果</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; select * from student;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>OK</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>1001<span style='mso-tab-count:
1'>   </span>zhangshan</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>1002<span style='mso-tab-count:
1'>   </span>lishi</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>1003<span style='mso-tab-count:
1'>   </span>zhaoliu</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Time taken: 0.266 seconds,
Fetched: 3 row(s)</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．遇到的问题</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>再打开一个客户端窗口启动</span><span lang=EN-US>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，会产生</span><span lang=EN-US>java.sql.SQLException</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>异常。</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Exception in thread
&quot;main&quot; java.lang.RuntimeException: java.lang.RuntimeException:</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>Unable to instantiate</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:522)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:677)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:621)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
java.lang.reflect.Method.invoke(Method.java:606)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.util.RunJar.run(RunJar.java:221)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.util.RunJar.main(RunJar.java:136)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Caused by:
java.lang.RuntimeException: Unable to instantiate
org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1523)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.&lt;init&gt;(RetryingMetaStoreClient.java:86)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:132)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3005)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3024)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>        </span>at
org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:503)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>... 8 more</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>原因是，</span><span lang=EN-US style='color:red'>Metastore</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>默认存储在自带的</span><span lang=EN-US style='color:red'>derby</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>（只能单客户端访问）数据库中，推荐使用</span><span lang=EN-US
style='color:red'>MySQL</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>存储</span><span
lang=EN-US style='color:red'>Metastore;<o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>2.4 MySql</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>安装</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.4.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>安装包准备</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看</span><span
lang=EN-US>mysql</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>是否安装，如果安装了，卸载</span><span lang=EN-US>mysql</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查看</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>桌面</span><span lang=EN-US>]# rpm -qa|grep mysql</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql-libs-5.1.73-7.el6.x86_64</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）卸载</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>桌面</span><span lang=EN-US>]# rpm -e --nodeps mysql-libs-5.1.73-7.el6.x86_64</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．解压</span><span
lang=EN-US>mysql-libs.zip</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>文件到当前目录</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 software]#
unzip mysql-libs.zip</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 software]# ls</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql-libs.zip</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql-libs</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．进入到</span><span
lang=EN-US>mysql-libs</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>文件夹下</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 mysql-libs]# ll</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>总用量</span><span lang=EN-US>
76048</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-rw-r--r--. 1 root root
18509960 3</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>月</span><span lang=EN-US><span
style='mso-spacerun:yes'>  </span>26 2015 MySQL-client-5.6.24-1.el6.x86_64.rpm</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-rw-r--r--. 1 root root<span
style='mso-spacerun:yes'>  </span>3575135 12</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>月</span><span
lang=EN-US><span style='mso-spacerun:yes'>  </span>1 2013
mysql-connector-java-5.1.27.tar.gz</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-rw-r--r--. 1 root root
55782196 3</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>月</span><span lang=EN-US><span
style='mso-spacerun:yes'>  </span>26 2015 MySQL-server-5.6.24-1.el6.x86_64.rpm</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.4.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>安装</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>MySql</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>服务器</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．安装</span><span
lang=EN-US>mysql</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>服务端</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 mysql-libs]#
rpm -ivh MySQL-server-5.6.24-1.el6.x86_64.rpm</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看产生的随机密码</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 mysql-libs]#
cat /root/.mysql_secret</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>OEXaQuS8IWkG19Xs</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看</span><span
lang=EN-US>mysql</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>状态</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 mysql-libs]#
service mysql status</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．启动</span><span
lang=EN-US>mysql</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 mysql-libs]#
service mysql start</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.4.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>安装</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>MySql</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>客户端</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．安装</span><span
lang=EN-US>mysql</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>客户端</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 mysql-libs]#
rpm -ivh MySQL-client-5.6.24-1.el6.x86_64.rpm</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．链接</span><span
lang=EN-US>mysql</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 mysql-libs]#
mysql -uroot -pOEXaQuS8IWkG19Xs</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．修改密码</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;SET
PASSWORD=PASSWORD('000000');</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．退出</span><span
lang=EN-US>mysql</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;exit</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.4.4 MySql</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>user</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表中主机配置</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>配置只要是</span><span
lang=EN-US>root</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>用户</span><span lang=EN-US>+</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>密码，在任何主机上都能登录</span><span lang=EN-US>MySQL</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据库。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．进入</span><span
lang=EN-US>mysql</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop102 mysql-libs]#
mysql -uroot -p000000</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．显示数据库</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;show databases;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．使用</span><span
lang=EN-US>mysql</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>数据库</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;use mysql;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．展示</span><span
lang=EN-US>mysql</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>数据库中的所有表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;show tables;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．展示</span><span
lang=EN-US>user</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>表的结构</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;desc user;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>6</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查询</span><span
lang=EN-US>user</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;select User, Host, Password
from user;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>7</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．修改</span><span
lang=EN-US>user</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>表，把</span><span lang=EN-US>Host</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>表内容修改为</span><span
lang=EN-US>%</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;update user set
host='%' where host='localhost';</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>8</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．删除</span><span
lang=EN-US>root</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>用户的其他</span><span lang=EN-US>host</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;delete from user where
Host='hadoop102';</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;delete from user where
Host='127.0.0.1';</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;delete from user where
Host='::1';</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>9</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．刷新</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;flush privileges;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>10</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．退出</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mysql&gt;quit;</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>2.5 Hive</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>元数据配置到</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>MySql<o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.5.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>驱动拷贝</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．在</span><span
lang=EN-US>/opt/software/mysql-libs</span><span style='font-family:黑体;
mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>目录下解压</span><span
lang=EN-US>mysql-connector-java-5.1.27.tar.gz</span><span style='font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>驱动包</span></p>

<p class=a><span lang=EN-US>[root@hadoop102 mysql-libs]# tar -zxvf
mysql-connector-java-5.1.27.tar.gz</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．拷贝</span><span
lang=EN-US>/opt/software/mysql-libs/mysql-connector-java-5.1.27</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>目录下的</span><span
lang=EN-US>mysql-connector-java-5.1.27-bin.jar</span><span style='font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>到</span><span
lang=EN-US>/opt/module/hive/lib/</span></p>

<p class=a><span lang=EN-US>[root@hadoop102 mysql-connector-java-5.1.27]# cp
mysql-connector-java-5.1.27-bin.jar</span></p>

<p class=a><span lang=EN-US><span
style='mso-spacerun:yes'> </span>/opt/module/hive/lib/</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.5.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>配置</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Metastore</span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>到</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'>MySql<o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．在</span><span
lang=EN-US>/opt/module/hive/conf</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>目录下创建一个</span><span lang=EN-US>hive-site.xml</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 conf]$ touch
hive-site.xml</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 conf]$ vi
hive-site.xml</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．根据官方文档配置参数，拷贝数据到</span><span
lang=EN-US>hive-site.xml</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>文件中</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><a
name="OLE_LINK12"></a><a name="OLE_LINK11"><span style='mso-bookmark:OLE_LINK12'></span></a><a
href="https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin"><span
style='mso-bookmark:OLE_LINK11'><span style='mso-bookmark:OLE_LINK12'><span
lang=EN-US>https://cwiki.apache.org/confluence/display/Hive/AdminManual+MetastoreAdmin</span></span></span><span
style='mso-bookmark:OLE_LINK11'><span style='mso-bookmark:OLE_LINK12'></span></span></a><span
style='mso-bookmark:OLE_LINK12'></span><span style='mso-bookmark:OLE_LINK11'></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>&lt;?xml
version=&quot;1.0&quot;?&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>&lt;?xml-stylesheet
type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>&lt;configuration&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>&lt;property&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'> 
</span>&lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>    
</span>&lt;!-- </span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>数据库会自动创建</span><span lang=EN-US> --&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'> 
</span>&lt;value&gt;jdbc:mysql://hadoop102:3306/<span style='color:red'>metastore</span>?createDatabaseIfNotExist=true&lt;/value&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'>  </span>&lt;description&gt;JDBC
connect string for a JDBC metastore&lt;/description&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>&lt;/property&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>&lt;property&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'> 
</span>&lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'> 
</span>&lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'>  </span>&lt;description&gt;Driver
class name for a JDBC metastore&lt;/description&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>&lt;/property&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>&lt;property&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'> 
</span>&lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'> 
</span>&lt;value&gt;root&lt;/value&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'> 
</span>&lt;description&gt;username to use against metastore
database&lt;/description&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>&lt;/property&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>&lt;property&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'>  </span>&lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'> 
</span>&lt;value&gt;000000&lt;/value&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-spacerun:yes'> 
</span>&lt;description&gt;password to use against metastore
database&lt;/description&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>&lt;/property&gt;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>&lt;/configuration&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>默认是使用</span><span lang=EN-US>derby</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_1"
 o:spid="_x0000_i1221" type="#_x0000_t75" style='width:444.6pt;height:76.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image004.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．配置完毕后，如果启动</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>异常，可以重新启动虚拟机。（重启后，别忘了启动</span><span lang=EN-US>hadoop</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>集群）</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.5.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>多窗口启动</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Hive</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>测试</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><a name="_Toc439081681"></a><a
name="_Toc436149220"><span style='mso-bookmark:_Toc439081681'><span lang=EN-US>1</span></span></a><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．先启动</span><span
lang=EN-US>MySQL</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>[atguigu@hadoop102
mysql-libs]$ mysql -uroot -p000000</span></span></span></p>

<p class=MsoNormal style='text-indent:42.0pt;mso-char-indent-count:4.0;
line-height:16.5pt'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>查看有几个数据库</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>mysql&gt; show databases;</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>+--------------------+</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| Database<span
style='mso-spacerun:yes'>           </span>|</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>+--------------------+</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| information_schema |</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| mysql<span
style='mso-spacerun:yes'>             </span>|</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| performance_schema |</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| test<span
style='mso-spacerun:yes'>              </span><span
style='mso-spacerun:yes'> </span>|</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>+--------------------+</span></span></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span lang=EN-US>2</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．再次打开多个窗口，分别启动</span><span
lang=EN-US>hive</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>[atguigu@hadoop102 hive]$
bin/hive</span></span></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span lang=EN-US>3</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．启动</span><span
lang=EN-US>hive</span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>后，回到</span><span lang=EN-US>MySQL</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>窗口查看数据库，显示增加了</span><span
lang=EN-US>metastore</span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>数据库</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US><span style='mso-tab-count:
1'>  </span>mysql&gt; show databases;</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>+--------------------+</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| Database<span
style='mso-spacerun:yes'>           </span>|</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>+--------------------+</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| information_schema |</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| metastore<span
style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>     </span>|</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| mysql<span
style='mso-spacerun:yes'>             </span>|</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| performance_schema |</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| test<span
style='mso-spacerun:yes'>               </span>|</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>+--------------------+</span></span></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US style='font-size:14.0pt;
line-height:172%;font-family:"Times New Roman","serif"'>2.6 HiveJDBC</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>访问</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></span></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>2.6.1 </span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>启动</span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>hiveserver2</span></span></span><span style='mso-bookmark:
_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>服务</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></span></span></h3>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>[atguigu@hadoop102 hive]$ bin/hiveserver2
</span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>（不打印日志，阻塞着）</span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>2.6.2 </span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>启动</span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>beeline<o:p></o:p></span></span></span></h3>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>[atguigu@hadoop102 hive]$ bin/beeline
</span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>（打开新窗口执行）</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>Beeline version 1.2.1 by
Apache Hive</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>beeline&gt;</span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>2.6.3 </span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>连接</span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>hiveserver2<o:p></o:p></span></span></span></h3>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>beeline&gt; <span
style='color:red'>!connect jdbc:hive2://hadoop102:10000</span></span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>（回车）</span><span style='color:red'> </span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>（</span><span lang=EN-US style='color:red'>jdbc</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>连接</span><span lang=EN-US style='color:red'>hive</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>）</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>Connecting to
jdbc:hive2://hadoop102:10000</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>Enter username for
jdbc:hive2://hadoop102:10000: <span style='color:red'>atguigu</span></span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>（回车）</span><span style='color:red'> </span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>（</span><span lang=EN-US style='color:red'>hdfs</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>文件用什么用户就创建什么用户，</span><span lang=EN-US
style='color:red'>hdfs</span></span></span><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New";color:red'>是弱权限管理，主要名字一样就行不需要对密码校验）</span><span
lang=EN-US style='color:red'><o:p></o:p></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>Enter password for
jdbc:hive2://hadoop102:10000: </span></span></span><span style='mso-bookmark:
_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:red'>（直接回车）</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>Connected to: Apache Hive
(version 1.2.1)</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>Driver: Hive JDBC (version
1.2.1)</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>Transaction isolation:
TRANSACTION_REPEATABLE_READ</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>0:
jdbc:hive2://hadoop102:10000&gt; <span style='color:red'>show databases; </span></span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>（这种查询打印的格式很友好）</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>+----------------+--+</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| database_name<span
style='mso-spacerun:yes'>  </span>|</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>+----------------+--+</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| default<span
style='mso-spacerun:yes'>        </span>|</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>| hive_db2<span
style='mso-spacerun:yes'>       </span>|</span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US>+----------------+--+</span></span></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc436149220'><span
style='mso-bookmark:_Toc439081681'><span lang=EN-US style='font-size:14.0pt;
line-height:172%;font-family:"Times New Roman","serif"'>2.7 Hive</span></span></span><span
style='mso-bookmark:_Toc436149220'><span style='mso-bookmark:_Toc439081681'><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>常用交互</span></span></span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>命令</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 hive]$
  bin/hive -help</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>usage: hive</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>-d,--define &lt;key=value&gt;<span
  style='mso-spacerun:yes'>          </span>Variable subsitution to apply to
  hive</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>                                  </span>commands.
  e.g. -d A=B or --define A=B</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>--database &lt;databasename&gt;<span
  style='mso-spacerun:yes'>     </span>Specify the database to use</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>-e &lt;quoted-query-string&gt;<span
  style='mso-spacerun:yes'>         </span>SQL from command line</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>-f &lt;filename&gt;<span
  style='mso-spacerun:yes'>                    </span>SQL from files</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>-H,--help<span
  style='mso-spacerun:yes'>                        </span>Print help
  information</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>--hiveconf &lt;property=value&gt;<span
  style='mso-spacerun:yes'>   </span>Use value for given property</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>--hivevar &lt;key=value&gt;<span
  style='mso-spacerun:yes'>         </span>Variable subsitution to apply to
  hive</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>                                  </span>commands.
  e.g. --hivevar A=B</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>-i &lt;filename&gt;<span
  style='mso-spacerun:yes'>                    </span>Initialization SQL file</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>-S,--silent<span
  style='mso-spacerun:yes'>                      </span>Silent mode in
  interactive shell</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>-v,--verbose<span
  style='mso-spacerun:yes'>                     </span>Verbose mode (echo
  executed SQL to the console)</span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．“</span><span
lang=EN-US>-e</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>”不进入</span><span lang=EN-US>hive</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>的交互窗口执行</span><span
lang=EN-US>sql</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>语句</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 hive]$
bin/hive -e &quot;select id from student;&quot;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．“</span><span
lang=EN-US>-f</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>”执行脚本中</span><span lang=EN-US>sql</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>语句</span></p>

<p class=MsoListParagraph style='text-indent:0cm;mso-char-indent-count:0;
line-height:16.5pt'><span lang=EN-US style='font-family:"Calibri","sans-serif";
mso-bidi-font-family:"Times New Roman"'><span style='mso-tab-count:1'>         </span></span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>（</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'>1</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>）在</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'>/opt/module/datas</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>目录下创建</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'>hivef.sql</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>文件</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 datas]$
touch hivef.sql</span></p>

<p class=MsoListParagraph style='text-indent:0cm;mso-char-indent-count:0;
line-height:16.5pt'><span lang=EN-US style='mso-bidi-font-size:10.5pt'><span
style='mso-tab-count:2'>              </span></span><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件中写入正确的</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt'>sql</span><span style='mso-bidi-font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>语句</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>

<p class=MsoListParagraph style='text-indent:0cm;mso-char-indent-count:0;
line-height:16.5pt'><span lang=EN-US style='mso-bidi-font-size:10.5pt'><span
style='mso-tab-count:2'>              </span>select *from student;<o:p></o:p></span></p>

<p class=MsoListParagraph style='text-indent:0cm;mso-char-indent-count:0;
line-height:16.5pt'><span lang=EN-US style='font-family:"Calibri","sans-serif";
mso-bidi-font-family:"Times New Roman"'><span style='mso-tab-count:1'>         </span></span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>（</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'>2</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>）执行文件中的</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'>sql</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>语句</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 hive]$
bin/hive -f /opt/module/datas/hivef.sql</span></p>

<p class=MsoListParagraph style='line-height:16.5pt'><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>（</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'>3</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>）执行文件中的</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'>sql</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>语句并将结果写入文件中</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 hive]$
bin/hive -f /opt/module/datas/hivef.sql<span style='mso-spacerun:yes'> 
</span>&gt; /opt/module/datas/hive_result.txt</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>2.8 Hive</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>其他命令操作</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．退出</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>窗口：</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive(default)&gt;exit;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive(default)&gt;quit;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:16.5pt'><a
name="OLE_LINK23"></a><a name="OLE_LINK22"><span style='mso-bookmark:OLE_LINK23'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在新版的</span><span lang=EN-US>hive</span></span></a><span
style='mso-bookmark:OLE_LINK22'><span style='mso-bookmark:OLE_LINK23'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中没区别了，在以前的版本是有的：</span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:16.5pt'><span
lang=EN-US>exit:</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>先隐性提交数据，再退出；</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:16.5pt'><span
lang=EN-US>quit:</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>不提交数据，退出；</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．在</span><span
lang=EN-US>hive cli</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>命令窗口中如何查看</span><span lang=EN-US>hdfs</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>文件系统</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive(default)&gt;dfs -ls /;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．在</span><span
lang=EN-US>hive cli</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>命令窗口中如何查看本地文件系统</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive(default)&gt;! ls
/opt/module/datas;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看在</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>中输入的所有历史命令</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）进入到当前用户的根目录</span><span lang=EN-US>/root</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或</span><span lang=EN-US>/home/atguigu</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查看</span><span lang=EN-US>.
hivehistory</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>文件</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 ~]$ cat
.hivehistory</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>2.9 </span><span
lang=EN-US style='font-family:"Times New Roman","serif"'>Hive</span><span
style='font-family:黑体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>常见属性配置</span><span lang=EN-US style='font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.9.1 Hive</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据仓库位置配置</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span>1</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>Default</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据仓库的最原始位置是在</span><span
lang=EN-US>hdfs</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>上的：</span><span lang=EN-US>/user/hive/warehouse</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>路径下。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span>2</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）<span
style='color:red'>在仓库目录下，没有对默认的数据库</span></span><span lang=EN-US
style='color:red'>default</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>创建文件夹。如果某张表属于</span><span
lang=EN-US style='color:red'>default</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>数据库，直接在数据仓库目录下创建一个文件夹。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span>3</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）修改</span><span
lang=EN-US>default</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据仓库原始位置（将</span><span
lang=EN-US>hive-default.xml.template</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>如下配置信息拷贝到</span><span
lang=EN-US>hive-site.xml</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件中）。</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:.45pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:51.2pt'>
  <td width=708 valign=top style='width:424.5pt;border:none;padding:0cm 5.4pt 0cm 5.4pt;
  height:51.2pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>&lt;property&gt;</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>&lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>&lt;value&gt;/user/hive/warehouse&lt;/value&gt;</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>&lt;description&gt;location
  of default database for the warehouse&lt;/description&gt;</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>&lt;/property&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>配置同组用户有执行权限</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>bin/hdfs dfs -chmod g+w
/user/hive/warehouse</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.9.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询后信息显示配置</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）在</span><span lang=EN-US>hive-site.xml</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件中添加如下配置信息，就可以实现显示当前数据库，以及查询表的头信息配置。</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>&lt;property&gt;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>    </span>&lt;name&gt;hive.cli.print.header&lt;/name&gt;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>    </span>&lt;value&gt;true&lt;/value&gt;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>&lt;/property&gt;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>&lt;property&gt;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>    </span>&lt;name&gt;hive.cli.print.current.db&lt;/name&gt;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>    </span>&lt;value&gt;true&lt;/value&gt;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>&lt;/property&gt;</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span>2</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）重新启动</span><span
lang=EN-US>hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，对比配置前后差异。</span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）配置前，如图</span><span lang=EN-US>6-2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示</span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
line-height:150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_4"
 o:spid="_x0000_i1220" type="#_x0000_t75" style='width:292.8pt;height:73.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image005.png" o:title=""/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='margin-left:42.0pt;mso-para-margin-left:
4.0gd;text-align:center;line-height:150%'><span style='font-size:9.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri'>图</span><span lang=EN-US
style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'>6-2
</span><span style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>配置前</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）配置后，如图</span><span lang=EN-US>6-3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示</span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
line-height:150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_5"
 o:spid="_x0000_i1219" type="#_x0000_t75" style='width:311.4pt;height:75.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image006.png" o:title=""/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='margin-left:42.0pt;mso-para-margin-left:
4.0gd;text-align:center;line-height:150%'><span style='font-size:9.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri'>图</span><span lang=EN-US
style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'>6-3
</span><span style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>配置后</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>也可以临时设置</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>查询到默认是</span><span lang=EN-US>false</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_2"
 o:spid="_x0000_i1218" type="#_x0000_t75" style='width:566.4pt;height:20.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image007.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_3"
 o:spid="_x0000_i1217" type="#_x0000_t75" style='width:66.6pt;height:21pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image008.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>设置为</span><span lang=EN-US>true</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>之后</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_7"
 o:spid="_x0000_i1216" type="#_x0000_t75" style='width:367.2pt;height:37.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image009.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.9.3 Hive</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>运行日志信息配置</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>的</span><span lang=EN-US>log</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>默认存放在</span><span
lang=EN-US>/tmp/atguigu/hive.log</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>目录下（当前用户名下）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．修改</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>的</span><span lang=EN-US>log</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>存放日志到</span><span
lang=EN-US>/opt/module/hive/logs</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）修改</span><span lang=EN-US>/opt/module/hive/conf/hive-log4j.properties.template</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件名称为</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>hive-log4j.properties</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 conf]$ pwd</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>/opt/module/hive/conf</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 conf]$ mv
hive-log4j.properties.template hive-log4j.properties</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）在</span><span lang=EN-US>hive-log4j.properties</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件中修改</span><span lang=EN-US>log</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>存放位置</span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
line-height:150%'><span lang=EN-US>hive.log.dir=<span style='color:red'>/opt/module/hive/logs</span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>2.9.4 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>参数配置方式</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看当前所有的配置信息</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt;set;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．参数的配置三种方式</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）配置文件方式</span></p>

<p class=10 style='margin-left:21.0pt;mso-char-indent-count:0;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>默认配置文件：</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>hive-default.xml
<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>用户自定义配置文件：</span><span lang=EN-US>hive-site.xml</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>注意：<span style='color:red'>用户自定义配置会覆盖默认配置。</span>另外，</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>也会读入</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的配置，因为</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是作为</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的客户端启动的，</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的配置会覆盖</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的配置。配置文件的设定对本机启动的所有</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进程都有效。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）命令行参数方式</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>启动</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，可以在命令行添加</span><span lang=EN-US>-hiveconf
param=value</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>来设定参数。</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>例如：</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;line-height:
16.5pt;mso-layout-grid-align:none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop103
hive]$ bin/hive -hiveconf mapred.reduce.tasks=10;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>注意：仅对本次</span><span
lang=EN-US style='color:red'>hive</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>启动有效</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>查看参数设置：</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; set
mapred.reduce.tasks;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）参数声明方式</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>可以在</span><span
lang=EN-US>HQL</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中使用</span><span lang=EN-US>SET</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>关键字设定参数</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>例如：</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; set
mapred.reduce.tasks=100;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>注意：仅对本次</span><span
lang=EN-US style='color:red'>hive</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>启动有效。</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>查看参数设置</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; set
mapred.reduce.tasks;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上述三种设定方式的优先级依次递增。即配置文件</span><span lang=EN-US>&lt;</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>命令行参数</span><span lang=EN-US>&lt;</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>参数声明。注意某些系统级的参数，例如</span><span lang=EN-US>log4j</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>相关的设定，必须用前两种方式设定，因为那些参数的读取在会话建立以前已经完成了。</span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>3</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'> Hive</span><span style='font-size:
15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据类型</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.1 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>基本数据类型</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>6-1<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=191 valign=top style='width:114.35pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Hive</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>数据类型</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Java</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>数据类型</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>长度</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>例子</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>TINYINT<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>byte<o:p></o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>1byte</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>有符号整数</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>20<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>SMALINT<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>short<o:p></o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>2byte</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>有符号整数</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>20<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='color:red;mso-ansi-language:ZH-CN'>INT<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>int<o:p></o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>4byte</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>有符号整数</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>20<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='color:red;mso-ansi-language:ZH-CN'>BIGINT<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>long<o:p></o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>8byte</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>有符号整数</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>20<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>BOOLEAN<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>boolean<o:p></o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>布尔类型，</span><span
  style='mso-ansi-language:ZH-CN'>true</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>或者</span><span style='mso-ansi-language:ZH-CN'>false<o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>TRUE<span
  style='mso-spacerun:yes'>  </span>FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>FLOAT<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>float<o:p></o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>单精度浮点数</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>3.14159<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='color:red;mso-ansi-language:ZH-CN'>DOUBLE<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>double<o:p></o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>双精度浮点数</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>3.14159<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='color:red;mso-ansi-language:ZH-CN'>STRING<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>string<o:p></o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>字符系列。可以指定字符集。可以使用单引号或者双引号。</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>‘</span><span lang=EN-US>now is the time</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>’</span> <span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>“</span><span lang=EN-US>for all good men</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>”</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>TIMESTAMP<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>时间类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10;mso-yfti-lastrow:yes'>
  <td width=191 valign=top style='width:114.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>BINARY<o:p></o:p></span></p>
  </td>
  <td width=163 valign=top style='width:97.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=176 valign=top style='width:105.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>字节数组</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=172 valign=top style='width:102.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
mso-pagination:widow-orphan'><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>对于</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>Hive</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>的</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>String</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>类型相当于数据库的</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>varchar</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>类型，该类型是一个可变的字符串，不过它不能声明其中最多能存储多少个字符，理论上它可以存储</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>2GB</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>的字符数。</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.2 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>集合数据类型</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>6-2<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=130 valign=top style='width:78.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=334 valign=top style='width:200.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>描述</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=221 valign=top style='width:132.45pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>语法示例</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=130 valign=top style='width:78.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>STRUCT<o:p></o:p></span></p>
  </td>
  <td width=334 valign=top style='width:200.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>和</span><span
  style='mso-ansi-language:ZH-CN'>c</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>语言中的</span><span style='mso-ansi-language:ZH-CN'>struct</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>类似，都可以通过“点”符号访问元素内容。例如，如果某个列的数据类型是</span><span
  style='mso-ansi-language:ZH-CN'>STRUCT{first STRING, last STRING},</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>那么第</span><span style='mso-ansi-language:
  ZH-CN'>1</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>个元素可以通过字段</span><span
  style='mso-ansi-language:ZH-CN'>.first</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>来引用。</span><span style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>struct()<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=130 valign=top style='width:78.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>MAP<o:p></o:p></span></p>
  </td>
  <td width=334 valign=top style='width:200.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>MAP</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>是一组键</span><span style='mso-ansi-language:
  ZH-CN'>-</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>值对元组集合，使用数组表示法可以访问数据。例如，如果某个列的数据类型是</span><span
  style='mso-ansi-language:ZH-CN'>MAP</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，其中键</span><span style='mso-ansi-language:ZH-CN'>-&gt;</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>值对是’</span><span style='mso-ansi-language:
  ZH-CN'>first</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>’</span><span
  style='mso-ansi-language:ZH-CN'>-&gt;</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>’</span><span style='mso-ansi-language:ZH-CN'>John</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>’和’</span><span style='mso-ansi-language:
  ZH-CN'>last</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>’</span><span
  style='mso-ansi-language:ZH-CN'>-&gt;</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>’</span><span style='mso-ansi-language:ZH-CN'>Doe</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>’，那么可以通过字段名</span><span style='mso-ansi-language:
  ZH-CN'>[</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>‘</span><span
  style='mso-ansi-language:ZH-CN'>last</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>’</span><span style='mso-ansi-language:ZH-CN'>]</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>获取最后一个元素</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>map()<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=130 valign=top style='width:78.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>ARRAY<o:p></o:p></span></p>
  </td>
  <td width=334 valign=top style='width:200.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>数组是一组具有相同类型和名称的变量的集合。这些变量称为数组的元素，每个数组元素都有一个编号，编号从零开始。例如，数组值为</span><span
  style='mso-ansi-language:ZH-CN'>[</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>‘</span><span style='mso-ansi-language:ZH-CN'>John</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>’</span><span style='mso-ansi-language:ZH-CN'>,
  </span><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>‘</span><span style='mso-ansi-language:ZH-CN'>Doe</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>’</span><span style='mso-ansi-language:ZH-CN'>]</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>，那么第</span><span style='mso-ansi-language:
  ZH-CN'>2</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>个元素可以通过数组名</span><span
  style='mso-ansi-language:ZH-CN'>[1]</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>进行引用。</span><span style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Array()<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
mso-pagination:widow-orphan'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>Hive</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>有三种复杂数据类型</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>ARRAY</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>、</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>MAP </span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>和</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'> STRUCT</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>。</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>ARRAY</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>和</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>MAP</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>与</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>Java</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>中的</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>Array</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>和</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>Map</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>类似，而</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>STRUCT</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>与</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>C</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>语言中的</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>Struct</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>类似，它封装了一个命名字段集合，复杂数据类型允许任意层次的嵌套。</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span style='font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>案例实操</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:39.0pt;
margin-bottom:.0001pt;text-indent:-18.0pt;line-height:150%;mso-pagination:widow-orphan;
mso-list:l13 level1 lfo7'><![if !supportLists]><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:1.0pt'><span style='mso-list:Ignore'>1）<span
style='font:7.0pt "Times New Roman"'> </span></span></span><![endif]><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>假设某表有如下一行，我们用</span><span lang=EN-US style='font-size:
10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>JSON</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>格式来表示其数据结构。在</span><span lang=EN-US style='font-size:
10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>Hive</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>下访问的格式为</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>{</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>&quot;name&quot;:
  &quot;songsong&quot;,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>&quot;friends&quot;:
  [&quot;bingbing&quot; , &quot;lili&quot;] ,<span
  style='mso-spacerun:yes'>       </span>//</span><span style='font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>列表</span><span
  lang=EN-US>Array, </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>&quot;children&quot;:
  {<span style='mso-spacerun:yes'>                      </span>//</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>键值</span><span lang=EN-US>Map,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>        </span>&quot;xiao
  song&quot;: 18 ,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>        </span>&quot;xiaoxiao
  song&quot;: 19</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>}</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>&quot;address&quot;:
  {<span style='mso-spacerun:yes'>             </span><span
  style='mso-spacerun:yes'>         </span>//</span><span style='font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>结构</span><span
  lang=EN-US>Struct,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>        </span>&quot;street&quot;:
  &quot;hui long guan&quot; ,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>        </span>&quot;city&quot;:
  &quot;beijing&quot; </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>}</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>}</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
  9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
mso-pagination:widow-orphan'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>2</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>）基于上述数据结构，我们在</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'>Hive</span><span style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>里创建对应的表，并导入数据。</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'> <o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;mso-pagination:widow-orphan'><span style='font-size:
10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>创建本地测试文件</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'>test.txt<o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>songsong,bingbing_lili,xiao song:18_xiaoxiao song:19,hui long
  guan_beijing</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>yangyang,caicai_susu,xiao yang:18_xiaoxiao yang:19,chao
  yang_beijing</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
  9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:42.0pt;mso-char-indent-count:
4.0;line-height:16.5pt;mso-pagination:widow-orphan'><span style='font-size:
10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:1.0pt'>注意</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>：</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'>MAP</span><span style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>，</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'>STRUCT</span><span style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-font-kerning:1.0pt'>和</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>ARRAY</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>里的元素间关系都可以用同一个字符表示，这里用</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>“_”</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>。</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;mso-pagination:widow-orphan'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>3</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>）</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'>Hive</span><span style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>上创建测试表</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'>test<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>create table test(</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>name string,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>friends array&lt;string&gt;,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>children map&lt;string, int&gt;,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>address struct&lt;street:string, city:string&gt;</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>)</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>row format delimited fields terminated by ','</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>collection items terminated by '_'</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>map keys terminated by ':'</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>lines terminated by '\n';</span><span lang=EN-US style='font-size:
  10.5pt;mso-bidi-font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:21.0pt;
margin-bottom:.0001pt;mso-para-margin-top:0cm;mso-para-margin-right:0cm;
mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;line-height:16.5pt;mso-pagination:widow-orphan'><span style='font-size:
10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>字段解释：</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'><o:p></o:p></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:21.0pt;
margin-bottom:.0001pt;mso-para-margin-top:0cm;mso-para-margin-right:0cm;
mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;line-height:16.5pt;mso-pagination:widow-orphan'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>row
format delimited fields terminated by ','<span style='mso-spacerun:yes'> 
</span>-- </span><span style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-font-kerning:1.0pt'>列分隔符</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:21.0pt;
margin-bottom:.0001pt;mso-para-margin-top:0cm;mso-para-margin-right:0cm;
mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;line-height:16.5pt;mso-pagination:widow-orphan'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>collection
items terminated by '_'<span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>   </span>--MAP STRUCT </span><span style='font-size:
10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>和</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'> ARRAY </span><span style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-font-kerning:1.0pt'>的分隔符</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>(</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>数据分割符号</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'>)<o:p></o:p></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:21.0pt;
margin-bottom:.0001pt;mso-para-margin-top:0cm;mso-para-margin-right:0cm;
mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;line-height:16.5pt;mso-pagination:widow-orphan'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>map
keys terminated by ':'<span style='mso-tab-count:4'>                        </span>--
MAP</span><span style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>中的</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>key</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>与</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'>value</span><span style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>的分隔符</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'><o:p></o:p></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:21.0pt;
margin-bottom:.0001pt;mso-para-margin-top:0cm;mso-para-margin-right:0cm;
mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;line-height:16.5pt;mso-pagination:widow-orphan'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>lines
terminated by '\n';<span style='mso-tab-count:5'>                                   </span>--
</span><span style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>行分隔符（默认一行也是</span><span lang=EN-US style='font-size:
10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>\n</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>分隔）</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;mso-pagination:widow-orphan'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>4</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>）导入文本数据到测试表</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>load</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>上去跟</span><span lang=EN-US>hadoop fs -put</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上去是一样的）</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive (default)&gt; load data local inpath ‘/opt/module/datas/test.txt’into
table test<span style='mso-spacerun:yes'>  </span></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;mso-pagination:widow-orphan'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>5</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>）访问三种集合列里的数据，以下分别是</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>ARRAY</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>，</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'>MAP</span><span style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>，</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'>STRUCT</span><span style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-font-kerning:1.0pt'>的访问方式</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>hive (default)&gt; select friends[1],children['xiao
  song'],address.city from test</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>where name=&quot;songsong&quot;;</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>OK</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>_c0<span style='mso-spacerun:yes'>     </span>_c1<span
  style='mso-spacerun:yes'>     </span>city</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>lili<span style='mso-spacerun:yes'>    </span>18<span
  style='mso-spacerun:yes'>      </span>beijing</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US>Time taken: 0.076 seconds, Fetched: 1 row(s)</span><span
  lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类型转化</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
mso-pagination:widow-orphan'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>Hive</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>的原子数据类型是可以进行隐式转换的，类似于</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:
1.0pt'>Java</span><span style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>的类型转换，例如某表达式使用</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>INT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>类型，</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>TINYINT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>会自动转换为</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>INT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>类型，但是</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>Hive</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>不会进行反向转化，例如，某表达式使用</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>TINYINT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>类型，</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>INT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>不会自动转换为</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>TINYINT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>类型，它会返回错误，除非使用</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>CAST</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>操作。</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．隐式类型转换规则如下</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:1.0cm;line-height:150%;
mso-pagination:widow-orphan'><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>（</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>1</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>）任何整数类型都可以隐式地转换为一个范围更广的类型，如</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>TINYINT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>可以转换成</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>INT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>，</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>INT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>可以转换成</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>BIGINT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>。</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:1.0cm;line-height:150%;
mso-pagination:widow-orphan'><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>（</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>2</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>）所有整数类型、</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>FLOAT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>和</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>STRING</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>类型都可以隐式地转换成</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>DOUBLE</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>。</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:1.0cm;line-height:150%;
mso-pagination:widow-orphan'><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>（</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>3</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>）</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>TINYINT</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>、</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>SMALLINT</span><span style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>、</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;mso-font-kerning:1.0pt'>INT</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>都可以转换为</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>FLOAT</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>。</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:1.0cm;line-height:150%;
mso-pagination:widow-orphan'><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>（</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>4</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>）</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>BOOLEAN</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>类型不可以转换为任何其它的类型。</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．可以使用</span><span
lang=EN-US>CAST</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>操作显示进行数据类型转换</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
mso-pagination:widow-orphan'><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>例如</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>CAST('1' AS INT)</span><span style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>将把字符串</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;mso-font-kerning:1.0pt'>'1' </span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>转换成整数</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:1.0pt'>1</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>；如果强制类型转换失败，如执行</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:
1.0pt'>CAST('X' AS INT)</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>，表达式返回空值</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'> NULL</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>。</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>4</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'> DDL</span><span style='font-size:
15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据定义</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.1 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建数据库</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;mso-pagination:
widow-orphan'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
mso-font-kerning:1.0pt'>1</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-font-kerning:1.0pt'>）创建一个数据库，数据库在</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'>HDFS</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>上的默认存储路径是</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'>/user/hive/warehouse/*.db</span><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>。</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0'>

<p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;mso-padding-alt:
1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>hive (default)&gt; create database
db_hive;</span></p>

</div>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;mso-pagination:
widow-orphan'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
mso-font-kerning:1.0pt'>2</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-font-kerning:1.0pt'>）避免要创建的数据库已经存在错误，增加</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'>if not exists</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-font-kerning:1.0pt'>判断。（标准写法，写脚本用这种写法）</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:.45pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=693 valign=top style='width:416.05pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0'>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>hive (default)&gt;
  create database db_hive;</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>FAILED: Execution
  Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. Database
  db_hive already exists</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>hive (default)&gt;
  create database if not exists db_hive;<span style='color:#7030A0'><o:p></o:p></span></span></p>
  </div>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;mso-pagination:
widow-orphan'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
mso-font-kerning:1.0pt'>3</span><span style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-font-kerning:1.0pt'>）创建一个数据库，指定数据库在</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:
1.0pt'>HDFS</span><span style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-font-kerning:1.0pt'>上存放的位置</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0'>

<p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;mso-padding-alt:
1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>hive (default)&gt; create database
db_hive2 location '/db_hive2.db'; </span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（不指定名字则数据库没有目录，创建的表就会在新建数据库时候指定的目录）</span></p>

</div>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_6" o:spid="_x0000_i1215"
 type="#_x0000_t75" style='width:460.8pt;height:64.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image010.png" o:title="" cropright="2904f"/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'>6-4
</span><span style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>数据库存放位置</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.2 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>查询数据库</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.2.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>显示数据库</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．显示数据库</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt; show databases;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．过滤显示查询的数据库</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt; show databases like 'db_hive*';</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>OK</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>db_hive</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>db_hive_1</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.2.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查看数据库详情</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．显示数据库信息</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt; desc database db_hive;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>OK</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>db_hive<span style='mso-tab-count:2'>     </span>hdfs://hadoop102:9000/user/hive/warehouse/db_hive.db<span
style='mso-tab-count:1'> </span>atguiguUSER</span><span lang=EN-US
style='font-family:"Times New Roman","serif";mso-bidi-font-family:Arial;
color:black'><span style='mso-tab-count:1'>      </span><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．显示数据库详细信息，</span><span
lang=EN-US>extended</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt; desc database extended db_hive;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>OK</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>db_hive<span style='mso-tab-count:2'>     </span>hdfs://hadoop102:9000/user/hive/warehouse/db_hive.db<span
style='mso-tab-count:1'> </span>atguiguUSER<span style='mso-tab-count:1'>  </span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>40.3.3 </span><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>切换当前数据库</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive (default)&gt; use db_hive;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.3.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>切换当前数据库</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive (default)&gt; use db_hive;</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>修改数据库</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>用户可以使用</span><span lang=EN-US>ALTER DATABASE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>命令为某个数据库的</span><span lang=EN-US>DBPROPERTIES</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>设置键</span><span lang=EN-US>-</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>值对属性值，来描述这个数据库的属性信息。<span
style='color:red'>数据库的其他元数据信息都是不可更改的，包括数据库名和数据库所在的目录位置。</span></span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive (default)&gt; alter database db_hive set dbproperties('createtime'='20170830');</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>在</span><span lang=EN-US style='color:black'>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>中查看修改结果</span><span lang=EN-US style='color:
black'><o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt; desc database extended db_hive;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>db_name comment location<span style='mso-spacerun:yes'>       
</span>owner_name<span style='mso-spacerun:yes'>      </span>owner_type<span
style='mso-spacerun:yes'>      </span>parameters</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>db_hive<span style='mso-spacerun:yes'>        
</span>hdfs://hadoop102:8020/user/hive/warehouse/db_hive.db<span
style='mso-spacerun:yes'>    </span>atguigu USER<span
style='mso-spacerun:yes'>    </span>{createtime=20170830}</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.4 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>删除数据库</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．删除空数据库</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt;drop database db_hive2;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．如果删除的数据库不存在，最好采用</span><span
lang=EN-US> if exists</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>判断数据库是否存在</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt; drop database db_hive;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>FAILED: SemanticException [Error 10072]: Database does not exist:
db_hive</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt; drop database if exists db_hive2;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．如果数据库不为空，可以采用</span><span
lang=EN-US>cascade</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>（级联）命令，强制删除</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt; drop database db_hive;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>FAILED: Execution Error, return code 1 from
org.apache.hadoop.hive.ql.exec.DDLTask.
InvalidOperationException(message:Database db_hive is not empty. One or more
tables exist.)</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive&gt; drop database db_hive cascade;</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.5 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建表</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．建表语法</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US style='color:red'>CREATE [EXTERNAL] TABLE [IF NOT EXISTS] table_name
<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US style='color:red'>[(col_name data_type [COMMENT col_comment], ...)] <o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>[COMMENT table_comment] </span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>[PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)] </span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>[CLUSTERED BY (col_name, col_name, ...) </span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>[SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS] </span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US style='color:red'>[ROW FORMAT row_format] <o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>[STORED AS file_format] </span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>[LOCATION hdfs_path]</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>也就是说</span><span lang=EN-US>PARTITIONED
BY</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分区的字段不能跟已有的字段（紫色框）重复。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_8"
 o:spid="_x0000_i1214" type="#_x0000_t75" style='width:567pt;height:102.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image011.png" o:title=""/>
</v:shape></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．字段解释说明</span>
</p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>1</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>CREATE TABLE </span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建一个指定名字的表。如果相同名字的表已经存在，则抛出异常；用户可以用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> IF NOT EXISTS </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>选项来忽略这个异常。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>2</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>EXTERNAL</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>关键字可以让用户创建一个外部表，在建表的同时指定一个指向实际数据的路径（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>LOCATION</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>），</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>创建内部表时，会将数据移动到数据仓库指向的路径；若创建外部表，仅记录数据所在的路径，不对数据的位置做任何改变</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。在删除表的时候，内部表的元数据和数据会被一起删除，而外部表只删除元数据，不删除数据。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=10 style='mso-char-indent-count:0;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>COMMENT</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：为表和列添加注释。</span><span lang=EN-US style='font-family:"Times New Roman","serif"'><o:p></o:p></span></p>

<p class=10 style='mso-char-indent-count:0;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>PARTITIONED
BY</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建分区表</span><span lang=EN-US
style='font-family:"Times New Roman","serif"'><o:p></o:p></span></p>

<p class=10 style='mso-char-indent-count:0;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>CLUSTERED
BY</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建分桶表</span><span lang=EN-US
style='font-family:"Times New Roman","serif"'><o:p></o:p></span></p>

<p class=10 style='mso-char-indent-count:0;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>SORTED
BY</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>不常用</span><span lang=EN-US
style='font-family:"Times New Roman","serif"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>7</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>ROW FORMAT </span></p>

<p class=MsoNormal style='margin-left:39.0pt;line-height:150%'><span
lang=EN-US>DELIMITED [FIELDS TERMINATED BY char</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（字段）</span><span
lang=EN-US>] [COLLECTION ITEMS TERMINATED BY char</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（数组</span><span
lang=EN-US> struct</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>]</span></p>

<p class=MsoNormal style='margin-left:39.0pt;line-height:150%'><span
lang=EN-US><span style='mso-spacerun:yes'>        </span>[MAP KEYS TERMINATED
BY char</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>] [LINES TERMINATED BY char</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（一行）</span><span lang=EN-US>] </span></p>

<p class=MsoNormal style='margin-left:39.0pt;line-height:150%'><span
lang=EN-US><span style='mso-spacerun:yes'>   </span>| SERDE serde_name [WITH
SERDEPROPERTIES (property_name=property_value, property_name=property_value,
...)]</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><a
name="OLE_LINK25"></a><a name="OLE_LINK24"><span style='mso-bookmark:OLE_LINK25'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用户在建表的时候可以自定义</span></span></a><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SerDe</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>或者使用自带的</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SerDe</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。如果没有指定</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>ROW FORMAT </span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>或者</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>ROW FORMAT
DELIMITED</span></span></span><span style='mso-bookmark:OLE_LINK24'><span
style='mso-bookmark:OLE_LINK25'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，将会使用自带的</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SerDe</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。在建表的时候，用户还需要为表指定列，用户在指定表的列的同时也会指定自定义的</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SerDe</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hive</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>通过</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SerDe</span></span></span><span
style='mso-bookmark:OLE_LINK24'><span style='mso-bookmark:OLE_LINK25'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>确定表的具体的列的数据。</span></span></span><span
style='mso-bookmark:OLE_LINK25'></span><span style='mso-bookmark:OLE_LINK24'></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SerDe</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Serialize/Deserilize</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的简称，目的是用于序列化和反序列化。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>8</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>STORED AS</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>指定存储文件类型</span></p>

<p class=MsoNormal style='margin-left:39.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>常用的存储文件类型：</span><span lang=EN-US>SEQUENCEFILE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（二进制序列文件）、</span><span lang=EN-US>TEXTFILE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（文本）、</span><span lang=EN-US>RCFILE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（列式存储格式文件）</span></p>

<p class=MsoNormal style='margin-left:39.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如果文件数据是纯文本，可以使用</span><span lang=EN-US>STORED AS TEXTFILE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。如果数据需要压缩，使用</span><span lang=EN-US> STORED AS SEQUENCEFILE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>（</span><span lang=EN-US style='color:red'>9</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>）</span><span lang=EN-US style='color:red'>LOCATION
</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>：指定表在</span><span
lang=EN-US style='color:red'>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>上的存储位置。</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>10</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>LIKE</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>允许用户复制现有的表结构，但是不复制数据。</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.5.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>管理表</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．理论</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>默认创建的表都是所谓的管理表，有时也被称为内部表。因为这种表，</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>会（或多或少地）控制着数据的生命周期。</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>默认情况下会将这些表的数据存储在由配置项</span><span lang=EN-US>hive.metastore.warehouse.dir(</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>例如，</span><span lang=EN-US>/user/hive/warehouse)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所定义的目录的子目录下。</span><span lang=EN-US style='color:red'><span
style='mso-tab-count:1'>      </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>当我们删除一个管理表时，</span><span lang=EN-US style='color:red'>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>也会删除这个表中数据（元数据</span><span style='color:red'> </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>原数据都删除）。</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>管理表不适合和其他工具共享数据。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）普通创建表</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0'>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>create table if not
  exists student2(</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>id int, name string</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>)</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>row format
  delimited fields terminated by '\t'</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>stored as textfile</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>location
  '/user/hive/warehouse/student2';</span></p>
  </div>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）根据查询结果创建表（查询的结果会添加到新创建的表中）</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>create table if not exists student3 as select id,
  name from student;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）根据已经存在的表结构创建表</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0'>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>create table if not
  exists student4 like student; </span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>（</span><span lang=EN-US>like</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>是只复制表结构，并没有数据）</span><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </div>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询表的类型</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; desc
formatted student2;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Table Type:<span
style='mso-spacerun:yes'>             </span>MANAGED_TABLE </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（表类型是管理表）</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这</span><span lang=EN-US>test</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示内部表，然后删除他</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_11"
 o:spid="_x0000_i1213" type="#_x0000_t75" style='width:289.8pt;height:46.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image012.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这是之前没删除的数据</span><span lang=EN-US>test</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>目录</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_12"
 o:spid="_x0000_i1212" type="#_x0000_t75" style='width:567pt;height:106.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image013.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>刷新就没有了</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_18"
 o:spid="_x0000_i1211" type="#_x0000_t75" style='width:567pt;height:115.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image014.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.5.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>外部表</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．理论</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>因为表是外部表，所以</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>并非认为其完全拥有这份数据。<span style='color:red'>删除该表并不会删除掉这份数据，不过描述表的元数据信息会被删除掉。</span></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．管理表和外部表的使用场景</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:22.5pt;line-height:150%'><span
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:1.0pt'>每天将收集到的网站日志定期流入</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;mso-font-kerning:
1.0pt'>HDFS</span><span style='font-size:10.5pt;mso-bidi-font-size:11.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-font-kerning:1.0pt'>文本文件。在外部表（原始日志表）的基础上做大量的统计分析，用到的中间表、结果表使用内部表存储，数据通过</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:11.0pt;line-height:150%;
mso-font-kerning:1.0pt'>SELECT+INSERT</span><span style='font-size:10.5pt;
mso-bidi-font-size:11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>进入内部表。</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
11.0pt;line-height:150%;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分别创建部门和员工外部表，并向表中导入数据。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）原始数据（在本地这目录</span><span
lang=EN-US>/opt/module/datas/</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建这俩文件）</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>              </span><a
name="OLE_LINK5"></a><a name="OLE_LINK4"><span style='mso-bookmark:OLE_LINK5'><span
style='mso-no-proof:yes'><v:shape id="_x0000_i1028" type="#_x0000_t75" style='width:31.2pt;
 height:31.2pt' o:ole="">
 <img src="Hive.files/image015.png" o:title="" embosscolor="white"/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1028"
  DrawAspect="Content" ObjectID="_1629836127">
 </o:OLEObject>
</xml><![endif]--></span></span></a><span style='mso-spacerun:yes'>   </span><span
style='mso-no-proof:yes'><v:shape id="_x0000_i1029" type="#_x0000_t75" style='width:30.6pt;
 height:31.2pt' o:ole="">
 <img src="Hive.files/image016.png" o:title="" embosscolor="white"/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1029"
  DrawAspect="Content" ObjectID="_1629836128">
 </o:OLEObject>
</xml><![endif]--></span><span style='mso-spacerun:yes'>  </span></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_19"
 o:spid="_x0000_i1210" type="#_x0000_t75" style='width:180.6pt;height:81pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image017.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_22"
 o:spid="_x0000_i1209" type="#_x0000_t75" style='width:382.2pt;height:180.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image018.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）建表语句</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:2'>              </span></span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建部门表</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:30.05pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=644 valign=top style='width:386.45pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>create external table if not exists default.dept(</span></p>
  <p class=a><span lang=EN-US>deptno int,</span></p>
  <p class=a><span lang=EN-US>dname string,</span></p>
  <p class=a><span lang=EN-US>loc int</span></p>
  <p class=a><span lang=EN-US>)</span></p>
  <p class=a><span lang=EN-US>row format delimited fields terminated by '\t';</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:2'>              </span></span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建员工表</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:30.8pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=643 valign=top style='width:385.7pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><a name="OLE_LINK7"></a><a name="OLE_LINK6"><span
  style='mso-bookmark:OLE_LINK7'><span lang=EN-US>create external table if not
  exists default.emp(</span></span></a></p>
  <p class=a><span style='mso-bookmark:OLE_LINK6'><span style='mso-bookmark:
  OLE_LINK7'><span lang=EN-US>empno int,</span></span></span></p>
  <p class=a><span style='mso-bookmark:OLE_LINK6'><span style='mso-bookmark:
  OLE_LINK7'><span lang=EN-US>ename string,</span></span></span></p>
  <p class=a><span style='mso-bookmark:OLE_LINK6'><span style='mso-bookmark:
  OLE_LINK7'><span lang=EN-US>job string,</span></span></span></p>
  <p class=a><span style='mso-bookmark:OLE_LINK6'><span style='mso-bookmark:
  OLE_LINK7'><span lang=EN-US>mgr int,</span></span></span></p>
  <p class=a><span style='mso-bookmark:OLE_LINK6'><span style='mso-bookmark:
  OLE_LINK7'><span lang=EN-US>hiredate string, </span></span></span></p>
  <p class=a><span style='mso-bookmark:OLE_LINK6'><span style='mso-bookmark:
  OLE_LINK7'><span lang=EN-US>sal double, </span></span></span></p>
  <p class=a><span style='mso-bookmark:OLE_LINK6'><span style='mso-bookmark:
  OLE_LINK7'><span lang=EN-US>comm double,</span></span></span></p>
  <p class=a><span style='mso-bookmark:OLE_LINK6'><span style='mso-bookmark:
  OLE_LINK7'><span lang=EN-US>deptno int)</span></span></span></p>
  <p class=a><span style='mso-bookmark:OLE_LINK6'><span style='mso-bookmark:
  OLE_LINK7'><span lang=EN-US>row format delimited fields terminated by '\t';</span></span></span><span
  lang=EN-US style='color:#7030A0'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）查看创建的表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; show tables;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>OK</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>tab_name</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>dept</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>emp</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>4</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）向外部表中导入数据</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:2'>              </span></span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>导入数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/dept.txt' into table default.dept;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/emp.txt' into table default.emp;</span></p>

<p class=MsoNormal style='text-indent:42.0pt;mso-char-indent-count:4.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>查询结果</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from dept;</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>5</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查看表格式化数据（删除数据之后，</span><span
lang=EN-US>hdfs</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的文件还在）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; desc
formatted dept;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Table Type:<span
style='mso-spacerun:yes'>             </span>EXTERNAL_TABLE</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.5.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>管理表与外部表的互相转换</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询表的类型</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; desc
formatted student2;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Table Type:<span
style='mso-spacerun:yes'>             </span>MANAGED_TABLE</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）修改内部表</span><span
lang=EN-US>student2</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为外部表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>alter table student2 set
tblproperties(<span style='color:red'>'EXTERNAL'='TRUE')</span>; </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（红色的大小写都不能改）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询表的类型</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; desc
formatted student2;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Table Type:<span
style='mso-spacerun:yes'>             </span>EXTERNAL_TABLE</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）修改外部表</span><span
lang=EN-US>student2</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为内部表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>alter table student2 set
tblproperties('EXTERNAL'='FALSE');</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>5</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询表的类型</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; desc
formatted student2;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Table Type:<span
style='mso-spacerun:yes'>             </span>MANAGED_TABLE</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>注意：</span><span lang=EN-US style='color:red'>('EXTERNAL'='TRUE')</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>和</span><span lang=EN-US style='color:red'>('EXTERNAL'='FALSE')</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>为固定写法，区分大小写！</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>如果是</span><span lang=EN-US
style='color:red'>'EXTERNAL'='true'</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，即小写的</span><span
lang=EN-US>true</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，结果也是会显示说成功，但是实际并没有改到。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_23"
 o:spid="_x0000_i1208" type="#_x0000_t75" style='width:566.4pt;height:234.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image019.png" o:title=""/>
</v:shape></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.6 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分区表</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分区表实际上就是对应一个</span><span lang=EN-US>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件系统上的独立的文件夹，该文件夹下是该分区所有的数据文件。</span><span lang=EN-US
style='color:red'>Hive</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>中的分区就是分目录</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，把一个大的数据集根据业务需要分割成小的数据集。在查询时通过</span><span lang=EN-US>WHERE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>子句中的表达式选择查询所需要的指定的分区，这样的查询效率会提高很多。（因为</span><span
lang=EN-US>hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>没有索引）</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.6.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分区表基本操作</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．引入分区表（需要根据日期对日志进行管理）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>/user/hive/warehouse/log_partition/20170702/20170702.log</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>/user/hive/warehouse/log_partition/20170703/20170703.log</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>/user/hive/warehouse/log_partition/20170704/20170704.log</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建分区表语法</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:-1.05pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=711 valign=top style='width:426.75pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; create
  table dept_partition(</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>deptno int, dname string, loc
  string</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>)</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>partitioned by (month string)</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>row format delimited fields
  terminated by '\t';</span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．加载数据到分区表中</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/dept.txt' into table default.dept_partition
partition(month='201709'); </span><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>（执行完可以看到图</span><span
lang=EN-US>6-5</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/dept.txt' into table default.dept_partition
partition(month='201708');</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/dept.txt' into table default.dept_partition
partition(month='201707’); </span><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>（全部执行完可以看到图</span><span
lang=EN-US>6-6</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_9" o:spid="_x0000_i1207" type="#_x0000_t75" style='width:415.2pt;
 height:60.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image020.png" o:title=""/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>图</span><span lang=EN-US>6-5 </span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>加载数据到分区表</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_10" o:spid="_x0000_i1206" type="#_x0000_t75"
 style='width:415.2pt;height:84pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image021.png" o:title=""/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>图</span><span lang=EN-US>6-6 </span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分区表</span><span
lang=EN-US style='color:#7030A0'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查询分区表中数据</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>单分区查询</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from dept_partition where month='201709'; </span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（不带分区就全部分区都查）</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>多分区联合查询（也可以用</span><span lang=EN-US>or</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，比如</span><span lang=EN-US>where month=’’ or month=’’</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，但</span><span lang=EN-US>or</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>不会排序）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from dept_partition where month='201709'</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>              </span>union</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>              </span>select * from dept_partition
where month='201708'</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>              </span>union</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'>              </span>select * from dept_partition
where month='201707';</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>_u3.deptno<span
style='mso-spacerun:yes'>      </span>_u3.dname<span
style='mso-spacerun:yes'>       </span>_u3.loc _u3.month</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>10<span
style='mso-spacerun:yes'>      </span>ACCOUNTING<span
style='mso-spacerun:yes'>      </span>NEW YORK<span
style='mso-spacerun:yes'>        </span>201707</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>10<span
style='mso-spacerun:yes'>      </span>ACCOUNTING<span
style='mso-spacerun:yes'>      </span>NEW YORK<span
style='mso-spacerun:yes'>        </span>201708</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>10<span
style='mso-spacerun:yes'>      </span>ACCOUNTING<span
style='mso-spacerun:yes'>      </span>NEW YORK<span
style='mso-spacerun:yes'>        </span>201709</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>20<span
style='mso-spacerun:yes'>      </span>RESEARCH<span
style='mso-spacerun:yes'>        </span>DALLAS<span style='mso-spacerun:yes'> 
</span>201707</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>20<span
style='mso-spacerun:yes'>      </span>RESEARCH<span
style='mso-spacerun:yes'>        </span>DALLAS<span style='mso-spacerun:yes'> 
</span>201708</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>20<span
style='mso-spacerun:yes'>      </span>RESEARCH<span
style='mso-spacerun:yes'>        </span>DALLAS<span style='mso-spacerun:yes'> 
</span>201709</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>30<span
style='mso-spacerun:yes'>      </span>SALES<span style='mso-spacerun:yes'>  
</span>CHICAGO 201707</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>30<span
style='mso-spacerun:yes'>      </span>SALES<span style='mso-spacerun:yes'>  
</span>CHICAGO 201708</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>30<span
style='mso-spacerun:yes'>      </span>SALES<span style='mso-spacerun:yes'> 
</span><span style='mso-spacerun:yes'> </span>CHICAGO 201709</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>40<span
style='mso-spacerun:yes'>      </span>OPERATIONS<span
style='mso-spacerun:yes'>      </span>BOSTON<span style='mso-spacerun:yes'> 
</span>201707</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>40<span
style='mso-spacerun:yes'>      </span>OPERATIONS<span
style='mso-spacerun:yes'>      </span>BOSTON<span style='mso-spacerun:yes'> 
</span>201708</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>40<span
style='mso-spacerun:yes'>      </span>OPERATIONS<span
style='mso-spacerun:yes'>      </span>BOSTON<span style='mso-spacerun:yes'> 
</span>201709</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．增加分区</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US
style='color:black'><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>创建单个分区</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; alter table
dept_partition add partition(month='201706') ;</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US
style='color:black'><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>同时创建多个分区</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; alter table dept_partition add
partition(month='201705') partition(month='201704');<span
style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（两个</span><span
lang=EN-US>partiton</span><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>用空格）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>6</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．删除分区</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US
style='color:black'><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>删除单个分区</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; alter table dept_partition drop partition
(month='201704');</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>同时删除多个分区</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; alter table dept_partition drop partition (month='201705')<span
style='color:red'>, </span>partition (month='201706');<span
style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（两个</span><span
lang=EN-US>partition</span><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>用逗号）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>7</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看分区表有多少分区</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive&gt; show partitions dept_partition;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>8</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看分区表结构</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive&gt; desc formatted dept_partition;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US># Partition Information<span style='mso-spacerun:yes'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（分区信息）</span><span lang=EN-US><span
style='mso-spacerun:yes'>       </span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US># col_name<span style='mso-spacerun:yes'>             
</span>data_type<span style='mso-spacerun:yes'>              
</span>comment<span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>           </span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>month<span style='mso-spacerun:yes'>                  
</span>string<span style='mso-spacerun:yes'>    </span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.6.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分区表注意事项</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建二级分区表</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:1.2pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=708 valign=top style='width:424.5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; create
  table dept_partition2(</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>               </span>deptno int, dname string, loc
  string</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>               </span>)</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>               </span>partitioned by (month string,
  day string)</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>             </span><span
  style='mso-spacerun:yes'>  </span>row format delimited fields terminated by
  '\t';</span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．正常的加载数据</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）加载数据到二级分区表中</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/dept.txt' into table</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>default.dept_partition2
partition(month='201709', day='13');</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）查询分区数据</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from dept_partition2 where month='201709' and day='13';</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>截图用</span><span lang=EN-US>stu2</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_24"
 o:spid="_x0000_i1205" type="#_x0000_t75" style='width:567pt;height:83.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image022.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在文件系统的表示</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_25"
 o:spid="_x0000_i1204" type="#_x0000_t75" style='width:567.6pt;height:116.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image023.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_26"
 o:spid="_x0000_i1203" type="#_x0000_t75" style='width:567pt;height:118.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image024.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．把数据直接上传到分区目录上，让分区表和数据产生关联的三种方式（下面用二级分区举例，一级也适用）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）方式一：上传数据后修复（文件已经在</span><span
lang=EN-US style='color:black'>hdfs</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>上可以这样子用）</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>上传数据</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; dfs -mkdir
-p /user/hive/warehouse/dept_partition2/month=201709/day=12;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; dfs -put
/opt/module/datas/dept.txt<span style='mso-spacerun:yes'> 
</span>/user/hive/warehouse/dept_partition2/month=201709/day=12;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>查询数据（查询不到刚上传的数据，因为创建表的时候或者直接</span><span lang=EN-US
style='color:black'>put</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>的时候</span><span
lang=EN-US style='color:black'>(load</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>的时候是要指定具体的分区内容的</span><span lang=EN-US style='color:black'>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>没有指定分区具体的内容，如果这个例子没有分区，是可以查的到数据的，注意区分，这里只是没有分区的元数据）</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from dept_partition2 where month='201709' and day='12';</span></p>

<p class=MsoNormal style='text-indent:42.0pt;mso-char-indent-count:4.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>执行修复命令</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; msck repair table
dept_partition2;</span></p>

<p class=MsoNormal style='text-indent:42.0pt;mso-char-indent-count:4.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>再次查询数据（就能查到了）</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from dept_partition2 where month='201709' and day='12';</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）方式二：上传数据后添加分区</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上传数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; dfs -mkdir
-p /user/hive/warehouse/dept_partition2/month=201709/day=11;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; dfs -put
/opt/module/datas/dept.txt<span style='mso-spacerun:yes'> 
</span>/user/hive/warehouse/dept_partition2/month=201709/day=11;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>执行添加分区（手动添加分区）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>  </span>hive (default)&gt; alter table dept_partition2 add
partition(month='201709', day='11');</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from dept_partition2 where month='201709' and day='11';</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）方式三：创建文件夹后</span><span lang=EN-US>load</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据到分区（最常用）</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:2'>              </span></span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建目录</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; dfs -mkdir
-p</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>/user/hive/warehouse/dept_partition2/month=201709/day=10;</span></p>

<p class=MsoNormal style='text-indent:42.0pt;mso-char-indent-count:4.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>上传数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/dept.txt' into table dept_partition2
partition(month='201709',day='10');</span></p>

<p class=MsoNormal style='text-indent:42.0pt;mso-char-indent-count:4.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>查询数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from dept_partition2 where month='201709' and day='10';</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.7 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>修改表</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.7.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>重命名表</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．语法</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>ALTER TABLE table_name RENAME
TO new_table_name</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．实操案例</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; alter table
dept_partition2 rename to dept_partition3;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.7.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>增加、修改和删除表分区</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>详见</span><span lang=EN-US style='color:red'>4.6.1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>分区表基本操作。</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>4.7.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>增加</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>/</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>修改</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>/</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>替换列信息</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．语法</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>更新列</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>ALTER TABLE table_name <span
style='color:red'>CHANGE</span> [COLUMN] col_old_name col_new_name column_type
[COMMENT col_comment] [FIRST|AFTER column_name]</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>增加和替换列</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>ALTER TABLE table_name <span
style='color:red'>ADD|REPLACE</span> COLUMNS (col_name data_type [COMMENT
col_comment], ...) </span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>注：</span><span lang=EN-US>ADD</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是代表新增一字段，字段位置在所有列后面</span><span
lang=EN-US>(partition</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>列前</span><span
lang=EN-US>)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，</span><span lang=EN-US>REPLACE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>则是表示替换表中所有字段。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．实操案例</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询表结构</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; desc dept_partition;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）添加列</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; alter table
dept_partition add columns(deptdesc string);</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询表结构</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; desc dept_partition;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）更新列</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; alter table
dept_partition change column deptdesc desc int; </span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（将</span><span
lang=EN-US>deptdesc</span><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>改为</span><span lang=EN-US>desc</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>5</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询表结构</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; desc dept_partition;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>6</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）替换列</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; alter table
dept_partition replace columns(deptno string, dname string, loc string); </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（这替换是把之前的字段都抛弃，用括号里面的字段作为新的）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>7</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询表结构</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive&gt; desc dept_partition;</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.8 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>删除表</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; drop table
dept_partition;</span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>5</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'> DML</span><span style='font-size:
15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据操作</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>5.1 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据导入</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>5.1.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>向表中装载数据（</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Load</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．语法（中括号表示可有可无；有</span><span
lang=EN-US>overwrite</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>是覆盖，没有</span><span lang=EN-US>overwrite</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>就是追加）</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US style='color:red'>hive&gt; load data [local]
inpath '/opt/module/datas/student.txt' overwrite | into table student
[partition (partcol1=val1,…)];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>load data:</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示加载数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>local:</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示从本地加载数据到</span><span lang=EN-US>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表；否则从</span><span lang=EN-US>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>加载数据到</span><span lang=EN-US>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>inpath:</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示加载数据的路径</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>overwrite:</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示覆盖表中已有数据，否则表示追加</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>into table:</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示加载到哪张表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>student:</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示具体的表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>7</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>partition:</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表示上传到指定分区</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．实操案例</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>0</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）创建一张表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; create table
student(id string, name string) row format delimited fields terminated by '\t';</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）加载本地文件到</span><span lang=EN-US>hive</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/student.txt' into table default.student;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）加载</span><span lang=EN-US>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件到</span><span lang=EN-US>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上传文件到</span><span lang=EN-US>HDFS</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; dfs -put
/opt/module/datas/student.txt /user/atguigu/hive;</span></p>

<p class=MsoNormal style='text-indent:42.0pt;mso-char-indent-count:4.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>加载</span><span lang=EN-US>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上数据（从</span><span lang=EN-US>hdfs</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>加载数据，其实就是移动文件到</span><span lang=EN-US>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表对应的</span><span lang=EN-US>hdfs</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的目录）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
inpath '/user/atguigu/hive/student.txt' into table default.student;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）加载数据覆盖表中已有的数据</span></p>

<p class=MsoNormal style='text-indent:42.0pt;mso-char-indent-count:4.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>上传文件到</span><span lang=EN-US>HDFS</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; dfs -put
/opt/module/datas/student.txt /user/atguigu/hive;</span></p>

<p class=MsoNormal style='text-indent:42.0pt;mso-char-indent-count:4.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>加载数据覆盖表中已有的数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
inpath '/user/atguigu/hive/student.txt' overwrite into table default.student;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>5.1.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>通过查询语句向表中插入数据（</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Insert</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建一张分区表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; create table student(id int, name string)
partitioned by (month string) row format delimited fields terminated by '\t';</span></p>

<p class=1 style='margin-top:6.2pt;margin-right:0cm;margin-bottom:0cm;
margin-left:21.0pt;margin-bottom:.0001pt;mso-para-margin-top:6.2pt;mso-para-margin-right:
0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;text-indent:0cm;mso-char-indent-count:0'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．基本插入数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; insert into table<span style='mso-spacerun:yes'> 
</span>student partition(month='201709') values(1,'wangwu');</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．基本模式插入（根据单张表查询结果，这里</span><span
lang=EN-US>overwrite</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>后面可以没有</span><span lang=EN-US>into</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; insert overwrite table student
partition(month='201708')</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>             </span>select id, name
from student where month='201709';</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．多插入模式（根据多张表查询结果）这种就不用多次使用</span><span
lang=EN-US>from table</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>来指定同一个表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; <span style='color:red'>from student<o:p></o:p></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>         </span>insert overwrite table student
partition(month='201707')</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>              </span>select id, name
where month='201709'</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>              </span>insert overwrite
table student partition(month='201706')</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>              </span>select id, name
where month='201709';</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>5.1.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询语句中创建表并加载数据（</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>As Select</span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red;background:yellow;mso-highlight:yellow'>详见</span><span
lang=EN-US style='color:red;background:yellow;mso-highlight:yellow'>4.5.1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red;background:yellow;mso-highlight:yellow'>章创建表。</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>根据查询结果创建表（查询的结果会添加到新创建的表中）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>create table if not exists student3</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>as select id, name from student;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>5.1.4 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>创建表时通过</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Location</span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>指定加载数据路径</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建表，并指定在</span><span
lang=EN-US>hdfs</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>上的位置（一般都创建外部表）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; create table if not exists student5(</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>              </span>id int, name
string</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>              </span>)</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>              </span>row format
delimited fields terminated by '\t'</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>              </span>location
'/user/hive/warehouse/student5';</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．上传数据到</span><span
lang=EN-US>hdfs</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>上（分析数据之前，数据已经在这个位置了，就可以在创建表的时候指定文件的路径，不需要移动了）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; dfs -put /opt/module/datas/student.txt</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>/user/hive/warehouse/student5;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查询数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; select * from student5;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>5.1.5 Import</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>数据到指定</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'>Hive</span><span
style='font-size:14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>表中</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>注意：先用</span><span lang=EN-US style='color:red'>export</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>导出后，再使用</span><span lang=EN-US style='color:red'>import</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>将数据导入，否则无法导入。</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; import table student2 partition(month='201709')
from</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span
style='mso-spacerun:yes'> </span>'/user/hive/warehouse/export/student';</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>5.2 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据导出</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>5.2.1 Insert</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>导出</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．将查询的结果导出到本地（数据之间没有任何分隔）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; insert overwrite local directory
'/opt/module/datas/export/student'</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>            </span>select * from
student;</span></p>

<p class=1 style='margin-top:6.2pt;margin-right:0cm;margin-bottom:0cm;
margin-left:21.0pt;margin-bottom:.0001pt;mso-para-margin-top:6.2pt;mso-para-margin-right:
0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;text-indent:0cm;mso-char-indent-count:0'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．将查询的结果格式化导出到本地（数据之间用</span><span
lang=EN-US>\t</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>分隔）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive(default)&gt;insert overwrite local directory '/opt/module/datas/export/student1'</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>           </span>ROW FORMAT
DELIMITED FIELDS TERMINATED BY '\t'<span style='mso-spacerun:yes'>            
</span>select * from student;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．将查询的结果导出到</span><span
lang=EN-US>HDFS</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>上</span><span lang=EN-US>(</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>没有</span><span
lang=EN-US>local)</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; insert overwrite directory
'/user/atguigu/student2'</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>             </span>ROW FORMAT
DELIMITED FIELDS TERMINATED BY '\t' </span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>             </span>select * from
student;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>5.2.2 Hadoop</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>命令导出到本地</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; dfs -get
/user/hive/warehouse/student/month=201709/000000_0</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>/opt/module/datas/export/student3.txt;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>5.2.3 Hive Shell </span><span
style='font-size:14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>命令导出</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><a name="_Hlk510280826"><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>基本语法：（</span><span
lang=EN-US>hive -f/-e </span></a><span style='mso-bookmark:_Hlk510280826'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>执行语句或者脚本</span><span lang=EN-US> &gt; file</span></span><span
style='mso-bookmark:_Hlk510280826'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
style='mso-bookmark:_Hlk510280826'><span lang=EN-US>[atguigu@hadoop102 hive]$
bin/hive -e 'select * from default.student;' &gt;</span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
style='mso-bookmark:_Hlk510280826'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>/opt/module/datas/export/student4.txt;</span></span></p>

<span style='mso-bookmark:_Hlk510280826'></span>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>5.2.4 Export</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>导出到</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'>HDFS</span><span
style='font-size:14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>上</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>(defahiveult)&gt; export table default.student to
'/user/hive/warehouse/export/student';</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_27"
 o:spid="_x0000_i1202" type="#_x0000_t75" style='width:567pt;height:95.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image025.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_28"
 o:spid="_x0000_i1201" type="#_x0000_t75" style='width:567.6pt;height:141pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image026.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>了解下元数据，这些元数据就存着</span><span
lang=EN-US>hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表与数据文件的映射关系</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_29"
 o:spid="_x0000_i1200" type="#_x0000_t75" style='width:567.6pt;height:159.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image027.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US>hive</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据库</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_30"
 o:spid="_x0000_i1199" type="#_x0000_t75" style='width:567pt;height:113.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image028.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_31"
 o:spid="_x0000_i1198" type="#_x0000_t75" style='width:567pt;height:180.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image029.png" o:title=""/>
</v:shape></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>5.2.5 Sqoop</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>导出</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>后续课程专门讲。</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>5.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>清除表中数据（</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>Truncate</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>注意：</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>Truncate</span><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>只能删除管理表，不能删除外部表中数据</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US>hive (default)&gt; truncate table student;</span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>6</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> </span><span style='font-size:15.0pt;line-height:240%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询（重点）</span><span lang=EN-US style='font-size:15.0pt;
line-height:240%'><o:p></o:p></span></h1>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><a
href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Select">https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Select</a></span></p>

<p class=MsoNormal style='line-height:16.5pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>查询语句语法：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0'>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>[WITH
  CommonTableExpression (, CommonTableExpression)*]&nbsp;&nbsp;&nbsp; (Note:
  Only available</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>starting with Hive&nbsp;0.13.0)</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>SELECT [ALL |
  DISTINCT</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>（去重）</span><span lang=EN-US>]
  select_expr, select_expr, ...</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>&nbsp;&nbsp;FROM
  table_reference</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>&nbsp;&nbsp;[WHERE
  where_condition]</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>&nbsp;&nbsp;[GROUP
  BY col_list]</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>&nbsp;&nbsp;[ORDER
  BY col_list]</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>&nbsp;&nbsp;[CLUSTER</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>（这不是分桶）</span><span lang=EN-US> BY col_list</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;|
  [DISTRIBUTE BY col_list] [SORT BY col_list]</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>&nbsp;&nbsp;]</span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US>&nbsp;[LIMIT
  number]</span></p>
  </div>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>6.1 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>基本查询（</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>Select…From</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.1.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>全表和特定列查询</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．全表查询</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; select * from emp;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．选择特定列查询</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; select empno, ename from emp;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>注意：</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span><span lang=EN-US>SQL </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语言<span style='color:red'>大小写不敏感。</span></span><span
lang=EN-US> </span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span><span lang=EN-US>SQL </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可以写在一行或者多行</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）<span style='color:red'>关键字不能被缩写也不能分行</span></span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>4</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）各子句一般要分行写。</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>5</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）使用缩进提高语句的可读性。</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.1.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>列别名</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．重命名一个列</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．便于计算</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．紧跟列名，<span
style='color:red'>也可以在列名和别名之间加入关键字‘</span></span><span lang=EN-US
style='color:red'>AS</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial;color:red'>’</span> </p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=MsoNormal style='margin-left:10.5pt;text-indent:21.0pt;line-height:
16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>查询名称和部门</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select ename
AS name, deptno dn from emp;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.1.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>算术运算符</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>6-3<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=225 valign=top style='width:134.7pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>运算符</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>描述</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A+B<o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>和</span><span style='mso-ansi-language:ZH-CN'>B
  </span><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>相加</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A-B<o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>减去</span><span style='mso-ansi-language:
  ZH-CN'>B<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A*B<o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>和</span><span style='mso-ansi-language:ZH-CN'>B
  </span><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>相乘</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A/B<o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>除以</span><span style='mso-ansi-language:
  ZH-CN'>B<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A%B<o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>对</span><span style='mso-ansi-language:ZH-CN'>B</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>取余</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A&amp;B<o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>和</span><span style='mso-ansi-language:ZH-CN'>B</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>按位取与</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A|B<o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>和</span><span style='mso-ansi-language:ZH-CN'>B</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>按位取或</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A^B<o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>和</span><span style='mso-ansi-language:ZH-CN'>B</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>按位取异或</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9;mso-yfti-lastrow:yes'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>~A<o:p></o:p></span></p>
  </td>
  <td width=461 valign=top style='width:276.4pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>按位取反</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>案例实操</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span><span style='mso-spacerun:yes'>  </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询出所有员工的薪水后加</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>显示。</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select sal
+1 from emp;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.1.4 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>常用函数</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．求总行数（</span><span
lang=EN-US>count</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
count(*) cnt from emp;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．求工资的最大值（</span><span
lang=EN-US>max</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
max(sal) max_sal from emp;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．求工资的最小值（</span><span
lang=EN-US>min</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
min(sal) min_sal from emp;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．求工资的总和（</span><span
lang=EN-US>sum</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
sum(sal) sum_sal from emp; </span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．求工资的平均值（</span><span
lang=EN-US>avg</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
avg(sal) avg_sal from emp;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.1.5 Limit</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>语句</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>典型的查询会返回多行数据。</span><span lang=EN-US>LIMIT</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>子句用于限制返回的行数。</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp limit 5;</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>6.2 Where</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>语句</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．使用</span><span
lang=EN-US>WHERE</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>子句，将不满足条件的行过滤掉</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>WHERE</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>子句紧随</span><span lang=EN-US>FROM</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>子句</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询出薪水大于</span><span lang=EN-US>1000</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的所有员工</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where sal &gt;1000;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.2.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>比较运算符（</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Between/In/ Is Null</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）下面表中描述了谓词操作符，这些操作符同样可以用于</span><span lang=EN-US>JOIN…ON</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><span lang=EN-US>HAVING</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语句中。</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>表</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;
font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>6-4<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=177 valign=top style='width:106.35pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>操作符</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>支持的数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>描述</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A=B<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>基本数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>如果</span><span
  style='mso-ansi-language:ZH-CN'>A</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>等于</span><span style='mso-ansi-language:ZH-CN'>B</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>则返回</span><span style='mso-ansi-language:
  ZH-CN'>TRUE</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>，反之返回</span><span
  style='mso-ansi-language:ZH-CN'>FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A&lt;=&gt;B<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>基本数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>如果</span><span
  style='mso-ansi-language:ZH-CN'>A</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>和</span><span style='mso-ansi-language:ZH-CN'>B</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>都为</span><span style='mso-ansi-language:
  ZH-CN'>NULL</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>，则返回</span><span
  style='mso-ansi-language:ZH-CN'>TRUE</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，其他的和等号（</span><span style='mso-ansi-language:ZH-CN'>=</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>）操作符的结果一致，如果任一为</span><span
  style='mso-ansi-language:ZH-CN'>NULL</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>则结果为</span><span style='mso-ansi-language:ZH-CN'>NULL<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A&lt;&gt;B, A!=B<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>基本数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>或者</span><span style='mso-ansi-language:
  ZH-CN'>B</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>为</span><span
  style='mso-ansi-language:ZH-CN'>NULL</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>则返回</span><span style='mso-ansi-language:ZH-CN'>NULL</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>；如果</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>不等于</span><span
  style='mso-ansi-language:ZH-CN'>B</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则返回</span><span style='mso-ansi-language:ZH-CN'>TRUE</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>，反之返回</span><span style='mso-ansi-language:
  ZH-CN'>FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A&lt;B<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>基本数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>或者</span><span style='mso-ansi-language:
  ZH-CN'>B</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>为</span><span
  style='mso-ansi-language:ZH-CN'>NULL</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则返回</span><span style='mso-ansi-language:ZH-CN'>NULL</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>；如果</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>小于</span><span
  style='mso-ansi-language:ZH-CN'>B</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则返回</span><span style='mso-ansi-language:ZH-CN'>TRUE</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>，反之返回</span><span style='mso-ansi-language:
  ZH-CN'>FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A&lt;=B<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>基本数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>或者</span><span style='mso-ansi-language:
  ZH-CN'>B</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>为</span><span
  style='mso-ansi-language:ZH-CN'>NULL</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则返回</span><span style='mso-ansi-language:ZH-CN'>NULL</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>；如果</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>小于等于</span><span
  style='mso-ansi-language:ZH-CN'>B</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则返回</span><span style='mso-ansi-language:ZH-CN'>TRUE</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>，反之返回</span><span style='mso-ansi-language:
  ZH-CN'>FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A&gt;B<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>基本数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>或者</span><span style='mso-ansi-language:
  ZH-CN'>B</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>为</span><span
  style='mso-ansi-language:ZH-CN'>NULL</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则返回</span><span style='mso-ansi-language:ZH-CN'>NULL</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>；如果</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>大于</span><span
  style='mso-ansi-language:ZH-CN'>B</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则返回</span><span style='mso-ansi-language:ZH-CN'>TRUE</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>，反之返回</span><span style='mso-ansi-language:
  ZH-CN'>FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A&gt;=B<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>基本数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>或者</span><span style='mso-ansi-language:
  ZH-CN'>B</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>为</span><span
  style='mso-ansi-language:ZH-CN'>NULL</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则返回</span><span style='mso-ansi-language:ZH-CN'>NULL</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>；如果</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>大于等于</span><span
  style='mso-ansi-language:ZH-CN'>B</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则返回</span><span style='mso-ansi-language:ZH-CN'>TRUE</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>，反之返回</span><span style='mso-ansi-language:
  ZH-CN'>FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>A [NOT] BETWEEN B AND C</span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>基本数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>如果</span><span
  style='mso-ansi-language:ZH-CN'>A</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，</span><span style='mso-ansi-language:ZH-CN'>B</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>或者</span><span style='mso-ansi-language:
  ZH-CN'>C</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>任一为</span><span
  style='mso-ansi-language:ZH-CN'>NULL</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>，则结果为</span><span style='mso-ansi-language:ZH-CN'>NULL</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>。如果</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>的值大于等于</span><span
  style='mso-ansi-language:ZH-CN'>B</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>而且小于或等于</span><span style='mso-ansi-language:ZH-CN'>C</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>，则结果为</span><span style='mso-ansi-language:
  ZH-CN'>TRUE</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>，反之为</span><span
  style='mso-ansi-language:ZH-CN'>FALSE</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>。如果使用</span><span style='mso-ansi-language:ZH-CN'>NOT</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>关键字则可达到相反的效果。</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A IS NULL<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>所有数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>如果</span><span
  style='mso-ansi-language:ZH-CN'>A</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>等于</span><span style='mso-ansi-language:ZH-CN'>NULL</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>，则返回</span><span style='mso-ansi-language:
  ZH-CN'>TRUE</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>，反之返回</span><span
  style='mso-ansi-language:ZH-CN'>FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A IS NOT NULL<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>所有数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>如果</span><span
  style='mso-ansi-language:ZH-CN'>A</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>不等于</span><span style='mso-ansi-language:ZH-CN'>NULL</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>，则返回</span><span style='mso-ansi-language:
  ZH-CN'>TRUE</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>，反之返回</span><span
  style='mso-ansi-language:ZH-CN'>FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>IN(</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>数值</span><span style='mso-ansi-language:
  ZH-CN'>1, </span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>数值</span><span
  style='mso-ansi-language:ZH-CN'>2)<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>所有数据类型</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>使用</span><span
  style='mso-ansi-language:ZH-CN'> IN</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>运算显示列表中的值</span><span style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>A [NOT] LIKE B<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>STRING </span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>类型</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>B</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>是一个</span><span style='mso-ansi-language:
  ZH-CN'>SQL</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>下的简单正则表达式，如果</span><span
  style='mso-ansi-language:ZH-CN'>A</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>与其匹配的话，则返回</span><span style='mso-ansi-language:ZH-CN'>TRUE</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>；反之返回</span><span style='mso-ansi-language:
  ZH-CN'>FALSE</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>。</span><span
  style='mso-ansi-language:ZH-CN'>B</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>的表达式说明如下：‘</span><span style='mso-ansi-language:ZH-CN'>x%</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>’表示</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>必须以字母‘</span><span
  style='mso-ansi-language:ZH-CN'>x</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>’开头，‘</span><span style='mso-ansi-language:ZH-CN'>%x</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>’表示</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>必须以字母’</span><span
  style='mso-ansi-language:ZH-CN'>x</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>’结尾，而‘</span><span style='mso-ansi-language:ZH-CN'>%x%</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>’表示</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>包含有字母’</span><span
  style='mso-ansi-language:ZH-CN'>x</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>’</span><span style='mso-ansi-language:ZH-CN'>,</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>可以位于开头，结尾或者字符串中间。如果使用</span><span
  style='mso-ansi-language:ZH-CN'>NOT</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>关键字则可达到相反的效果。</span><span style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13;mso-yfti-lastrow:yes'>
  <td width=177 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>A RLIKE B, A REGEXP B</span></p>
  </td>
  <td width=142 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>STRING </span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>类型</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=366 valign=top style='width:219.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>B</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>是一个正则表达式，如果</span><span style='mso-ansi-language:
  ZH-CN'>A</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>与其匹配，则返回</span><span
  style='mso-ansi-language:ZH-CN'>TRUE</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>；反之返回</span><span style='mso-ansi-language:ZH-CN'>FALSE</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>。匹配使用的是</span><span style='mso-ansi-language:
  ZH-CN'>JDK</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>中的正则表达式接口实现的，因为正则也依据其中的规则。例如，正则表达式必须和整个字符串</span><span
  style='mso-ansi-language:ZH-CN'>A</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>相匹配，而不是只需与其字符串匹配。</span><span style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt;tab-stops:36.0pt'><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询出薪水等于</span><span
lang=EN-US>5000</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的所有员工</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where sal =5000;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询工资在</span><span
lang=EN-US>500</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>到</span><span lang=EN-US>1000</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的员工信息</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where sal between 500 and 1000;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询</span><span
lang=EN-US>comm</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为空的所有员工信息</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where comm is null;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询工资是</span><span
lang=EN-US>1500</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>或</span><span lang=EN-US>5000</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的员工信息</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where sal IN (1500, 5000);</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.2.2 Like</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>RLike<o:p></o:p></span></h3>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%;tab-stops:36.0pt'><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）使用</span><span lang=EN-US>LIKE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>运算选择类似的值</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%;tab-stops:36.0pt'><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）选择条件可以包含字符或数字</span><span lang=EN-US>:</span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
line-height:150%'><span lang=EN-US style='color:red'>% </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>代表零个或多个字符</span><span lang=EN-US style='color:
red'>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>任意个字符</span><span
lang=EN-US style='color:red'>)</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>。</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
line-height:150%'><span lang=EN-US style='color:red'>_ </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>代表一个字符。</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US>3</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>RLIKE</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>子句是</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中这个功能的一个扩展，其可以通过</span><span lang=EN-US style='color:red'>Java</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>的正则表达式</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>这个更强大的语言来指定匹配条件。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span lang=EN-US>4</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）案例实操</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查找以</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>开头薪水的员工信息</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where sal LIKE '2%';</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查找第二个数值为</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的薪水的员工信息</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where sal LIKE '_2%';</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查找薪水中含有</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的员工信息（正则）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where sal RLIKE '[2]';</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.2.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>逻辑运算符（</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>And/Or/Not</span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'><o:p></o:p></span></h3>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>6-5<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=346 valign=top style='width:207.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>操作符</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=339 valign=top style='width:203.45pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>含义</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=346 valign=top style='width:207.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>AND<o:p></o:p></span></p>
  </td>
  <td width=339 valign=top style='width:203.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>逻辑并</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;height:4.5pt'>
  <td width=346 valign=top style='width:207.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:4.5pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>OR<o:p></o:p></span></p>
  </td>
  <td width=339 valign=top style='width:203.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt;height:4.5pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>逻辑或</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=346 valign=top style='width:207.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>NOT<o:p></o:p></span></p>
  </td>
  <td width=339 valign=top style='width:203.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>逻辑否</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>案例实操</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查询薪水大于</span><span lang=EN-US>1000</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，部门是</span><span lang=EN-US>30</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where sal&gt;1000 and deptno=30;</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查询薪水大于</span><span lang=EN-US>1000</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，或者部门是</span><span lang=EN-US>30</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where sal&gt;1000 or deptno=30;</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查询除了</span><span lang=EN-US>20</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>部门和</span><span lang=EN-US>30</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>部门以外的员工信息</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp where deptno not IN(30, 20);</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>6.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分组</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.3.1 Group By</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>语句</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>GROUP BY</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>语句通常会和聚合函数一起使用，按照一个或者多个列队结果进行分组，然后对每个组执行聚合操作。</span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例实操：</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）计算</span><span lang=EN-US>emp</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表每个部门的平均工资</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
t.deptno, <span style='color:red'>avg(t.sal)</span> avg_sal from emp t group by
t.deptno;</span></p>

<p class=MsoNormal><span lang=EN-US>avg</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是聚合函数，由于</span><span
lang=EN-US>avg(t.sal)</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，所以</span><span
lang=EN-US>t.sal</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可以不放到</span><span lang=EN-US>group by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>里面，但</span><span lang=EN-US>t.deptno</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>没有聚合函数，所以在有</span><span lang=EN-US>group by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的时候要查询</span><span lang=EN-US>t.deptno</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，那么就要把</span><span lang=EN-US>t.deptno</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>放到</span><span lang=EN-US>group by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>后面</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_32"
 o:spid="_x0000_i1197" type="#_x0000_t75" style='width:288.6pt;height:144.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image030.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）计算</span><span lang=EN-US>emp</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>每个部门中每个岗位的最高薪水</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
t.deptno, t.job, max(t.sal) max_sal from emp t group by t.deptno, t.job;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.3.2 Having</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>语句</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>having</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>与</span><span lang=EN-US>where</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>不同点</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>where</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>针对表中的列发挥作用，查询数据；</span><span
lang=EN-US>having</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>针对查询结果中的列发挥作用，筛选数据。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>where</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>后面不能写分组函数，而</span><span lang=EN-US>having</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>后面可以使用分组函数。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>having</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>只用于</span><span lang=EN-US>group by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分组统计语句。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）求每个部门的平均薪水大于</span><span lang=EN-US>2000</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的部门</span></p>

<p class=MsoNormal style='margin-left:10.5pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>求每个部门的平均工资</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
deptno, avg(sal) from emp group by deptno;</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span><span style='mso-spacerun:yes'>  </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>求每个部门的平均薪水大于</span><span lang=EN-US>2000</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的部门（聚合函数的结果不能放</span><span lang=EN-US>where</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的条件要用</span><span lang=EN-US>having</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
deptno, avg(sal) avg_sal from emp group by deptno having avg_sal &gt; 2000; </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（要用</span><span lang=EN-US>where</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>的话就要把整个不包括</span><span
lang=EN-US>having</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>语句的结果再套一层）</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>6.4 Join</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>语句</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.4.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>等值</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Join<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>支持通常的</span><span lang=EN-US>SQL JOIN</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语句，但是<span style='color:red'>只支持等值连接，不支持非等值连接。</span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:12.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）根据员工表和部门表中的部门编号相等，查询员工编号、员工名称和部门名称；</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
e.empno, e.ename, d.deptno, d.dname from emp e join dept d on e.deptno =
d.deptno;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.4.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表的别名</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．好处</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%;tab-stops:36.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）使用别名可以简化查询。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%;tab-stops:36.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）使用表名前缀可以提高执行效率。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:12.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>合并员工表和部门表</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
e.empno, e.ename, d.deptno from emp e join dept d on e.deptno = d.deptno;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.4.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>内连接</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:12.0pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>内连接：只有进行连接的两个表中都存在与连接条件相匹配的数据才会被保留下来。</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-family:"Cambria","serif";
mso-bidi-font-family:Cambria;color:black'>h</span><span lang=EN-US>ive (default)&gt;
<a name="OLE_LINK29"></a><a name="OLE_LINK28"></a><a name="OLE_LINK27"></a><a
name="OLE_LINK26"><span style='mso-bookmark:OLE_LINK27'><span style='mso-bookmark:
OLE_LINK28'><span style='mso-bookmark:OLE_LINK29'>select e.empno, e.ename,
d.deptno from emp e join dept d on e.deptno = d.deptno;</span></span></span></a></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.4.4 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>左外连接</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:12.0pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>左外连接：</span><span lang=EN-US>JOIN</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>操作符左边表中符合</span><span lang=EN-US>WHERE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>子句的所有记录将会被返回。</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
e.empno, e.ename, d.deptno from emp e left join dept d on e.deptno = d.deptno;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.4.5 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>右外连接</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>右外连接：</span><span
lang=EN-US>JOIN</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>操作符右边表中符合</span><span lang=EN-US>WHERE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>子句的所有记录将会被返回。</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
e.empno, e.ename, d.deptno from emp e right join dept d on e.deptno = d.deptno;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.4.6 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>满外连接</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><a name="_Hlk510342938"><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>满外连接：将会返回所有表中符合</span><span lang=EN-US>WHERE</span></a><span
style='mso-bookmark:_Hlk510342938'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>语句条件的所有记录。如果任一表的指定字段没有符合条件的值的话，那么就使用</span><span
lang=EN-US>NULL</span></span><span style='mso-bookmark:_Hlk510342938'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>值替代。</span></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510342938'><span
lang=EN-US>hive (default)&gt; select e.empno, e.ename, d.deptno from emp e full
join dept d on e.deptno = d.deptno;</span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.4.7 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>多表连接</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-char-indent-count:2.0;line-height:150%;tab-stops:36.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>注意：连接</span><span lang=EN-US style='color:red'> n</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>个表，至少需要</span><span lang=EN-US style='color:red'>n-1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>个连接条件。例如：连接三个表，至少需要两个连接条件。</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-char-indent-count:2.0;line-height:150%;tab-stops:36.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据准备</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-char-indent-count:2.0;line-height:150%;tab-stops:36.0pt'><span lang=EN-US
style='color:red;mso-no-proof:yes'><v:shape id="_x0000_i1030" type="#_x0000_t75"
 style='width:43.8pt;height:31.2pt;mso-position-horizontal-relative:page;
 mso-position-vertical-relative:page' o:ole="">
 <img src="Hive.files/image031.png" o:title="" embosscolor="white"/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1030"
  DrawAspect="Content" ObjectID="_1629836130">
 </o:OLEObject>
</xml><![endif]--></span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建位置表</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:-.3pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=711 valign=top style='width:426.75pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table if not exists
  default.location(</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>loc int,</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>loc_name string</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>)</span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>row format delimited fields
  terminated by '\t';</span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．导入数据</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/location.txt' into table default.location;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．多表连接查询</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt;SELECT
e.ename, d.deptno, l. loc_name</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>FROM<span
style='mso-spacerun:yes'>   </span>emp e </span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>JOIN<span
style='mso-spacerun:yes'>   </span>dept d</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>ON<span
style='mso-spacerun:yes'>     </span>d.deptno = e.deptno </span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>JOIN<span
style='mso-spacerun:yes'>   </span>location l</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>ON<span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>   </span>d.loc = l.loc;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>大多数情况下，</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>会对每对</span><span lang=EN-US>JOIN</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>连接对象启动一个</span><span lang=EN-US>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>任务。本例中会首先启动一个</span><span lang=EN-US>MapReduce job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对表</span><span lang=EN-US>e</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>和表</span><span
lang=EN-US>d</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>进行连接操作，然后会再启动一个</span><span
lang=EN-US>MapReduce job</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将第一个</span><span
lang=EN-US>MapReduce job</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的输出和表</span><span
lang=EN-US>l;</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>进行连接操作。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>注意：为什么不是表</span><span lang=EN-US>d</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和表</span><span lang=EN-US>l</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>先进行连接操作呢？这是因为</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>总是按照从左到右的顺序执行的。</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.4.8 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>笛卡尔积（很多时候没有意义）</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．笛卡尔集会在下面条件下产生</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%;tab-stops:72.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）省略连接条件</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%;tab-stops:72.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）连接条件无效</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%;tab-stops:72.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）所有表中的所有行互相连接</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
empno, dname from emp, dept;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.4.9 </span><a name="OLE_LINK31"></a><a
name="OLE_LINK30"></a><a name="OLE_LINK15"></a><a name="OLE_LINK14"></a><a
name="OLE_LINK13"><span style='mso-bookmark:OLE_LINK14'><span style='mso-bookmark:
OLE_LINK15'><span style='mso-bookmark:OLE_LINK30'><span style='mso-bookmark:
OLE_LINK31'><span style='font-size:14.0pt;line-height:172%;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>连接谓词</span></span></span></span></span></a><span
style='mso-bookmark:OLE_LINK30'><span style='mso-bookmark:OLE_LINK31'><span
style='font-size:14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中不支持</span></span></span><span
style='mso-bookmark:OLE_LINK30'><span style='mso-bookmark:OLE_LINK31'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>or</span></span></span><span
lang=EN-US style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
e.empno, e.ename, d.deptno from emp e join dept d on e.deptno</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>= d.deptno or
e.ename=d.ename;<span style='mso-spacerun:yes'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>错误的</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>6.5 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>排序</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.5.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>全局排序（</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Order By</span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='color:red'>Order By</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>：全局排序，设置成一个</span><span lang=EN-US
style='color:red'>Reducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>，会自动排序</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．使用</span><span
lang=EN-US> ORDER BY </span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>子句排序</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%;tab-stops:72.0pt'><span
lang=EN-US style='color:red'>ASC</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>（</span><span
lang=EN-US style='color:red'>ascend</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>）</span><span lang=EN-US style='color:red'>: </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>升序（默认）</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%;tab-stops:72.0pt'><span
lang=EN-US style='color:red'>DESC</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>（</span><span
lang=EN-US style='color:red'>descend</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>）</span><span lang=EN-US style='color:red'>: </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>降序</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>ORDER BY </span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>子句在</span><span lang=EN-US>SELECT</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>语句的结尾</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span>
</p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><a name="_Hlk510343078"><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span></a><span style='mso-bookmark:
_Hlk510343078'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）查询员工信息按工资升序排列</span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510343078'><span
lang=EN-US>hive (default)&gt; select * from emp order by sal;<span
style='mso-spacerun:yes'>  </span></span></span><span style='mso-bookmark:_Hlk510343078'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（其实就是把</span><span lang=EN-US>sal</span></span><span
style='mso-bookmark:_Hlk510343078'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>字段放到</span><span lang=EN-US>key</span></span><span
style='mso-bookmark:_Hlk510343078'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>的位置）</span></span></p>

<p class=MsoNormal style='line-height:16.5pt'><span style='mso-bookmark:_Hlk510343078'><span
lang=EN-US><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Hlk510343078'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span><span style='mso-bookmark:_Hlk510343078'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）查询员工信息按工资降序排列</span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510343078'><span
lang=EN-US>hive (default)&gt; select * from emp order by sal desc;</span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.5.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>按照别名排序</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>按照员工薪水的</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>倍排序</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
ename, sal*2 twosal from emp order by twosal;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.5.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>多个列排序</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>按照部门和工资升序排序</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
ename, deptno, sal from emp order by deptno, sal ;<span
style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（一个</span><span
lang=EN-US>map</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>）</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.5.4 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>每个</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>MapReduce</span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>内部排序（</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Sort By</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>Sort By</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：每个</span><span
lang=EN-US>Reducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>内部进行排序，对全局结果集来说不是排序。（即多个</span><span
lang=EN-US>reduce</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:0cm;mso-char-indent-count:0'><span
lang=EN-US><span style='mso-tab-count:1'>       </span>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．设置</span><span
lang=EN-US>reduce</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>个数</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; set
mapreduce.job.reduces=3;<span style='mso-spacerun:yes'>  </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（默认是</span><span lang=EN-US>-1</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>，表示根据</span><span
lang=EN-US>SQL</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>语句来调整，根据大小</span><span lang=EN-US>256m</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>就分配一个</span><span lang=EN-US>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>，但不超</span><span lang=EN-US>1099</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>个），注意，设置</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>个之后，如果使用</span><span lang=EN-US>order by</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>，那么</span><span lang=EN-US>reduce</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>个数就是一个，因为就是全局排序</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看设置</span><span
lang=EN-US>reduce</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>个数</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; set
mapreduce.job.reduces;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．根据部门编号降序查看员工信息</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select *
from emp sort by empno desc; </span><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>（直接打印到控制台不知道是怎么分</span><span
lang=EN-US>reduce</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>的，所以后面把结果存入文件）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:0cm;mso-char-indent-count:0'><span
lang=EN-US><span style='mso-tab-count:1'>       </span>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．将查询结果导入到文件中（按照部门编号降序排序）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; insert
overwrite local directory '/opt/module/datas/sortby-result'</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>select * from emp sort by deptno desc; </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（结果保存到本地文件）</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_34"
 o:spid="_x0000_i1196" type="#_x0000_t75" style='width:412.2pt;height:262.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image032.png" o:title=""/>
</v:shape></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.5.5 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分区排序（</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Distribute By</span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>Distribute By</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：类似</span><span
lang=EN-US>MR</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中</span><span lang=EN-US>partition</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，进行分区，结合</span><span lang=EN-US>sort by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>使用。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:red'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>注意，</span><span lang=EN-US style='color:red'>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>要求</span><span lang=EN-US style='color:red'>DISTRIBUTE
BY</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>语句要写在</span><span
lang=EN-US style='color:red'>SORT BY</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>语句之前。（</span><span lang=EN-US style='color:red'>sort by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>是为了排序，不要也行）</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>对于</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>distribute by</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>进行测试，一定要分配多</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>进行处理，否则无法看到</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>distribute by</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的效果。</span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>案例实操：</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US
style='color:black'><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='color:black'>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）先按照部门编号分区，再按照员工编号降序排序。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; set mapreduce.job.reduces=3;<span
style='mso-spacerun:yes'>  </span>// </span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>如果值是</span><span
lang=EN-US>-1</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>，则使用默认的，默认是</span><span lang=EN-US>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>是</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; insert
overwrite local directory '/opt/module/datas/distribute-result' select * from
emp distribute by deptno sort by empno desc;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_33"
 o:spid="_x0000_i1195" type="#_x0000_t75" style='width:450.6pt;height:225.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image033.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这么分区的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_35"
 o:spid="_x0000_i1194" type="#_x0000_t75" style='width:419.4pt;height:174.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image034.png" o:title=""/>
</v:shape></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.5.6 Cluster By<o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当</span><span lang=EN-US>distribute by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><span lang=EN-US>sorts by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>字段相同时，可以使用</span><span lang=EN-US>cluster by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>方式。（即按照分区排序，又内部排序）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>cluster by</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>除了具有</span><span
lang=EN-US>distribute by</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的功能外还兼具</span><span
lang=EN-US>sort by</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的功能。但是排序<span
style='color:red'>只能是升序排序，</span>不能指定排序规则为</span><span lang=EN-US>ASC</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或者</span><span lang=EN-US>DESC</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）以下两种写法等价</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive (default)&gt; select * from emp cluster by deptno; </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（部门</span><span lang=EN-US>deptno</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>很多的时候时候就能看出结果）</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
lang=EN-US>hive (default)&gt; select * from emp distribute by deptno sort by
deptno;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_36"
 o:spid="_x0000_i1193" type="#_x0000_t75" style='width:432.6pt;height:147.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image035.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>注意：按照部门编号分区，不一定就是固定死的数值，可以是</span><span lang=EN-US>20</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>号和</span><span lang=EN-US>30</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>号部门分到一个分区里面去。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>对比一下</span><span lang=EN-US>sort by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，并没有先分区再排序，所以是分区内排序</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_37"
 o:spid="_x0000_i1192" type="#_x0000_t75" style='width:390.6pt;height:224.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image036.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_38"
 o:spid="_x0000_i1191" type="#_x0000_t75" style='width:567pt;height:148.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image037.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif";color:black'>6.6 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>分桶及抽样查询</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif";
color:black'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>6.6.1 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>分桶表数据存储</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:red'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>分区针对的是数据的存储路径；分桶针对的是数据文件。（即分区之后最终结果再分成几个文件，跟</span><span lang=EN-US
style='color:red'>mr</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>的</span><span
lang=EN-US style='color:red'>partition</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>类似，很多公司用不到，因为要求数据量要很大。分区分桶都是解决数据量大的问题）</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分区提供一个隔离数据和优化查询的便利方式。不过，并非所有的数据集都可形成合理的分区，特别是之前所提到过的要确定合适的划分大小这个疑虑。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分桶是将数据集分解成更容易管理的若干部分的另一个技术。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．先创建分桶表，通过直接导入数据文件的方式</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）数据准备</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><a
name="OLE_LINK34"></a><a name="OLE_LINK33"></a><a name="OLE_LINK32"></a><a
name="OLE_LINK19"></a><a name="OLE_LINK18"></a><a name="OLE_LINK17"></a><a
name="OLE_LINK16"><span style='mso-bookmark:OLE_LINK17'><span style='mso-bookmark:
OLE_LINK18'><span style='mso-bookmark:OLE_LINK19'><span style='mso-bookmark:
OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span style='mso-bookmark:
OLE_LINK34'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="_x0000_i1031"
 type="#_x0000_t75" style='width:42pt;height:31.2pt' o:ole="">
 <img src="Hive.files/image038.png" o:title="" embosscolor="white"/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1031"
  DrawAspect="Content" ObjectID="_1629836131">
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></span></a><span
lang=EN-US style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_39" o:spid="_x0000_i1190"
 type="#_x0000_t75" style='width:124.8pt;height:208.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image039.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）创建分桶表（分桶的字段不需要指定类型。建表语句才带</span><span
lang=EN-US>ed</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的。</span><span lang=EN-US>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个分桶）</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:-.3pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=709 valign=top style='width:15.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table stu_buck(id int,
  name string)</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='color:red'>cluster<b
  style='mso-bidi-font-weight:normal'>ed</b> by</span><span lang=EN-US>(id) </span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='color:red'>into 4
  buckets<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>row format delimited fields
  terminated by '\t';</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查看表结构</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; desc
formatted stu_buck;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Num Buckets:<span
style='mso-spacerun:yes'>            </span>4<span style='mso-spacerun:yes'>   
</span></span><span lang=EN-US style='font-family:"Times New Roman","serif";
mso-bidi-font-family:Arial;color:black'><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）导入数据到分桶表中</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/student.txt' into table</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>stu_buck;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>5</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查看创建的分桶表中是否分成</span><span
lang=EN-US>4</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>个桶，如图</span><span lang=EN-US>6-7</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_13" o:spid="_x0000_i1189"
 type="#_x0000_t75" style='width:393.6pt;height:78.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image040.png" o:title=""/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt;
line-height:150%'><span style='font-size:9.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:
Calibri'>图</span><span lang=EN-US style='font-size:9.0pt;line-height:150%;
font-family:"Calibri","sans-serif"'>6-7 </span><span style='font-size:9.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri'>未分桶</span><span lang=EN-US
style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>发现并没有分成</span><span lang=EN-US>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个桶。是什么原因呢？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>这是因为</span><span lang=EN-US style='color:red'>load</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>的方式相当于拷贝，所以不进行分桶，下面用</span><span lang=EN-US
style='color:red'>insert</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>的方式，这会走</span><span
lang=EN-US style='color:red'>MapReduce</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>任务的。</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建分桶表时，数据通过子查询的方式导入</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）先建一个普通的</span><span
lang=EN-US>stu</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表（后面从这个表把数据</span><span lang=EN-US>insert</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>到分桶表）</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>create table stu(id int, name string)</span></p>
  <p class=a><span lang=EN-US>row format delimited fields terminated by '\t';</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）向普通的</span><span
lang=EN-US>stu</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表中导入数据</span><span lang=EN-US
style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:39.45pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=620 valign=top style='width:372.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>load data local inpath '/opt/module/datas/student.txt'
  into table stu;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）清空</span><span
lang=EN-US>stu_buck</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表中数据</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>truncate table stu_buck;</span></p>
  <p class=a><span lang=EN-US>select * from stu_buck;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）导入数据到分桶表，通过子查询的方式</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>insert into table stu_buck</span></p>
  <p class=a><span lang=EN-US>select id, name from stu;</span></p>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>可以看到没有走</span><span lang=EN-US>reduce</span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_40"
   o:spid="_x0000_i1188" type="#_x0000_t75" style='width:372pt;height:92.4pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hive.files/image041.png" o:title=""/>
  </v:shape></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>5</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）发现还是只有一个分桶，如图</span><span
lang=EN-US>6-8</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所示</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_14" o:spid="_x0000_i1187"
 type="#_x0000_t75" style='width:396.6pt;height:53.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image042.png" o:title=""/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt;
line-height:150%'><span style='font-size:9.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:
Calibri'>图</span><span lang=EN-US style='font-size:9.0pt;line-height:150%;
font-family:"Calibri","sans-serif"'>6-8 </span><span style='font-size:9.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri'>未分桶</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>6</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）这是因为需要设置一个属性</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; set
  hive.enforce.bucketing=true;<span style='mso-spacerun:yes'>  </span></span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>（是否分桶，默认是</span><span lang=EN-US>false</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>）</span></p>
  <p class=a><span lang=EN-US>hive (default)&gt; set mapreduce.job.reduces=-1;<span
  style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（</span><span
  lang=EN-US>reduce</span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>让他自己设置）</span></p>
  <p class=a><span lang=EN-US>hive (default)&gt; insert into table stu_buck</span></p>
  <p class=a><span lang=EN-US>select id, name from stu;</span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>可以看到走了</span><span lang=EN-US>Reduce</span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_41"
   o:spid="_x0000_i1186" type="#_x0000_t75" style='width:372pt;height:122.4pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hive.files/image043.png" o:title=""/>
  </v:shape></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>这就分桶了</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_15" o:spid="_x0000_i1185"
 type="#_x0000_t75" style='width:474pt;height:138pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image044.png" o:title="" cropright="1097f"/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt;
line-height:150%'><span style='font-size:9.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:
Calibri'>图</span><span lang=EN-US style='font-size:9.0pt;line-height:150%;
font-family:"Calibri","sans-serif"'>6-9 </span><span style='font-size:9.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri'>分桶</span><span lang=EN-US
style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_42"
 o:spid="_x0000_i1184" type="#_x0000_t75" style='width:567pt;height:172.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image045.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_43"
 o:spid="_x0000_i1183" type="#_x0000_t75" style='width:530.4pt;height:88.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image046.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>下图这些</span><span lang=EN-US>id</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>模于</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>都是</span><span
lang=EN-US>0</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_44"
 o:spid="_x0000_i1182" type="#_x0000_t75" style='width:172.8pt;height:213pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image047.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>0</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分区的内容</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_45"
 o:spid="_x0000_i1181" type="#_x0000_t75" style='width:318.6pt;height:131.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image048.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>7</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查询分桶的数据</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; select * from stu_buck;</span></p>
  <p class=a><span lang=EN-US>OK</span></p>
  <p class=a><span lang=EN-US>stu_buck.id<span style='mso-spacerun:yes'>    
  </span>stu_buck.name</span></p>
  <p class=a><span lang=EN-US>1004<span style='mso-spacerun:yes'>    </span>ss4</span></p>
  <p class=a><span lang=EN-US>1008<span style='mso-spacerun:yes'>    </span>ss8</span></p>
  <p class=a><span lang=EN-US>1012<span style='mso-spacerun:yes'>   
  </span>ss12</span></p>
  <p class=a><span lang=EN-US>1016<span style='mso-spacerun:yes'>   
  </span>ss16</span></p>
  <p class=a><span lang=EN-US>1001<span style='mso-spacerun:yes'>    </span>ss1</span></p>
  <p class=a><span lang=EN-US>1005<span style='mso-spacerun:yes'>    </span>ss5</span></p>
  <p class=a><span lang=EN-US>1009<span style='mso-spacerun:yes'>    </span>ss9</span></p>
  <p class=a><span lang=EN-US>1013<span style='mso-spacerun:yes'>   
  </span>ss13</span></p>
  <p class=a><span lang=EN-US>1002<span style='mso-spacerun:yes'>    </span>ss2</span></p>
  <p class=a><span lang=EN-US>1006<span style='mso-spacerun:yes'>    </span>ss6</span></p>
  <p class=a><span lang=EN-US>1010<span style='mso-spacerun:yes'>   
  </span>ss10</span></p>
  <p class=a><span lang=EN-US>1014<span style='mso-spacerun:yes'>   
  </span>ss14</span></p>
  <p class=a><span lang=EN-US>1003<span style='mso-spacerun:yes'>    </span>ss3</span></p>
  <p class=a><span lang=EN-US>1007 <span style='mso-spacerun:yes'>   </span>ss7</span></p>
  <p class=a><span lang=EN-US>1011<span style='mso-spacerun:yes'>   
  </span>ss11</span></p>
  <p class=a><span lang=EN-US>1015<span style='mso-spacerun:yes'>   
  </span>ss15</span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>6.6.2 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>分桶抽样查询</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对于非常大的数据集，有时用户需要使用的是一个具有代表性的查询结果而不是全部结果。</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可以通过对表进行抽样来满足这个需求。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询表</span><span lang=EN-US>stu_buck</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中的数据。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:26.7pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=650 valign=top style='width:389.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; select * from stu_buck
  tablesample(bucket 1 out of 4 on id);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_47"
 o:spid="_x0000_i1180" type="#_x0000_t75" style='width:567pt;height:83.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image049.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_48"
 o:spid="_x0000_i1179" type="#_x0000_t75" style='width:435.6pt;height:184.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image050.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>注：</span><span lang=EN-US>tablesample</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是抽样语句，语法：</span><span lang=EN-US>TABLESAMPLE(BUCKET x OUT OF
y)&nbsp;</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>y</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>必须是</span><span lang=EN-US>table</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>总</span><span lang=EN-US>bucket</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数的倍数或者因子。</span><span lang=EN-US>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>根据</span><span lang=EN-US>y</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的大小，决定抽样的比例。例如，</span><span
lang=EN-US>table</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>总共分了</span><span lang=EN-US>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>份，当</span><span lang=EN-US>y=2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>时，抽取</span><span
lang=EN-US>(4/2=)2</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>个</span><span
lang=EN-US>bucket</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的数据，当</span><span lang=EN-US>y=8</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时，抽取</span><span lang=EN-US>(4/8=)1/2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个</span><span lang=EN-US>bucket</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的数据。（</span><span lang=EN-US>y</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是决定抽多少）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:red'>x</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>表示从哪个</span><span
lang=EN-US style='color:red'>bucket</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>开始抽取，如果需要取多个分区，以后的分区号为当前分区号加上</span><span lang=EN-US
style='color:red'>y</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。例如，</span><span
lang=EN-US>table</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>总</span><span lang=EN-US>bucket</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数为</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span><span
lang=EN-US>tablesample(bucket 1 out of 2)</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，表示总共抽取（</span><span
lang=EN-US>4/2=</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个</span><span lang=EN-US>bucket</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的数据，抽取第</span><span lang=EN-US>1(x)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个和第</span><span lang=EN-US>3(x+y)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个</span><span lang=EN-US>bucket</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的数据。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>注意：</span><span lang=EN-US style='color:red'>x</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>的值必须小于等于</span><span lang=EN-US style='color:red'>y</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>的值，否则</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>FAILED: SemanticException [Error 10061]: Numerator should not be
bigger than denominator in sample clause for table stu_buck</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>x</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>、</span><span
lang=EN-US>y</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span><span lang=EN-US>z</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>z</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是分桶数），抽第一个是</span><span
lang=EN-US>x+y</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，第二次抽</span><span lang=EN-US>x+y+y</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（就是继续加</span><span lang=EN-US>y</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>），最后一个是</span><span lang=EN-US>x+(z/y -1)*y</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，化简就是</span><span lang=EN-US>x+z-y,</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如果</span><span lang=EN-US>x&gt;y</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，则</span><span lang=EN-US>x-y</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>就是大于</span><span
lang=EN-US>0</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，</span><span lang=EN-US>z+</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>大于</span><span lang=EN-US>0</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的数就是超过了分桶数了，所以不能</span><span
lang=EN-US>x&gt;y</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif";color:black'>6.7 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>其他常用查询函数</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif";
color:black'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>6.7.1 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>空字段赋值</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;margin-right:0cm;margin-bottom:0cm;
margin-left:40.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;mso-char-indent-count:
0;mso-list:l16 level1 lfo20'><![if !supportLists]><span lang=EN-US
style='mso-fareast-font-family:Arial'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>函数说明</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>NVL</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>：给值为</span><span lang=EN-US>NULL</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的数据赋值，它的格式是</span><span lang=EN-US>NVL( string1,
replace_with)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。它的功能是如果</span><span lang=EN-US>string1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为</span><span lang=EN-US>NULL</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，则</span><span
lang=EN-US>NVL</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>函数返回</span><span lang=EN-US>replace_with</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的值，否则返回</span><span lang=EN-US>string1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的值，如果两个参数都为</span><span lang=EN-US>NULL </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，则返回</span><span lang=EN-US>NULL</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=1 style='margin-top:6.2pt;margin-right:0cm;margin-bottom:0cm;
margin-left:40.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;mso-char-indent-count:
0;mso-list:l16 level1 lfo20'><![if !supportLists]><span lang=EN-US
style='mso-fareast-font-family:Arial'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>数据准备：采用员工表</span></p>

<p class=1 style='margin-top:6.2pt;margin-right:0cm;margin-bottom:0cm;
margin-left:40.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;mso-char-indent-count:
0;mso-list:l16 level1 lfo20'><![if !supportLists]><span lang=EN-US
style='mso-fareast-font-family:Arial'><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>查询：如果员工的</span><span
lang=EN-US>comm</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>为</span><span lang=EN-US>NULL</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>，则用</span><span
lang=EN-US>-1</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>代替</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
nvl(comm,-1) from emp;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>OK</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>_c0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>20.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>300.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>500.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-1.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>1400.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-1.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-1.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-1.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-1.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>0.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-1.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-1.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-1.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>-1.0</span></p>

<p class=1 style='margin-top:6.2pt;margin-right:0cm;margin-bottom:0cm;
margin-left:40.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;mso-char-indent-count:
0;mso-list:l16 level1 lfo20'><![if !supportLists]><span lang=EN-US
style='mso-fareast-font-family:Arial'><span style='mso-list:Ignore'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>查询：如果员工的</span><span
lang=EN-US>comm</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>为</span><span lang=EN-US>NULL</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>，则用领导</span><span
lang=EN-US>id</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>代替</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
nvl(comm,mgr) from emp;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>OK</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>_c0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>20.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>300.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>500.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>7839.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>1400.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>7839.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>7839.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>7566.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>NULL</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>0.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>7788.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>7698.0</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>7566.0</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>用字段的值来替代</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_49"
 o:spid="_x0000_i1178" type="#_x0000_t75" style='width:435.6pt;height:215.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image051.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_50"
 o:spid="_x0000_i1177" type="#_x0000_t75" style='width:429.6pt;height:220.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image052.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>6.7.2 CASE WHEN<o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1. </span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>数据准备</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=711
 style='width:426.55pt;border-collapse:collapse;border:none;mso-border-top-alt:
 solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>name<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>dept_id<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>sex<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>悟空</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>A<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>男</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>大海</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>A<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>男</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>宋宋</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>B<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>男</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>凤姐</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>A<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>女</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>婷姐</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>B<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>女</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>婷婷</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>B<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>女</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:1.0pt;line-height:
150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>求出不同部门男女各多少人。结果如下：</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>A<span
style='mso-spacerun:yes'>     </span>2<span style='mso-spacerun:yes'>      
</span>1<span style='mso-spacerun:yes'>    </span>// A</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>部门有</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>个男的，</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>个女的</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>B<span
style='mso-spacerun:yes'>     </span>1<span style='mso-spacerun:yes'>      
</span>2<span style='mso-spacerun:yes'>    </span>// B</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>部门有</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>个男的，</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>个女的</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建本地</span><span
lang=EN-US>emp_sex.txt</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>，导入数据</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 datas]$ vi emp_sex.txt</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>悟空</span><span lang=EN-US><span
style='mso-tab-count:1'> </span>A<span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>男</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>大海</span><span lang=EN-US><span
style='mso-tab-count:1'> </span>A<span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>男</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>宋宋</span><span lang=EN-US><span
style='mso-tab-count:1'> </span>B<span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>男</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>凤姐</span><span lang=EN-US><span
style='mso-tab-count:1'> </span>A<span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>女</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>婷姐</span><span lang=EN-US><span
style='mso-tab-count:1'> </span>B<span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>女</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>婷婷</span><span lang=EN-US><span
style='mso-tab-count:1'> </span>B<span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>女</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>表并导入数据</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>create table emp_sex(</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>name string, </span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>dept_id string, </span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>sex string) </span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>row format delimited fields
terminated by &quot;\t&quot;;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>load data local inpath
'/opt/module/datas/emp_sex.txt' into table emp_sex;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．按需求查询数据</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=945
 style='width:20.0cm;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=945 valign=top style='width:20.0cm;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>  </span>dept_id,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>  </span>sum(case sex when '</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>男</span><span lang=EN-US>' then 1 else 0 end) male_count,<span
  style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（当是男的时候为</span><span
  lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>，然后</span><span lang=EN-US>sum</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>最后累加的是</span><span lang=EN-US>1</span><span style='font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>  </span>sum(case sex when '</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>女</span><span lang=EN-US>' then 1 else 0 end) female_count</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>from </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>  </span>emp_sex</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>group by</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>  </span>dept_id;</span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>6.7.2 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>行转列</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．相关函数说明</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US style='color:red'>CONCAT</span><span
lang=EN-US>(string A/col, string B/col</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>…</span><span
lang=EN-US>)</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>：返回输入字符串连接后的结果，支持任意个输入字符串</span><span
lang=EN-US>;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_46"
 o:spid="_x0000_i1176" type="#_x0000_t75" style='width:457.2pt;height:186.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image053.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_51"
 o:spid="_x0000_i1175" type="#_x0000_t75" style='width:486.6pt;height:96pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image054.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>即拼接一行数据中的多个字段。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US style='color:red'>CONCAT_WS</span><span
lang=EN-US>(separator, str1, str2,...)</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：它是一个特殊形式的</span><span
lang=EN-US> CONCAT()</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。第一个参数剩余参数间的分隔符。分隔符可以是与剩余参数一样的字符串。如果分隔符是</span><span
lang=EN-US> NULL</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，返回值也将为</span><span lang=EN-US> NULL</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。这个函数会跳过分隔符参数后的任何</span><span lang=EN-US> NULL </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和空字符串。分隔符将被加到被连接的字符串之间</span><span lang=EN-US>;</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（字段必须是</span><span lang=EN-US>String</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类型）</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_52"
 o:spid="_x0000_i1174" type="#_x0000_t75" style='width:346.2pt;height:167.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image055.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_53"
 o:spid="_x0000_i1173" type="#_x0000_t75" style='width:481.8pt;height:189.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image056.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US>COLLECT_SET(col)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：函数只接受基本数据类型，它的主要作用是将某字段的值进行去重汇总，产生</span><span lang=EN-US>array</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类型字段。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_54"
 o:spid="_x0000_i1172" type="#_x0000_t75" style='width:566.4pt;height:237pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image057.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_55"
 o:spid="_x0000_i1171" type="#_x0000_t75" style='width:567pt;height:17.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image058.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>部门名称</span><span lang=EN-US>dname</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>本来是四行数据，现在变成了一行了。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_56"
 o:spid="_x0000_i1170" type="#_x0000_t75" style='width:429.6pt;height:61.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image059.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>dname</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>本来是这样子的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_57"
 o:spid="_x0000_i1169" type="#_x0000_t75" style='width:97.2pt;height:79.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image060.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b><span style='font-size:18.0pt;mso-bidi-font-size:20.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>先热身</span></b><b><span lang=EN-US style='font-size:18.0pt;
mso-bidi-font-size:20.0pt'><o:p></o:p></span></b></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_58"
 o:spid="_x0000_i1168" type="#_x0000_t75" style='width:139.8pt;height:81pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image061.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>经过</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_59"
 o:spid="_x0000_i1167" type="#_x0000_t75" style='width:360.6pt;height:18.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image062.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>得到</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_60"
 o:spid="_x0000_i1166" type="#_x0000_t75" style='width:183pt;height:76.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image063.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>示例：创建表</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_61"
 o:spid="_x0000_i1165" type="#_x0000_t75" style='width:333.6pt;height:63pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image064.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US>load</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_62"
 o:spid="_x0000_i1164" type="#_x0000_t75" style='width:498pt;height:21.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image065.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>原始数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_63"
 o:spid="_x0000_i1163" type="#_x0000_t75" style='width:529.2pt;height:100.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image066.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>执行</span><span lang=EN-US>sql</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_64"
 o:spid="_x0000_i1162" type="#_x0000_t75" style='width:566.4pt;height:112.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image067.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>然后从这个</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_65"
 o:spid="_x0000_i1161" type="#_x0000_t75" style='width:202.2pt;height:87pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image068.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>想得到这个</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_66"
 o:spid="_x0000_i1160" type="#_x0000_t75" style='width:269.4pt;height:61.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image069.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这样子就可以得到</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_67"
 o:spid="_x0000_i1159" type="#_x0000_t75" style='width:261.6pt;height:175.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image070.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>把</span><span lang=EN-US>t1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表写进去</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_68"
 o:spid="_x0000_i1158" type="#_x0000_t75" style='width:323.4pt;height:140.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image071.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>得到的结果，就差去掉数组了</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_69"
 o:spid="_x0000_i1157" type="#_x0000_t75" style='width:324pt;height:95.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image072.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>加上这个即可去掉数组</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_70"
 o:spid="_x0000_i1156" type="#_x0000_t75" style='width:395.4pt;height:222pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image073.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>执行的结果，这也是最终的结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_71"
 o:spid="_x0000_i1155" type="#_x0000_t75" style='width:222.6pt;height:79.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image074.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．数据准备</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>6-6 </span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据准备</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=711
 style='width:426.55pt;border-collapse:collapse;border:none;mso-border-top-alt:
 solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>name<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>constellation<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>blood_type<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>孙悟空</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>白羊座</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>A<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>大海</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>射手座</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>A<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>宋宋</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>白羊座</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>B<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>猪八戒</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>白羊座</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>A<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>凤姐</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>射手座</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>A<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:10.5pt;mso-char-indent-count:
1.0;line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>把星座和血型一样的人归类到一起。结果如下：</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>射手座</span><span lang=EN-US>,A<span
style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>大海</span><span
lang=EN-US>|</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>凤姐</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>白羊座</span><span lang=EN-US>,A<span
style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>孙悟空</span><span
lang=EN-US>|</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>猪八戒</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>白羊座</span><span lang=EN-US>,B<span
style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>    </span><span style='mso-spacerun:yes'> </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>宋宋</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建本地</span><span
lang=EN-US>constellation.txt</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>，导入数据</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 datas]$ vi
constellation.txt</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>孙悟空</span><span lang=EN-US><span
style='mso-tab-count:1'>    </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>白羊座</span><span
lang=EN-US><span style='mso-tab-count:1'>    </span>A</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>大海</span><span lang=EN-US><span
style='mso-tab-count:1'> </span> <span style='mso-spacerun:yes'>    </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>射手座</span><span lang=EN-US><span style='mso-tab-count:1'> </span>A</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>宋宋</span><span lang=EN-US><span
style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'>     </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>白羊座</span><span lang=EN-US><span style='mso-tab-count:1'> </span>B</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>猪八戒</span><span lang=EN-US><span
style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>白羊座</span><span
lang=EN-US><span style='mso-tab-count:1'> </span>A</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>凤姐</span><span lang=EN-US><span
style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'>     </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>射手座</span><span lang=EN-US><span style='mso-tab-count:1'> </span>A</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>表并导入数据</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>create table person_info(</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>name string, </span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>constellation string, </span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>blood_type string) </span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>row format delimited fields
terminated by &quot;\t&quot;;</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>load data local inpath </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>“</span><span lang=EN-US>/opt/module/datas/person_info.txt</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>”</span> <span lang=EN-US>into table person_info;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>6</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．按需求查询数据</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>t1.base,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>concat_ws('|', collect_set(t1.name)) name</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>from</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>(select</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>        </span>name,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>        </span>concat(constellation, &quot;,&quot;,
  blood_type) base</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>from</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>        </span>person_info) t1</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>group by</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>t1.base;</span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>6.7.3 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>列转行</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．函数说明</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>EXPLODE(col)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>：将</span><span lang=EN-US style='color:black'>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>一列中复杂的</span><span lang=EN-US style='color:black'>array</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>或者</span><span lang=EN-US style='color:black'>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>结构拆分成多行。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><a name="OLE_LINK21"></a><a
name="OLE_LINK20"><span style='mso-bookmark:OLE_LINK21'><span lang=EN-US>LATERAL
VIEW</span></span></a></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>用法：</span><span lang=EN-US style='color:black'>LATERAL
VIEW udtf(expression) tableAlias AS columnAlias<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>解释：用于和</span><span lang=EN-US style='color:black'>split,
explode</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>等</span><span lang=EN-US
style='color:black'>UDTF</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>一起使用，它能够将一列数据拆成多行数据，在此基础上可以对拆分后的数据进行聚合。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．数据准备</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>6-7 </span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据准备</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-top-alt:
 solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:17.0pt'>
  <td width="50%" style='width:50.0%;border:solid windowtext 1.0pt;border-left:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  mso-border-right-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>movie<o:p></o:p></span></p>
  </td>
  <td width="50%" style='width:50.0%;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>category<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;height:17.0pt'>
  <td width="50%" style='width:50.0%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>《疑犯追踪》</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width="50%" style='width:50.0%;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>悬疑</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>,</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>动作</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>,</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>科幻</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>,</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>剧情</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;height:17.0pt'>
  <td width="50%" style='width:50.0%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>《</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>Lie
  to me</span><span style='font-size:7.5pt;line-height:150%;font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:
  Calibri'>》</span><span lang=EN-US style='font-size:7.5pt;line-height:150%;
  font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width="50%" style='width:50.0%;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>悬疑</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>,</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>警匪</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>,</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>动作</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>,</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>心理</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>,</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>剧情</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes;height:17.0pt'>
  <td width="50%" style='width:50.0%;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:17.0pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>《战狼</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>2</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>》</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width="50%" style='width:50.0%;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:17.0pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>战争</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>,</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>动作</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>,</span><span
  style='font-size:7.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>灾难</span><span
  lang=EN-US style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='margin-left:39.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>将电影分类中的数组数据展开。结果如下：</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《疑犯追踪》</span><span
lang=EN-US><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>悬疑</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《疑犯追踪》</span><span
lang=EN-US><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>动作</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《疑犯追踪》</span><span
lang=EN-US><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>科幻</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《疑犯追踪》</span><span
lang=EN-US><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>剧情</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《</span><span lang=EN-US>Lie
to me</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>》</span><span lang=EN-US><span
style='mso-spacerun:yes'>   </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>悬疑</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《</span><span lang=EN-US>Lie
to me</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>》</span><span lang=EN-US><span
style='mso-spacerun:yes'>   </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>警匪</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《</span><span lang=EN-US>Lie
to me</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>》</span><span lang=EN-US><span
style='mso-spacerun:yes'>   </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>动作</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《</span><span lang=EN-US>Lie
to me</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>》</span><span lang=EN-US><span
style='mso-spacerun:yes'>   </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>心理</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《</span><span lang=EN-US>Lie
to me</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>》</span><span lang=EN-US><span
style='mso-spacerun:yes'>   </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>剧情</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《战狼</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>》</span><span lang=EN-US><span style='mso-spacerun:yes'>      
</span><span style='mso-spacerun:yes'> </span></span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>战争</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《战狼</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>》</span><span lang=EN-US><span style='mso-spacerun:yes'>      
</span><span style='mso-spacerun:yes'> </span></span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>动作</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《战狼</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>》</span><span lang=EN-US><span style='mso-spacerun:yes'>      
</span><span style='mso-spacerun:yes'> </span></span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>灾难</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建本地</span><span
lang=EN-US>movie.txt</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>，导入数据</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 datas]$ vi
movie.txt</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《疑犯追踪》</span><span
lang=EN-US><span style='mso-tab-count:1'>    </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>悬疑</span><span lang=EN-US>,</span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>动作</span><span
lang=EN-US>,</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>科幻</span><span lang=EN-US>,</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>剧情</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《</span><span lang=EN-US>Lie
to me</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>》</span><span lang=EN-US><span
style='mso-tab-count:1'>  </span></span><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>悬疑</span><span lang=EN-US>,</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>警匪</span><span lang=EN-US>,</span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>动作</span><span
lang=EN-US>,</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>心理</span><span lang=EN-US>,</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>剧情</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>《战狼</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>》</span><span lang=EN-US><span style='mso-tab-count:1'>  </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>战争</span><span lang=EN-US>,</span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>动作</span><span
lang=EN-US>,</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>灾难</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>表并导入数据</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table movie_info(</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>movie string, </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>category array&lt;string&gt;) </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>row format delimited fields
  terminated by &quot;\t&quot;</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>collection items terminated
  by &quot;,&quot;;</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>load data local inpath
  &quot;/opt/module/datas/movie.txt&quot; into table movie_info;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>EXPLODE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>是这样的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_73"
 o:spid="_x0000_i1154" type="#_x0000_t75" style='width:518.4pt;height:243pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image075.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>想直接关联</span><span lang=EN-US>movie</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>字段，然后炸裂是不行的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_74"
 o:spid="_x0000_i1153" type="#_x0000_t75" style='width:567.6pt;height:57pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image076.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_75"
 o:spid="_x0000_i1152" type="#_x0000_t75" style='width:567pt;height:88.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image077.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>测写</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_76"
 o:spid="_x0000_i1151" type="#_x0000_t75" style='width:566.4pt;height:273pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image078.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_77"
 o:spid="_x0000_i1150" type="#_x0000_t75" style='width:566.4pt;height:81.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image079.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>写</span><span lang=EN-US>sql</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的步骤</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_78"
 o:spid="_x0000_i1149" type="#_x0000_t75" style='width:424.8pt;height:52.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image080.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_79"
 o:spid="_x0000_i1148" type="#_x0000_t75" style='width:261pt;height:66.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image081.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_80"
 o:spid="_x0000_i1147" type="#_x0000_t75" style='width:478.8pt;height:110.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image082.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>最终结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_81"
 o:spid="_x0000_i1146" type="#_x0000_t75" style='width:567pt;height:238.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image083.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>6</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．按需求查询数据</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>movie,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>category_name</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>from </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>movie_info lateral view explode(category)
  table_tmp as category_name;</span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>6.7.4 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>窗口函数</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．相关函数说明</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>OVER()</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>：指定分析函数工作的数据窗口大小，这个数据窗口大小可能会随着行的变而变化</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US>CURRENT ROW</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：当前行</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US>n PRECEDING</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：往前</span><span
lang=EN-US>n</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US>n FOLLOWING</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：往后</span><span
lang=EN-US>n</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行数据</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>UNBOUNDED</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：起点，</span><span
lang=EN-US>UNBOUNDED PRECEDING </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表示从前面的起点，</span><span
lang=EN-US> UNBOUNDED FOLLOWING</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表示到后面的终点</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US>LAG(col,n)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：往前第</span><span
lang=EN-US>n</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US>LEAD(col,n)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：往后第</span><span
lang=EN-US>n</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>行数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span lang=EN-US>NTILE(n)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：把有序分区中的行分发到指定数据的组中，各个组有编号，编号从</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>开始，对于每一行，</span><span lang=EN-US>NTILE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>返回此行所属的组的编号。<span style='color:red'>注意：</span></span><span
lang=EN-US style='color:red'>n</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>必须为</span><span
lang=EN-US style='color:red'>int</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>类型。</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>解析</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_82"
 o:spid="_x0000_i1145" type="#_x0000_t75" style='width:315pt;height:34.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image084.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_83"
 o:spid="_x0000_i1144" type="#_x0000_t75" style='width:147pt;height:77.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image085.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_84"
 o:spid="_x0000_i1143" type="#_x0000_t75" style='width:567pt;height:70.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image086.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>看下原始数据、需求</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_72"
 o:spid="_x0000_i1142" type="#_x0000_t75" style='width:390pt;height:281.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image087.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建表</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_85"
 o:spid="_x0000_i1141" type="#_x0000_t75" style='width:482.4pt;height:122.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image088.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_86"
 o:spid="_x0000_i1140" type="#_x0000_t75" style='width:428.4pt;height:178.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image089.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_87"
 o:spid="_x0000_i1139" type="#_x0000_t75" style='width:278.4pt;height:123.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image090.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分析</span><span lang=EN-US>over()</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_88"
 o:spid="_x0000_i1138" type="#_x0000_t75" style='width:566.4pt;height:124.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image091.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_89"
 o:spid="_x0000_i1137" type="#_x0000_t75" style='width:567pt;height:103.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image092.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_91"
 o:spid="_x0000_i1136" type="#_x0000_t75" style='width:465.6pt;height:75pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image093.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第二个需求（注意中间点是空格），不是最终结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_92"
 o:spid="_x0000_i1135" type="#_x0000_t75" style='width:409.8pt;height:52.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image094.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_93"
 o:spid="_x0000_i1134" type="#_x0000_t75" style='width:366pt;height:61.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image095.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果，但结果并没有按月</span><span lang=EN-US>count</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_94"
 o:spid="_x0000_i1133" type="#_x0000_t75" style='width:430.8pt;height:135.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image096.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>小插曲</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_95"
 o:spid="_x0000_i1132" type="#_x0000_t75" style='width:484.8pt;height:201.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image097.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_96"
 o:spid="_x0000_i1131" type="#_x0000_t75" style='width:567pt;height:60.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image098.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这就是我们要的结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_97"
 o:spid="_x0000_i1130" type="#_x0000_t75" style='width:504.6pt;height:163.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image099.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>或者分区实现</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_98"
 o:spid="_x0000_i1129" type="#_x0000_t75" style='width:567pt;height:73.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image100.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果一样的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_99"
 o:spid="_x0000_i1128" type="#_x0000_t75" style='width:567.6pt;height:197.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image101.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>下一个需求</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_100"
 o:spid="_x0000_i1127" type="#_x0000_t75" style='width:567pt;height:219pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image102.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>先</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_101"
 o:spid="_x0000_i1126" type="#_x0000_t75" style='width:388.8pt;height:31.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image103.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_103"
 o:spid="_x0000_i1125" type="#_x0000_t75" style='width:567.6pt;height:70.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image104.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果，从开始到当前行的</span><span lang=EN-US>cost</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进行</span><span lang=EN-US>sum</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_105"
 o:spid="_x0000_i1124" type="#_x0000_t75" style='width:523.2pt;height:187.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image105.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>看看其他函数</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_104"
 o:spid="_x0000_i1123" type="#_x0000_t75" style='width:567pt;height:146.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image106.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>举个例子</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_106"
 o:spid="_x0000_i1122" type="#_x0000_t75" style='width:566.4pt;height:63pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image107.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_107"
 o:spid="_x0000_i1121" type="#_x0000_t75" style='width:567pt;height:194.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image108.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>再举例子</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_108"
 o:spid="_x0000_i1120" type="#_x0000_t75" style='width:435pt;height:19.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image109.png" o:title=""/>
</v:shape><v:shape id="图片_x0020_109" o:spid="_x0000_i1119" type="#_x0000_t75"
 style='width:111pt;height:16.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image110.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_110"
 o:spid="_x0000_i1118" type="#_x0000_t75" style='width:566.4pt;height:216.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image111.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>再举</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_111"
 o:spid="_x0000_i1117" type="#_x0000_t75" style='width:566.4pt;height:46.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image112.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_112"
 o:spid="_x0000_i1116" type="#_x0000_t75" style='width:567pt;height:190.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image113.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>需求</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_113"
 o:spid="_x0000_i1115" type="#_x0000_t75" style='width:567pt;height:50.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image114.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_114"
 o:spid="_x0000_i1114" type="#_x0000_t75" style='width:566.4pt;height:203.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image115.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这可应用于求页面跳转率</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_115"
 o:spid="_x0000_i1113" type="#_x0000_t75" style='width:567.6pt;height:156.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image116.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>例子，上下条都要</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_117"
 o:spid="_x0000_i1112" type="#_x0000_t75" style='width:567pt;height:44.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image117.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_118"
 o:spid="_x0000_i1111" type="#_x0000_t75" style='width:567pt;height:258.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image118.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>需求</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_119"
 o:spid="_x0000_i1110" type="#_x0000_t75" style='width:238.8pt;height:30pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image119.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_120"
 o:spid="_x0000_i1109" type="#_x0000_t75" style='width:566.4pt;height:26.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image120.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_121"
 o:spid="_x0000_i1108" type="#_x0000_t75" style='width:567pt;height:211.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image121.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>取</span><span lang=EN-US>1/5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>就是，</span><span lang=EN-US>20%</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>了</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_122"
 o:spid="_x0000_i1107" type="#_x0000_t75" style='width:566.4pt;height:57.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image122.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_123"
 o:spid="_x0000_i1106" type="#_x0000_t75" style='width:567pt;height:73.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image123.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_124"
 o:spid="_x0000_i1105" type="#_x0000_t75" style='width:567pt;height:101.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image124.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US>having</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>也不行</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_125"
 o:spid="_x0000_i1104" type="#_x0000_t75" style='width:567pt;height:25.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image125.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>正确的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_126"
 o:spid="_x0000_i1103" type="#_x0000_t75" style='width:567pt;height:91.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image126.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_127"
 o:spid="_x0000_i1102" type="#_x0000_t75" style='width:496.2pt;height:109.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image127.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．数据准备：</span><span
lang=EN-US>name</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>人名，</span><span lang=EN-US>orderdate</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>时间，</span><span
lang=EN-US>cost</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>花费</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>jack,2017-01-01,10</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>tony,2017-01-02,15</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>jack,2017-02-03,23</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>tony,2017-01-04,29</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>jack,2017-01-05,46</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>jack,2017-04-06,42</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>tony,2017-01-07,50</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>jack,2017-01-08,55</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mart,2017-04-08,62</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mart,2017-04-09,68</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>neil,2017-05-10,12</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mart,2017-04-11,75</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>neil,2017-06-12,80</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>mart,2017-04-13,94</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:0cm;line-height:150%;
mso-list:l14 level1 lfo3'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（1）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询在</span><span lang=EN-US>2017</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>年</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>月份购买过的顾客及总人数</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:0cm;line-height:150%;
mso-list:l14 level1 lfo3'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（2）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询顾客的购买明细及月购买总额</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:0cm;line-height:150%;
mso-list:l14 level1 lfo3'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（3）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上述的场景</span><span lang=EN-US>,</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>要将</span><span
lang=EN-US>cost</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>按照日期进行累加</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:0cm;line-height:150%;
mso-list:l14 level1 lfo3'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（4）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询顾客上次的购买时间</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:0cm;line-height:150%;
mso-list:l14 level1 lfo3'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（5）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询前</span><span lang=EN-US>20%</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>时间的订单信息</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建本地</span><span
lang=EN-US>business.txt</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>，导入数据</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 datas]$ vi
business.txt</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>表并导入数据</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table business(</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>name string, </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>orderdate string,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>cost int</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>) ROW FORMAT DELIMITED FIELDS
  TERMINATED BY ',';</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>load data local inpath
  &quot;/opt/module/datas/business.txt&quot; into table business;</span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>6</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．按需求查询数据</span></p>

<p class=MsoNormal style='margin-left:0cm;text-indent:21.0pt;line-height:150%;
mso-list:l3 level1 lfo5'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（1）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询在</span><span lang=EN-US>2017</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>年</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>月份购买过的顾客及总人数</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select name,count(*) over () </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>from business </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>where
  substring(orderdate,1,7) = '2017-04' </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>group by name;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:0cm;text-indent:21.0pt;line-height:150%;
mso-list:l3 level1 lfo5'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（2）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询顾客的购买明细及月购买总额</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select
  name,orderdate,cost,sum(cost) over(partition by month(orderdate)) from</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>business;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:0cm;text-indent:21.0pt;line-height:150%;
mso-list:l3 level1 lfo5'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（3）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上述的场景</span><span lang=EN-US>,</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>要将</span><span
lang=EN-US>cost</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>按照日期进行累加</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select name,orderdate,cost, </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>sum(cost) over() as
  sample1,--</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>所有行相加</span><span lang=EN-US> </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>sum(cost) over(partition by
  name) as sample2,--</span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>按</span><span lang=EN-US>name</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>分组，组内数据相加</span><span lang=EN-US> </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>sum(cost) over(partition by
  name order by orderdate) as sample3,--</span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>按</span><span
  lang=EN-US>name</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>分组，组内数据累加</span><span lang=EN-US> </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>sum(cost) over(partition by
  name order by orderdate rows between UNBOUNDED PRECEDING and current row ) as
  sample4 ,--</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>和</span><span lang=EN-US>sample3</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>一样</span><span lang=EN-US>,</span><span style='font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>由起点到当前行的聚合</span><span
  lang=EN-US> </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>sum(cost) over(partition by
  name order by orderdate rows between 1 PRECEDING and current row) as sample5,
  --</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>当前行和前面一行做聚合</span> </p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>sum(cost) over(partition by
  name order by orderdate rows between 1 PRECEDING AND 1 FOLLOWING ) as
  sample6,--</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>当前行和前边一行及后面一行</span><span lang=EN-US> </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>sum(cost) over(partition by
  name order by orderdate rows between current row and UNBOUNDED FOLLOWING ) as
  sample7 --</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>当前行及后面所有行</span><span lang=EN-US> </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>from business;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:0cm;text-indent:21.0pt;line-height:150%;
mso-list:l3 level1 lfo5'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（4）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查看顾客上次的购买时间</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select name,orderdate,cost, </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>lag(orderdate,1,'1900-01-01')
  over(partition by name order by orderdate ) as time1, lag(orderdate,2) over
  (partition by name order by orderdate) as time2 </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>from business;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:0cm;text-indent:21.0pt;line-height:150%;
mso-list:l3 level1 lfo5'><![if !supportLists]><span lang=EN-US
style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>（5）</span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>查询前</span><span lang=EN-US>20%</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>时间的订单信息</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select * from (</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>   </span><span
  style='mso-spacerun:yes'> </span>select name,orderdate,cost, ntile(5)
  over(order by orderdate) sorted</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>from business</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>) t</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>where sorted = 1;</span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;color:black'>6.7.5 Rank<o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．函数说明</span></p>

<p class=MsoNormal align=left style='margin-top:7.5pt;margin-right:0cm;
margin-bottom:7.5pt;margin-left:21.0pt;mso-para-margin-top:7.5pt;mso-para-margin-right:
0cm;mso-para-margin-bottom:7.5pt;mso-para-margin-left:2.0gd;text-align:left;
mso-pagination:widow-orphan;background:white'><span lang=EN-US>RANK() </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>排序相同时会重复，总数不会变</span></p>

<p class=MsoNormal align=left style='margin-top:7.5pt;margin-right:0cm;
margin-bottom:7.5pt;margin-left:21.0pt;mso-para-margin-top:7.5pt;mso-para-margin-right:
0cm;mso-para-margin-bottom:7.5pt;mso-para-margin-left:2.0gd;text-align:left;
mso-pagination:widow-orphan;background:white'><span lang=EN-US>DENSE_RANK() </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>排序相同时会重复，总数会减少</span></p>

<p class=MsoNormal align=left style='margin-top:7.5pt;margin-right:0cm;
margin-bottom:7.5pt;margin-left:21.0pt;mso-para-margin-top:7.5pt;mso-para-margin-right:
0cm;mso-para-margin-bottom:7.5pt;mso-para-margin-left:2.0gd;text-align:left;
mso-pagination:widow-orphan;tab-stops:center 207.65pt;background:white'><span
lang=EN-US>ROW_NUMBER() </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>会根据顺序计算</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_128"
 o:spid="_x0000_i1101" type="#_x0000_t75" style='width:491.4pt;height:97.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image128.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这是数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_129"
 o:spid="_x0000_i1100" type="#_x0000_t75" style='width:417.6pt;height:205.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image129.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>rank</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_130"
 o:spid="_x0000_i1099" type="#_x0000_t75" style='width:363.6pt;height:41.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image130.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_131"
 o:spid="_x0000_i1098" type="#_x0000_t75" style='width:567pt;height:181.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image131.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>row_number</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_132"
 o:spid="_x0000_i1097" type="#_x0000_t75" style='width:369.6pt;height:27.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image132.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_133"
 o:spid="_x0000_i1096" type="#_x0000_t75" style='width:503.4pt;height:169.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image133.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>全部显示，这里还没写完</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_134"
 o:spid="_x0000_i1095" type="#_x0000_t75" style='width:413.4pt;height:87pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image134.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-no-proof:yes'>完整的</span><span
lang=EN-US style='mso-no-proof:yes'>sql</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-no-proof:yes'>，排序是为了好分析</span><span lang=EN-US style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_136"
 o:spid="_x0000_i1094" type="#_x0000_t75" style='width:430.2pt;height:97.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image135.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_137"
 o:spid="_x0000_i1093" type="#_x0000_t75" style='width:567pt;height:172.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image136.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．数据准备</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>6-7 </span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据准备</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=711
 style='width:426.55pt;border-collapse:collapse;border:none;mso-border-top-alt:
 solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>name<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>subject<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>score<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>孙悟空</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>语文</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>87<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>孙悟空</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>数学</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>95<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>孙悟空</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>英语</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>68<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>大海</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>语文</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>94<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>大海</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>数学</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>56<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>大海</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>英语</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>84<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>宋宋</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>语文</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>64<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>宋宋</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>数学</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>86<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>宋宋</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>英语</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>84<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>婷婷</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>语文</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>65<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>婷婷</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>数学</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>85<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12;mso-yfti-lastrow:yes;height:19.85pt'>
  <td width=237 valign=top style='width:142.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>婷婷</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span style='font-size:7.5pt;
  line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-bidi-font-family:Calibri'>英语</span><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:19.85pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Calibri","sans-serif"'>78<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='margin-left:39.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>计算每门学科成绩排名。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建本地</span><span
lang=EN-US>movie.txt</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>，导入数据</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[atguigu@hadoop102 datas]$ vi score.txt</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>表并导入数据</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table score(</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>name string,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>subject string, </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>score int) </span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>row format delimited fields
  terminated by &quot;\t&quot;;</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>load data local inpath
  '/opt/module/datas/score.txt' into table score;</span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>6</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．按需求查询数据</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select name,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>subject,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>score,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>rank() over(partition by
  subject order by score desc) rp,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>dense_rank() over(partition
  by subject order by score desc) drp,</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>row_number() over(partition
  by subject order by score desc) rmp</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>from score;</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>name<span
  style='mso-spacerun:yes'>    </span>subject score<span
  style='mso-spacerun:yes'>   </span>rp<span style='mso-spacerun:yes'>     
  </span>drp<span style='mso-spacerun:yes'>     </span>rmp</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>孙悟空</span><span
  lang=EN-US><span style='mso-spacerun:yes'>  </span></span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>数学</span><span lang=EN-US><span style='mso-spacerun:yes'>   
  </span>95<span style='mso-spacerun:yes'>      </span>1<span
  style='mso-spacerun:yes'>       </span>1<span style='mso-spacerun:yes'>      
  </span>1</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>宋宋</span><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>数学</span><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>86<span
  style='mso-spacerun:yes'>      </span>2<span style='mso-spacerun:yes'>      
  </span>2<span style='mso-spacerun:yes'>       </span>2</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>婷婷</span><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>数学</span><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>85<span
  style='mso-spacerun:yes'>      </span>3<span style='mso-spacerun:yes'>      
  </span>3<span style='mso-spacerun:yes'>  </span><span
  style='mso-spacerun:yes'>     </span>3</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>大海</span><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>数学</span><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>56<span
  style='mso-spacerun:yes'>      </span>4<span style='mso-spacerun:yes'>      
  </span>4<span style='mso-spacerun:yes'>       </span>4</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:red'>宋宋</span><span
  lang=EN-US style='color:red'><span style='mso-spacerun:yes'>    </span></span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>英语</span><span lang=EN-US style='color:red'><span
  style='mso-spacerun:yes'>    </span>84<span style='mso-spacerun:yes'>     
  </span>1<span style='mso-spacerun:yes'>       </span>1<span
  style='mso-spacerun:yes'>       </span>1<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:red'>大海</span><span
  lang=EN-US style='color:red'><span style='mso-spacerun:yes'>    </span></span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>英语</span><span lang=EN-US style='color:red'><span
  style='mso-spacerun:yes'>    </span>84<span style='mso-spacerun:yes'>     
  </span>1<span style='mso-spacerun:yes'>       </span>1<span
  style='mso-spacerun:yes'>       </span>2<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:red'>婷婷</span><span
  lang=EN-US style='color:red'><span style='mso-spacerun:yes'>    </span></span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>英语</span><span lang=EN-US style='color:red'><span
  style='mso-spacerun:yes'>    </span>78<span style='mso-spacerun:yes'>     
  </span>3<span style='mso-spacerun:yes'>       </span>2<span
  style='mso-spacerun:yes'>       </span>3<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:red'>孙悟空</span><span
  lang=EN-US style='color:red'><span style='mso-spacerun:yes'>  </span></span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>英语</span><span lang=EN-US style='color:red'><span
  style='mso-spacerun:yes'>    </span>68<span style='mso-spacerun:yes'>     
  </span>4<span style='mso-spacerun:yes'>       </span>3<span
  style='mso-spacerun:yes'>       </span>4<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>大海</span><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>语文</span><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>94<span
  style='mso-spacerun:yes'>      </span>1<span style='mso-spacerun:yes'>      
  </span>1<span style='mso-spacerun:yes'>       </span>1</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>孙悟空</span><span
  lang=EN-US><span style='mso-spacerun:yes'>  </span></span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>语文</span><span lang=EN-US><span style='mso-spacerun:yes'>   
  </span>87<span style='mso-spacerun:yes'>      </span>2<span
  style='mso-spacerun:yes'>  </span><span
  style='mso-spacerun:yes'>     </span>2<span style='mso-spacerun:yes'>      
  </span>2</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>婷婷</span><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>语文</span><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>65<span
  style='mso-spacerun:yes'>      </span>3<span style='mso-spacerun:yes'>      
  </span>3<span style='mso-spacerun:yes'>       </span>3</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>宋宋</span><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>语文</span><span
  lang=EN-US><span style='mso-spacerun:yes'>    </span>64<span
  style='mso-spacerun:yes'>      </span>4<span style='mso-spacerun:yes'>      
  </span>4<span style='mso-spacerun:yes'>       </span>4</span></p>
  </td>
 </tr>
</table>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>7</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> </span><span style='font-size:15.0pt;line-height:240%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数</span><span lang=EN-US style='font-size:15.0pt;
line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:150%'><span lang=EN-US
style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'>7.1
</span><span style='font-size:14.0pt;line-height:150%;font-family:黑体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>系统内置函数</span><span
lang=EN-US style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看系统自带的函数</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive&gt; show functions;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．显示自带的函数的用法</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive&gt; desc function upper; </span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（</span><span
lang=EN-US>upper</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>是具体的函数名）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．详细显示自带的函数的用法</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive&gt; desc function extended upper; </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（有例子）</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:150%'><span lang=EN-US
style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'>7.2
</span><span style='font-size:14.0pt;line-height:150%;font-family:黑体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>自定义函数</span><span
lang=EN-US style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US>1</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>Hive </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>自带了一些函数，比如：</span><span lang=EN-US>max/min</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>等，但是数量有限，自己可以通过自定义</span><span lang=EN-US>UDF</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>来方便的扩展。</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US>2</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）当</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>提供的内置函数无法满足你的业务处理需要时，此时就可以考虑使用用户自定义函数（</span><span
lang=EN-US>UDF</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>：</span><span lang=EN-US>user-defined
function</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）。</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US>3</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）根据用户自定义函数类别分为以下三种：</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US style='color:red'><span style='mso-tab-count:
1'>   </span></span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>（</span><span lang=EN-US
style='color:red'>1</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>）</span><span
lang=EN-US style='color:red'>UDF</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>（</span><span
lang=EN-US style='color:red'>User-Defined-Function</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>）</span><span style='color:red'> </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>这个用的多。</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US><span style='mso-tab-count:2'>          </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>一进一出（给一条数据就返回一条数据）</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US><span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>UDAF</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>User-Defined
Aggregation Function</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US><span style='mso-tab-count:2'>          </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>聚集函数，多进一出</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US><span style='mso-tab-count:2'>          </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类似于：</span><span lang=EN-US>count/max/min/sum</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US><span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>UDTF</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>User-Defined
Table-Generating Functions</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US><span style='mso-tab-count:2'>          </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>一进多出</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US><span style='mso-tab-count:2'>          </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如</span><span lang=EN-US>lateral view explore()</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US>4</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）官方文档地址</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
text-indent:21.0pt;line-height:150%'><span lang=EN-US>https://cwiki.apache.org/confluence/display/Hive/HivePlugins</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US>5</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编程步骤：</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US style='color:red'><span style='mso-tab-count:
1'>   </span></span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>（</span><span lang=EN-US
style='color:red'>1</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>）继承</span><span
lang=EN-US style='color:red'>org.apache.hadoop.hive.ql.UDF<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US style='color:red'><span style='mso-tab-count:
1'>   </span></span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>（</span><span lang=EN-US
style='color:red'>2</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>）需要实现</span><span
lang=EN-US style='color:red'>evaluate</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>函数（可以不加</span><span lang=EN-US style='color:red'>override</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>）；</span><span lang=EN-US style='color:red'>evaluate</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>函数支持重载；</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US style='color:red'><span style='mso-tab-count:
1'>   </span></span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>（</span><span lang=EN-US
style='color:red'>3</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>）在</span><span
lang=EN-US style='color:red'>hive</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>的命令行窗口创建函数</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:16.5pt'><span lang=EN-US style='color:red'><span style='mso-tab-count:
2'>          </span>a</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>）添加</span><span
lang=EN-US style='color:red'>jar<o:p></o:p></span></p>

<p class=a style='margin-left:57.75pt;mso-para-margin-left:5.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><a name="OLE_LINK37"></a><a name="OLE_LINK36"></a><a
name="OLE_LINK35"><span style='mso-bookmark:OLE_LINK36'><span style='mso-bookmark:
OLE_LINK37'><span lang=EN-US>add jar</span></span></span></a><span lang=EN-US>
linux_jar_path</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:16.5pt'><span lang=EN-US style='color:red'><span style='mso-tab-count:
2'>          </span>b</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>）创建</span><span
lang=EN-US style='color:red'>function</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>，（加了</span><span lang=EN-US style='color:red'>temporary</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>就是临时的，关了窗口函数就没了）</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<p class=a style='margin-left:57.75pt;mso-para-margin-left:5.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>create [temporary] function
[dbname.]function_name AS class_name;</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:16.5pt'><span lang=EN-US><span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）在</span><span
lang=EN-US>hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的命令行窗口删除函数</span></p>

<p class=a style='margin-left:42.0pt;mso-para-margin-left:4.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Drop [temporary] function [if
exists] [dbname.]function_name;</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US>6</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）注意事项</span></p>

<p class=MsoNormal style='margin-left:10.5pt;mso-para-margin-left:1.0gd;
line-height:150%'><span lang=EN-US><span style='mso-tab-count:1'>   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>UDF</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>必须要有返回类型，可以返回</span><span lang=EN-US>null</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，但是返回类型不能为</span><span lang=EN-US>void</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（这是没有返回）；</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>7.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>自定义</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>UDF</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建一个</span><span
lang=EN-US>Maven</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>工程</span><span lang=EN-US>Hive</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．导入依赖</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>&lt;dependencies&gt;</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
  2'>       </span>&lt;!--
  https://mvnrepository.com/artifact/org.apache.hive/hive-exec --&gt;</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
  2'>       </span>&lt;dependency&gt;</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
  3'>           </span>&lt;groupId&gt;org.apache.hive&lt;/groupId&gt;</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
  3'>           </span>&lt;artifactId&gt;hive-exec&lt;/artifactId&gt;</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
  3'>           </span>&lt;version&gt;1.2.1&lt;/version&gt;</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
  2'>       </span>&lt;/dependency&gt;</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>&lt;/dependencies&gt;</span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建一个类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><a
  name="_Hlk510344338"><span lang=EN-US>package com.atguigu.hive;</span></a></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US>import
  org.apache.hadoop.hive.ql.exec.UDF;</span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US>public class Lower
  extends UDF {</span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US><span style='mso-tab-count:
  1'>   </span>public String evaluate (final String s) {</span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US><span style='mso-tab-count:
  2'>        </span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US><span style='mso-tab-count:
  2'>        </span>if (s == null) {</span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US><span style='mso-tab-count:
  3'>            </span>return null;</span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US><span style='mso-tab-count:
  2'>        </span>}</span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US><span style='mso-tab-count:
  2'>        </span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510344338'><span lang=EN-US><span style='mso-tab-count:
  2'>        </span>return s.toLowerCase(); // </span></span><span
  style='mso-bookmark:_Hlk510344338'><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>转小写</span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510344338'><span
  lang=EN-US><span style='mso-tab-count:1'>   </span>}</span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510344338'><span
  lang=EN-US>}<b><o:p></o:p></b></span></span></p>
  </td>
  <span style='mso-bookmark:_Hlk510344338'></span>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Hlk510344338'><span lang=EN-US>4</span></span><span style='mso-bookmark:_Hlk510344338'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．打成</span><span
lang=EN-US>jar</span></span><span style='mso-bookmark:_Hlk510344338'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>包上传到服务器</span><span
lang=EN-US>/opt/module/jars/udf.jar</span></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Hlk510344338'><span lang=EN-US>5</span></span><span style='mso-bookmark:_Hlk510344338'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．将</span><span
lang=EN-US>jar</span></span><span style='mso-bookmark:_Hlk510344338'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>包添加到</span><span
lang=EN-US>hive</span></span><span style='mso-bookmark:_Hlk510344338'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>的</span><span
lang=EN-US>classpath</span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510344338'><span
lang=EN-US>hive (default)&gt; add jar /opt/module/datas/udf.jar;</span></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Hlk510344338'><span lang=EN-US>6</span></span><span style='mso-bookmark:_Hlk510344338'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建临时函数与开发好的</span><span
lang=EN-US>java class</span></span><span style='mso-bookmark:_Hlk510344338'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>关联</span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510344338'><span
lang=EN-US>hive (default)&gt; create temporary function mylower as
&quot;com.atguigu.hive.Lower&quot;;</span></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Hlk510344338'><span lang=EN-US>7</span></span><span style='mso-bookmark:_Hlk510344338'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．即可在</span><span
lang=EN-US>hql</span></span><span style='mso-bookmark:_Hlk510344338'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>中使用自定义的函数</span><span
lang=EN-US>strip&nbsp;</span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510344338'><span
lang=EN-US>hive (default)&gt; select ename, mylower(ename) lowername from emp;</span></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>8</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> </span><span style='font-size:15.0pt;line-height:240%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>压缩和存储</span><span lang=EN-US style='font-size:15.0pt;
line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>8.1 Hadoop</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>源码编译支持</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>Snappy</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>压缩</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>8.1.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>资源准备</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>CentOS</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>联网</span><span lang=EN-US> </span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span style='font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#333333'>配置</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;color:#333333'>CentOS</span><span style='font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333'>能连接外网。</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;color:#333333'>Linux</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:#333333'>虚拟机</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:#333333'>ping </span><span
lang=EN-US><a href="http://www.baidu.com"><span style='font-size:10.5pt;
line-height:150%'>www.baidu.com</span></a></span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;color:#333333'> </span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:#333333'>是畅通的</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:#333333'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span style='font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#333333'>注意：</span><span style='font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>采用</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;color:red'>root</span><span style='font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>角色编译</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:#333333'>，减少文件夹权限出现问题</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:#333333'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>jar</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>包准备</span><span lang=EN-US>(hadoop</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>源码、</span><span
lang=EN-US>JDK8 </span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>、</span><span lang=EN-US>maven</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>、</span><span
lang=EN-US>protobuf)</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span style='font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#333333'>（</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;color:#333333'>1</span><span style='font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333'>）</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;color:#333333'>hadoop-2.7.2-src.tar.gz<o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span style='font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#333333'>（</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;color:#333333'>2</span><span style='font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333'>）</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;color:#333333'>jdk-8u144-linux-x64.tar.gz<o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span style='font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#333333'>（</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;color:#333333'>3</span><span style='font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333'>）</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;color:#333333'>snappy-1.1.3.tar.gz<o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span style='font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#333333'>（</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;color:#333333'>4</span><span style='font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333'>）</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;color:#333333'>apache-maven-3.0.5-bin.tar.gz<o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span style='font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#333333'>（</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;color:#333333'>5</span><span style='font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333'>）</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;color:#333333'>protobuf-2.5.0.tar.gz<o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>8.1.2 jar</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>包安装</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>注意：所有操作必须在</span><span
lang=EN-US style='color:red'>root</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>用户下完成</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>JDK</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>解压、配置环境变量</span><span lang=EN-US>JAVA_HOME</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>和</span><span
lang=EN-US>PATH</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>，验证</span><span lang=EN-US><a
href="http://lib.csdn.net/base/javase" target="_blank" title="Java SE知识库"><span
style='font-family:"Times New Roman","serif"'>java</span></a>-version(</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>如下都需要验证是否配置成功</span><span
lang=EN-US>)</span></p>

<p class=a><span lang=EN-US>[root@hadoop101 software] # tar -zxf
jdk-8u144-linux-x64.tar.gz -C /opt/module/</span></p>

<p class=a><span lang=EN-US>[root@hadoop101 software]# vi /etc/profile</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:-.3pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>#JAVA_HOME</span></p>
  <p class=a><span lang=EN-US>export JAVA_HOME=/opt/module/jdk1.8.0_144</span></p>
  <p class=a><span lang=EN-US>export PATH=$PATH:$JAVA_HOME/bin</span><span
  lang=EN-US style='mso-bidi-font-size:10.5pt;color:#333333'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=a><span lang=EN-US>[root@hadoop101 software]#source /etc/profile</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#00B0F0'>验证命令：</span><span lang=EN-US style='color:
#00B0F0'>java -version<o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Maven</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>解压、配置</span><span lang=EN-US> &nbsp;MAVEN_HOME</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>和</span><span
lang=EN-US>PATH</span></p>

<p class=a><span lang=EN-US>[root@hadoop101 software]# tar -zxvf
apache-maven-3.0.5-bin.tar.gz -C /opt/module/</span></p>

<p class=a><span lang=EN-US>[root@hadoop101 apache-maven-3.0.5]# vi
/etc/profile</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:-.3pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=711 valign=top style='width:426.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>#MAVEN_HOME</span></p>
  <p class=a><span lang=EN-US>export MAVEN_HOME=/opt/module/apache-maven-3.0.5</span></p>
  <p class=a><span lang=EN-US>export PATH=$PATH:$MAVEN_HOME/bin<span
  style='color:#7030A0'><o:p></o:p></span></span></p>
  </td>
 </tr>
</table>

<p class=a><span lang=EN-US>[root@hadoop101 software]#source /etc/profile</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#00B0F0'>验证命令：</span><span lang=EN-US style='color:
#00B0F0'>mvn -version<o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>8.1.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>编译源码</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这是手动自己编译，也可以转到</span><span lang=EN-US>8.6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>直接用编译好的。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．准备编译环境</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# yum
install svn</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# yum
install autoconf automake libtool cmake</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# yum
install ncurses-devel</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# yum
install openssl-devel</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# yum
install gcc*</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．编译安装</span><span
lang=EN-US>snappy</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# tar
-zxvf snappy-1.1.3.tar.gz -C /opt/module/</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 module]# cd
snappy-1.1.3/</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 snappy-1.1.3]#
./configure</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 snappy-1.1.3]#
make</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 snappy-1.1.3]#
make install</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US># </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>查看</span><span lang=EN-US>snappy</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>库文件</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 snappy-1.1.3]#
ls -lh /usr/local/lib |grep snappy</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．编译安装</span><span
lang=EN-US>protobuf</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# tar
-zxvf protobuf-2.5.0.tar.gz -C /opt/module/</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 module]# cd
protobuf-2.5.0/</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 protobuf-2.5.0]#
./configure&nbsp;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101
protobuf-2.5.0]#<span style='mso-spacerun:yes'>  </span>make&nbsp;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101
protobuf-2.5.0]#<span style='mso-spacerun:yes'>  </span>make install</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US># </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>查看</span><span lang=EN-US>protobuf</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>版本以测试是否安装成功</span><span
lang=EN-US><br>
[root@hadoop101 protobuf-2.5.0]# protoc --version</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．编译</span><span
lang=EN-US>hadoop native</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# tar
-zxvf hadoop-2.7.2-src.tar.gz</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# cd
hadoop-2.7.2-src/</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>[root@hadoop101 software]# mvn
clean package -DskipTests -Pdist,native -Dtar -Dsnappy.lib=/usr/local/lib
-Dbundle.snappy</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:21.0pt;
margin-bottom:.0001pt;mso-para-margin-top:0cm;mso-para-margin-right:0cm;
mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;line-height:16.5pt;background:white'><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333;background:white;mso-font-kerning:1.0pt'>执行成功后，</span><span
lang=EN-US style='font-size:10.5pt;color:#333333;background:white;mso-font-kerning:
1.0pt'>/opt/software/hadoop-2.7.2-src/hadoop-dist/target/</span><span
lang=EN-US><a href="http://lib.csdn.net/base/hadoop" target="_blank"
title=Hadoop知识库><span style='font-size:10.5pt;color:#333333;background:white;
mso-font-kerning:1.0pt'>hadoop</span></a></span><span lang=EN-US
style='font-size:10.5pt;color:#333333;background:white;mso-font-kerning:1.0pt'>-2.7.2.tar.gz</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:#333333;background:white;
mso-font-kerning:1.0pt'>即为新生成的支持</span><span lang=EN-US style='font-size:10.5pt;
color:#333333;background:white;mso-font-kerning:1.0pt'>snappy</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:#333333;background:white;
mso-font-kerning:1.0pt'>压缩的二进制安装包。</span><span lang=EN-US style='font-size:
10.5pt;color:#333333;background:white;mso-font-kerning:1.0pt'><o:p></o:p></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:21.0pt;
margin-bottom:.0001pt;mso-para-margin-top:0cm;mso-para-margin-right:0cm;
mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;line-height:150%;background:white'><span lang=EN-US style='font-size:
10.5pt;line-height:150%;color:#333333;background:white;mso-font-kerning:1.0pt'><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>8.2 Hadoop</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>压缩配置</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><a
name="_Toc439079699"><span lang=EN-US style='font-size:14.0pt'>8.2.1 MR</span></a><span
style='mso-bookmark:_Toc439079699'><span style='font-size:14.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>支持的压缩编码</span></span><span
style='mso-bookmark:_Toc439079699'></span><span lang=EN-US style='font-size:
14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>6-8<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=133 valign=top style='width:79.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>压缩格式</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>工具</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>算法</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>文件扩展名</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>是否可切分</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>DEFAULT<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>无</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>DEFAULT<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>.deflate<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>否</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Gzip<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>gzip<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>DEFAULT<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>.gz<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>否</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>bzip2<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>bzip2<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>bzip2<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>.bz2<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>是</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>LZO<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>lzop<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>LZO<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>.lzo<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>是</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Snappy<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>无</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Snappy<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>.snappy<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>否</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;background:white'><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333'>为了支持多种压缩</span><span lang=EN-US
style='font-size:10.5pt;color:#333333'>/</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333'>解压缩算法，</span><span lang=EN-US
style='font-size:10.5pt;color:#333333'>Hadoop</span><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:#333333'>引入了编码</span><span lang=EN-US style='font-size:
10.5pt;color:#333333'>/</span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:#333333'>解码器，如下表所示：</span><span lang=EN-US style='font-size:10.5pt;
color:#333333'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>6-9<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=272 style='width:163.05pt;border:solid windowtext 1.0pt;border-left:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  mso-border-right-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>压缩格式</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>对应的编码</span><span
  style='mso-ansi-language:ZH-CN'>/</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>解码器</span><span style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>DEFLATE<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>org.apache.hadoop.io.compress.DefaultCodec</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>gzip<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>org.apache.hadoop.io.compress.GzipCodec</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>bzip2<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>org.apache.hadoop.io.compress.BZip2Codec</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>LZO<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>com.hadoop.compression.lzo.LzopCodec</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Snappy<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>org.apache.hadoop.io.compress.SnappyCodec</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;background:white'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:#333333'>压缩性能的比较：</span><span
lang=EN-US style='font-size:10.5pt;color:#333333'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>6-10<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=133 valign=bottom style='width:79.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>压缩算法</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=bottom style='width:85.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>原始文件大小</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=bottom style='width:85.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>压缩文件大小</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=bottom style='width:85.25pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>压缩速度</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=126 valign=bottom style='width:75.65pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>解压速度</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>gzip<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>8.3GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>1.8GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>17.5MB/s<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>58MB/s<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>bzip2<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>8.3GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>1.1GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>2.4MB/s<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>9.5MB/s<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>LZO<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>8.3GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>2.9GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>49.3MB/s<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>74.6MB/s<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span lang=EN-US><a href="http://google.github.io/snappy/">http://google.github.io/snappy/</a></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span lang=EN-US>On a single core of a Core i7 processor in
64-bit mode, Snappy <span style='color:red'>compresses</span> at about <span
style='color:red'>250 MB/</span>sec or more and<span style='color:red'>
decompresses</span> at about<span style='color:red'> 500 MB</span>/sec or more.
</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（比较之后</span><span lang=EN-US>snappy</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>好用）</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>8.2.2 </span><span style='font-size:14.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>压缩参数配置</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>要在</span><span
lang=EN-US>Hadoop</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中启用压缩，可以配置如下参数（</span><span
lang=EN-US>mapred-site.xml</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件中）：</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>表</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;
font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>6-11<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=225 valign=top style='width:134.7pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>参数</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=284 valign=top style='width:6.0cm;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>默认值</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=104 valign=top style='width:62.4pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>阶段</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=312 valign=top style='width:187.35pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>建议</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#D0CECE;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>io.compression.codecs<span
  style='mso-spacerun:yes'>   </span></span></p>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>（</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>在</span><span lang=EN-US>core-site.xml</span><span style='font-family:
  宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>中配置</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>）</span></p>
  </td>
  <td width=284 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#D0CECE;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>org.apache.hadoop.io.compress.DefaultCodec,
  org.apache.hadoop.io.compress.GzipCodec,
  org.apache.hadoop.io.compress.BZip2Codec,</span></p>
  <p class=a0><span lang=EN-US>org.apache.hadoop.io.compress.Lz4Codec</span></p>
  </td>
  <td width=104 valign=top style='width:62.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#D0CECE;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>输入压缩</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=312 valign=top style='width:187.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #D0CECE;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Hadoop</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>使用文件扩展名判断是否支持某种编解码器</span><span
  style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#DEEAF6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>mapreduce.map.output.compress<o:p></o:p></span></p>
  </td>
  <td width=284 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#DEEAF6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>false<o:p></o:p></span></p>
  </td>
  <td width=104 valign=top style='width:62.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#DEEAF6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>mapper</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>输出</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=312 valign=top style='width:187.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #DEEAF6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>这个参数设为</span><span
  style='mso-ansi-language:ZH-CN'>true</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>启用压缩</span><span style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#DEEAF6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>mapreduce.map.output.compress.codec</span></p>
  </td>
  <td width=284 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#DEEAF6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>org.apache.hadoop.io.compress.DefaultCodec</span></p>
  </td>
  <td width=104 valign=top style='width:62.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#DEEAF6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>mapper</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>输出</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=312 valign=top style='width:187.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #DEEAF6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>使用</span><span
  style='mso-ansi-language:ZH-CN'>LZO</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>、</span><span style='mso-ansi-language:ZH-CN'>LZ4</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>或</span><span style='mso-ansi-language:ZH-CN'>snappy</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>编解码器在此阶段压缩数据</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>mapreduce.output.fileoutputformat.compress<o:p></o:p></span></p>
  </td>
  <td width=284 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>false<o:p></o:p></span></p>
  </td>
  <td width=104 valign=top style='width:62.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>reducer</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>输出</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=312 valign=top style='width:187.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>这个参数设为</span><span
  style='mso-ansi-language:ZH-CN'>true</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>启用压缩</span><span style='mso-ansi-language:ZH-CN'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>mapreduce.output.fileoutputformat.compress.codec</span></p>
  </td>
  <td width=284 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>org.apache.hadoop.io.compress. DefaultCodec</span></p>
  </td>
  <td width=104 valign=top style='width:62.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>reducer</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>输出</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=312 valign=top style='width:187.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>使用标准工具或者编解码器，如</span><span
  style='mso-ansi-language:ZH-CN'>gzip</span><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-ansi-language:
  ZH-CN'>和</span><span style='mso-ansi-language:ZH-CN'>bzip2<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=225 valign=top style='width:134.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>mapreduce.output.fileoutputformat.compress.type</span></p>
  </td>
  <td width=284 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>RECORD<o:p></o:p></span></p>
  </td>
  <td width=104 valign=top style='width:62.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>reducer</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>输出</span><span style='mso-ansi-language:
  ZH-CN'><o:p></o:p></span></p>
  </td>
  <td width=312 valign=top style='width:187.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #EDEDED;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>SequenceFile</span><span
  style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;mso-ansi-language:ZH-CN'>输出使用的压缩类型：</span><span style='mso-ansi-language:
  ZH-CN'>NONE</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-ansi-language:ZH-CN'>和</span><span
  style='mso-ansi-language:ZH-CN'>BLOCK<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>8.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>开启</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>Map</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>输出阶段压缩</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>开启</span><span
lang=EN-US>map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>输出阶段压缩可以减少</span><span lang=EN-US>job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中</span><span lang=EN-US>map</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>和</span><span
lang=EN-US>Reduce task</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>间数据传输量。具体配置如下：</span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>案例实操：</span><span lang=EN-US><o:p></o:p></span></b></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．开启</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>中间传输数据压缩功能</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt;set
hive.exec.compress.intermediate=true;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．开启</span><span
lang=EN-US>mapreduce</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>中</span><span lang=EN-US>map</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>输出压缩功能</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt;set
mapreduce.map.output.compress=true;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．设置</span><span
lang=EN-US>mapreduce</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>中</span><span lang=EN-US>map</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>输出数据的压缩方式</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt;set mapreduce.map.output.compress.codec=</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>org.apache.hadoop.io.compress.SnappyCodec;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．执行查询语句</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>hive (default)&gt; select count(ename) name from emp; </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（然后去浏览器历史服务看配置文件是否设置了，日志是看不到的）</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>8.4 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>开启</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>Reduce</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>输出阶段压缩</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当</span><span lang=EN-US>Hive</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将输出写入到表中时，输出内容同样可以进行压缩。属性</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>hive.exec.compress.output</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>控制着这个功能。用户可能需要保持默认设置文件中的默认值</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>false</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，这样默认的输出就是非压缩的纯文本文件了。用户可以通过在查询语句或执行脚本中设置这个值为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>true</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，来开启输出结果压缩功能。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例实操：</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></b></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．开启</span><span
lang=EN-US>hive</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>最终输出数据压缩功能</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt;set
hive.exec.compress.output=true;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．开启</span><span
lang=EN-US>mapreduce</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>最终输出数据压缩</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt;set
mapreduce.output.fileoutputformat.compress=true;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．设置</span><span
lang=EN-US>mapreduce</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>最终数据输出压缩方式</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; set
mapreduce.output.fileoutputformat.compress.codec =</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>org.apache.hadoop.io.compress.SnappyCodec;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．设置</span><span
lang=EN-US>mapreduce</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>最终数据输出压缩为块压缩（默认是</span><span lang=EN-US>record</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>，一行行压缩）</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; <a
name="OLE_LINK40"></a><a name="OLE_LINK39"></a><a name="OLE_LINK38"><span
style='mso-bookmark:OLE_LINK39'><span style='mso-bookmark:OLE_LINK40'>set
mapreduce.output.fileoutputformat.compress.type=BLOCK;</span></span></a></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．测试一下输出结果是否是压缩文件</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; insert
overwrite local directory</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>'/opt/module/datas/distribute-result' select *
from emp distribute by deptno sort by empno desc;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>（输出结果是以</span><span
lang=EN-US>.snappy</span><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>后缀的文件）</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>8.5 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件存储格式</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>支持的存储数的格式主要有：</span><span lang=EN-US
style='color:black'>TEXTFILE</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（行存储，默认的）</span><span
lang=EN-US style='color:black'>&nbsp;</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>、</span><span lang=EN-US style='color:black'>SEQUENCEFILE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>、</span><span lang=EN-US style='color:black'>ORC</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>、</span><span lang=EN-US style='color:black'>PARQUET</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>8.5.1 </span><span style='font-size:14.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>列式存储和行式存储</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>不管是哪一种存储，显示在客户端的都是表格的形式。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_16"
 o:spid="_x0000_i1092" type="#_x0000_t75" style='width:406.2pt;height:141.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image137.png" o:title="" croptop="917f"
  cropbottom="4350f" cropright="1444f"/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri'>图</span><span lang=EN-US
style='font-size:9.0pt;font-family:"Calibri","sans-serif"'>6-10 </span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri'>列式存储和行式存储</span><span lang=EN-US
style='font-size:9.0pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>如图</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>6-10</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>所示左边为逻辑表，右边第一个为行式存储，第二个为列式存储。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．行存储的特点</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>查询满足条件的一整行数据的时候，列存储则需要去每个聚集的字段找到对应的每个列的值，行存储只需要找到其中一个值，其余的值都在相邻地方，所以此时行存储查询的速度更快。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．列存储的特点</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>因为每个字段的数据聚集存储，在查询只需要少数几个字段的时候，能大大减少读取的数据量；每个字段的数据类型一定是相同的，列式存储可以针对性的设计更好的设计压缩算法。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>TEXTFILE</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>SEQUENCEFILE</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>的存储格式都是基于行存储的；</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:red'>ORC</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>和</span><span lang=EN-US
style='color:red'>PARQUET</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>是基于列式存储的。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>8.5.2 TextFile</span><span
style='font-size:14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>格式</span><span lang=EN-US
style='font-size:14.0pt'><o:p></o:p></span></h3>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span style='font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>默认格式，数据不做压缩，磁盘开销大，数据解析开销大。可结合</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;color:black'>Gzip</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>、</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>Bzip2</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>使用，但使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>Gzip</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>这种方式，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>hive</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>不会对数据进行切分，从而无法对数据进行并行操作。</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>8.5.3 Orc</span><span style='font-size:
14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>格式</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span lang=EN-US style='font-size:10.5pt;line-height:150%;
color:black'>Orc (Optimized Row Columnar)</span><span style='font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>是</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;color:black'>Hive 0.11</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>版里引入的新的存储格式。</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:150%;
background:white'><span style='font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>如图</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;color:black'>6-11</span><span style='font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>所示可以看到每个</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;color:black'>Orc</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>文件由</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>1</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>个或多个</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>stripe</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>组成，每个</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>stripe250MB</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>大小，这个</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>Stripe</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>实际相当于</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>RowGroup</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>概念，不过大小由</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>4MB-&gt;250MB</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>，这样应该能提升顺序读的吞吐率。每个</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>Stripe</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>里有三部分组成，分别是</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>Index Data</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>Row Data</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'>Stripe Footer</span><span
style='font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>：</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p align=center style='margin-top:0cm;margin-right:0cm;margin-bottom:7.5pt;
margin-left:0cm;text-align:center;background:white'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="图片_x0020_17" o:spid="_x0000_i1091"
 type="#_x0000_t75" style='width:4in;height:402.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image138.png" o:title="" croptop="768f"
  cropbottom="1022f" cropleft="1506f" cropright="2076f"/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p align=center style='margin-top:0cm;margin-right:0cm;margin-bottom:7.5pt;
margin-left:0cm;text-align:center;background:white'><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>图</span><span lang=EN-US style='font-size:9.0pt'>6-11 Orc</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>格式</span><span lang=EN-US
style='font-size:9.0pt;color:black'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%;
mso-pagination:widow-orphan;background:white'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>&nbsp;&nbsp; <span style='mso-tab-count:1'>   </span>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>）</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>Index Data</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>：一个轻量级的</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>index</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>，默认是</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:0pt'>每隔</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red;
mso-font-kerning:0pt'>1W</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:0pt'>行做一个索引</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>。这里做的索引应该只是记录某行的各字段在</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>Row Data</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>中的</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>offset</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%;
mso-pagination:widow-orphan;background:white'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>&nbsp; &nbsp; <span style='mso-tab-count:1'> </span>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>）</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>Row Data</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>：存的是具体的数据，先取部分行，然后对这些行按列进行存储。对每个列进行了编码，分成多个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>Stream</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>来存储。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%;
mso-pagination:widow-orphan;background:white'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>&nbsp; &nbsp;<span style='mso-tab-count:1'>   </span>3</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>）</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>Stripe Footer</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>：存的是各个</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>Stream</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>的类型，长度等信息。</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:18.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>每个文件有一个</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>File Footer</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>，这里面存的是每个</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>Stripe</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>的行数，每个</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>Column</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>的数据类型信息等；每个文件的尾部是一个</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>PostScript</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>，这里面记录了整个文件的压缩类型以及</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>FileFooter</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>的长度信息等。在读取文件时，会</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>seek</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>到文件尾部读</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>PostScript</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>，从里面解析到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>File Footer</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>长度，再读</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>FileFooter</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>，从里面解析到各个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>Stripe</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>信息，再读各个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>Stripe</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>，即从后往前读。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:18.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:18.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_138" o:spid="_x0000_i1090"
 type="#_x0000_t75" style='width:536.4pt;height:267pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image139.png" o:title=""/>
</v:shape></span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>8.5.4 Parquet</span><span style='font-size:
14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>格式</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（也是行列结合）</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:18.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Parquet</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>是面向分析型业务的列式存储格式，由</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Twitter</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Cloudera</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>合作开发，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>2015</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>年</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>5</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>月从</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>Apache</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的孵化器里毕业成为</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>Apache</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>顶级项目。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:18.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Parquet</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>文件是以二进制方式存储的，所以是不可以直接读取的，文件中包括该文件的数据和元数据，</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red;background:
white'>因此</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;color:red;background:white'>Parquet</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;background:white'>格式文件是自解析的。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:18.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>通常情况下，在存储</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>Parquet</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>数据的时候会按照</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>Block</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>大小设置行组的大小，由于一般情况下每一个</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>Mapper</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>任务处理数据的最小单位是一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>Block</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>，这样可以把</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:
0pt'>每一个行组由一个</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:red;mso-font-kerning:0pt'>Mapper</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:
0pt'>任务处理，增大任务执行并行度</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>Parquet</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>文件的格式如图</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>6-12</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>所示。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%;
mso-pagination:widow-orphan;background:white'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="_x0000_i1032" type="#_x0000_t75" alt="Parquet文件格式"
 style='width:405pt;height:308.4pt;mso-position-horizontal-relative:page;
 mso-position-vertical-relative:page'>
 <img src="Hive.files/image140.png" o:href="https://www.2cto.com/uploadfile/Collfiles/20160328/20160328090821306.png"
  croptop="2035f" cropbottom="5640f" cropleft="2303f" cropright="2111f"
  embosscolor="white"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%;
mso-pagination:widow-orphan;background:white'><span style='font-size:9.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri;color:black;mso-font-kerning:0pt'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif";
color:black;mso-font-kerning:0pt'>6-12<span style='mso-spacerun:yes'>  </span></span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'>Parquet</span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>格式</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif";
color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上图展示了一个</span><span lang=EN-US>Parquet</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件的内容，一个文件中可以存储多个行组，文件的首位都是该文件的</span><span lang=EN-US>Magic
Code</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，用于校验它是否是一个</span><span lang=EN-US>Parquet</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件，</span><span lang=EN-US>Footer length</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>记录了文件元数据的大小，通过该值和文件长度可以计算出元数据的偏移量，文件的元数据中包括每一个行组的元数据信息和该文件存储数据的</span><span
lang=EN-US>Schema</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>信息。除了文件中每一个行组的元数据，每一页的开始都会存储该页的元数据，在</span><span
lang=EN-US>Parquet</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中，有三种类型的页：<span
style='color:red'>数据页、字典页和索引页</span>。数据页用于存储当前行组中该列的值，字典页存储该列值的编码字典，每一个列块中最多包含一个字典页，索引页用来存储当前行组下该列的索引，目前</span><span
lang=EN-US>Parquet</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中还不支持索引页。</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>8.5.5 </span><span style='font-size:14.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>主流文件存储格式对比实验</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>从存储文件的压缩比和查询速度两个角度对比。</span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>存储文件的压缩比测试：</span><span lang=EN-US><o:p></o:p></span></b></p>

<p class=1 style='margin-top:6.2pt;margin-right:0cm;margin-bottom:0cm;
margin-left:40.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;mso-char-indent-count:
0;mso-list:l7 level1 lfo9'><![if !supportLists]><span lang=EN-US
style='mso-fareast-font-family:Arial'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>测试数据（</span><span
lang=EN-US>10</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>万条数据，不算大）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="_x0000_i1034" type="#_x0000_t75" style='width:33.6pt;
 height:30pt' o:ole="">
 <img src="Hive.files/image141.png" o:title="" embosscolor="white"/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1034"
  DrawAspect="Content" ObjectID="_1629836132">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_139" o:spid="_x0000_i1089" type="#_x0000_t75"
 style='width:566.4pt;height:207pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image142.png" o:title=""/>
</v:shape></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>TextFile</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;color:black'>1</span><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）创建表，存储数据格式为</span><span lang=EN-US
style='font-size:10.5pt;color:black'>TEXTFILE<o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>create table log_text (</span></p>
  <p class=a><span lang=EN-US>track_time string,</span></p>
  <p class=a><span lang=EN-US>url string,</span></p>
  <p class=a><span lang=EN-US>session_id string,</span></p>
  <p class=a><span lang=EN-US>referer string,</span></p>
  <p class=a><span lang=EN-US>ip string,</span></p>
  <p class=a><span lang=EN-US>end_user_id string,</span></p>
  <p class=a><span lang=EN-US>city_id string</span></p>
  <p class=a><span lang=EN-US>)</span></p>
  <p class=a><span lang=EN-US>row format delimited fields terminated by '\t'</span></p>
  <p class=a><span lang=EN-US>stored as <span style='color:red'>textfile</span>
  ; </span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>（默认就是这个）</span><span lang=EN-US
  style='font-size:10.5pt;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;color:black'>2</span><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）向表中加载数据（</span><span lang=EN-US
style='font-size:10.5pt;color:black'>load</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>其实就是直接把文件移动）</span><span lang=EN-US
style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:38.7pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=620 valign=top style='width:372.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; load data local inpath '/opt/module/datas/log.data'
  into table log_text ;</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;color:black'>3</span><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）查看表中数据大小（或者直接在</span><span lang=EN-US
style='font-size:10.5pt;color:black'>hdfs</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>文件页面看）</span><span lang=EN-US style='font-size:
10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:37.95pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=621 valign=top style='width:372.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; dfs -du -h
  /user/hive/warehouse/log_text;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:red'>18.1 M<span
style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='mso-bidi-font-size:
10.5pt'>/user/hive/warehouse/log_text/log.data<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_140" o:spid="_x0000_i1088"
 type="#_x0000_t75" style='width:513pt;height:124.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image143.png" o:title=""/>
</v:shape></span><span lang=EN-US style='font-family:"Calibri","sans-serif";
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>ORC</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;background:white'><span
lang=EN-US style='font-size:10.5pt;color:black'><span style='mso-tab-count:
1'>       </span></span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='font-size:10.5pt;color:black'>1</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>）创建表，存储数据格式为</span><span
lang=EN-US style='font-size:10.5pt;color:black'>ORC<o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>create table log_orc(</span></p>
  <p class=a><span lang=EN-US>track_time string,</span></p>
  <p class=a><span lang=EN-US>url string,</span></p>
  <p class=a><span lang=EN-US>session_id string,</span></p>
  <p class=a><span lang=EN-US>referer string,</span></p>
  <p class=a><span lang=EN-US>ip string,</span></p>
  <p class=a><span lang=EN-US>end_user_id string,</span></p>
  <p class=a><span lang=EN-US>city_id string</span></p>
  <p class=a><span lang=EN-US>)</span></p>
  <p class=a><span lang=EN-US>row format delimited fields terminated by '\t'</span></p>
  <p class=a><span lang=EN-US>stored as <span style='color:red'>orc</span> ;</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;background:white'><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='font-size:10.5pt;
color:black'>2</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）向表中加载数据（不能用</span><span
lang=EN-US style='font-size:10.5pt;color:black'>load</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>，</span><span lang=EN-US
style='font-size:10.5pt;color:black'>load</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>是直接移动文件，</span><span lang=EN-US
style='font-size:10.5pt;color:black'>insert</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>是走</span><span lang=EN-US style='font-size:10.5pt;
color:black'>MR</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>的）</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:39.45pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=619 valign=top style='width:371.25pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; insert into table log_orc
  select * from log_text ;</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;background:white'><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='font-size:10.5pt;
color:black'>3</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）查看表中数据大小</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:38.7pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=621 valign=top style='width:372.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; dfs -du -h
  /user/hive/warehouse/log_orc/ ;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;
color:red'>2.8 M<span style='mso-spacerun:yes'>  </span></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>/user/hive/warehouse/log_orc/000000_0<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_141"
 o:spid="_x0000_i1087" type="#_x0000_t75" style='width:515.4pt;height:100.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image144.png" o:title=""/>
</v:shape></span><span lang=EN-US style='font-family:"Calibri","sans-serif";
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Parquet</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;background:white'><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='font-size:10.5pt;
color:black'>1</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）创建表，存储数据格式为</span><span
lang=EN-US style='font-size:10.5pt;color:black'>parquet<o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>create table log_parquet(</span></p>
  <p class=a><span lang=EN-US>track_time string,</span></p>
  <p class=a><span lang=EN-US>url string,</span></p>
  <p class=a><span lang=EN-US>session_id string,</span></p>
  <p class=a><span lang=EN-US>referer string,</span></p>
  <p class=a><span lang=EN-US>ip string,</span></p>
  <p class=a><span lang=EN-US>end_user_id string,</span></p>
  <p class=a><span lang=EN-US>city_id string</span></p>
  <p class=a><span lang=EN-US>)</span></p>
  <p class=a><span lang=EN-US>row format delimited fields terminated by '\t'</span></p>
  <p class=a><span lang=EN-US>stored as <span style='color:red'>parquet</span>
  ;<span style='mso-tab-count:1'>   </span></span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;background:white'><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='font-size:10.5pt;
color:black'>2</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）向表中加载数据</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:40.2pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=627 valign=top style='width:376.3pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; insert into table log_parquet
  select * from log_text ;</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;background:white'><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='font-size:10.5pt;
color:black'>3</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）查看表中数据大小</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:40.2pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=627 valign=top style='width:376.3pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; dfs -du -h
  /user/hive/warehouse/log_parquet/ ;</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span lang=EN-US style='font-size:10.5pt;color:red'>13.1 M </span><span
lang=EN-US style='font-size:10.5pt'><span
style='mso-spacerun:yes'> </span>/user/hive/warehouse/log_parquet/000000_0<o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_142"
 o:spid="_x0000_i1086" type="#_x0000_t75" style='width:529.8pt;height:111pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image145.png" o:title=""/>
</v:shape></span><span lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span lang=EN-US style='font-size:10.5pt;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>存储文件的压缩比总结：</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span lang=EN-US style='font-size:10.5pt;color:red'>ORC
&gt;<span style='mso-spacerun:yes'>  </span>Parquet &gt;<span
style='mso-spacerun:yes'>  </span>textFile<o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span lang=EN-US style='font-size:10.5pt;color:black'><o:p>&nbsp;</o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.1pt;mso-char-indent-count:
2.0;line-height:16.5pt;background:white'><b style='mso-bidi-font-weight:normal'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>存储文件的查询速度测试：</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:10.5pt;
color:black'><o:p></o:p></span></b></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>TextFile</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; select count(*) from log_text;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>_c0</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>100000</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Time taken: 21.54 seconds, Fetched: 1 row(s)</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Time taken: 21.08 seconds, Fetched: 1 row(s) </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（这是多次测试的结果）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Time taken: 19.298 seconds, Fetched: 1 row(s)</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>ORC</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; select count(*) from log_orc;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>_c0</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>100000</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Time taken: 20.867 seconds, Fetched: 1 row(s)</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Time taken: 22.667 seconds, Fetched: 1 row(s)</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Time taken: 18.36 seconds, Fetched: 1 row(s)</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Parquet</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hive (default)&gt; select count(*) from log_parquet;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>_c0</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>100000</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Time taken: 22.922 seconds, Fetched: 1 row(s)</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Time taken: 21.074 seconds, Fetched: 1 row(s)</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Time taken: 18.384 seconds, Fetched: 1 row(s)</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>存储文件的查询速度总结：<span style='color:red'>查询速度相近，</span></span><span
lang=EN-US style='color:red'>orc</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>压缩之后最小。</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>8.6 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>存储和压缩结合</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>8.6.1 </span><span style='font-size:14.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>修改</span><span lang=EN-US style='font-size:14.0pt'>Hadoop</span><span
style='font-size:14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>集群具有</span><span lang=EN-US
style='font-size:14.0pt'>Snappy</span><span style='font-size:14.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>压缩方式</span><span
lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看</span><span
lang=EN-US>hadoop checknative</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>命令使用</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>[atguigu@hadoop104 hadoop-2.7.2]$ hadoop</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-spacerun:yes'>  </span><span style='mso-tab-count:
2'>     </span>checknative [-a|-h]<span style='mso-spacerun:yes'>  </span>check
native hadoop and compression libraries availability </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（其中一条信息）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．查看</span><span
lang=EN-US>hadoop</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>支持的压缩方式</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US><span style='mso-tab-count:1'>  </span>[atguigu@hadoop104
hadoop-2.7.2]$ hadoop checknative</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>17/12/24 20:32:52 WARN bzip2.Bzip2Factory: Failed to load/initialize
native-bzip2 library system-native, will use pure-Java version</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>17/12/24 20:32:52 INFO zlib.ZlibFactory: Successfully loaded &amp;
initialized native-zlib library</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Native library checking:</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hadoop:<span style='mso-spacerun:yes'>  </span>true
/opt/module/hadoop-2.7.2/lib/native/libhadoop.so</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>zlib:<span style='mso-spacerun:yes'>    </span>true /lib64/libz.so.1</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US style='color:red'>snappy:<span style='mso-spacerun:yes'> 
</span>false <o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>lz4:<span style='mso-spacerun:yes'>     </span>true revision:99</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>bzip2:<span style='mso-spacerun:yes'>   </span>false</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．将编译好的支持</span><span
lang=EN-US>Snappy</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>压缩的</span><span lang=EN-US>hadoop-2.7.2.tar.gz</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>包导入到</span><span
lang=EN-US>hadoop102</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>的</span><span lang=EN-US>/opt/software</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>中</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span style='font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>放截图，不用重新搭集群</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．解压</span><span
lang=EN-US>hadoop-2.7.2.tar.gz</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>到当前路径</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>[atguigu@hadoop102 software]$ tar -zxvf hadoop-2.7.2.tar.gz</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．进入到</span><span
lang=EN-US>/opt/software/hadoop-2.7.2/lib/native</span><span style='font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>路径可以看到支持</span><span
lang=EN-US>Snappy</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>压缩的动态链接库</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>[atguigu@hadoop102 native]$ pwd</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>/opt/software/hadoop-2.7.2/lib/native</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>[atguigu@hadoop102 native]$ ll </span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（可以看到很多带</span><span
lang=EN-US>snappy</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>的文件）</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span lang=EN-US>-rw-r--r--. 1 atguigu atguigu<span
style='mso-spacerun:yes'>  </span>472950 9</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>月</span><span
lang=EN-US><span style='mso-spacerun:yes'>   </span>1 10:19 libsnappy.a</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span lang=EN-US>-rwxr-xr-x. 1 atguigu atguigu<span
style='mso-spacerun:yes'>     </span>955 9</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>月</span><span
lang=EN-US><span style='mso-spacerun:yes'>   </span>1 10:19 libsnappy.la</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span lang=EN-US>lrwxrwxrwx. 1 atguigu atguigu<span
style='mso-spacerun:yes'>      </span>18 12</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>月</span><span
lang=EN-US> 24 20:39 libsnappy.so -&gt; libsnappy.so.1.3.0</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span lang=EN-US>lrwxrwxrwx. 1 atguigu atguigu<span
style='mso-spacerun:yes'>      </span>18 12</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>月</span><span
lang=EN-US> 24 20:39 libsnappy.so.1 -&gt; libsnappy.so.1.3.0</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:16.5pt'><span lang=EN-US>-rwxr-xr-x. 1 atguigu atguigu<span
style='mso-spacerun:yes'>  </span>228177 9</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>月</span><span
lang=EN-US><span style='mso-spacerun:yes'>   </span>1 10:19 libsnappy.so.1.3.0</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>6</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．拷贝</span><span
lang=EN-US>/opt/software/hadoop-2.7.2/lib/native</span><span style='font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>（支持</span><span
lang=EN-US>snappy</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>压缩的）里面的所有内容到开发集群的</span><span lang=EN-US>/opt/module/hadoop-2.7.2/lib/native</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>路径上</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>[atguigu@hadoop102 native]$ cp ../native/*
/opt/module/hadoop-2.7.2/lib/native/</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>7</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．分发集群</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>[atguigu@hadoop102 lib]$ xsync native/</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>8</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．重启集群，再次查看</span><span
lang=EN-US>hadoop</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>支持的压缩类型</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>[atguigu@hadoop102 hadoop-2.7.2]$ hadoop checknative</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>17/12/24 20:45:02 WARN bzip2.Bzip2Factory: Failed to load/initialize
native-bzip2 library system-native, will use pure-Java version</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>17/12/24 20:45:02 INFO zlib.ZlibFactory: Successfully loaded &amp;
initialized native-zlib library</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>Native library checking:</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>hadoop:<span style='mso-spacerun:yes'>  </span>true
/opt/module/hadoop-2.7.2/lib/native/libhadoop.so</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>zlib:<span style='mso-spacerun:yes'>    </span>true /lib64/libz.so.1</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US style='color:red'>snappy:<span style='mso-spacerun:yes'> 
</span>true</span><span lang=EN-US>
/opt/module/hadoop-2.7.2/lib/native/libsnappy.so.1</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>lz4:<span style='mso-spacerun:yes'>     </span>true revision:99</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd'><span
lang=EN-US>bzip2:<span style='mso-spacerun:yes'>   </span>false</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>9</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．重新启动</span><span
lang=EN-US>hadoop</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>集群和</span><span lang=EN-US>hive</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>8.6.2 </span><span style='font-size:14.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>测试存储和压缩</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US>Orc</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>与</span><span
lang=EN-US>snappy</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结合。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:7.5pt;margin-left:0cm;
background:white'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>官网：</span><span
lang=EN-US><a
href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+ORC"><span
style='font-size:10.5pt'>https://cwiki.apache.org/confluence/display/Hive/LanguageManual+ORC</span></a></span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:7.5pt;margin-left:0cm;
background:white'><span lang=EN-US style='font-size:10.5pt;color:black'>ORC</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>存储方式的压缩：</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<p align=center style='margin-top:0cm;margin-right:0cm;margin-bottom:7.5pt;
margin-left:0cm;text-align:center;background:white'><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial;mso-font-kerning:1.0pt'>表</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial","sans-serif";
mso-fareast-font-family:黑体;mso-bidi-font-family:"Times New Roman";mso-font-kerning:
1.0pt'>6-12<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:19.5pt'>
  <td width=228 valign=top style='width:136.6pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt;height:19.5pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Key<o:p></o:p></span></p>
  </td>
  <td width=139 valign=top style='width:83.15pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:19.5pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Default<o:p></o:p></span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:19.5pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>Notes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=228 valign=top style='width:136.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>orc.compress<o:p></o:p></span></p>
  </td>
  <td width=139 valign=top style='width:83.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>ZLIB<o:p></o:p></span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>high level compression (one of NONE, ZLIB,
  SNAPPY)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=228 valign=top style='width:136.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>orc.compress.size<o:p></o:p></span></p>
  </td>
  <td width=139 valign=top style='width:83.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>262,144<o:p></o:p></span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>number of bytes in each compression chunk</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=228 valign=top style='width:136.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>orc.stripe.size<o:p></o:p></span></p>
  </td>
  <td width=139 valign=top style='width:83.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>67,108,864<o:p></o:p></span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>number of bytes in each stripe</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=228 valign=top style='width:136.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>orc.row.index.stride<o:p></o:p></span></p>
  </td>
  <td width=139 valign=top style='width:83.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>10,000<o:p></o:p></span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>number of rows between index entries (must be
  &gt;= 1000)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=228 valign=top style='width:136.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>orc.create.index<o:p></o:p></span></p>
  </td>
  <td width=139 valign=top style='width:83.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>true<o:p></o:p></span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>whether to create row indexes</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=228 valign=top style='width:136.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>orc.bloom.filter.columns<o:p></o:p></span></p>
  </td>
  <td width=139 valign=top style='width:83.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>&quot;&quot;<o:p></o:p></span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>comma separated list of column names for which bloom
  filter should be created</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td width=228 valign=top style='width:136.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>orc.bloom.filter.fpp<o:p></o:p></span></p>
  </td>
  <td width=139 valign=top style='width:83.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-ansi-language:ZH-CN'>0.05<o:p></o:p></span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US>false positive probability for bloom filter
  (must &gt;0.0 and &lt;1.0)</span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建一个非压缩的的</span><span
lang=EN-US>ORC</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>存储方式</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;background:white'><span
lang=EN-US style='font-size:10.5pt;color:black'><span style='mso-tab-count:
1'>       </span></span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='font-size:10.5pt;color:black'>1</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>）建表语句</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>create table log_orc_none(</span></p>
  <p class=a><span lang=EN-US>track_time string,</span></p>
  <p class=a><span lang=EN-US>url string,</span></p>
  <p class=a><span lang=EN-US>session_id string,</span></p>
  <p class=a><span lang=EN-US>referer string,</span></p>
  <p class=a><span lang=EN-US>ip string,</span></p>
  <p class=a><span lang=EN-US>end_user_id string,</span></p>
  <p class=a><span lang=EN-US>city_id string</span></p>
  <p class=a><span lang=EN-US>)</span></p>
  <p class=a><span lang=EN-US>row format delimited fields terminated by '\t'</span></p>
  <p class=a><span lang=EN-US>stored as <span style='color:red'>orc</span>
  tblproperties (&quot;orc.compress&quot;=&quot;<span style='color:red'>NONE</span>&quot;);
  </span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>（</span><span lang=EN-US>none</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>是不使用</span><span lang=EN-US>orc</span><span style='font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>的压缩，</span><span
  lang=EN-US>orc</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>自带压缩）</span><span lang=EN-US
  style='font-size:10.5pt;color:#333333'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;background:white'><span
lang=EN-US style='font-size:10.5pt;color:black'><span style='mso-tab-count:
1'>       </span></span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='font-size:10.5pt;color:black'>2</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>）插入数据</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:37.95pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=624 valign=top style='width:374.25pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; insert into table log_orc_none
  select * from log_text ;</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;background:white'><span
lang=EN-US style='font-size:10.5pt;color:black'><span style='mso-tab-count:
1'>       </span></span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='font-size:10.5pt;color:black'>3</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>）查看插入后数据</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:37.95pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=623 valign=top style='width:373.5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; dfs -du -h
  /user/hive/warehouse/log_orc_none/ ;</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span lang=EN-US style='font-size:10.5pt;color:red'>7.7
M<span style='mso-spacerun:yes'> 
</span>/user/hive/warehouse/log_orc_none/000000_0<o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．创建一个</span><span
lang=EN-US>SNAPPY</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>压缩的</span><span lang=EN-US>ORC</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>存储方式</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;background:white'><span
lang=EN-US style='font-size:10.5pt;color:black'><span style='mso-tab-count:
1'>       </span></span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='font-size:10.5pt;color:black'>1</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>）建表语句</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table log_orc_snappy(</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>track_time string,</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>url string,</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>session_id string,</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>referer string,</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>ip string,</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>end_user_id string,</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>city_id string</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>)</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>row format delimited fields
  terminated by '\t'</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>stored as <span
  style='color:red'>orc</span> tblproperties (&quot;orc.compress&quot;=&quot;<span
  style='color:red'>SNAPPY</span>&quot;);</span><span lang=EN-US
  style='font-family:"Times New Roman","serif";mso-bidi-font-family:Arial;
  color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;background:white'><span
lang=EN-US style='font-size:10.5pt;color:black'><span style='mso-tab-count:
1'>       </span></span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='font-size:10.5pt;color:black'>2</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>）插入数据</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:38.7pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=621 valign=top style='width:372.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; insert into table
  log_orc_snappy select * from log_text ;</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;line-height:16.5pt;background:white'><span
lang=EN-US style='font-size:10.5pt;color:black'><span style='mso-tab-count:
1'>       </span></span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='font-size:10.5pt;color:black'>3</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>）查看插入后数据</span><span
lang=EN-US style='font-size:10.5pt;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:37.95pt;background:#E6E0EC;border-collapse:collapse;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:8.75pt'>
  <td width=624 valign=top style='width:374.25pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:8.75pt'>
  <p class=a><span lang=EN-US>hive (default)&gt; dfs -du -h
  /user/hive/warehouse/log_orc_snappy/ ;</span></p>
  </td>
 </tr>
</table>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;line-height:16.5pt;
background:white'><span lang=EN-US style='font-size:10.5pt;color:red'>3.8 M </span><span
lang=EN-US style='font-size:10.5pt;color:black'><span
style='mso-spacerun:yes'> </span>/user/hive/warehouse/log_orc_snappy/000000_0<o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．上一节中默认创建的</span><span
lang=EN-US>ORC</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>存储方式，导入数据后的大小为</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:red'>2.8 M</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black'><span
style='mso-spacerun:yes'>  </span>/user/hive/warehouse/log_orc/000000_0</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;background:white'><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>比</span><span lang=EN-US style='font-size:10.5pt;
color:black'>Snappy</span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>压缩的还小。原因是</span><span lang=EN-US style='font-size:10.5pt;
color:black'>orc</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>存储文件默认采用</span><span
lang=EN-US style='font-size:10.5pt;color:red'>ZLIB</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>压缩。比</span><span lang=EN-US
style='font-size:10.5pt;color:red'>snappy</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>压缩的小。</span><span lang=EN-US style='font-size:
10.5pt;color:black'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．存储方式和压缩总结</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt;mso-char-indent-count:
2.0;line-height:16.5pt;background:white'><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>在实际的项目开发当中，</span><span lang=EN-US
style='font-size:10.5pt;color:red'>hive</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>表的数据存储格式一般选择：</span><span lang=EN-US
style='font-size:10.5pt;color:red'>orc</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>或</span><span lang=EN-US style='font-size:10.5pt;
color:red'>parquet</span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>。压缩方式一般选择</span><span lang=EN-US style='font-size:10.5pt;color:red'>snappy</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>（不支持切分，</span><span
lang=EN-US style='font-size:10.5pt;color:red'>lzo</span><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>（支持切分。</span><span lang=EN-US style='font-size:
10.5pt;color:red'><o:p></o:p></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%;color:black'>9</span><span
style='font-size:15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>章</span><span
style='font-size:15.0pt;line-height:240%;color:black'> </span><span
style='font-size:15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>企业级调优</span><span
lang=EN-US style='font-size:15.0pt;line-height:240%;color:black'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.1 Fetch</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>抓取</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>Fetch</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>抓取是指，</span><span lang=EN-US
style='color:red'>Hive</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>中对某些情况的查询可以不必使用</span><span
lang=EN-US style='color:red'>MapReduce</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>计算</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。例如：</span><span lang=EN-US>SELECT *
FROM employees;</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在这种情况下，</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可以简单地读取</span><span lang=EN-US>employee</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对应的存储目录下的文件（</span><span lang=EN-US>select *</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>就是显示全部数据，直接读文件即可），然后输出查询结果到控制台。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在</span><span lang=EN-US>hive-default.xml.template</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件中</span><span lang=EN-US>hive.fetch.task.conversion</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>默认是</span><span lang=EN-US>more</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，老版本</span><span lang=EN-US>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>默认是</span><span lang=EN-US style='color:red'>minimal</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>，该属性修改为</span><span lang=EN-US style='color:red'>more</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>以后，在全局查找、字段查找、</span><span lang=EN-US
style='color:red'>limit</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>查找等都不走</span><span
lang=EN-US style='color:red'>mapreduce</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>&lt;property&gt;</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>   
  </span>&lt;name&gt;hive.fetch.task.conversion&lt;/name&gt;</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>&lt;value&gt;more&lt;/value&gt;</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>&lt;description&gt;</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>      </span>Expects one of [none, minimal, more].</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>      </span>Some select queries can be converted to
  single FETCH task minimizing latency.</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>      </span>Currently the query should be single
  sourced not having any subquery and should not have</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>      </span>any aggregations or distincts (which
  incurs RS), lateral views and joins.</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>      </span>0. <span style='color:red'>none</span>
  : disable hive.fetch.task.conversion </span><span style='font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>（走</span><span
  lang=EN-US>MR</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>）</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>      </span>1. <span style='color:red'>minimal</span>
  : SELECT STAR, FILTER on partition columns, LIMIT only</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>      </span>2. <span style='color:red'>more</span><span
  style='mso-spacerun:yes'>  </span>: SELECT, FILTER, LIMIT only (support
  TABLESAMPLE and virtual columns)</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>    </span>&lt;/description&gt;</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'>  </span>&lt;/property&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:16.5pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例实操：</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span>1</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）把</span><span
lang=EN-US>hive.fetch.task.conversion</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>设置成</span><span
lang=EN-US>none</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，然后执行查询语句，都会执行</span><span lang=EN-US>mapreduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>程序。</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; set
hive.fetch.task.conversion=none;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; select * from emp;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; select ename from emp;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; select ename from emp limit 3;</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span>2</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）把</span><span
lang=EN-US>hive.fetch.task.conversion</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>设置成</span><span
lang=EN-US>more</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，然后执行查询语句，如下查询方式都不会执行</span><span
lang=EN-US>mapreduce</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>程序。</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; set
hive.fetch.task.conversion=more;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; select * from emp;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; select ename from emp;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; select ename from emp limit 3;</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.2 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>本地模式</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>大多数的</span><span lang=EN-US>Hadoop Job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是需要</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>提供的完整的可扩展性来处理大数据集的。不过，有时</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的输入数据量是非常小的。在这种情况下，为查询触发执行任务消耗的时间可能会比实际</span><span
lang=EN-US>job</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的执行时间要多的多。对于大多数这种情况，</span><span
lang=EN-US style='color:red'>Hive</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>可以通过本地模式在单台机器上处理所有的任务（默认是提交给</span><span
lang=EN-US style='color:red'>yarn</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>集群执行的，访问端口</span><span
lang=EN-US style='color:red'>8088</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>）。对于小数据集，执行时间可以明显被缩短。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>用户可以通过设置</span><span lang=EN-US>hive.exec.mode.local.auto</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的值为</span><span lang=EN-US>true</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，来让</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在适当的时候自动启动这个优化。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:79.5pt'>
  <td width=883 valign=top style='width:529.75pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:79.5pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>set hive.exec.mode.local.auto=true;&nbsp; //</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>开启本地</span><span lang=EN-US>mr</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>//</span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置</span><span lang=EN-US>local
  mr</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>的最大输入数据量，当输入数据量小于这个值时采用</span><span
  lang=EN-US>local&nbsp; mr</span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>的方式，默认为</span><span
  lang=EN-US>134217728</span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>，即</span><span lang=EN-US>128M</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>set
  hive.exec.mode.local.auto.inputbytes.max=50000000;</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>//</span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置</span><span lang=EN-US>local
  mr</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>的最大输入文件个数，当输入文件个数小于这个值时采用</span><span
  lang=EN-US>local mr</span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>的方式，默认为</span><span
  lang=EN-US>4</span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>set hive.exec.mode.local.auto.input.files.max=10;<span
  style='color:#7030A0'><o:p></o:p></span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:16.5pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例实操：</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）开启本地模式，并执行查询语句</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; set
hive.exec.mode.local.auto=true;&nbsp;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; select * from emp cluster by
deptno;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>Time taken: 1.328 seconds, Fetched: 14 row(s)</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）关闭本地模式，并执行查询语句</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; set
hive.exec.mode.local.auto=false;&nbsp;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; select * from emp cluster by
deptno;</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>Time taken: 20.09 seconds, Fetched: 14 row(s)</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表的优化</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>小表、大表</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Join<o:p></o:p></span></h3>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>将</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>相对分散，并且数据量小的表放在</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>join</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>的左边，这样可以有效减少内存溢出错误发生的几率；再进一步，<a name="OLE_LINK42"></a><a
name="OLE_LINK41"><span style='mso-bookmark:OLE_LINK42'>可以使用</span></a></span><span
style='mso-bookmark:OLE_LINK41'><span style='mso-bookmark:OLE_LINK42'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>map join</span></span></span><span style='mso-bookmark:
OLE_LINK41'><span style='mso-bookmark:OLE_LINK42'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>让小的维度表（</span></span></span><span
style='mso-bookmark:OLE_LINK41'><span style='mso-bookmark:OLE_LINK42'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>1000</span></span></span><span style='mso-bookmark:OLE_LINK41'><span
style='mso-bookmark:OLE_LINK42'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>条以下的记录条数）先进内存。在</span></span></span><span
style='mso-bookmark:OLE_LINK41'><span style='mso-bookmark:OLE_LINK42'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>map</span></span></span><span style='mso-bookmark:OLE_LINK41'><span
style='mso-bookmark:OLE_LINK42'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>端完成</span></span></span><span
style='mso-bookmark:OLE_LINK41'><span style='mso-bookmark:OLE_LINK42'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>reduce</span></span></span><span style='mso-bookmark:
OLE_LINK41'><span style='mso-bookmark:OLE_LINK42'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>。</span></span></span><span
style='mso-bookmark:OLE_LINK42'></span><span style='mso-bookmark:OLE_LINK41'></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:
0pt'>实际测试发现：新版的</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:red;mso-font-kerning:0pt'>hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:
0pt'>已经对小表</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;color:red;mso-font-kerning:0pt'>JOIN</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:0pt'>大表和大表</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red;
mso-font-kerning:0pt'>JOIN</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:0pt'>小表进行了优化。小表放在左边和右边已经没有明显区别。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:16.5pt'><b style='mso-bidi-font-weight:
normal'><span style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>案例实操</span></b><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'><o:p></o:p></span></b></p>

<p class=1 style='margin-top:6.2pt;margin-right:0cm;margin-bottom:0cm;
margin-left:0cm;margin-bottom:.0001pt;text-indent:22.0pt;mso-list:l18 level1 lfo10'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:Arial'><span style='mso-list:Ignore'>1．</span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>需求（有两个文件数据需要上传到集群，这俩文件字段一样，数据大小不同而已）</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:21.0pt'><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
mso-bidi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>测试大表</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Calibri","sans-serif";
mso-fareast-font-family:宋体;mso-bidi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>JOIN</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>小表和小表</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Calibri","sans-serif";
mso-fareast-font-family:宋体;mso-bidi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>JOIN</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>大表的效率</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Calibri","sans-serif";
mso-fareast-font-family:宋体;mso-bidi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．建大表、小表和</span><span
lang=EN-US>JOIN</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>后表的语句</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.45pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:125.95pt'>
  <td width=889 valign=top style='width:533.2pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:125.95pt'>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>// </span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>创建大表</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table bigtable(id
  bigint, time bigint, uid string, keyword string, url_rank int, click_num int,
  click_url string) row format delimited fields terminated by '\t';</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>// </span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>创建小表</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table smalltable(id
  bigint, time bigint, uid string, keyword string, url_rank int, click_num int,
  click_url string) row format delimited fields terminated by '\t';</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>// </span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>创建</span><span lang=EN-US>join</span><span style='font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>后表的语句，就不打印到控制台了</span></p>
  <p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table jointable(id
  bigint, time bigint, uid string, keyword string, url_rank int, click_num int,
  click_url string) row format delimited fields terminated by '\t';</span><span
  lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:
  0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．分别向大表和小表中导入数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/bigtable' into table bigtable;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt;load data
local inpath '/opt/module/datas/smalltable' into table smalltable;</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_143"
 o:spid="_x0000_i1085" type="#_x0000_t75" style='width:567pt;height:109.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image146.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>大小表的字段一样，只是数据量不一样</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_145"
 o:spid="_x0000_i1084" type="#_x0000_t75" style='width:567pt;height:143.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image147.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_144"
 o:spid="_x0000_i1083" type="#_x0000_t75" style='width:567pt;height:115.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image148.png" o:title=""/>
</v:shape></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．关闭</span><span
lang=EN-US>mapjoin</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>功能（默认是打开的）</span> <span style='font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>（要关闭才有差不多，不关闭结果不同）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>set hive.auto.convert.join =
false;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．执行小表</span><span
lang=EN-US>JOIN</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>大表语句</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>insert overwrite table
jointable</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>select b.id, b.time, b.uid,
b.keyword, b.url_rank, b.click_num, b.click_url</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>from smalltable s</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>left join bigtable<span
style='mso-spacerun:yes'>  </span>b</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>on b.id = s.id;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:red;mso-font-kerning:0pt'>Time
taken: 35.921 seconds<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:red;mso-font-kerning:0pt'>No
rows affected (44.456 seconds) </span><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red;mso-font-kerning:0pt'>（未关闭</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;color:red;mso-font-kerning:0pt'>mapjoin</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red;mso-font-kerning:0pt'>）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:red;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=1 style='margin-top:4.8pt;margin-right:0cm;margin-bottom:0cm;
margin-left:21.0pt;margin-bottom:.0001pt;mso-para-margin-top:4.8pt;mso-para-margin-right:
0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:2.0gd;mso-para-margin-bottom:
.0001pt;text-indent:0cm;mso-char-indent-count:0'><span lang=EN-US>6</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．执行大表</span><span
lang=EN-US>JOIN</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>小表语句</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>insert overwrite table
jointable</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>select b.id, b.time, b.uid,
b.keyword, b.url_rank, b.click_num, b.click_url</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>from bigtable<span
style='mso-spacerun:yes'>  </span>b</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>left join smalltable<span
style='mso-spacerun:yes'>  </span>s</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>on s.id = b.id;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>Time
taken: </span><span lang=EN-US style='mso-bidi-font-size:10.5pt;color:red;
mso-font-kerning:0pt'>34.196</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;color:black;mso-font-kerning:0pt'> seconds<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>No
rows affected (</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
color:red;mso-font-kerning:0pt'>26.287 </span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>seconds) </span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>（未关闭</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>mapjoin</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>大表</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Join</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>大表</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．空</span><span
lang=EN-US>KEY</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>过滤</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>有时</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>join</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>超时是因为某些</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>对应的数据太多，而相同</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>对应的数据都会发送到相同的</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>reducer</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>上，从而导致内存不够。此时我们应该仔细分析这些异常的</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>key</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>，很多情况下，这些</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>key</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>对应的数据是异常数据，我们需要在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>SQL</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>语句中进行过滤。例如</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>key</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>对应的字段为空，操作如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%;
mso-pagination:widow-orphan;background:white'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>案例实操</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:150%;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>）配置历史服务器</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>配置</span><span
lang=EN-US>mapred-site.xml</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:26.7pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=650 valign=top style='width:389.8pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>&lt;property&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;value&gt;hadoop102:10020&lt;/value&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;/property&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;property&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'>   
  </span>&lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'>   
  </span>&lt;value&gt;hadoop102:19888&lt;/value&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;/property&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>启动历史服务器</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:"Calibri","sans-serif";
mso-bidi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>sbin/mr-jobhistory-daemon.sh
start historyserver</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>查看</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>jobhistory<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US><a href="http://hadoop102:19888/jobhistory">http://hadoop102:19888/jobhistory</a></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>2</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>）创建原始数据表、空</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>id</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>表、合并后数据表</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=912
 style='width:547.4pt;margin-left:26.7pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-yfti-tbllook:1184;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;mso-border-insidev:
 .5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=912 valign=top style='width:547.4pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>// </span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>创建原始表</span></p>
  <p class=a><span lang=EN-US>create table ori(id bigint, time bigint, uid
  string, keyword string, url_rank int, click_num int, click_url string) row
  format delimited fields terminated by '\t';</span></p>
  <p class=a><span lang=EN-US>// </span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>创建空</span><span
  lang=EN-US>id</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>表</span></p>
  <p class=a><span lang=EN-US>create table nullidtable(id bigint, time bigint,
  uid string, keyword string, url_rank int, click_num int, click_url string)
  row format delimited fields terminated by '\t';</span></p>
  <p class=a><span lang=EN-US>// </span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>创建</span><span lang=EN-US>join</span><span
  style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>后表的语句</span></p>
  <p class=a><span lang=EN-US>create table jointable(id bigint, time bigint,
  uid string, keyword string, url_rank int, click_num int, click_url string)
  row format delimited fields terminated by '\t';</span><span lang=EN-US
  style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>3</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>）分别加载原始数据和空</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>id</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>数据到对应表中（要先上传数据两个文件</span><span
style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'> </span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>没有</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>ori</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>文件用前面的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>bigtable</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>即可）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:"Calibri","sans-serif";
mso-bidi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/ori' into table ori;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/nullid' into table nullidtable;</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>4</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>）测试不过滤空</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>id<o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; insert
overwrite table jointable </span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>select n.* from nullidtable n
left join ori o on n.id = o.id;</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:red;mso-font-kerning:0pt'>Time
taken: 42.038 seconds<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:red;mso-font-kerning:0pt'>Time
taken: 37.284 seconds<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>5</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>）测试过滤空</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>id<o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; insert
overwrite table jointable </span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>select n.* from (select * from
nullidtable where <span style='color:red'>id is not null</span> ) n<span
style='mso-spacerun:yes'>  </span>left join ori o on n.id = o.id;</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:red;mso-font-kerning:0pt'>Time
taken: 31.725 seconds<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:16.5pt;mso-pagination:widow-orphan;background:white'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:red;mso-font-kerning:0pt'>Time
taken: 28.876 seconds<o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．空</span><span
lang=EN-US>key</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>转换</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>有时虽然某个</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>为空对应的数据很多，但是相应的数据不是异常数据，必须要包含在</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'>join</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>的结果中，此时我们可以表</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>a</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>key</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>为空的字段赋一个随机的值，使得数据随机均匀地分不到不同的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>reducer</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>上。例如：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>数据：</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_146" o:spid="_x0000_i1082"
 type="#_x0000_t75" style='width:537pt;height:101.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image149.png" o:title=""/>
</v:shape></span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>案例实操：</span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;
color:black;mso-font-kerning:0pt'><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>不随机分布空</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>null</span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>值：</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>）设置</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>5</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>个</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>个数</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt;line-height:150%;mso-pagination:widow-orphan'><span
lang=EN-US style='color:red'>set mapreduce.job.reduces = 5;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>）</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>JOIN</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>两张表</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>insert overwrite table
jointable</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>select n.* from nullidtable n
left join ori b on n.id = b.id;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>结果：如图</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>6-13</span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>所示（历史</span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'> <span lang=EN-US>-<span
style='mso-spacerun:yes'>  </span>reduce</span></span></b><b style='mso-bidi-font-weight:
normal'><span style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>，有截图），可以看出来，出现了数据倾斜，某些</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>reducer</span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>的资源消耗远大于其他</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>reducer</span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>。</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_147" o:spid="_x0000_i1081"
 type="#_x0000_t75" style='width:539.4pt;height:167.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image150.png" o:title=""/>
</v:shape></span><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_148" o:spid="_x0000_i1080"
 type="#_x0000_t75" style='width:529.2pt;height:244.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image151.png" o:title=""/>
</v:shape></span><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;mso-font-kerning:
0pt'><o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_20" o:spid="_x0000_i1079"
 type="#_x0000_t75" style='width:547.2pt;height:184.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image152.png" o:title=""/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;color:black;
mso-font-kerning:0pt'>图</span><span lang=EN-US style='font-size:9.0pt;
line-height:150%;font-family:"Calibri","sans-serif";color:black;mso-font-kerning:
0pt'>6-13 </span><span style='font-size:9.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:
Calibri;color:black;mso-font-kerning:0pt'>空</span><span lang=EN-US
style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif";
color:black;mso-font-kerning:0pt'>key</span><span style='font-size:9.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri;color:black;mso-font-kerning:0pt'>转换</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif";
color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>随机分布空</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>null</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>值</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>）设置</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>5</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>个</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>个数</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt;line-height:150%;mso-pagination:widow-orphan'><span
lang=EN-US style='color:red'>set mapreduce.job.reduces = 5;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>）</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;mso-font-kerning:0pt'>JOIN</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>两张表</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>insert overwrite table
jointable</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>select n.* from nullidtable n
full join ori o on </span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>case when n.id is null then
concat('hive', rand()) else n.id end = o.id;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>结果：如图</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>6-14</span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>所示，可以看出来，消除了数据倾斜，负载均衡</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'>reducer</span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>的资源消耗</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;mso-font-kerning:0pt'><o:p></o:p></span></b></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_21" o:spid="_x0000_i1078" type="#_x0000_t75"
 style='width:549.6pt;height:198.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image153.png" o:title=""/>
 <o:lock v:ext="edit" aspectratio="f"/>
</v:shape></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;color:black;
mso-font-kerning:0pt'>图</span><span lang=EN-US style='font-size:9.0pt;
line-height:150%;font-family:"Calibri","sans-serif";color:black;mso-font-kerning:
0pt'>6-14 </span><span style='font-size:9.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:
Calibri;color:black;mso-font-kerning:0pt'>随机分布空值</span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;
color:black;mso-font-kerning:0pt'><o:p></o:p></span></b></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.3 MapJoin<o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如果不指定</span><span lang=EN-US>MapJoin</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或者不符合</span><span lang=EN-US>MapJoin</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的条件，那么</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>解析器会将</span><span lang=EN-US>Join</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>操作转换成</span><span lang=EN-US>Common Join</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，即：在</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>阶段完成</span><span lang=EN-US>join</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。容易发生数据倾斜。可以用</span><span lang=EN-US>MapJoin</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>把小表全部加载到内存在</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>端进行</span><span lang=EN-US>join</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，避免</span><span lang=EN-US>reducer</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>处理。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．开启</span><span
lang=EN-US>MapJoin</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>参数设置</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）设置自动选择</span><span
lang=EN-US>Mapjoin</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>set hive.auto.convert.join =
true; </span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>默认为</span><span lang=EN-US>true</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）大表小表的阈值设置（默认</span><span
lang=EN-US>25M</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>一下认为是小表）：</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>set
hive.mapjoin.smalltable.filesize=25000000;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>MapJoin</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>工作机制，如图</span><span lang=EN-US>6-15</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>所示</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="_x0000_i1033" type="#_x0000_t75" style='width:416.4pt;
 height:234pt;mso-position-horizontal-relative:page;
 mso-position-vertical-relative:page' o:ole="">
 <img src="Hive.files/image154.png" o:title="" embosscolor="white"/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1033"
  DrawAspect="Content" ObjectID="_1629836134">
 </o:OLEObject>
</xml><![endif]--></span><span style='font-size:9.0pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt'>6-15<span style='mso-spacerun:yes'>  </span>MapJoin</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>工作机制</span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>案例实操：</span> <span lang=EN-US><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）开启</span><span lang=EN-US>Mapjoin</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>功能</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>set hive.auto.convert.join =
true; </span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>默认为</span><span lang=EN-US>true</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）执行小表</span><span lang=EN-US>JOIN</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>大表语句</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:2.7pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=690 valign=top style='width:413.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>insert overwrite table
  jointable</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select b.id, b.time, b.uid,
  b.keyword, b.url_rank, b.click_num, b.click_url</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>from smalltable s</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>join bigtable<span
  style='mso-spacerun:yes'>  </span>b</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>on s.id = b.id;</span><span
  lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:
  0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>Time
taken: 24.594 seconds</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>3</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>）执行大表</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'>JOIN</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>小表语句</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:3.45pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=688 valign=top style='width:413.05pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>insert overwrite table
  jointable</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>select b.id, b.time, b.uid,
  b.keyword, b.url_rank, b.click_num, b.click_url</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>from bigtable<span
  style='mso-spacerun:yes'>  </span>b</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>join smalltable<span
  style='mso-spacerun:yes'>  </span>s</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>on s.id = b.id;</span><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
mso-font-kerning:0pt'>Time taken: 24.315 seconds<o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.4 Group By<o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>默认情况下，</span><span lang=EN-US>Map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>阶段同一</span><span lang=EN-US>Key</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据分发给一个</span><span lang=EN-US>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，当一个</span><span lang=EN-US>key</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据过大时就倾斜了。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>并不是所有的聚合操作都需要在</span><span
lang=EN-US>Reduce</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>端完成，很多聚合操作都可以先在</span><span
lang=EN-US>Map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>端进行部分聚合，最后在</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>端得出最终结果。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．开启</span><span
lang=EN-US>Map</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>端聚合参数设置</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）是否在</span><span lang=EN-US>Map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>端进行聚合，默认为</span><span lang=EN-US>True</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.map.aggr = true</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US>Map</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>端进行聚合操作的条目数目</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.groupby.mapaggr.checkinterval
= 100000</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）有数据倾斜的时候进行负载均衡（默认是</span><span lang=EN-US>false</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.groupby.skewindata = true</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>当选项设定为</span><span lang=EN-US style='color:red'> true</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>，生成的查询计划会有两个</span><span lang=EN-US
style='color:red'>MR Job</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>。</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>第一个</span><span lang=EN-US>MR Job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中，</span><span lang=EN-US>Map</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的输出结果会随机分布到</span><span
lang=EN-US>Reduce</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中，每个</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>做部分聚合操作，并输出结果，这样处理的结果<span style='color:red'>是相同的</span></span><span
lang=EN-US style='color:red'>Group By Key</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>有可能被分发到不同的</span><span lang=EN-US style='color:red'>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中，从而达到负载均衡的目的；第二个</span><span lang=EN-US>MR Job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>再根据预处理的数据结果按照</span><span lang=EN-US>Group By Key</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分布到</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中（这个过程可以保证相同的</span><span lang=EN-US>Group By Key</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>被分布到同一个</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中），最后完成最终的聚合操作，也就是累加相同</span><span lang=EN-US>key</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的数据。</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.5 Count(Distinct) </span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>去重统计</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>先去重再</span><span lang=EN-US>count</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据量小的时候无所谓，数据量大的情况下，由于</span><span lang=EN-US>COUNT DISTINCT</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>操作需要用一个</span><span lang=EN-US>Reduce Task</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>来完成（交给一个</span><span lang=EN-US>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>），这一个</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>需要处理的数据量太大，就会导致整个</span><span lang=EN-US>Job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>很难完成，一般</span><span lang=EN-US>COUNT DISTINCT</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>使用</span> <span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>先</span><span
lang=EN-US>GROUP BY</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>再</span><span
lang=EN-US>COUNT</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的方式<span style='color:red'>替换</span>：</span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>案例实操</span><span lang=EN-US><o:p></o:p></span></b></p>

<p class=1 style='margin-top:6.2pt;margin-right:0cm;margin-bottom:0cm;
margin-left:40.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;mso-char-indent-count:
0;mso-list:l15 level1 lfo11'><![if !supportLists]><span lang=EN-US
style='mso-fareast-font-family:Arial'><span style='mso-list:Ignore'>1．<span
style='font:7.0pt "Times New Roman"'> </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>创建一张大表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; create table
bigtable(id bigint, time bigint, uid string, keyword</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>string, url_rank int, click_num
int, click_url string) row format delimited</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>fields terminated by '\t';</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．加载数据</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
local inpath '/opt/module/datas/bigtable' into table</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US><span
style='mso-spacerun:yes'> </span>bigtable;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．设置</span><span
lang=EN-US>5</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>个</span><span lang=EN-US>reduce</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>个数</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>set mapreduce.job.reduces = 5;</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．执行去重</span><span
lang=EN-US>id</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>查询（只用一个</span><span lang=EN-US>reduce</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>去重）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
count(distinct id) from bigtable;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Stage-Stage-1: Map: 1<span
style='mso-spacerun:yes'>  </span>Reduce: 1<span style='mso-spacerun:yes'>  
</span>Cumulative CPU: 7.12 sec<span style='mso-spacerun:yes'>   </span>HDFS
Read: 120741990 HDFS Write: 7 SUCCESS</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Total MapReduce CPU Time Spent:
7 seconds 120 msec</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>OK</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>c0</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>100001</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Time taken: 23.607 seconds,
Fetched: 1 row(s)</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．采用</span><span
lang=EN-US>GROUP by</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>去重</span><span lang=EN-US>id</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>（红色部分是去重，替代</span><span
lang=EN-US>distinct</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>，可以有多个</span><span lang=EN-US>reduce</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>去重）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
count(id) from (<span style='color:red'>select id from bigtable group by id</span>)
a;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Stage-Stage-1: Map: 1<span
style='mso-spacerun:yes'>  </span>Reduce: 5<span style='mso-spacerun:yes'>  
</span>Cumulative CPU: 17.53 sec<span style='mso-spacerun:yes'>   </span>HDFS
Read: 120752703 HDFS Write: 580 SUCCESS</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Stage-Stage-2: Map: 1<span
style='mso-spacerun:yes'>  </span>Reduce: 1<span style='mso-spacerun:yes'>  
</span>Cumulative CPU: 4.29 sec<span style='mso-spacerun:yes'>   </span>HDFS
Read: 9409 HDFS Write: 7 SUCCESS</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Total MapReduce CPU Time Spent:
21 seconds 820 msec</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>OK</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>_c0</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>100001</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Time taken: 50.795 seconds,
Fetched: 1 row(s)</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>虽然会多用一个</span><span lang=EN-US style='color:red'>Job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>来完成，但在数据量大的情况下，这个绝对是值得的。</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.6 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>笛卡尔积</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>尽量避免笛卡尔积，</span><span lang=EN-US>join</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的时候不加</span><span lang=EN-US>on</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>条件，或者无效的</span><span lang=EN-US>on</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>条件，</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>只能使用</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>个</span><span
lang=EN-US>reducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>来完成笛卡尔积。</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.7 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>行列过滤</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>列处理：在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SELECT</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中，只拿需要的列，如果有，尽量使用分区过滤，少用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SELECT *</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>行处理：在分区剪裁中，当使用外关联时，如果将副表的过滤条件写在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Where</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>后面，那么就会先全表关联，之后再过滤，可以优化为先用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>where</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>得到子查询，然后再</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>join</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，比如：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例实操：</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></b></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．测试先关联两张表，再用</span><span
lang=EN-US>where</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>条件过滤</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select o.id
from bigtable b</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>join ori o on o.id = b.id</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>where o.id &lt;= 10; </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（这是全部</span><span lang=EN-US>join</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>才过滤</span><span
lang=EN-US>where</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>条件，</span><span lang=EN-US>join</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>是很耗性能的）</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:22.4pt;line-height:16.5pt'><span
lang=EN-US style='font-size:10.5pt;mso-font-kerning:1.0pt'>Time taken: <span
style='color:red'>34.406</span> seconds, Fetched: 100 row(s)<o:p></o:p></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．通过子查询后，再关联表</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select b.id
from bigtable b</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>join (<span style='color:red'>select
id from ori where id &lt;= 10 </span>) o on b.id = o.id; </span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（先使用</span><span lang=EN-US>where</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>的条件作为子查询，这样就数据小了，再</span><span
lang=EN-US>join</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>）</span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:22.4pt;line-height:16.5pt'><span
lang=EN-US style='font-size:10.5pt;mso-font-kerning:1.0pt'>Time taken: <span
style='color:red'>30.058</span> seconds, Fetched: 100 row(s)<o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.8 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>动态分区调整</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_149"
 o:spid="_x0000_i1077" type="#_x0000_t75" style='width:534.6pt;height:229.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image155.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>就比如，按照时间，每天或者每月的数据放在一个分区，这种根据时间或者具体的数据动态分区。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>关系型数据库中，对分区表</span><span lang=EN-US>Insert</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据时候，数据库自动会根据分区字段的值，将数据插入到相应的分区中，</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中也提供了类似的机制，即动态分区</span><span lang=EN-US>(Dynamic Partition)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，只不过，使用</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的动态分区，需要进行相应的配置。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．开启动态分区参数设置</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）开启动态分区功能（默认</span><span
lang=EN-US>true</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，开启）</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
16.5pt'><span lang=EN-US style='color:red'>hive.exec.dynamic.partition=true<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）设置为非严格模式（动态分区的模式，默认</span><span
lang=EN-US>strict</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，严格模式，表示必须指定至少一个分区为静态分区，即分区要指定固定的值，</span><span
lang=EN-US>nonstrict</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是非严格模式，表示允许所有的分区字段都可以使用动态分区。）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.exec.dynamic.partition.mode=nonstrict</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）在<span
style='color:red'>所有</span>执行</span><span lang=EN-US>MR</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的节点上，最大一共可以创建多少个动态分区。</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.exec.max.dynamic.partitions=1000</span></p>

<p class=MsoNormal style='line-height:16.5pt'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>4</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）<span style='color:red'>在每个执行</span></span><span
lang=EN-US style='color:red'>MR</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>的节点上，最大可以创建多少个动态分区。</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>该参数需要根据实际的数据来设定。比如：源数据中包含了一年的数据，即</span><span lang=EN-US>day</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>字段（按天）有</span><span lang=EN-US>365</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个值，那么该参数就需要设置成大于</span><span lang=EN-US>365</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，如果使用默认值</span><span lang=EN-US>100</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，则会报错。</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.exec.max.dynamic.partitions.pernode=100</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>5</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）整个</span><span
lang=EN-US>MR Job</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中，最大可以创建多少个</span><span lang=EN-US>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件。</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.exec.max.created.files=100000</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>6</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）当有空分区生成时，是否抛出异常，</span><span
lang=EN-US>false</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>不抛异常。一般不需要设置。</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.error.on.empty.partition=false</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>需求：将</span><span lang=EN-US>ori</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中的数据按照时间</span><span lang=EN-US>(</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>如：</span><span lang=EN-US>20111230000008)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，插入到目标表</span><span lang=EN-US style='color:#7030A0'>ori_partitioned_target</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的相应分区中。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）创建分区表</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=912
 style='width:546.9pt;margin-left:26.7pt;border-collapse:collapse;mso-yfti-tbllook:
 1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:38.9pt'>
  <td width=912 valign=top style='width:546.9pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:38.9pt'>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>create table
  ori_partitioned(id bigint, time bigint, uid string, keyword string,</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>url_rank int, click_num int, click_url
  string) </span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='background:red;
  mso-highlight:red'>partitioned by (p_time bigint)</span><span lang=EN-US> </span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>row format delimited fields
  terminated by '\t';</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
  color:blue;mso-font-kerning:0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）加载数据到分区表中（静态分区）</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=907
 style='width:544.35pt;margin-left:26.7pt;border-collapse:collapse;mso-yfti-tbllook:
 1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:42.45pt'>
  <td width=907 valign=top style='width:544.35pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:42.45pt'>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
  local inpath '/home/atguigu/ds1' into table</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US><span
  style='mso-spacerun:yes'> </span>ori_partitioned <span style='color:red'>partition(p_time='20111230000010')
  </span>;</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; load data
  local inpath '/home/atguigu/ds2' into table ori_partitioned <span
  style='color:red'>partition(p_time='20111230000011') </span>;<span
  style='color:#7030A0'><o:p></o:p></span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）创建目标分区表</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:26.7pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:33.0pt'>
  <td width=898 valign=top style='width:538.85pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:33.0pt'>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>create table ori_partitioned_target(id bigint, time
  bigint, uid string,</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US><span style='mso-spacerun:yes'> </span>keyword
  string, url_rank int, click_num int, click_url string) <span
  style='background:red;mso-highlight:red'>PARTITIONED BY (p_time STRING)</span>
  row format delimited fields terminated by '\t';</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）设置动态分区（动态分区）</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=908
 style='width:544.85pt;margin-left:26.7pt;border-collapse:collapse;mso-yfti-tbllook:
 1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:119.45pt'>
  <td width=908 valign=top style='width:544.85pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:119.45pt'>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>set hive.exec.dynamic.partition = true;</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>set hive.exec.dynamic.partition.mode = nonstrict;</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>set hive.exec.max.dynamic.partitions = 1000;</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>set hive.exec.max.dynamic.partitions.pernode = 100;</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>set hive.exec.max.created.files = 100000;</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>set hive.error.on.empty.partition = false;</span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>hive (default)&gt; insert overwrite table
  ori_partitioned_target <span style='color:red'>partition (p_time)</span> </span></p>
  <p class=a style='margin-left:5.25pt;mso-para-margin-left:.5gd;text-indent:
  32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US>select id, time, uid, keyword, url_rank, click_num,
  click_url, p_time from ori_partitioned;</span><span lang=EN-US
  style='mso-bidi-font-size:10.5pt;color:#7030A0;mso-font-kerning:0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>5</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查看目标分区表的分区情况（结果就是分目录）</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;text-indent:
32.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
leading'><span lang=EN-US>hive (default)&gt; show partitions
ori_partitioned_target;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.9 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分桶</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:150%;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red;background:yellow;mso-highlight:yellow'>详见</span><span lang=EN-US
style='color:red;background:yellow;mso-highlight:yellow'>6.6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red;background:yellow;mso-highlight:yellow'>章。</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.3.10 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分区</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:150%;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red;background:yellow;mso-highlight:yellow'>详见</span><span lang=EN-US
style='color:red;background:yellow;mso-highlight:yellow'>4.6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red;background:yellow;mso-highlight:yellow'>章。</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.4 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据倾斜</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><a name="_Toc374199304"><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>9.4.1 </span></a><span
style='mso-bookmark:_Toc374199304'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>合理设置</span></span><span style='mso-bookmark:_Toc374199304'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>Map</span></span><span
style='mso-bookmark:_Toc374199304'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数</span></span><span style='mso-bookmark:_Toc374199304'></span><span
lang=EN-US style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:150%;mso-pagination:widow-orphan'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US>1</span></b><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）通常情况下，作业会通过</span><span lang=EN-US>input</span></b><b
style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的目录产生一个或者多个</span><span
lang=EN-US>map</span></b><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>任务。</span><span lang=EN-US><o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:150%;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>主要的决定因素有：</span><span
lang=EN-US>input</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的文件总个数，</span><span lang=EN-US>input</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的文件大小，集群设置的文件块大小。</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:1.4pt;line-height:150%;mso-pagination:widow-orphan'><b
style='mso-bidi-font-weight:normal'><span lang=EN-US>2</span></b><b
style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）是不是</span><span
lang=EN-US>map</span></b><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数越多越好？</span><span lang=EN-US><o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:150%;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>答案是否定的。如果一个任务有很多小文件（远远小于块大小</span><span
lang=EN-US>128m</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>），则每个小文件也会被当做一个块，用一个</span><span
lang=EN-US>map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>任务来完成，而一个</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>任务启动和初始化的时间远远大于逻辑处理的时间，就会造成很大的资源浪费。而且，同时可执行的</span><span
lang=EN-US>map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数是受限的。</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:150%;mso-pagination:widow-orphan'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US>3</span></b><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）是不是保证每个</span><span lang=EN-US>map</span></b><b
style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>处理接近</span><span
lang=EN-US>128m</span></b><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的文件块，就高枕无忧了？</span><span lang=EN-US><o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:150%;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>答案也是不一定。比如有一个</span><span
lang=EN-US>127m</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的文件，正常会用一个</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>去完成，但这个文件只有一个或者两个小字段，却有几千万的记录，如果</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>处理的逻辑比较复杂，用一个</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>任务去做，肯定也比较耗时。</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:150%;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>针对上面的问题</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，我们需要采取两种方式来解决：即减少</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数和增加</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数；</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.4.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>小文件进行合并</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:150%;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在</span><span
lang=EN-US>map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>执行前合并小文件，减少</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数：</span><span lang=EN-US>CombineHiveInputFormat</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>具有对小文件进行合并的功能（系统默认的格式）。</span><span lang=EN-US>HiveInputFormat</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>没有对小文件合并功能。</span></p>

<p class=a><span lang=EN-US>set hive.input.format=
org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.4.3 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>复杂文件增加</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Map</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'><o:p></o:p></span></h3>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:150%;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>当</span><span
lang=EN-US>input</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的文件都很大，任务逻辑复杂，</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>执行非常慢的时候，可以考虑增加</span><span lang=EN-US>Map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数，来使得每个</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>处理的数据量减少，从而提高任务的执行效率。</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>增加</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的方法为：根据</span><span lang=EN-US>computeSliteSize(Math.max(minSize,Math.min(maxSize,blocksize)))=blocksize=128M</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>公式，调整</span><span lang=EN-US>maxSize</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>最大值。让</span><span lang=EN-US>maxSize</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>最大值低于</span><span lang=EN-US>blocksize</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>就可以增加</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的个数。</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%;
mso-pagination:widow-orphan'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>案例实操：</span><span lang=EN-US><o:p></o:p></span></b></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．执行查询</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
count(*) from emp;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Hadoop job information for
Stage-1: number of mappers: 1; number of reducers: 1</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．设置最大切片值为</span><span
lang=EN-US>100</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>个字节</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; set mapreduce.input.fileinputformat.split.maxsize=100;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; select
count(*) from emp;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>Hadoop job information for
Stage-1: number of mappers: 6; number of reducers: 1</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>9.4.4 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>合理设置</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>Reduce</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数</span><span lang=EN-US style='font-size:14.0pt;line-height:
172%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．调整</span><span
lang=EN-US>reduce</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>个数方法一</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:16.5pt;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）每个</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>处理的数据量默认是</span><span lang=EN-US>256MB</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.exec.reducers.bytes.per.reducer=256000000</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:16.5pt;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）每个任务最大的</span><span lang=EN-US>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数，默认为</span><span lang=EN-US>1009</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive.exec.reducers.max=1009</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:16.5pt;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）计算</span><span lang=EN-US>reducer</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数的公式</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>N=min(</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>参数</span><span lang=EN-US>2</span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>，总输入数据量</span><span
lang=EN-US>/</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>参数</span><span lang=EN-US>1)</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．调整</span><span
lang=EN-US>reduce</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>个数方法二（与方法一冲突）</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:19.6pt;
line-height:16.5pt;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在</span><span
lang=EN-US>hadoop</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的</span><span lang=EN-US>mapred-default.xml</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件中修改</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:19.6pt;
line-height:16.5pt;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>设置每个</span><span
lang=EN-US>job</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个数</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>set mapreduce.job.reduces = 15;<span
style='color:red'><o:p></o:p></span></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>reduce</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>个数并不是越多越好</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:1.4pt;line-height:16.5pt;mso-pagination:widow-orphan'><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）过多的启动和初始化</span><span lang=EN-US>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>也会消耗时间和资源；</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:16.5pt;mso-pagination:widow-orphan'><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）另外，有多少个</span><span lang=EN-US>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，就会有多少个输出文件，如果生成了很多个小文件，那么如果这些小文件作为下一个任务的输入，则也会出现小文件过多的问题；</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:22.4pt;
line-height:150%;mso-pagination:widow-orphan'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在设置</span><span
lang=EN-US>reduce</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>个数的时候也需要考虑这两个原则：<span
style='color:red'>处理大数据量利用合适的</span></span><span lang=EN-US style='color:red'>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>数；使单个</span><span lang=EN-US style='color:red'>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>任务处理数据量大小要合适；</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.5 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>并行执行</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>会将一个查询转化成一个或者多个阶段。这样的阶段可以是</span><span
lang=EN-US>MapReduce</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>阶段、抽样阶段、合并阶段、</span><span
lang=EN-US>limit</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>阶段。或者</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>执行过程中可能需要的其他阶段。默认情况下，</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>一次只会执行一个阶段。不过，某个特定的</span><span lang=EN-US>job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>可能包含众多的阶段，而这些阶段可能并非完全互相依赖的，也就是说有些阶段是可以并行执行的，这样可能使得整个</span><span
lang=EN-US>job</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的执行时间缩短。不过，如果有更多的阶段可以并行执行，那么</span><span
lang=EN-US>job</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可能就越快完成。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>通过设置参数</span><span
lang=EN-US>hive.exec.parallel</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>值为</span><span
lang=EN-US>true</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，就可以开启并发执行。不过，在共享集群中，需要注意下，如果</span><span
lang=EN-US>job</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>中并行阶段增多，那么集群利用率就会增加。</span></p>

<p class=a><span lang=EN-US>set hive.exec.parallel=true;&nbsp;&nbsp;<span
style='mso-spacerun:yes'>            </span>//</span><span style='font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>打开任务并行执行，默认</span><span
lang=EN-US>false</span></p>

<p class=a><span lang=EN-US>set hive.exec.parallel.thread.number=16;<span
style='mso-spacerun:yes'>  </span>//</span><span style='font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>同一个</span><span
lang=EN-US>sql</span><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>允许最大并行度，默认为</span><span lang=EN-US>8</span><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当然，得是在系统资源比较空闲的时候才有优势，否则，没资源，并行也起不来，对集群性能要求高。</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.6 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>严格模式</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（不是动态分区的严格模式，这俩不一样）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>提供了一个严格模式，可以防止用户执行那些可能意想不到的不好的影响的查询。公司当中默认打开。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>通过设置属性</span><span
lang=EN-US>hive.mapred.mode</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>值为默认是非严格模式</span><span
lang=EN-US style='color:red'>nonstrict</span><span lang=EN-US> </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。开启严格模式需要修改</span><span lang=EN-US>hive.mapred.mode</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>值为</span><span lang=EN-US>strict</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，开启严格模式可以禁止</span><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>种类型的查询。</span></p>

<p class=a><span lang=EN-US>&lt;property&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>&lt;name&gt;hive.mapred.mode&lt;/name&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>&lt;value&gt;strict&lt;/value&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>&lt;description&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>      </span>The
mode in which the Hive operations are being performed. </span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>      </span>In
strict mode, some risky queries are not allowed to run. They include:</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>Cartesian Product.</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>        </span>No
partition being picked up for a query.</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>Comparing bigints and strings.</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>Comparing bigints and doubles.</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>Orderby without limit.</span></p>

<p class=a style='text-indent:16.5pt'><span lang=EN-US>&lt;/description&gt;</span></p>

<p class=a style='text-indent:16.5pt'><span lang=EN-US>&lt;/property&gt;</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt;line-height:
150%;mso-list:l8 level1 lfo18'><![if !supportLists]><span lang=EN-US
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>1)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对于分区表，<span style='color:red'>除非</span></span><span
lang=EN-US style='color:red'>where</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>语句中含有分区字段过滤条件来限制范围，否则不允许执行。</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>换句话说，就是用户不允许扫描所有分区。进行这个限制的原因是，通常分区表都拥有非常大的数据集，而且数据增加迅速。没有进行分区限制的查询可能会消耗令人不可接受的巨大资源来处理这个表。</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt;line-height:
150%;mso-list:l8 level1 lfo18'><![if !supportLists]><span lang=EN-US
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>2)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对于<span style='color:red'>使用了</span></span><span lang=EN-US
style='color:red'>order by</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>语句的查询，要求必须使用</span><span
lang=EN-US style='color:red'>limit</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>语句。</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>因为</span><span lang=EN-US>order by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为了执行排序过程会将所有的结果数据分发到同一个</span><span lang=EN-US>Reducer</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中进行处理，强制要求用户增加这个</span><span lang=EN-US>LIMIT</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语句可以防止</span><span lang=EN-US>Reducer</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>额外执行很长一段时间。</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt;line-height:
150%;mso-list:l8 level1 lfo18'><![if !supportLists]><span lang=EN-US
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>3)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>限制笛卡尔积的查询。</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对关系型数据库非常了解的用户可能期望在执行</span><span
lang=EN-US>JOIN</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>查询的时候不使用</span><span lang=EN-US>ON</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语句而是使用</span><span lang=EN-US>where</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语句，这样关系数据库的执行优化器就可以高效地将</span><span lang=EN-US>WHERE</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语句转化成那个</span><span lang=EN-US>ON</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语句。不幸的是，</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>并不会执行这种优化，因此，如果表足够大，那么这个查询就会出现不可控的情况。</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.7 JVM</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>重用</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>特别好的优化。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>JVM</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>重用是</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>调优参数的内容，其对</span><span lang=EN-US>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的性能具有非常大的影响，特别是对于很难避免<span style='color:red'>小文件的场景或</span></span><span
lang=EN-US style='color:red'>task</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>特别多的场景，这类场景大多数执行时间都很短。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>Hadoop</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的默认配置通常是使用派生</span><span lang=EN-US>JVM</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>来执行</span><span lang=EN-US>map</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>和</span><span
lang=EN-US>Reduce</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>任务的。这时</span><span lang=EN-US>JVM</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的启动过程可能会造成相当大的开销，尤其是执行的</span><span lang=EN-US>job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>包含有成百上千</span><span lang=EN-US>task</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>任务的情况。</span><span lang=EN-US style='color:red'>JVM</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>重用可以使得</span><span lang=EN-US style='color:red'>JVM</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>实例在同一个</span><span lang=EN-US style='color:red'>job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>中重新使用</span><span lang=EN-US style='color:red'>N</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>次。</span><span lang=EN-US>N</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的值可以在</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span><span lang=EN-US>mapred-site.xml</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件中进行配置。默认是</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，通常在</span><span lang=EN-US>10-20</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>之间，具体多少需要根据具体业务场景测试得出。</span></p>

<p class=a><span lang=EN-US>&lt;property&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
</span>&lt;name&gt;mapreduce.job.jvm.numtasks&lt;/name&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
</span>&lt;value&gt;10&lt;/value&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
</span>&lt;description&gt;How many tasks to run per jvm. If set to -1, there is</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>  </span>no limit. </span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
</span>&lt;/description&gt;</span></p>

<p class=a><span lang=EN-US>&lt;/property&gt;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>这个功能的缺点是，开启</span><span lang=EN-US>JVM</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>重用将一直占用使用到的</span><span lang=EN-US>task</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>插槽，以便进行重用，直到任务完成后才能释放。如果某个</span><span lang=EN-US>“</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>不平衡的</span><span lang=EN-US>”job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中有某几个</span><span lang=EN-US>reduce task</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>执行的时间要比其他</span><span lang=EN-US>Reduce task</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>消耗的时间多的多的话，那么保留的插槽就会一直空闲着却无法被其他的</span><span lang=EN-US>job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>使用，直到所有的</span><span lang=EN-US>task</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>都结束了才会释放。</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.8 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>推测执行</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在分布式集群环境下，因为程序</span><span lang=EN-US>Bug</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（包括</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>本身的</span><span lang=EN-US>bug</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>），负载不均衡或者资源分布不均等原因，会造成同一个作业的多个任务之间运行速度不一致，有些任务的运行速度可能明显慢于其他任务（比如一个作业的某个任务进度只有</span><span
lang=EN-US>50%</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，而其他所有任务已经运行完毕），则这些任务会拖慢作业的整体执行进度。为了避免这种情况发生，</span><span
lang=EN-US>Hadoop</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>采用了推测执行（</span><span lang=EN-US>Speculative
Execution</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）机制，它根据一定的法则推测出</span><span
lang=EN-US>“</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>拖后腿</span><span lang=EN-US>”</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的任务，并为这样的任务启动一个备份任务，让该任务与原始任务同时处理同一份数据，并最终选用最先成功运行完成任务的计算结果作为最终结果。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>设置开启推测执行参数：</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span><span lang=EN-US>mapred-site.xml</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件中进行配置</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US>&lt;property&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
  </span>&lt;name&gt;mapreduce.map.speculative&lt;/name&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
  </span>&lt;value&gt;true&lt;/value&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
  </span>&lt;description&gt;If true, then multiple instances of some map tasks </span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'>              
  </span>may be executed in parallel.&lt;/description&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;/property&gt;</span></p>
  <p class=a><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=a><span lang=EN-US>&lt;property&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'>  </span>&lt;name&gt;mapreduce.reduce.speculative&lt;/name&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
  </span>&lt;value&gt;true&lt;/value&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
  </span>&lt;description&gt;If true, then multiple instances of some reduce
  tasks </span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'>              
  </span>may be executed in parallel.&lt;/description&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;/property&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:16.5pt;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>不过</span><span lang=EN-US>hive</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>本身也提供了配置项来控制</span><span
lang=EN-US>reduce-side</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的推测执行：</span><span
lang=EN-US style='font-family:"Calibri","sans-serif";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-yfti-tbllook:1184;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
  </span>&lt;property&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'>  </span><span
  style='mso-spacerun:yes'>  </span>&lt;name&gt;hive.mapred.reduce.tasks.speculative.execution&lt;/name&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'>   
  </span>&lt;value&gt;true&lt;/value&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'>   
  </span>&lt;description&gt;Whether speculative execution for reducers should
  be turned on. &lt;/description&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-spacerun:yes'> 
  </span>&lt;/property&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>关于调优这些推测执行变量，还很难给一个具体的建议。<span style='color:red'>如果用户对于运行时的偏差非常敏感的话，那么可以将这些功能关闭掉。</span>如果用户因为输入数据量很大而需要执行长时间的</span><span
lang=EN-US>map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>或者</span><span lang=EN-US>Reduce task</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的话，那么启动推测执行造成的浪费是非常巨大大。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_150" o:spid="_x0000_i1076"
 type="#_x0000_t75" style='width:523.8pt;height:271.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image156.png" o:title=""/>
</v:shape></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.9 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>压缩</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red;background:yellow;mso-highlight:yellow'>详见第</span><span lang=EN-US
style='color:red;background:yellow;mso-highlight:yellow'>8</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red;background:yellow;mso-highlight:yellow'>章。</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>9.10 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>执行计划（</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>Explain</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>就是可以看到</span><span lang=EN-US>SQL</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>具体会怎么执行，可以看到</span><span lang=EN-US>SQL</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>会执行的计划内容。对</span><span lang=EN-US>hive</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span><span lang=EN-US>SQL</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的调优是经常要看的。</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．基本语法</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
lang=EN-US>EXPLAIN [EXTENDED | DEPENDENCY | AUTHORIZATION] query</span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查看下面这条语句的执行计划（有截图）</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; explain
select * from emp;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; explain
select deptno, avg(sal) avg_sal from emp group by deptno;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:16.5pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查看详细执行计划</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; explain
extended select * from emp;</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US>hive (default)&gt; explain
extended select deptno, avg(sal) avg_sal from emp group by deptno;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_151"
 o:spid="_x0000_i1075" type="#_x0000_t75" style='width:567pt;height:211.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image157.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_152"
 o:spid="_x0000_i1074" type="#_x0000_t75" style='width:567pt;height:22.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image158.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US>key</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_153"
 o:spid="_x0000_i1073" type="#_x0000_t75" style='width:567pt;height:271.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image159.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US>output</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_154"
 o:spid="_x0000_i1072" type="#_x0000_t75" style='width:567pt;height:264.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image160.png" o:title=""/>
</v:shape></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>10</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'> Hive</span><span style='font-size:
15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>实战之谷粒影音</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:150%'><span lang=EN-US
style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'>10.1
</span><span style='font-size:14.0pt;line-height:150%;font-family:黑体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>需求描述</span><span
lang=EN-US style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计硅谷影音视频网站的常规指标，各种</span><span
lang=EN-US>TopN</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>指标：</span></p>

<p class=MsoNormal><span lang=EN-US>--</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计视频观看数</span><span
lang=EN-US>Top10</span></p>

<p class=MsoNormal><span lang=EN-US>--</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计视频类别热度</span><span
lang=EN-US>Top10</span></p>

<p class=MsoNormal><span lang=EN-US>--</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计视频观看数</span><span
lang=EN-US>Top20</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所属类别</span></p>

<p class=MsoNormal><span lang=EN-US>--</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计视频观看数</span><span
lang=EN-US>Top50</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所关联视频的所属类别</span><span lang=EN-US>Rank</span></p>

<p class=MsoNormal><span lang=EN-US>--</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计每个类别中的视频热度</span><span
lang=EN-US>Top10</span></p>

<p class=MsoNormal><span lang=EN-US>--</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计每个类别中视频流量</span><span
lang=EN-US>Top10</span></p>

<p class=MsoNormal><span lang=EN-US>--</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计上传视频最多的用户</span><span
lang=EN-US>Top10</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>以及他们上传的视频</span></p>

<p class=MsoNormal><span lang=EN-US>--</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计每个类别视频观看数</span><span
lang=EN-US>Top10</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:150%'><span lang=EN-US
style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'>10.2
</span><span style='font-size:14.0pt;line-height:150%;font-family:黑体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>项目</span><span
lang=EN-US style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:150%'><span lang=EN-US
style='font-size:14.0pt;line-height:150%'>10.2.1 </span><span style='font-size:
14.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据结构</span><span lang=EN-US
style='font-size:14.0pt;line-height:150%'><o:p></o:p></span></h3>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．视频表</span></p>

<p class=10 align=center style='text-align:center;text-indent:0cm;mso-char-indent-count:
0;line-height:150%'><span style='font-size:9.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black;mso-bidi-font-weight:bold'>表</span><span lang=EN-US
style='font-size:9.0pt;line-height:150%;font-family:"Times New Roman","serif";
color:black;mso-bidi-font-weight:bold'>6-13 </span><span style='font-size:9.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-bidi-font-weight:bold'>视频表</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Times New Roman","serif";
color:black;mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-top-alt:solid windowtext .5pt;
 mso-border-bottom-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=237 valign=top style='width:142.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>字段</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>备注</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>详细描述</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>video
  id<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>视频唯一</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>id<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>11</span><span
  style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>位字符串</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>uploader<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>视频上传者</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>上传视频的用户名</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>String<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>age<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>视频年龄</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>视频在平台上的整数天</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>category<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>视频类别</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>上传视频指定的视频分类</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>length<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>视频长度</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>整形数字标识的视频长度</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>views<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>观看次数</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>视频被浏览的次数</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>rate<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>视频评分</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>满分</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>5</span><span
  style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>分</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>ratings<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>流量</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>视频的流量，整型数字</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>conments<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>评论数</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>一个视频的整数评论数</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10;mso-yfti-lastrow:yes'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>related
  ids<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>相关视频</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>id<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>相关视频的</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>id</span><span
  style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>，最多</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>20</span><span
  style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>个</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．用户表</span></p>

<p class=10 align=center style='text-align:center;text-indent:0cm;mso-char-indent-count:
0;line-height:150%'><span style='font-size:9.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black;mso-bidi-font-weight:bold'>表</span><span lang=EN-US
style='font-size:9.0pt;line-height:150%;font-family:"Times New Roman","serif";
color:black;mso-bidi-font-weight:bold'>6-14 </span><span style='font-size:9.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-bidi-font-weight:bold'>用户表</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Times New Roman","serif";
color:black;mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-top-alt:solid windowtext .5pt;
 mso-border-bottom-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=237 valign=top style='width:142.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>字段</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>备注</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>字段类型</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>uploader<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>上传者用户名</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>string<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>videos<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>上传视频数</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>int<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=237 valign=top style='width:142.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>friends<o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-size:7.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri'>朋友数量</span><span
  lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>
  </td>
  <td width=237 valign=top style='width:142.05pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;background:
  #E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:7.5pt;font-family:"Calibri","sans-serif"'>int<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_155"
 o:spid="_x0000_i1071" type="#_x0000_t75" style='width:394.2pt;height:126pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image161.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_156"
 o:spid="_x0000_i1070" type="#_x0000_t75" style='width:567pt;height:333pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image162.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这是一个数据，但是都是</span><span lang=EN-US>\t</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>隔开的（选中的会显示为</span><span lang=EN-US>-</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>），前面的数据也是</span><span lang=EN-US>\t</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>隔开的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_157"
 o:spid="_x0000_i1069" type="#_x0000_t75" style='width:567.6pt;height:37.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image163.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>有些又有</span><span lang=EN-US>&amp;</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>符号，中海油空格（选中之后显示为点）</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_158"
 o:spid="_x0000_i1068" type="#_x0000_t75" style='width:567pt;height:24.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image164.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据要求</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_160"
 o:spid="_x0000_i1067" type="#_x0000_t75" style='width:448.2pt;height:198.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image165.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_170"
 o:spid="_x0000_i1066" type="#_x0000_t75" style='width:285.6pt;height:84pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image166.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_169"
 o:spid="_x0000_i1065" type="#_x0000_t75" style='width:387pt;height:355.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image167.png" o:title=""/>
</v:shape></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.2.2 ETL</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>原始数据</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>通过观察原始数据形式，可以发现，视频可以有多个所属分类，每个所属分类用</span><span lang=EN-US>&amp;</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>符号分割，且分割的两边有空格字符，同时相关视频也是可以有多个元素，多个相关视频又用“</span><span
lang=EN-US>\t</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>”进行分割。为了分析数据时方便对存在多个子元素的数据进行操作，我们首先进行数据重组清洗操作。即：将所有的类别用“</span><span
lang=EN-US>&amp;</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>”分割，同时去掉两边空格，多个相关视频</span><span
lang=EN-US>id</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>也使用“</span><span lang=EN-US>&amp;</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”进行分割。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>依赖</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_161" o:spid="_x0000_i1064"
 type="#_x0000_t75" style='width:282.6pt;height:279pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image168.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_162" o:spid="_x0000_i1063"
 type="#_x0000_t75" style='width:288.6pt;height:41.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hive.files/image169.png" o:title=""/>
</v:shape></span></p>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>ETL</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>之</span><span lang=EN-US>ETLUtil</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>public class ETLUtil {<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>public
  static String oriString2ETLString(String ori){<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>StringBuilder
  etlString = new StringBuilder();<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>String[]
  splits = ori.split(&quot;\t&quot;);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>if(splits.length
  &lt; 9) return null;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>splits[3]
  = splits[3].replace(&quot; &quot;, &quot;&quot;); // </span><span
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial'>去掉类别字段中的空格</span><span
  lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>for(int
  i = 0; i &lt; splits.length; i++){ // </span><span style='font-size:8.0pt;
  mso-bidi-font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial'>替换关联视频的分隔符</span><span
  lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:3'>             </span>if(i
  &lt; 9){<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:4'>                  </span>if(i
  == splits.length - 1){<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:5'>                      </span>etlString.append(splits[i]);<span
  style='mso-tab-count:5'>                    </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:4'>                  </span>}else{<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:5'>                      </span>etlString.append(splits[i]
  + &quot;\t&quot;);<span style='mso-tab-count:1'>    </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:4'>                  </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:3'>             </span>}else{<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:4'>                  </span>if(i
  == splits.length - 1){<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span><span
  style='mso-tab-count:4'>                  </span>etlString.append(splits[i]);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:4'>                  </span>}else{<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:5'>                      </span>etlString.append(splits[i]
  + &quot;&amp;&quot;);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:4'>                  </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:3'>             </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>return
  etlString.toString();<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>}</span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>ETL</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>之</span><span lang=EN-US>Mapper</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=933 valign=top style='width:559.95pt;background:#E7E6E6;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.commons.lang.StringUtils;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import com.atguigu.util.ETLUtil;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>public class VideoETLMapper extends
  Mapper&lt;Object, Text, NullWritable, Text&gt;{<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>Text k =
  new Text();<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>@Override<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>protected
  void map(Object key, Text value, Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>String
  etlString = ETLUtil.oriString2ETLString(value.toString()); // </span><span
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial'>获取一条数据并清洗</span><span
  lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>if(StringUtils.isBlank(etlString))
  return;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>k.set(etlString);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>context.write(k,
  NullWritable.get());<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>}<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>ETL</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>之</span><span lang=EN-US>Runner</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.fs.FileSystem;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.util.Tool;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>import org.apache.hadoop.util.ToolRunner;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>public class VideoETLRunner implements Tool {<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>private
  Configuration conf = null;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>@Override<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>public
  void setConf(Configuration conf) {<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>this.conf
  = conf;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>@Override<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>public
  Configuration getConf() {<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>return
  this.conf;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>@Override<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>public
  int run(String[] args) throws Exception {<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>conf
  = this.getConf();<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>Job
  job = Job.getInstance(conf);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>job.setJarByClass(VideoETLRunner.class);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>job.setMapperClass(VideoETLMapper.class);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>job.setMapOutputKeyClass(NullWritable.class);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>job.setMapOutputValueClass(Text.class);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>//job.setNumReduceTasks(0);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span><span
  style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>   </span>FileOutputFormat.setOutputPaths(job, new
  Path(args[1]));<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span><span
  style='mso-tab-count:1'>    </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>return
  job.waitForCompletion(true) ? 0 : 1;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>public
  static void main(String[] args) {<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>try
  {<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span><span
  style='mso-tab-count:2'>         </span>int resultCode = ToolRunner.run(new
  VideoETLRunner(), args);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:3'>             </span>if(resultCode
  == 0){<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:4'>                  </span>System.out.println(&quot;Success!&quot;);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:3'>             </span>}else{<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:4'>                  </span>System.out.println(&quot;Fail!&quot;);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:3'>             </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:3'>             </span>System.exit(resultCode);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>}
  catch (Exception e) {<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:3'>             </span>e.printStackTrace();<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:3'>             </span>System.exit(1);<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:2'>         </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>}<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=1 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．执行</span><span
lang=EN-US>ETL</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可以先复制一些需要过滤的数据，测试一下过滤行不行，比如</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_163"
 o:spid="_x0000_i1062" type="#_x0000_t75" style='width:566.4pt;height:187.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image170.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_164"
 o:spid="_x0000_i1061" type="#_x0000_t75" style='width:567.6pt;height:43.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image171.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>然后再执行</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>从本地上传数据、</span><span lang=EN-US>jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>到服务器</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_165"
 o:spid="_x0000_i1060" type="#_x0000_t75" style='width:135pt;height:94.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image172.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_166"
 o:spid="_x0000_i1059" type="#_x0000_t75" style='width:337.8pt;height:221.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image173.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_168"
 o:spid="_x0000_i1058" type="#_x0000_t75" style='width:348pt;height:28.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image174.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>再上传到</span><span lang=EN-US>HDFS</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_171"
 o:spid="_x0000_i1057" type="#_x0000_t75" style='width:486pt;height:37.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image175.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_172"
 o:spid="_x0000_i1056" type="#_x0000_t75" style='width:567pt;height:138pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image176.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_175"
 o:spid="_x0000_i1055" type="#_x0000_t75" style='width:567pt;height:105.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image177.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>执行</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_173"
 o:spid="_x0000_i1054" type="#_x0000_t75" style='width:529.8pt;height:19.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image178.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>或者</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>$ bin/yarn jar ~/softwares/jars/gulivideo-0.0.1-SNAPSHOT.jar
  \<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>com.atguigu.etl.ETLVideosRunner \<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>/gulivideo/video/2008/0222 \<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>/gulivideo/output/video/2008/0222</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>处理的结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_174"
 o:spid="_x0000_i1053" type="#_x0000_t75" style='width:567pt;height:129pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image179.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:150%'><span lang=EN-US
style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'>10.3
</span><span style='font-size:14.0pt;line-height:150%;font-family:黑体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>准备工作</span><span
lang=EN-US style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.3.1 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建表</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建表：</span><span lang=EN-US>gulivideo_ori</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，</span><span lang=EN-US>gulivideo_user_ori</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建表：</span><span lang=EN-US>gulivideo_orc</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，</span><span lang=EN-US>gulivideo_user_orc</span></p>

<p class=MsoNormal><span lang=EN-US>gulivideo_ori</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>create table gulivideo_ori(<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>videoId
  string, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>uploader string, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>age
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>category array&lt;string&gt;, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>length
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>rate
  float, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>ratings
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>comments int,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>relatedId
  array&lt;string&gt;)<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>row format delimited <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>fields terminated by &quot;\t&quot;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>collection items terminated by &quot;&amp;&quot;<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>stored as textfile;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>gulivideo_user_ori</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>create table gulivideo_user_ori(<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>uploader string,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>videos
  int,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>friends
  int)<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>row format delimited <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>fields terminated by &quot;\t&quot; <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>stored as textfile;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>然后把原始数据插入到</span><span lang=EN-US>orc</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表中</span></p>

<p class=MsoNormal><span lang=EN-US>gulivideo_orc</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>create table gulivideo_orc(<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>videoId
  string, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>uploader string, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>age
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>category array&lt;string&gt;, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>length
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>rate
  float, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>ratings
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>comments int,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>relatedId array&lt;string&gt;)<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>clustered by (uploader) into 8 buckets <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>row format delimited fields terminated by
  &quot;\t&quot; <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>collection items terminated by &quot;&amp;&quot; <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>stored as orc;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>gulivideo_user_orc</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>create table gulivideo_user_orc(<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>uploader string,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>videos
  int,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>friends
  int)<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>row format delimited <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>fields terminated by &quot;\t&quot; <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>stored as orc;</span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.3.2 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>导入</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>ETL</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>后的数据</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US>gulivideo_ori</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>load data inpath &quot;/gulivideo/output/video/2008/0222&quot;
  into table gulivideo_ori;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>gulivideo_user_ori</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>load data inpath &quot;/gulivideo/user/2008/0903&quot;
  into table gulivideo_user_ori;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.3.3 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>向</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>ORC</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>表插入数据</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US>gulivideo_orc</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>insert into table gulivideo_orc select * from gulivideo_ori;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>gulivideo_user_orc</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>insert into table gulivideo_user_orc select *
  from gulivideo_user_ori;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:150%'><span lang=EN-US
style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'>10.4
</span><span style='font-size:14.0pt;line-height:150%;font-family:黑体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>业务分析</span><span
lang=EN-US style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.4.1 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计视频观看数</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Top10<o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>思路：使用</span><span
lang=EN-US style='mso-bidi-font-weight:bold'>order by</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-weight:bold'>按照</span><span lang=EN-US
style='mso-bidi-font-weight:bold'>views</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-weight:bold'>字段做一个全局排序即可，同时我们设置只显示前</span><span lang=EN-US
style='mso-bidi-font-weight:bold'>10</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-weight:bold'>条。</span><span lang=EN-US style='mso-bidi-font-weight:
bold'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>最终代码：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>videoId, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>uploader, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>age, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>category, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>length,
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>rate, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>ratings, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>comments <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>gulivideo_orc
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>desc limit <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>10;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果，忽略字段不全</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_178"
 o:spid="_x0000_i1052" type="#_x0000_t75" style='width:243pt;height:157.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image180.png" o:title=""/>
</v:shape></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.4.2 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计视频类别热度</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Top10<o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>思路：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>1) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>即统计每个类别有多少个视频，显示出包含视频最多的前</span><span
lang=EN-US>10</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>个类别。</span></p>

<p class=MsoNormal><span lang=EN-US>2) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>我们需要按照类别</span><span
lang=EN-US>group by</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>聚合，然后</span><span
lang=EN-US>count</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>组内的</span><span lang=EN-US>videoId</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个数即可。</span></p>

<p class=MsoNormal><span lang=EN-US>3) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>因为当前表结构为：一个视频对应一个或多个类别。所以如果要</span><span
lang=EN-US>group by</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类别，需要先将类别进行列转行</span><span
lang=EN-US>(</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>展开</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，然后再进行</span><span lang=EN-US>count</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>即可。</span></p>

<p class=MsoNormal><span lang=EN-US>4) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>最后按照热度排序，显示前</span><span
lang=EN-US>10</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>条。</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>最终代码：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>category_name as category, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   </span><span
  style='mso-spacerun:yes'> </span>count(t1.videoId) as hot <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from (<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>videoId,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>category_name <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>        </span>gulivideo_orc
  lateral view explode(category) t_catetory as category_name) t1 <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>group by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>t1.category_name <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>hot <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>desc limit <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>10;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_179"
 o:spid="_x0000_i1051" type="#_x0000_t75" style='width:376.2pt;height:183.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image181.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_180"
 o:spid="_x0000_i1050" type="#_x0000_t75" style='width:426.6pt;height:223.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image182.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_181"
 o:spid="_x0000_i1049" type="#_x0000_t75" style='width:285.6pt;height:172.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image183.png" o:title=""/>
</v:shape></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.4.3 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计出视频观看数最高的</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>20</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>个视频的所属类别以及类别包含</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Top20</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>视频的个数</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>思路：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>1) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>先找到观看数最高的</span><span
lang=EN-US>20</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>个视频所属条目的所有信息，降序排列</span></p>

<p class=MsoNormal><span lang=EN-US>2) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>把这</span><span
lang=EN-US>20</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>条信息中的</span><span lang=EN-US>category</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分裂出来</span><span lang=EN-US>(</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>列转行</span><span
lang=EN-US>)</span></p>

<p class=MsoNormal><span lang=EN-US>3) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>最后查询视频分类名称和该分类下有多少个</span><span
lang=EN-US>Top20</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的视频</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>最终代码：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>category_name as category, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>count(t2.videoId) as hot_with_views <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from (<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>        </span>videoId,
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>category_name <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>from (<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>           
  </span>* <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>           
  </span>gulivideo_orc <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>           
  </span>views <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>desc limit <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>           
  </span>20) t1 lateral view explode(category) t_catetory as category_name) t2 <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>group by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>category_name <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>hot_with_views <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>desc;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_182"
 o:spid="_x0000_i1048" type="#_x0000_t75" style='width:210.6pt;height:150pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image184.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_186"
 o:spid="_x0000_i1047" type="#_x0000_t75" style='width:445.8pt;height:229.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image185.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_187"
 o:spid="_x0000_i1046" type="#_x0000_t75" style='width:192pt;height:137.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image186.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.4.4 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计视频观看数</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Top50</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>所关联视频的所属类别</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Rank<o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>思路：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt;mso-list:l12 level1 lfo13'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Times New Roman"'><span
style='mso-list:Ignore'>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>查询出观看数最多的前</span><span
lang=EN-US>50</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>个视频的所有信息</span><span lang=EN-US>(</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>当然包含了每个视频对应的关联视频</span><span lang=EN-US>)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，记为临时表</span><span lang=EN-US>t1</span></p>

<p class=MsoNormal><span lang=EN-US>t1</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：观看数前</span><span
lang=EN-US>50</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的视频</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>* <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>gulivideo_orc
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>desc limit <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>50;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt;mso-list:l12 level1 lfo13'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Times New Roman"'><span
style='mso-list:Ignore'>2)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将找到的</span><span
lang=EN-US>50</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>条视频信息的相关视频</span><span lang=EN-US>relatedId</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>列转行，记为临时表</span><span lang=EN-US>t2</span></p>

<p class=MsoNormal><span lang=EN-US>t2</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：将相关视频的</span><span
lang=EN-US>id</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>进行列转行操作</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>explode(relatedId) as videoId <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-tab-count:1'>    </span>t1;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt;mso-list:l12 level1 lfo13'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Times New Roman"'><span
style='mso-list:Ignore'>3)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将相关视频的</span><span
lang=EN-US>id</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span><span lang=EN-US>gulivideo_orc</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表进行</span><span lang=EN-US>inner join</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>操作</span></p>

<p class=MsoNormal><span lang=EN-US>t5</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>：得到两列数据，一列是</span><span
lang=EN-US>category</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，一列是之前查询出来的相关视频</span><span
lang=EN-US>id</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'> </span>(select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>distinct(t2.videoId), <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>t3.category <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>t2<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>inner join <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>   </span>gulivideo_orc t3 on t2.videoId =
  t3.videoId) t4 lateral view explode(category) t_catetory as category_name;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>4) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>按照视频类别进行分组，统计每组视频个数，然后排行</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>最终代码：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>category_name as category, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>count(t5.videoId) as hot <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from (<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>videoId, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   </span><span
  style='mso-spacerun:yes'>     </span>category_name <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>from (<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>           
  </span>distinct(t2.videoId), <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>           
  </span>t3.category <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>from (<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>           
  </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>               
  </span>explode(relatedId) as videoId <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>           
  </span>from (<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>               
  </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span
  style='mso-spacerun:yes'>                    </span>* <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>               </span>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span
  style='mso-spacerun:yes'>                    </span>gulivideo_orc <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>               
  </span>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span
  style='mso-spacerun:yes'>                    </span>views <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>               
  </span>desc limit <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span
  style='mso-spacerun:yes'>                    </span>50) t1) t2 <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>inner join <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>           
  </span>gulivideo_orc t3 on t2.videoId = t3.videoId) t4 lateral view
  explode(category) t_catetory as category_name) t5<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>group by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>category_name <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>hot <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>desc;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_188"
 o:spid="_x0000_i1045" type="#_x0000_t75" style='width:285.6pt;height:127.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image187.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_191"
 o:spid="_x0000_i1044" type="#_x0000_t75" style='width:441.6pt;height:151.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image188.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_190"
 o:spid="_x0000_i1043" type="#_x0000_t75" style='width:444.6pt;height:181.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image189.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_192"
 o:spid="_x0000_i1042" type="#_x0000_t75" style='width:445.8pt;height:212.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image190.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_193"
 o:spid="_x0000_i1041" type="#_x0000_t75" style='width:235.2pt;height:272.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image191.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.4.5 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计每个类别中的视频热度</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Top10</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，以</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Music</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为例</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（像这种类别经常用的，可以先炸裂放到临时表，就不用每次都炸裂了）</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>思路：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>1) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>要想统计</span><span
lang=EN-US>Music</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>类别中的视频热度</span><span lang=EN-US>Top10</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，需要先找到</span><span lang=EN-US>Music</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类别，那么就需要将</span><span lang=EN-US>category</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>展开，所以可以创建一张表用于存放</span><span lang=EN-US>categoryId</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>展开的数据。</span></p>

<p class=MsoNormal><span lang=EN-US>2) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>向</span><span
lang=EN-US>category</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>展开的表中插入数据。</span></p>

<p class=MsoNormal><span lang=EN-US>3) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计对应类别（</span><span
lang=EN-US>Music</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）中的视频热度。</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>最终代码：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>创建表类别表：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>create table gulivideo_category(<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>videoId
  string, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>uploader string, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>age
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>categoryId string, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>length
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>rate
  float, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>ratings
  int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>comments int, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>relatedId array&lt;string&gt;)<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>row format delimited <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>fields terminated by &quot;\t&quot; <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>collection items terminated by &quot;&amp;&quot; <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>stored as orc;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>向类别表中插入数据：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>insert into table gulivideo_category<span
  style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>videoId,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>uploader,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>age,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>categoryId,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>        </span>length,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>views,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>rate,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>ratings,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>comments,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>relatedId <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>        </span>gulivideo_orc
  lateral view explode(category) catetory as categoryId;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计</span><span lang=EN-US>Music</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类别的</span><span lang=EN-US>Top10</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（也可以统计其他）</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>videoId, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>gulivideo_category
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>where <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>categoryId = &quot;Music&quot; <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>desc limit<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>10;</span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.4.6 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计每个类别中视频流量</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Top10</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，以</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Music</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为例</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>思路：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>1) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>创建视频类别展开表（</span><span
lang=EN-US>categoryId</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>列转行后的表）</span></p>

<p class=MsoNormal><span lang=EN-US>2) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>按照</span><span
lang=EN-US>ratings</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>排序即可</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>最终代码：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>videoId,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>ratings
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>gulivideo_category
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>where <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>categoryId = &quot;Music&quot; <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>ratings
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>desc limit <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>10;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.4.7 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计上传视频最多的用户</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Top10</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>以及他们上传的观看次数在前</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>20</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的视频</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>思路：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>1) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>先找到上传视频最多的</span><span
lang=EN-US>10</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>个用户的用户信息</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>* <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>gulivideo_user_orc
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>videos <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>desc limit <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>10;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>2) </span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>通过</span><span
lang=EN-US>uploader</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>字段与</span><span
lang=EN-US>gulivideo_orc</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>表进行</span><span
lang=EN-US>join</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，得到的信息按照</span><span lang=EN-US>views</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>观看次数进行排序即可。</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>最终代码：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>t2.videoId, <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>t2.views,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>t2.ratings,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>t1.videos,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>t1.friends <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from (<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>        </span>* <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>from <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>        </span>gulivideo_user_orc
  <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>order
  by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>videos desc <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>limit <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>        </span>10)
  t1 <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>join <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>gulivideo_orc
  t2<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>on <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>   
  </span>t1.uploader = t2.uploader <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>order by <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>views
  desc <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>limit <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>20;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_194"
 o:spid="_x0000_i1040" type="#_x0000_t75" style='width:436.8pt;height:190.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image192.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_196"
 o:spid="_x0000_i1039" type="#_x0000_t75" style='width:376.2pt;height:274.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image193.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_197"
 o:spid="_x0000_i1038" type="#_x0000_t75" style='width:277.8pt;height:234pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image194.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>10.4.8 </span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>统计每个类别视频观看数</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'>Top10<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-weight:bold'>思路：</span><span lang=EN-US style='mso-bidi-font-weight:
bold'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>1) </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>先得到</span><span lang=EN-US>categoryId</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>展开的表数据</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>2) </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>子查询按照</span><span lang=EN-US>categoryId</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进行分区，然后分区内排序，并生成递增数字，该递增数字这一列起名为</span><span lang=EN-US>rank</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>列</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>3) </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>通过子查询产生的临时表，查询</span><span lang=EN-US>rank</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>值小于等于</span><span lang=EN-US>10</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的数据行即可。</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-weight:bold'>最终代码：</span><span
lang=EN-US style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=710 valign=top style='width:426.1pt;border:none;background:#E7E6E6;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>t1.* <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>from (<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>select <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>videoId,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>categoryId,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>views,<o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>       
  </span>row_number() over(partition by categoryId order by views desc) rank
  from gulivideo_category) t1 <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'>where <o:p></o:p></span></p>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:8.0pt;mso-bidi-font-size:9.0pt;font-family:"Courier New";
  mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>    </span>rank
  &lt;= 10;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_198"
 o:spid="_x0000_i1037" type="#_x0000_t75" style='width:406.2pt;height:278.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image195.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_199"
 o:spid="_x0000_i1036" type="#_x0000_t75" style='width:385.8pt;height:256.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image196.png" o:title=""/>
</v:shape></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>11</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> </span><span style='font-size:15.0pt;line-height:240%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>常见错误及解决方案</span><span lang=EN-US style='font-size:15.0pt;
line-height:240%'><o:p></o:p></span></h1>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>SecureCRT 7.3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>出现乱码或者删除不掉数据，免安装版的</span><span lang=EN-US>SecureCRT </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>卸载或者用虚拟机直接操作或者换安装版的</span><span lang=EN-US>SecureCRT </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）连接不上</span><span lang=EN-US>mysql</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据库</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）导错驱动包，应该把</span><span lang=EN-US>mysql-connector-java-5.1.27-bin.jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>导入</span><span lang=EN-US>/opt/module/hive/lib</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的不是这个包。错把</span><span lang=EN-US>mysql-connector-java-5.1.27.tar.gz</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>导入</span><span lang=EN-US>hive/lib</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>包下。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）修改</span><span lang=EN-US>user</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>表中的主机名称没有都修改为</span><span lang=EN-US>%</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，而是修改为</span><span lang=EN-US>localhost</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>hive</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>默认的输入格式处理是</span><span
lang=EN-US>CombineHiveInputFormat</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，会对小文件进行合并。</span></p>

<p class=a><span lang=EN-US>hive (default)&gt; set hive.input.format;</span></p>

<p class=a><span lang=EN-US>hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>可以采用</span><span lang=EN-US>HiveInputFormat</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>就会根据分区数输出相应的文件。</span></p>

<p class=a><span lang=EN-US>hive (default)&gt; set
hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）不能执行</span><span lang=EN-US>mapreduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>程序</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>可能是</span><span
lang=EN-US>hadoop</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的</span><span lang=EN-US>yarn</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>没开启。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）启动</span><span lang=EN-US>mysql</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>服务时，报</span><span lang=EN-US>MySQL server PID file could not
be found! </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>异常。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>在</span><span
lang=EN-US>/var/lock/subsys/mysql</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>路径下创建</span><span
lang=EN-US>hadoop102.pid</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，并在文件中添加内容：</span><span
lang=EN-US>4396</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）报</span><span lang=EN-US>service mysql status MySQL is not
running, but lock file (/var/lock/subsys/mysql[</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>失败</span><span
lang=EN-US>])</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>异常。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>解决方案：在</span><span
lang=EN-US>/var/lib/mysql </span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>目录下创建：</span><span
lang=EN-US> -rw-rw----. 1 mysql mysql<span style='mso-spacerun:yes'>       
</span>5 12</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>月</span><span lang=EN-US> 22 16:41
hadoop102.pid </span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>文件，并修改权限为</span><span lang=EN-US> 777</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>7</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>JVM</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>堆内存溢出</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>描述：</span><span lang=EN-US>java.lang.OutOfMemoryError:
Java heap space</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_176"
 o:spid="_x0000_i1035" type="#_x0000_t75" style='width:567pt;height:295.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hive.files/image197.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>解决：在</span><span lang=EN-US>yarn-site.xml</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中加入如下代码</span></p>

<p class=a><span lang=EN-US>&lt;property&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-tab-count:1'>    </span>&lt;name&gt;yarn.scheduler.maximum-allocation-mb&lt;/name&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-tab-count:1'>    </span>&lt;value&gt;2048&lt;/value&gt;</span></p>

<p class=a><span lang=EN-US>&lt;/property&gt;</span></p>

<p class=a><span lang=EN-US>&lt;property&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>   </span>&lt;name&gt;yarn.scheduler.minimum-allocation-mb&lt;/name&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>   </span>&lt;value&gt;2048&lt;/value&gt;</span></p>

<p class=a><span lang=EN-US>&lt;/property&gt;</span></p>

<p class=a><span lang=EN-US>&lt;property&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-tab-count:1'>    </span>&lt;name&gt;yarn.nodemanager.vmem-pmem-ratio&lt;/name&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-tab-count:1'>    </span>&lt;value&gt;2.1&lt;/value&gt;</span></p>

<p class=a><span lang=EN-US>&lt;/property&gt;</span></p>

<p class=a><span lang=EN-US>&lt;property&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-tab-count:1'>    </span>&lt;name&gt;mapred.child.java.opts&lt;/name&gt;</span></p>

<p class=a><span lang=EN-US><span style='mso-tab-count:1'>    </span>&lt;value&gt;-Xmx1024m&lt;/value&gt;</span></p>

<p class=a><span lang=EN-US>&lt;/property&gt;</span></p>

</div>

</body>

</html>
