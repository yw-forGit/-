<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="Hadoop_03MapReduce.files/filelist.xml">
<link rel=Edit-Time-Data href="Hadoop_03MapReduce.files/editdata.mso">
<link rel=OLE-Object-Data href="Hadoop_03MapReduce.files/oledata.mso">
<link rel=dataStoreItem href="Hadoop_03MapReduce.files/item0001.xml"
target="Hadoop_03MapReduce.files/props002.xml">
<link rel=themeData href="Hadoop_03MapReduce.files/themedata.thmx">
<link rel=colorSchemeMapping
href="Hadoop_03MapReduce.files/colorschememapping.xml">

<link href="./css/treemenu.css" rel="stylesheet" type="text/css">
<!-- GitHub Pages只认./js/xxx这种相对定位，不认js/xxx这种 -->
<script src="./js/jquery-3.4.1.min.js"></script>
<script src="./js/test.js"></script>
<script src="./js/treemenu.js"></script>
</head>

<body lang=ZH-CN link=blue vlink=purple style='tab-interval:21.0pt;text-justify-trim:
punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<div id="noScroll" class="divcss5-right">
	<ul id="menuId" class="tree">
	</ul>
	<div style="font-size: 10px; color: #161FB0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 （Ctrl+滚动鼠标可缩放页面）</div>
</div> 

<p class=MsoNormal align=center style='text-align:center;mso-line-height-alt:
11.0pt'><span lang=EN-US style='font-size:22.0pt'>Hadoop</span><span
style='font-size:22.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US
style='font-size:22.0pt'>MapReduce</span><span style='font-size:22.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US style='font-size:22.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right;mso-line-height-alt:
11.0pt'><span style='font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>作者：尚硅谷大数据研发部</span><span
lang=EN-US style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right;mso-line-height-alt:
11.0pt'><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>整理：小邹</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt'>[yw_forgit@163.com]</span><span
lang=EN-US style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;mso-line-height-alt:
11.0pt'><span lang=EN-US style='font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;mso-line-height-alt:
11.0pt'><span style='font-size:12.0pt;font-family:"微软雅黑","sans-serif";
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:微软雅黑;mso-font-kerning:0pt'>版本：</span><span lang=EN-US
style='font-size:12.0pt;mso-fareast-font-family:微软雅黑;mso-bidi-font-family:微软雅黑;
mso-font-kerning:0pt'>V2.0<o:p></o:p></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>1</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> <span lang=EN-US>MapReduce</span></span><span
style='font-size:15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>概述</span><span
lang=EN-US style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'>1.1
MapReduce</span><span style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>定义</span><span
lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:411pt;
 height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image001.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1025"
  DrawAspect="Content" ObjectID="_1629748200">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'>1.2 MapReduce</span><span
style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>优缺点</span><span lang=EN-US
style='font-size:14.0pt;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.2.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>优点</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US><v:shape id="_x0000_i1026" type="#_x0000_t75"
 style='width:410.4pt;height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image002.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1026"
  DrawAspect="Content" ObjectID="_1629748201">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal><span lang=EN-US><v:shape id="_x0000_i1027" type="#_x0000_t75"
 style='width:407.4pt;height:230.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image003.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1027"
  DrawAspect="Content" ObjectID="_1629748202">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>1.2.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>缺点</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US><v:shape id="_x0000_i1028" type="#_x0000_t75" style='width:403.8pt;
 height:226.2pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image004.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1028"
  DrawAspect="Content" ObjectID="_1629748203">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></b></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>1.3 MapReduce</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>核心思想</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>核心编程思想，如图</span><span lang=EN-US>4-1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示。</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'><v:shape id="_x0000_i1029"
 type="#_x0000_t75" style='width:564pt;height:321pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image005.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1029"
  DrawAspect="Content" ObjectID="_1629748204">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'>4-1 MapReduce</span><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>核心编程思想</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）分布式的运算程序往往需要分成至少</span><span lang=EN-US
style='color:black'>2</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>个阶段。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）第一个阶段的</span><span lang=EN-US style='color:
black'>MapTask</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>并发实例，完全并行运行，互不相干。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）第二个阶段的</span><span lang=EN-US style='color:
black'>ReduceTask</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>并发实例互不相干，但是他们的数据依赖于上一个阶段的所有</span><span
lang=EN-US style='color:black'>MapTask</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>并发实例的输出。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>编程模型只能包含一个</span><span lang=EN-US
style='color:black'>Map</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>阶段和一个</span><span
lang=EN-US style='color:black'>Reduce</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>阶段，如果用户的业务逻辑非常复杂，那就只能多个</span><span lang=EN-US style='color:black'>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>程序，串行运行。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>总结：分析</span><span lang=EN-US style='color:black'>WordCount</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>数据流走向深入理解</span><span lang=EN-US
style='color:black'>MapReduce</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>核心思想。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>1.4 MapReduce</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>进程</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1030" type="#_x0000_t75" style='width:411pt;height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image006.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1030"
  DrawAspect="Content" ObjectID="_1629748205">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>1.5 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>官方</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>WordCount</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>源码</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>采用反编译工具反编译源码，发现</span><span lang=EN-US
style='color:black'>WordCount</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>案例有</span><span
lang=EN-US style='color:black'>Map</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>类、</span><span lang=EN-US style='color:black'>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>类和驱动类。且数据的类型是</span><span lang=EN-US
style='color:black'>Hadoop</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>自身封装的序列化类型。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:normal;tab-stops:center 207.65pt'><span
lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'>1.6 </span><span
style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>常用数据序列化类型</span><span lang=EN-US
style='font-size:14.0pt;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>4-1 </span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>常用的数据类型对应的</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'>Hadoop</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>数据序列化类型</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=685
 style='width:411.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=345 valign=top style='width:207.25pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><b style='mso-bidi-font-weight:normal'><span lang=EN-US
  style='font-size:10.5pt'>Java</span></b><b style='mso-bidi-font-weight:normal'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>类型</span></b><b style='mso-bidi-font-weight:
  normal'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></b></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><b style='mso-bidi-font-weight:normal'><span lang=EN-US
  style='font-size:10.5pt'>Hadoop Writable</span></b><b style='mso-bidi-font-weight:
  normal'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>类型</span></b><b style='mso-bidi-font-weight:
  normal'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>boolean<o:p></o:p></span></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>BooleanWritable<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>byte<o:p></o:p></span></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>ByteWritable<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>int<o:p></o:p></span></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>IntWritable<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>float<o:p></o:p></span></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>FloatWritable<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>long<o:p></o:p></span></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>LongWritable<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>double<o:p></o:p></span></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>DoubleWritable<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt;color:red'>String<o:p></o:p></span></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt;color:red'>Text<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>map<o:p></o:p></span></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>MapWritable<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9;mso-yfti-lastrow:yes;height:4.5pt'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:4.5pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>array<o:p></o:p></span></p>
  </td>
  <td width=340 valign=top style='width:203.85pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt;height:4.5pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>ArrayWritable<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>1.7 MapReduce</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>编程规范</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>用户编写的程序分成三个部分：</span><span lang=EN-US style='color:black'>Mapper</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>、</span><span lang=EN-US style='color:black'>Reducer</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>和</span><span lang=EN-US style='color:black'>Driver</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:red'><v:shape
 id="_x0000_i1031" type="#_x0000_t75" style='width:407.4pt;height:230.4pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image007.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1031"
  DrawAspect="Content" ObjectID="_1629748206">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:red'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分析</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_14" o:spid="_x0000_i1405" type="#_x0000_t75"
 style='width:304.8pt;height:24pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image008.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>也就是一行调用一次，</span><span lang=EN-US>k</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是字节大小，</span><span lang=EN-US>v</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是一行数据</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:red'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:red'><v:shape
 id="_x0000_i1032" type="#_x0000_t75" style='width:407.4pt;height:230.4pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image009.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1032"
  DrawAspect="Content" ObjectID="_1629748207">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><a name="_1.8_WordCount案例实操"></a><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>1.8
WordCount</span><span style='font-size:14.0pt;line-height:172%;font-family:
黑体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例实操</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US>Mapper.java</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>源码有四个方法</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_103"
 o:spid="_x0000_i1404" type="#_x0000_t75" style='width:412.2pt;height:474.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image010.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Reducer.java</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>源码也有四个方法</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_104"
 o:spid="_x0000_i1403" type="#_x0000_t75" style='width:486pt;height:638.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image011.png" o:title=""/>
</v:shape></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>在给定的文本文件中统计输出每一个单词出现的总次数</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='color:black'>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）输入数据</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='color:black'><v:shape id="_x0000_i1033" type="#_x0000_t75"
 style='width:56.4pt;height:55.2pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image012.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1033"
  DrawAspect="Content" ObjectID="_1629748208">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_16"
 o:spid="_x0000_i1402" type="#_x0000_t75" style='width:103.2pt;height:115.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image013.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='color:black'>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）期望输出数据</span><span lang=EN-US style='color:
black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt'><span lang=EN-US style='color:black'>atguigu<span
style='mso-tab-count:1'>   </span>2<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt'><span lang=EN-US style='color:black'>banzhang<span
style='mso-tab-count:1'>       </span>1<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt'><span lang=EN-US style='color:black'>cls<span
style='mso-tab-count:1'>   </span>2<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt'><span lang=EN-US style='color:black'>hadoop<span
style='mso-tab-count:1'>   </span>1<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt'><span lang=EN-US style='color:black'>jiao<span
style='mso-tab-count:1'>  </span>1<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt'><span lang=EN-US style='color:black'>ss<span
style='mso-tab-count:1'>    </span>2<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt'><span lang=EN-US style='color:black'>xue<span
style='mso-tab-count:1'>  </span>1<o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>按照</span><span lang=EN-US style='color:black'>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>编程规范，分别编写</span><span lang=EN-US
style='color:black'>Mapper</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>，</span><span
lang=EN-US style='color:black'>Reducer</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>，</span><span lang=EN-US style='color:black'>Driver</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>，如图</span><span lang=EN-US style='color:black'>4-2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>所示。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1034" type="#_x0000_t75" style='width:559.8pt;height:316.2pt'
 o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image014.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1034"
  DrawAspect="Content" ObjectID="_1629748209">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%'>4-2
</span><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>需求分析</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;line-height:150%'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．环境准备</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）创建</span><span
lang=EN-US>maven</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>工程</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_1" o:spid="_x0000_i1401"
 type="#_x0000_t75" style='width:355.2pt;height:91.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image015.png" o:title=""
  cropbottom="40246f"/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_2" o:spid="_x0000_i1400"
 type="#_x0000_t75" style='width:360.6pt;height:339.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image016.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_3" o:spid="_x0000_i1399"
 type="#_x0000_t75" style='width:359.4pt;height:321.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image017.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_4" o:spid="_x0000_i1398"
 type="#_x0000_t75" style='width:359.4pt;height:322.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image018.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）在</span><span
lang=EN-US>pom.xml</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件中添加如下依赖</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><a name="OLE_LINK33"></a><a name="OLE_LINK51"></a><a
name="OLE_LINK50"></a><a name="OLE_LINK49"><span style='mso-bookmark:OLE_LINK50'><span
style='mso-bookmark:OLE_LINK51'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.5pt'>&lt;dependencies&gt;<o:p></o:p></span></span></span></span></a></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;groupId&gt;junit&lt;/groupId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;artifactId&gt;junit&lt;/artifactId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;version&gt;RELEASE&lt;/version&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;/dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;artifactId&gt;log4j-core&lt;/artifactId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;version&gt;2.8.2&lt;/version&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;/dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;version&gt;2.7.2&lt;/version&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;/dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;version&gt;2.7.2&lt;/version&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;/dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;artifactId&gt;hadoop-hdfs&lt;/artifactId&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;version&gt;2.7.2&lt;/version&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;/dependency&gt;<o:p></o:p></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:OLE_LINK49'><span
style='mso-bookmark:OLE_LINK50'><span style='mso-bookmark:OLE_LINK51'><span
style='mso-bookmark:OLE_LINK33'><span lang=EN-US style='font-size:10.5pt'>&lt;/dependencies&gt;</span></span></span></span></span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）在项目的</span><span
lang=EN-US>src/main/resources</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>目录下，新建一个文件，命名为“</span><span
lang=EN-US>log4j.properties</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>”，在文件中填入。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:-1.05pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=781 valign=top style='width:468.85pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>log4j.rootLogger=INFO,
  stdout<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>log4j.appender.stdout=org.apache.log4j.ConsoleAppender<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>log4j.appender.stdout.layout=org.apache.log4j.PatternLayout<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>log4j.appender.stdout.layout.ConversionPattern=%d
  %p [%c] - %m%n<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>log4j.appender.logfile=org.apache.log4j.FileAppender<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>log4j.appender.logfile.File=target/spring.log<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>log4j.appender.logfile.layout=org.apache.log4j.PatternLayout<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>log4j.appender.logfile.layout.ConversionPattern=%d
  %p [%c] - %m%n</span></p>
  </td>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．编写程序</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>Mapper</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>类</span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.IntWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class WordcountMapper extends Mapper&lt;LongWritable, Text, Text,
  IntWritable&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>Text k = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>IntWritable v = new IntWritable(1);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void map(LongWritable key, Text
  value, Context context)<span style='mso-tab-count:1'>  </span>throws
  IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>获取一行</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><span style='mso-tab-count:1'>   </span>String
  line = value.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>切割</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>String[] words = line.split(&quot;
  &quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 3 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>输出</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>for (String word : words) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>k.set(word);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>context.write(k, v);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-size:9.0pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>Reducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:4.5pt'>
  <td width=933 valign=top style='width:559.95pt;border:none;padding:0cm 5.4pt 0cm 5.4pt;
  height:4.5pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.wordcount;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.IntWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class WordcountReducer extends Reducer&lt;Text, IntWritable, Text,
  IntWritable&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  10.5pt;mso-char-indent-count:1.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US style='font-size:10.5pt'>int sum;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  10.5pt;mso-char-indent-count:1.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US style='font-size:10.5pt'>IntWritable v = new IntWritable();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void reduce(Text key,
  Iterable&lt;IntWritable&gt; values,Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>累加求和</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>sum = 0;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>for (IntWritable count : values) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>sum += count.get();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>输出</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span>v.set(sum);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>context.write(key,v);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Driver</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>驱动类</span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=933 valign=top style='width:559.95pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.wordcount;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.IntWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class <span style='color:red'>WordcountDriver </span>{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public static void main(String[] args)
  throws IOException, ClassNotFoundException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>获取配置信息以及封装任务</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Configuration configuration = new
  Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Job job =
  Job.getInstance(configuration);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>设置</span><span lang=EN-US style='font-size:10.5pt'>jar</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>加载路径</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setJarByClass(WordcountDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 3 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>设置</span><span lang=EN-US style='font-size:10.5pt'>map</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>和</span><span lang=EN-US
  style='font-size:10.5pt'>reduce</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>类</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapperClass(WordcountMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setReducerClass(WordcountReducer.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 4 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>设置</span><span lang=EN-US style='font-size:10.5pt'>map</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>输出</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(IntWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 5 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>设置最终输出的</span><span lang=EN-US style='font-size:10.5pt'>kv</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>类型</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputValueClass(IntWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 6 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>设置输入和输出路径</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job, new
  Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job, new
  Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 7 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>提交。该方法立马会调用</span><span lang=EN-US style='font-size:10.5pt'>job.submit()</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>方法</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>boolean result =
  job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>System.exit(result ? 0 : 1);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．本地测试</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='color:black'>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）如果电脑系统是</span><span lang=EN-US
style='color:black'>win7</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>的就将</span><span
lang=EN-US style='color:black'>win7</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>的</span><span lang=EN-US style='color:black'>hadoop jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>包解压到非中文路径，并在</span><span lang=EN-US
style='color:black'>Windows</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>环境上配置</span><span
lang=EN-US style='color:black'>HADOOP_HOME</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>环境变量。如果是电脑</span><span lang=EN-US style='color:black'>win10</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>操作系统，就解压</span><span lang=EN-US
style='color:black'>win10</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>的</span><span
lang=EN-US style='color:black'>hadoop jar</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>包，并配置</span><span lang=EN-US style='color:black'>HADOOP_HOME</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>环境变量。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>注意：</span><span lang=EN-US style='color:red'>win8</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>电脑和</span><span lang=EN-US style='color:red'>win10</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>家庭版操作系统可能有问题，需要重新编译源码或者更改操作系统。</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_5" o:spid="_x0000_i1397"
 type="#_x0000_t75" style='width:175.2pt;height:64.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image019.png" o:title="" croptop="40567f"
  cropbottom="2969f" cropleft="9612f" cropright="7854f"/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='color:black'>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）在</span><span lang=EN-US style='color:black'>Eclipse/Idea</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>上运行程序</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>6</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．集群上测试</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>0</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）用</span><span
lang=EN-US>maven</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>打</span><span lang=EN-US>jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>包，需要添加的打包插件依赖</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>注意：标记红颜色的部分需要替换为自己工程主类</span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>&lt;build&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;plugins&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;plugin&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:4'>            </span>&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:4'>            </span>&lt;version&gt;2.3.2&lt;/version&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:4'>            </span>&lt;configuration&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:5'>               </span>&lt;source&gt;1.8&lt;/source&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:5'>               </span>&lt;target&gt;1.8&lt;/target&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:4'>            </span>&lt;/configuration&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;/plugin&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;plugin&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:4'>            </span>&lt;artifactId&gt;maven-assembly-plugin
&lt;/artifactId&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:4'>            </span>&lt;configuration&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:5'>               </span>&lt;descriptorRefs&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:6'>                  </span>&lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:5'>               </span>&lt;/descriptorRefs&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:5'>               </span>&lt;archive&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:6'>                  </span>&lt;manifest&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:6'>                  </span><span style='mso-tab-count:
1'>  </span>&lt;mainClass&gt;<span style='color:red'>com.atguigu.mr.WordcountDriver</span>&lt;/mainClass&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:6'>                  </span>&lt;/manifest&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:5'>               </span>&lt;/archive&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:4'>            </span>&lt;/configuration&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:4'>            </span>&lt;executions&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:5'>               </span>&lt;execution&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:6'>                  </span>&lt;id&gt;make-assembly&lt;/id&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:6'>                  </span>&lt;phase&gt;package&lt;/phase&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:6'>                  </span>&lt;goals&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:7'>                     </span>&lt;goal&gt;single&lt;/goal&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:6'>                  </span>&lt;/goals&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:5'>               </span>&lt;/execution&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:4'>            </span>&lt;/executions&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>         </span>&lt;/plugin&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>&lt;/plugins&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>  </span>&lt;/build&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>注意：如果工程上显示红叉。在项目上右键</span><span lang=EN-US>-&gt;maven-&gt;update
project</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>即可。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_17" o:spid="_x0000_i1396"
 type="#_x0000_t75" style='width:372.6pt;height:184.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image020.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_18" o:spid="_x0000_i1395"
 type="#_x0000_t75" style='width:466.8pt;height:289.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image021.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）将程序打成</span><span
lang=EN-US>jar</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>包，然后拷贝到</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>集群中</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>步骤详情：右键</span><span lang=EN-US>-&gt;Run as-&gt;maven install</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_19" o:spid="_x0000_i1394"
 type="#_x0000_t75" style='width:346.8pt;height:178.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image022.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>等待编译完成就会在项目的</span><span lang=EN-US>target</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件夹中生成</span><span lang=EN-US>jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>包。如果看不到。在项目上右键</span><span lang=EN-US>-</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>》</span><span lang=EN-US>Refresh</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，即可看到。修改不带依赖的</span><span lang=EN-US>jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>包名称为</span><span lang=EN-US>wc.jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，并拷贝该</span><span lang=EN-US>jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>包到</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>集群。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_20" o:spid="_x0000_i1393"
 type="#_x0000_t75" style='width:234.6pt;height:206.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image023.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）启动</span><span
lang=EN-US>Hadoop</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>集群</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）执行</span><span
lang=EN-US>WordCount</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>程序</span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>[atguigu@hadoop102
software]$ hadoop jar<span style='mso-spacerun:yes'>  </span>wc.jar
com.atguigu.wordcount.WordcountDriver /user/atguigu/input /user/atguigu/output<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_21"
 o:spid="_x0000_i1392" type="#_x0000_t75" style='width:567pt;height:109.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image024.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>2</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> <span lang=EN-US>Hadoop</span></span><span style='font-size:
15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>序列化</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'>2.1 </span><span
style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>序列化概述</span><span lang=EN-US
style='font-size:14.0pt;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US><v:shape id="_x0000_i1035" type="#_x0000_t75"
 style='width:408.6pt;height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image025.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1035"
  DrawAspect="Content" ObjectID="_1629748210">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='line-height:150%;mso-layout-grid-align:none;
punctuation-trim:leading'><span lang=EN-US><v:shape id="_x0000_i1036" type="#_x0000_t75"
 style='width:411pt;height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image026.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1036"
  DrawAspect="Content" ObjectID="_1629748212">
 </o:OLEObject>
</xml><![endif]-->&nbsp;</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><a
name="_Toc439079683"><span lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'>2.2
</span></a><span style='mso-bookmark:_Toc439079683'><span style='font-size:
14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>自定义</span></span><span style='mso-bookmark:_Toc439079683'><span
lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'>bean</span></span><span
style='mso-bookmark:_Toc439079683'><span style='font-size:14.0pt;font-family:
黑体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对象实现序列化接口</span></span><span
style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US
style='font-size:14.0pt;font-family:"Times New Roman","serif"'>Writable</span><span
style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span><span lang=EN-US
style='font-size:14.0pt;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>在企业开发中往往常用的基本序列化类型不能满足所有需求，比如在</span><span
lang=EN-US style='color:black;mso-themecolor:text1'>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>框架内部传递一个</span><span
lang=EN-US style='color:black;mso-themecolor:text1'>bean</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>对象，那么该对象就需要实现序列化接口。</span><span
lang=EN-US style='color:black;mso-themecolor:text1'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>具体实现</span><span
lang=EN-US style='color:black;mso-themecolor:text1'>bean</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>对象序列化步骤如下</span><span
lang=EN-US style='color:black;mso-themecolor:text1'>7</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>步。</span><span lang=EN-US
style='color:black;mso-themecolor:text1'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）必须实现</span><span lang=EN-US>Writable</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>接口</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）反序列化时，需要反射调用空参构造函数，所以必须有空参构造</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0'>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>public FlowBean() {<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'><span style='mso-tab-count:1'>   </span>super();<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>}</span><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </div>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）重写序列化方法</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0'>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>@Override<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>public void write(DataOutput out) throws IOException {<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'><span style='mso-tab-count:1'>   </span>out.writeLong(upFlow);<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'><span style='mso-tab-count:1'>   </span>out.writeLong(downFlow);<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'><span style='mso-tab-count:1'>   </span>out.writeLong(sumFlow);<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>}</span><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </div>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>4</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）重写反序列化方法</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0'>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>@Override<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>public void readFields(DataInput in) throws IOException {<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'><span style='mso-tab-count:1'>   </span>upFlow = in.readLong();<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'><span style='mso-tab-count:1'>   </span>downFlow = in.readLong();<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'><span style='mso-tab-count:1'>   </span>sumFlow = in.readLong();<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>}</span><span lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </div>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>（</span><span lang=EN-US style='color:red'>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>）<a name="OLE_LINK9"></a><a name="_Hlk515272361"><span
style='mso-bookmark:OLE_LINK9'>注意反序列化的顺序和序列化的顺序完全一致</span></a>（因为用了队列）</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>6</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）要想把结果显示在文件中，需要重写</span><span
lang=EN-US>toString()</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，可用”</span><span
lang=EN-US>\t</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>”分开，方便后续用。</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>7</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）如果需要将自定义的</span><span lang=EN-US>bean</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>放在</span><span lang=EN-US>key</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>中传输，则还需要实现</span><span
lang=EN-US>Comparable</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>接口，因为</span><span
lang=EN-US>MapReduce</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>框中的</span><span
lang=EN-US>Shuffle</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>过程要求对</span><span
lang=EN-US>key</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>必须能排序。<span style='color:red'>详见后面排序案例。</span></span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:33.75pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:13.4pt'>
  <td width=638 valign=top style='width:382.75pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:13.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0'>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>@Override<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>public int compareTo(FlowBean o) {<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'><span style='mso-tab-count:1'>   </span>// </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>倒序排列，从大到小</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'><span style='mso-tab-count:1'>   </span>return this.sumFlow &gt;
  o.getSumFlow() ? -1 : 1;<o:p></o:p></span></p>
  <p class=a style='background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:
  leading;border:none;mso-border-alt:none windowtext 0cm;padding:0cm;
  mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:
  10.5pt'>}</span><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </div>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'>2.3 </span><span
style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>序列化案例实操</span><span lang=EN-US
style='font-size:14.0pt;font-family:"Times New Roman","serif"'><span
style='mso-tab-count:1'>      </span><o:p></o:p></span></h2>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1.<span
style='mso-tab-count:1'>    </span></span><span style='font-family:黑体;
mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>需求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>统计每一个手机号耗费的总上行流量、下行流量、总流量</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）输入数据</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><v:shape
 id="_x0000_i1037" type="#_x0000_t75" style='width:81.6pt;height:42pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image027.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1037"
  DrawAspect="Content" ObjectID="_1629748213">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_22" o:spid="_x0000_i1391"
 type="#_x0000_t75" style='width:420.6pt;height:254.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image028.png" o:title=""/>
</v:shape></span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）输入数据格式：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=659
 style='width:395.45pt;margin-left:21.05pt;border-collapse:collapse;border:
 none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=659 valign=top style='width:395.45pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;color:black'>7 <span
  style='mso-tab-count:1'>     </span>13560436666<span style='mso-tab-count:
  1'>    </span>120.196.100.99<span style='mso-tab-count:2'>          </span>1116<span
  style='mso-tab-count:2'>          </span> 954<span style='mso-tab-count:2'>          </span><span
  style='mso-tab-count:1'>         </span>200<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;color:black'>id<span
  style='mso-tab-count:1'>      </span></span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman";color:black'>手机号码</span><span lang=EN-US style='font-size:
  9.0pt;color:black'><span style='mso-tab-count:2'>           </span></span><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:black'>网络</span><span
  lang=EN-US style='font-size:9.0pt;color:black'>ip<span style='mso-tab-count:
  3'>                        </span></span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman";color:black'>上行流量</span><span style='font-size:9.0pt;
  color:black'> <span style='mso-spacerun:yes'> </span></span><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:black'>下行流量</span><span
  lang=EN-US style='font-size:9.0pt;color:black'><span
  style='mso-spacerun:yes'>     </span></span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman";color:black'>网络状态码</span><span lang=EN-US style='font-size:
  7.5pt;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>3</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）期望输出数据格式</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=659
 style='width:395.45pt;margin-left:21.05pt;border-collapse:collapse;border:
 none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=659 valign=top style='width:395.45pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;color:black'>13560436666
  <span style='mso-tab-count:2'>           </span>1116<span style='mso-tab-count:
  2'>          </span><span style='mso-spacerun:yes'>      </span>954 <span
  style='mso-tab-count:3'>                          </span>2070<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>手机号码</span><span
  lang=EN-US style='font-size:9.0pt;color:black'><span style='mso-tab-count:
  2'>           </span><span style='mso-spacerun:yes'>    </span></span><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:black'>上行流量</span><span
  style='font-size:9.0pt;color:black'> <span lang=EN-US><span
  style='mso-spacerun:yes'>       </span></span></span><span style='font-size:
  9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman";color:black'>下行流量</span><span lang=EN-US style='font-size:
  9.0pt;color:black'><span style='mso-tab-count:2'>          </span></span><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:black'>总流量</span></p>
  </td>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'><v:shape id="_x0000_i1038" type="#_x0000_t75"
 style='width:391.8pt;height:222pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image029.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1038"
  DrawAspect="Content" ObjectID="_1629748214">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．编写</span><span
lang=EN-US>MapReduce</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>程序</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:.95pt;mso-char-indent-count:
.09;line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写流量统计的</span><span
lang=EN-US>Bean</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>对象</span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.flowsum;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.DataInput;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.DataOutput;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Writable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>// 1
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>实现</span><span lang=EN-US
  style='font-size:10.5pt'>writable</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>接口</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class FlowBean implements Writable{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private long upFlow;<span
  style='mso-spacerun:yes'>  </span>// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>上行流量</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private long downFlow;<span
  style='mso-spacerun:yes'>  </span>// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>下行流量</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private long sumFlow;<span
  style='mso-spacerun:yes'>  </span>// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>总流量</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>//2<span style='mso-spacerun:yes'>  </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>反序列化时，需要反射调用空参构造函数，所以必须有</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public FlowBean() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>super();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public FlowBean(long upFlow, long downFlow)
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>super();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.upFlow = upFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.downFlow = downFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.sumFlow = upFlow + downFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>//3<span style='mso-spacerun:yes'>  </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>写序列化方法</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void write(DataOutput out) throws
  IOException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>out.writeLong(upFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>out.writeLong(downFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>out.writeLong(sumFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>//4 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>反序列化方法</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>//5 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>反序列化方法读顺序必须和写序列化方法的写顺序必须一致</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void readFields(DataInput in) throws
  IOException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.upFlow<span
  style='mso-spacerun:yes'>  </span>= in.readLong();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.downFlow = in.readLong();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.sumFlow = in.readLong();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>// 6 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>编写</span><span lang=EN-US style='font-size:10.5pt'>toString</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>方法，方便后续打印到文本</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public String toString() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return upFlow + &quot;\t&quot; +
  downFlow + &quot;\t&quot; + sumFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public long getUpFlow() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return upFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void setUpFlow(long upFlow) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.upFlow = upFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public long getDownFlow() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return downFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void setDownFlow(long downFlow) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.downFlow = downFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public long getSumFlow() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return sumFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void setSumFlow(long sumFlow) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.sumFlow = sumFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>Mapper</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>类</span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.flowsum;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class FlowCountMapper extends Mapper&lt;LongWritable, Text, Text,
  FlowBean&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>FlowBean v = new FlowBean();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>Text k = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void map(LongWritable key, Text
  value, Context context)<span style='mso-tab-count:1'>  </span>throws
  IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>// 7 <span
  style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span>13560436666<span
  style='mso-tab-count:1'> </span>120.196.100.99<span style='mso-tab-count:
  2'>     </span>1116<span style='mso-tab-count:2'>      </span> 954<span
  style='mso-tab-count:3'>         </span>200<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>// id<span
  style='mso-tab-count:1'> </span> </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>手机号码</span><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><span style='mso-tab-count:2'>     </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>网络</span><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>ip<span
  style='mso-tab-count:3'>       </span><span style='mso-spacerun:yes'>      
  </span></span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>上行流量</span><span lang=EN-US style='font-size:
  10.5pt;color:#538135;mso-themecolor:accent6;mso-themeshade:191'><span
  style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'> </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>下行流量</span><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'><span
  style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>  </span></span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>网络状态码</span><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>获取一行。</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>String line = value.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>切割字段</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>String[] fields =
  line.split(&quot;\t&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 3 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>封装对象</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>取出手机号码</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>String phoneNum = fields[1];<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>取出上行流量和下行流量</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>long upFlow =
  Long.parseLong(fields[fields.length - 3]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>long downFlow =
  Long.parseLong(fields[fields.length - 2]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>k.set(phoneNum);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>v.set(downFlow, upFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 4 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>写出</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>context.write(k, v);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>Reducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.flowsum;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class FlowCountReducer extends Reducer&lt;Text, FlowBean, Text, FlowBean&gt;
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void reduce(Text key,
  Iterable&lt;FlowBean&gt; values, Context context)throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>// 13560436666 <span
  style='mso-tab-count:2'>   </span>1116<span style='mso-tab-count:2'>      </span><span
  style='mso-spacerun:yes'>      </span>954 <span style='mso-tab-count:3'>       </span>2070<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>// </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>手机号码</span><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'><span
  style='mso-tab-count:2'>      </span><span style='mso-spacerun:yes'>   
  </span></span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>上行流量</span><span lang=EN-US style='font-size:
  10.5pt;color:#538135;mso-themecolor:accent6;mso-themeshade:191'><span
  style='mso-spacerun:yes'>        </span></span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>下行流量</span><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><span style='mso-tab-count:2'>      </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>总流量</span><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>long sum_upFlow = 0;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>long sum_downFlow = 0;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>遍历所用</span><span lang=EN-US style='font-size:10.5pt'>bean</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>，将其中的上行流量，下行流量分别累加</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>for (FlowBean flowBean : values) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>sum_upFlow += flowBean.getUpFlow();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>sum_downFlow +=
  flowBean.getDownFlow();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>封装对象</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FlowBean resultBean = new
  FlowBean(sum_upFlow, sum_downFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 3 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>写出</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>context.write(key, resultBean);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Driver</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>驱动类</span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.flowsum;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class FlowsumDriver {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public static void main(String[] args)
  throws IllegalArgumentException, IOException, ClassNotFoundException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>获取配置信息，或者</span><span lang=EN-US style='font-size:10.5pt'>job</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>对象实例</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Configuration configuration = new
  Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Job job =
  Job.getInstance(configuration);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>设置</span><span lang=EN-US style='font-size:10.5pt'>jar</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>加载路径</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setJarByClass(FlowsumDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 3 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>指定本业务</span><span lang=EN-US style='font-size:10.5pt'>job</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>要使用的</span><span lang=EN-US
  style='font-size:10.5pt'>mapper/Reducer</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>业务类</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><span style='mso-tab-count:1'>   </span>job.setMapperClass(FlowCountMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setReducerClass(FlowCountReducer.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 4 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>指定</span><span lang=EN-US style='font-size:10.5pt'>mapper</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>输出数据的</span><span lang=EN-US
  style='font-size:10.5pt'>kv</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(FlowBean.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 5 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>指定最终输出的数据的</span><span lang=EN-US style='font-size:10.5pt'>kv</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>类型</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputValueClass(FlowBean.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 6 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>指定</span><span lang=EN-US style='font-size:10.5pt'>job</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>的输入原始文件所在目录</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job, new
  Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job, new
  Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 7 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>将</span><span lang=EN-US style='font-size:10.5pt'>job</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>中配置的相关参数，以及</span><span lang=EN-US
  style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>所用的</span><span
  lang=EN-US style='font-size:10.5pt'>java</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>类所在的</span><span lang=EN-US style='font-size:10.5pt'>jar</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>包，</span><span style='font-size:10.5pt'>
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>提交给</span><span
  lang=EN-US style='font-size:10.5pt'>yarn</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>去运行</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>boolean result =
  job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>System.exit(result ? 0 : 1);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>执行的结果</span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_23"
   o:spid="_x0000_i1390" type="#_x0000_t75" style='width:306pt;height:253.8pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image030.png" o:title=""/>
  </v:shape></span></p>
  </td>
 </tr>
</table>

</div>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>3</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> <span lang=EN-US>MapReduce</span></span><span
style='font-size:15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>框架原理</span><span
lang=EN-US style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><a name="_Toc421731836"></a><a
name="_Toc28720"></a><a name="_Toc13977"></a><a name="_Toc17018"></a><a
name="_Toc439079663"><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%;font-family:"Times New Roman","serif"'>3.1 InputFormat</span></span></span></span></span></a><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:黑体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据输入</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></span></span></span></span></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.1 </span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>切片与</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>并行度决定机制</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></span></span></span></span></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．问题引出</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的并行度决定</span><span
lang=EN-US>Map</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>阶段的任务处理并发度，进而影响到整个</span><span lang=EN-US>Job</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的处理速度。</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>思考：</span><span
lang=EN-US style='color:red'>1G</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>的数据，启动</span><span
lang=EN-US style='color:red'>8</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>个</span><span
lang=EN-US style='color:red'>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>，可以提高集群的并发处理能力。那么</span><span
lang=EN-US style='color:red'>1K</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>的数据，也启动</span><span
lang=EN-US style='color:red'>8</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>个</span><span
lang=EN-US style='color:red'>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>，会提高集群性能吗？</span><span
lang=EN-US style='color:red'>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>并行任务是否越多越好呢？哪些因素影响了</span><span
lang=EN-US style='color:red'>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>并行度？</span><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_12" o:spid="_x0000_i1389"
 type="#_x0000_t75" style='width:16.8pt;height:17.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image031.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>并行度决定机制</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>数据块：</span></b><span
lang=EN-US style='color:black;mso-themecolor:text1'>Block</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-themecolor:text1'>是</span><span lang=EN-US style='color:black;mso-themecolor:
text1'>HDFS</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>物理上把数据分成一块一块。</span><span
lang=EN-US style='color:black;mso-themecolor:text1'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>数据切片：</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-themecolor:text1'>数据切片只是在逻辑上对输入进行分片，并不会在磁盘上将其切分成片进行存储。只是一种标记。</span><span
lang=EN-US style='color:black;mso-themecolor:text1'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='color:red'><v:shape id="_x0000_i1039" type="#_x0000_t75"
 style='width:522.6pt;height:295.8pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image032.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1039"
  DrawAspect="Content" ObjectID="_1629748215">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:9.0pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
mso-bidi-font-family:Calibri'>图</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:9.0pt;
line-height:150%;font-family:"Calibri","sans-serif"'>4-11 <span
style='mso-spacerun:yes'> </span>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:9.0pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
mso-bidi-font-family:Calibri'>并行度决定机制</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:9.0pt;
line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分析</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_24" o:spid="_x0000_i1388"
 type="#_x0000_t75" style='width:322.2pt;height:182.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image033.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_25" o:spid="_x0000_i1387"
 type="#_x0000_t75" style='width:426pt;height:29.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image034.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>切片数决定</span><span lang=EN-US>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的并行度。</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_26" o:spid="_x0000_i1386"
 type="#_x0000_t75" style='width:567pt;height:204pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image035.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.2 Job</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>提交流程源码和切片源码详解</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></span></span></span></span></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Job</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>提交流程源码详解，如图</span><span
lang=EN-US>4-8</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>所示</span></span></span></span></span></span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
border-right:none;mso-border-top-alt:none windowtext 0cm;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;padding:1.0pt 0cm 1.0pt 4.0pt;
background:#E0E0E0;margin-left:21.0pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>waitForCompletion()<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>submit();<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt;color:red'>// 1</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>建立连接</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt;color:red'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>connect();<span
style='mso-tab-count:1'> </span><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>       </span>// 1</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）创建提交</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>Job</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>的代理</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>       </span>new
Cluster(getConfiguration());<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>       </span><span
style='mso-tab-count:1'>    </span>// </span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>1</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）判断是本地</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>yarn</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>还是远程</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>       </span><span
style='mso-tab-count:1'>    </span>initialize(jobTrackAddr, conf); <o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt;color:red'>// 2 </span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>提交</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt;color:red'>job<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;text-indent:20.0pt;
mso-char-indent-count:2.0;background:#E0E0E0;mso-layout-grid-align:none;
punctuation-trim:leading;border:none;mso-border-top-alt:none windowtext 0cm;
mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;
padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>submitter.submitJobInternal(Job.this,
cluster)<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>// 1</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）创建给集群提交数据的</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>Stag</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>路径</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>Path
jobStagingArea = JobSubmissionFiles.getStagingDir(cluster, conf);<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>// 2</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）获取</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>jobid </span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>，并创建</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>Job</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>路径</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>JobID jobId
= submitClient.getNewJobID();<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>// 3</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）拷贝</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>jar</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>包到集群</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;text-indent:21.0pt;
background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:leading;
border:none;mso-border-top-alt:none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;
mso-border-bottom-alt:none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>copyAndConfigureFiles(job, submitJobDir);<span
style='mso-tab-count:1'> </span><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>rUploader.uploadFiles(job,
jobSubmitDir);<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>// 4</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）计算切片，生成切片规划文件</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;text-indent:20.0pt;
mso-char-indent-count:2.0;background:#E0E0E0;mso-layout-grid-align:none;
punctuation-trim:leading;border:none;mso-border-top-alt:none windowtext 0cm;
mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;
padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>writeSplits(job,
submitJobDir);<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span><span
style='mso-tab-count:1'>    </span>maps = writeNewSplits(job, jobSubmitDir);<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>       </span>input.getSplits(job);<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>// 5</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）向</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>Stag</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>路径写</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>XML</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>配置文件</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;text-indent:20.0pt;
mso-char-indent-count:2.0;background:#E0E0E0;mso-layout-grid-align:none;
punctuation-trim:leading;border:none;mso-border-top-alt:none windowtext 0cm;
mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;
padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>writeConf(conf,
submitJobFile);<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>conf.writeXml(out);<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-top-alt:
none windowtext 0cm;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>// 6</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>）提交</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'>Job,</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.0pt;mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>返回提交状态</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.0pt;
mso-bidi-font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;text-indent:20.0pt;
mso-char-indent-count:2.0;background:#E0E0E0;mso-layout-grid-align:none;
punctuation-trim:leading;border:none;mso-border-top-alt:none windowtext 0cm;
mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;
padding:0cm;mso-padding-alt:1.0pt 0cm 1.0pt 4.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>status = submitClient.submitJob(jobId,
submitJobDir.toString(), job.getCredentials());<o:p></o:p></span></span></span></span></span></span></p>

</div>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><v:shape id="_x0000_i1040" type="#_x0000_t75" style='width:555.6pt;
 height:313.8pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image036.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1040"
  DrawAspect="Content" ObjectID="_1629748216">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>图</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;line-height:150%'>4-8<span style='mso-spacerun:yes'> 
</span>Job</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>提交流程源码分析</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<h4><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US>debugJob</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-hansi-font-family:"Calibri Light"'>提交源码详情</span></span></span></span></span></span></h4>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>拿前面</span></span></span></span></span></span><a
href="#_1.8_WordCount案例实操"><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>WordCount</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'></span></span></span></span></span></a><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>例子</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_27" o:spid="_x0000_i1385"
 type="#_x0000_t75" style='width:7in;height:192.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image037.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>都在</span><span lang=EN-US>Job.class</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_28" o:spid="_x0000_i1384"
 type="#_x0000_t75" style='width:397.2pt;height:231pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image038.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_29" o:spid="_x0000_i1383"
 type="#_x0000_t75" style='width:470.4pt;height:253.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image039.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_30" o:spid="_x0000_i1382"
 type="#_x0000_t75" style='width:421.8pt;height:158.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image040.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>回到这里</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_32" o:spid="_x0000_i1381"
 type="#_x0000_t75" style='width:470.4pt;height:253.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image039.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_31" o:spid="_x0000_i1380"
 type="#_x0000_t75" style='width:419.4pt;height:321pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image041.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>回到</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_33" o:spid="_x0000_i1379"
 type="#_x0000_t75" style='width:480pt;height:177.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image042.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>在</span><span lang=EN-US>Cluster</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类了，可以看到配置文件</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_35" o:spid="_x0000_i1378"
 type="#_x0000_t75" style='width:460.8pt;height:212.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image043.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_36" o:spid="_x0000_i1377"
 type="#_x0000_t75" style='width:444pt;height:274.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image044.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_37" o:spid="_x0000_i1376"
 type="#_x0000_t75" style='width:453pt;height:265.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image045.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_38" o:spid="_x0000_i1375"
 type="#_x0000_t75" style='width:442.8pt;height:327pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image046.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_40" o:spid="_x0000_i1374"
 type="#_x0000_t75" style='width:449.4pt;height:204.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image047.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_41" o:spid="_x0000_i1373"
 type="#_x0000_t75" style='width:432.6pt;height:191.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image048.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>回来</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_42" o:spid="_x0000_i1372"
 type="#_x0000_t75" style='width:449.4pt;height:292.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image049.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_43" o:spid="_x0000_i1371"
 type="#_x0000_t75" style='width:465pt;height:211.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image050.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_44" o:spid="_x0000_i1370"
 type="#_x0000_t75" style='width:472.8pt;height:247.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image051.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_45" o:spid="_x0000_i1369"
 type="#_x0000_t75" style='width:567pt;height:246.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image052.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_46" o:spid="_x0000_i1368"
 type="#_x0000_t75" style='width:567pt;height:269.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image053.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_47" o:spid="_x0000_i1367"
 type="#_x0000_t75" style='width:567pt;height:203.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image054.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分配</span><span lang=EN-US>job</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的</span><span
lang=EN-US>id</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_48" o:spid="_x0000_i1366"
 type="#_x0000_t75" style='width:430.2pt;height:210.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image055.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_50" o:spid="_x0000_i1365"
 type="#_x0000_t75" style='width:424.2pt;height:182.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image056.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_51" o:spid="_x0000_i1364"
 type="#_x0000_t75" style='width:430.2pt;height:280.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image057.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_52" o:spid="_x0000_i1363"
 type="#_x0000_t75" style='width:417pt;height:178.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image058.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_53" o:spid="_x0000_i1362"
 type="#_x0000_t75" style='width:429.6pt;height:215.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image059.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_54" o:spid="_x0000_i1361"
 type="#_x0000_t75" style='width:402.6pt;height:307.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image060.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_55" o:spid="_x0000_i1360"
 type="#_x0000_t75" style='width:567pt;height:282pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image061.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_56" o:spid="_x0000_i1359"
 type="#_x0000_t75" style='width:566.4pt;height:292.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image062.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_57" o:spid="_x0000_i1358"
 type="#_x0000_t75" style='width:424.2pt;height:189.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image063.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_58" o:spid="_x0000_i1357"
 type="#_x0000_t75" style='width:567pt;height:204.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image064.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_59" o:spid="_x0000_i1356"
 type="#_x0000_t75" style='width:567pt;height:60pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image065.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_60" o:spid="_x0000_i1355"
 type="#_x0000_t75" style='width:433.8pt;height:171pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image066.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_63" o:spid="_x0000_i1354"
 type="#_x0000_t75" style='width:567pt;height:203.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image067.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_62" o:spid="_x0000_i1353"
 type="#_x0000_t75" style='width:566.4pt;height:281.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image068.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_64" o:spid="_x0000_i1352"
 type="#_x0000_t75" style='width:567pt;height:307.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image069.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>回到最开始的方法</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_65" o:spid="_x0000_i1351"
 type="#_x0000_t75" style='width:401.4pt;height:276.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image070.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<h4><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US>FileInputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-hansi-font-family:"Calibri Light"'>切片源码解析</span><span
lang=EN-US>(input.getSplits(job))</span></span></span></span></span></span></h4>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
color:black'><v:shape id="_x0000_i1041" type="#_x0000_t75" style='width:532.8pt;
 height:300pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image071.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1041"
  DrawAspect="Content" ObjectID="_1629748217">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
color:black'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
color:black'>wordcount</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>例子</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
color:black'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_66" o:spid="_x0000_i1350" type="#_x0000_t75" style='width:446.4pt;
 height:226.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image072.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_67" o:spid="_x0000_i1349" type="#_x0000_t75" style='width:451.8pt;
 height:259.2pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image073.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_68" o:spid="_x0000_i1348" type="#_x0000_t75" style='width:487.2pt;
 height:187.2pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image074.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_69" o:spid="_x0000_i1347" type="#_x0000_t75" style='width:440.4pt;
 height:223.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image075.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_70" o:spid="_x0000_i1346" type="#_x0000_t75" style='width:447.6pt;
 height:222pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image076.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_71" o:spid="_x0000_i1345" type="#_x0000_t75" style='width:426.6pt;
 height:325.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image077.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_72" o:spid="_x0000_i1344" type="#_x0000_t75" style='width:567pt;
 height:144.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image078.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_74" o:spid="_x0000_i1343" type="#_x0000_t75" style='width:567pt;
 height:189pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image079.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_75" o:spid="_x0000_i1342" type="#_x0000_t75" style='width:490.8pt;
 height:327pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image080.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_76" o:spid="_x0000_i1341" type="#_x0000_t75" style='width:468.6pt;
 height:141.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image081.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_77" o:spid="_x0000_i1340" type="#_x0000_t75" style='width:454.2pt;
 height:230.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image082.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_78" o:spid="_x0000_i1339" type="#_x0000_t75" style='width:491.4pt;
 height:162.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image083.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>分片大小</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_79" o:spid="_x0000_i1338" type="#_x0000_t75" style='width:567pt;
 height:159.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image084.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_80" o:spid="_x0000_i1337" type="#_x0000_t75" style='width:554.4pt;
 height:95.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image085.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_81" o:spid="_x0000_i1336" type="#_x0000_t75" style='width:424.2pt;
 height:114pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image086.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_82" o:spid="_x0000_i1335" type="#_x0000_t75" style='width:451.2pt;
 height:170.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image087.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_83" o:spid="_x0000_i1334" type="#_x0000_t75" style='width:567pt;
 height:160.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image088.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_84" o:spid="_x0000_i1333" type="#_x0000_t75" style='width:408pt;
 height:195.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image089.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_85" o:spid="_x0000_i1332" type="#_x0000_t75" style='width:507.6pt;
 height:259.2pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image090.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_86" o:spid="_x0000_i1331" type="#_x0000_t75" style='width:460.2pt;
 height:271.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image091.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-family:"Times New Roman","serif";color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
color:black'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><a
name="_Toc439079677"><span lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.3
FileInputFormat</span></a></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079677'><span
style='font-size:14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>切片机制</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079677'></span><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></span></span></span></span></span></h3>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><v:shape id="_x0000_i1042" type="#_x0000_t75" style='width:409.2pt;
 height:230.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image092.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1042"
  DrawAspect="Content" ObjectID="_1629748218">
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><v:shape id="_x0000_i1043" type="#_x0000_t75" style='width:492pt;
 height:277.8pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image093.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1043"
  DrawAspect="Content" ObjectID="_1629748219">
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>好点机器，</span><span lang=EN-US>minSize</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>就改为</span><span
lang=EN-US>256M</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_87" o:spid="_x0000_i1330"
 type="#_x0000_t75" style='width:387pt;height:23.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image094.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.4 CombineTextInputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>切片机制</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></span></span></span></span></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>框架默认的</span><span lang=EN-US>TextInputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>切片机制是</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>对任务按文件规划切片</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red;mso-ansi-language:
ZH-CN'>不管文件多小</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>，</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red;mso-ansi-language:
ZH-CN'>都会是一个单独的切片</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>都会交给一个</span><span lang=EN-US>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>这样如果有大量小文件</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>就<span style='color:red'>会产生大量的</span></span><span lang=EN-US
style='color:red'>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>处理效率极其低下。</span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>、应用场景：</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>CombineTextInputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>用于小文件过多的场景，</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>它可以将多个小文件从逻辑上规划到一个切片中</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>这样</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>多个小文件就可以交给一个</span><span lang=EN-US>MapTask</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>处理</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>。</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>、虚拟存储切片最大值设置</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>CombineTextInputFormat.setMaxInputSplitSize(job, <span
style='color:red'>4194304</span>);<span style='mso-spacerun:yes'>  </span>// 4m</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，这是为了后面测试，实际一般使用</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>128M<o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>注意：虚拟存储切片最大值设置最好根据实际的小文件大小情况来设置具体的值。</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>3</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>、切片机制</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>生成切片过程包括：虚拟存储过程和切片过程二部分。（以</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>4M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>为例，好计算）</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-ansi-language:ZH-CN'><v:shape
 id="_x0000_i1044" type="#_x0000_t75" style='width:521.4pt;height:294.6pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image095.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1044"
  DrawAspect="Content" ObjectID="_1629748220">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:1.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>1</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）虚拟存储过程：</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>将输入目录下所有文件大小，依次和设置的</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>setMaxInputSplitSize</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>值比较，如果不大于设置的最大值，逻辑上划分一个块。如果输入文件大于设置的最大值且大于两倍，那么以最大值切割一块；<span
style='color:red'>当剩余数据大小超过设置的最大值且不大于最大值</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>2</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>倍，此时将文件均分成</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>2</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>个虚拟存储块（防止出现太小切片）。</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>例如</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>setMaxInputSplitSize</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>值为</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>4M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，输入文件大小为</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>8.02M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，则先逻辑上分成一个</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>4M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。剩余的大小为</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>4.02M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，如果按照</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>4M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>逻辑划分，就会出现</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>0.02M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的小的虚拟存储文件，所以将剩余的</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>4.02M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>文件切分成（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>2.01M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>和</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>2.01M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）两个文件。</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>2</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）切片过程：</span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>a</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）判断虚拟存储的文件大小是否大于</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>setMaxInputSplitSize</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>值，大于等于则单独形成一个切片。</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>b</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）如果不大于则跟下一个虚拟存储文件进行合并，共同形成一个切片。</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>c</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>）测试举例：有</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>4</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>个小文件大小分别为</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>1.7M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>、</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>5.1M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>、</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>3.4M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>以及</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>6.8M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>这四个小文件，则虚拟存储之后形成</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>6</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>个文件块，大小分别为：</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>1.7M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>，（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>2.55M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>、</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>2.55M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>），</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>3.4M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>以及（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>3.4M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>、</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>3.4M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>）</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>最终会形成</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>3</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>个切片，大小分别为：</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>1.7+2.55</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>）</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>，（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>2.55+3.4</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>）</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>，（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>3.4+3.4</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>）</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>M</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.5 CombineTextInputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>案例实操</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></span></span></span></span></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>将输入的大量小文件合并成一个切片统一处理。</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>输入数据</span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>准备</span><span
lang=EN-US>4</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个小文件</span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_88" o:spid="_x0000_i1329" type="#_x0000_t75" style='width:488.4pt;
 height:168.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image096.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_89" o:spid="_x0000_i1328" type="#_x0000_t75" style='width:270pt;
 height:389.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image097.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）期望</span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>期望一个切片处理</span><span
lang=EN-US>4</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个文件</span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．实现过程</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）不做任何处理，运行</span><span lang=EN-US>WordCount</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>案例程序，给路径，本地运行</span><span lang=EN-US><o:p></o:p></span></b></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_90" o:spid="_x0000_i1327" type="#_x0000_t75" style='width:526.2pt;
 height:292.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image098.png" o:title=""/>
</v:shape></span><b style='mso-bidi-font-weight:normal'><span lang=EN-US><o:p></o:p></span></b></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>观察切片个数为</span><span lang=EN-US>4</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span><span lang=EN-US><o:p></o:p></span></b></span></span></span></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:21.0pt;margin-bottom:
0cm;margin-left:21.0pt;margin-bottom:.0001pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="_x0000_i1326" type="#_x0000_t75" style='width:501pt;height:216.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image099.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US>WordcountDriver</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中增加如下代码，运行程序，并观察运行的切片个数为</span><span lang=EN-US>3</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span><span lang=EN-US><o:p></o:p></span></b></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>a</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）驱动类中添加代码如下：</span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>// </span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>如果不设置</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>InputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>，它默认用的是</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>TextInputFormat.class<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>job.setInputFormatClass(CombineTextInputFormat.class);<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>//</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>虚拟存储切片最大值设置</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt;
color:red'>4m</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>CombineTextInputFormat.setMaxInputSplitSize(job,
<span style='color:red'>4194304</span>);<o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_92" o:spid="_x0000_i1325"
 type="#_x0000_t75" style='width:437.4pt;height:259.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image100.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-right:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US><span style='mso-tab-count:
1'>       </span><span style='mso-tab-count:1'>       </span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>b</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）运行如果为</span><span lang=EN-US>3</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>个切片。</span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_93" o:spid="_x0000_i1324" type="#_x0000_t75" style='width:477pt;
 height:231.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image101.png" o:title=""/>
</v:shape></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Calibri","sans-serif"'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US>WordcountDriver</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中增加如下代码，运行程序，并观察运行的切片个数为</span><span lang=EN-US>1</span></b></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><b style='mso-bidi-font-weight:normal'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span><span lang=EN-US><o:p></o:p></span></b></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><span style='mso-tab-count:
1'>         </span><span style='mso-tab-count:1'>         </span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:9.0pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:9.0pt;
line-height:150%'>a</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:9.0pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>驱动中添加代码如下：</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:9.0pt;
line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>// </span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>如果不设置</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>InputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>，它默认用的是</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>TextInputFormat.class<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>job.setInputFormatClass(CombineTextInputFormat.class);<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>//</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>虚拟存储切片最大值设置</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt;
color:red'>20m</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:47.25pt;mso-para-margin-left:4.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>CombineTextInputFormat.setMaxInputSplitSize(job,
<span style='color:red'>20971520</span>);<o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>b</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）运行如果为</span><span lang=EN-US>1</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>个切片。</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:9.0pt;
line-height:150%'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_94" o:spid="_x0000_i1323" type="#_x0000_t75" style='width:517.8pt;
 height:184.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image102.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:red'><o:p></o:p></span></span></span></span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.6 FileInputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>实现类</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></span></span></span></span></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='color:black'><v:shape id="_x0000_i1045" type="#_x0000_t75"
 style='width:412.2pt;height:234pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image103.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1045"
  DrawAspect="Content" ObjectID="_1629748221">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='color:black'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_95" o:spid="_x0000_i1322"
 type="#_x0000_t75" style='width:343.8pt;height:197.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image104.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='color:black'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='color:black'><v:shape id="_x0000_i1046" type="#_x0000_t75"
 style='width:417.6pt;height:234pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image105.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1046"
  DrawAspect="Content" ObjectID="_1629748222">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='color:black'><v:shape id="_x0000_i1047" type="#_x0000_t75"
 style='width:411pt;height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image106.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1047"
  DrawAspect="Content" ObjectID="_1629748223">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='color:black'><v:shape id="_x0000_i1048" type="#_x0000_t75"
 style='width:7in;height:285.6pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image107.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1048"
  DrawAspect="Content" ObjectID="_1629748224">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></span></span></span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.7
KeyValueTextInputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>使用案例</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></span></span></span></span></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计输入文件中每一行的第一个单词相同的行数。</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）输入数据</span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>xihuan hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>xihuan hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）期望结果数据</span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>banzhang<span style='mso-tab-count:1'> </span>2<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>xihuan<span style='mso-tab-count:1'>   </span>2<o:p></o:p></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US><v:shape id="_x0000_i1049"
 type="#_x0000_t75" style='width:455.4pt;height:255.6pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image108.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1049"
  DrawAspect="Content" ObjectID="_1629748226">
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>3</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．代码实现</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>编写</span><span lang=EN-US>Mapper</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>类</span></span></span></span></span></span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=969
 style='width:581.2pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=969 valign=top style='width:581.2pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.KeyValueTextInputFormat;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>public class KVTextMapper extends
  Mapper&lt;<span style='color:red'>Text, Text</span>, Text, LongWritable&gt;{<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  15.75pt;mso-char-indent-count:1.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span lang=EN-US
  style='font-size:10.5pt'>// 1 </span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>设置</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>value<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>  
  </span>LongWritable v = new LongWritable(1);<span style='mso-spacerun:yes'> 
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>   
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void map(Text key, Text value, Context context)<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>throws
  IOException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  42.0pt;mso-char-indent-count:4.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span lang=EN-US
  style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>// banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 2 </span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>写出，例如</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>(banzhang,
  1) (ni, 1)<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>context.write(key, v);<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'></span></span></span></span></span>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>（</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>2</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>）编写</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>Reducer</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>类</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=945
 style='width:20.0cm;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=945 valign=top style='width:20.0cm;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.KeyValueTextInputFormat;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>public class KVTextReducer extends
  Reducer&lt;Text, LongWritable, Text, LongWritable&gt;{<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>   
  </span>LongWritable v = new LongWritable();<span style='mso-spacerun:yes'> 
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>   
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void reduce(Text key, Iterable&lt;LongWritable&gt; values,<span
  style='mso-tab-count:1'>  </span>Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='mso-spacerun:yes'> </span>long sum = 0L;<span
  style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='mso-spacerun:yes'> </span>// 1 </span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>汇总统计</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>for (LongWritable value : values) {<span style='mso-spacerun:yes'> 
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>            </span>sum += value.get();<span
  style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>}<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>        
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>v.set(sum);<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>        
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 2 </span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>输出</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>context.write(key, v);<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'></span></span></span></span></span>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>（</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>3</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>）编写</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>Driver</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>类</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.keyvaleTextInputFormat;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.KeyValueLineRecordReader;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.KeyValueTextInputFormat;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>public class KVTextDriver {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  static void main(String[] args) throws IOException, ClassNotFoundException,
  InterruptedException {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
  conf = new Configuration();<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
  style='color:red'><span style='mso-tab-count:1'>   </span>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>设置切割符，默认是</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt;
  color:red'>\t<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>conf.set(KeyValueLineRecordReader.KEY_VALUE_SEPERATOR, &quot;
  &quot;);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span></span></span></span></span></span><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>job</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>对象</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job
  job = Job.getInstance(conf);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span></span></span></span></span></span><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>jar</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包位置，关联</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>mapper</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>和</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>reducer<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setJarByClass(KVTextDriver.class);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(KVTextMapper.class);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span lang=EN-US
  style='font-size:10.5pt'>job.setReducerClass(KVTextReducer.class);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>            </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span></span></span></span></span></span><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>map</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输出</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>kv</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(LongWritable.class);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  4 </span></span></span></span></span></span><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置最终输出</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>kv</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span lang=EN-US
  style='font-size:10.5pt'>job.setOutputValueClass(LongWritable.class);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  5 </span></span></span></span></span></span><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置输入输出数据路径</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='color:red'>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>设置输入格式</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>job.setInputFormatClass(KeyValueTextInputFormat.class);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  6 </span></span></span></span></span></span><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置输出数据路径</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  7 </span></span></span></span></span></span><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>提交</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>job<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.waitForCompletion(true);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>执行</span><span lang=EN-US>Driver</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>的结果</span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_97" o:spid="_x0000_i1321"
   type="#_x0000_t75" style='width:438.6pt;height:154.8pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image109.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'></span></span></span></span></span>
 </tr>
</table>

</div>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.8 NLineInputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>使用案例</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></span></span></span></span></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对每个单词进行个数统计，要求根据每个输入文件的行数来规定输出多少个切片。此案例要求每三行放入一个切片中。</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）输入数据</span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>banzhang
ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>xihuan
hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>banzhang
ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>xihuan
hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>banzhang
ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>xihuan
hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>banzhang
ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>xihuan
hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>banzhang
ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>xihuan
hadoop banzhang banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>xihuan
hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_98" o:spid="_x0000_i1320"
 type="#_x0000_t75" style='width:435pt;height:155.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image110.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）期望输出数据</span></span></span></span></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>Number
of splits:4<o:p></o:p></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US><v:shape id="_x0000_i1050"
 type="#_x0000_t75" style='width:385.8pt;height:216.6pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image111.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1050"
  DrawAspect="Content" ObjectID="_1629748227">
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>3</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．代码实现</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>（</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>1</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>）编写</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>Mapper</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>类</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=933 valign=top style='width:559.95pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.nline;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>public
  class NLineMapper extends Mapper&lt;LongWritable, Text, Text,
  LongWritable&gt;{<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private Text k = new Text();<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private LongWritable v = new
  LongWritable(1);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void map(LongWritable key, Text
  value, Context context)<span style='mso-tab-count:1'> </span>throws
  IOException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><span style='mso-spacerun:yes'> </span>//
  1 </span></span></span></span></span></span><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取一行</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span><span
  style='mso-spacerun:yes'> </span>String line = value.toString();<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span>// 2 </span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>切割</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span>String[] splited = line.split(&quot;
  &quot;);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span>// 3 </span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>循环写出</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span>for (int i = 0; i &lt; splited.length;
  i++) {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>  </span>k.set(splited[i]);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>           </span>context.write(k, v);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>}</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'></span></span></span></span></span>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>（</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>2</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>）编写</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>Reducer</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>类</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.nline;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>public class NLineReducer extends
  Reducer&lt;Text, LongWritable, Text, LongWritable&gt;{<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>LongWritable
  v = new LongWritable();<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void reduce(Text key, Iterable&lt;LongWritable&gt; values,<span
  style='mso-tab-count:1'>  </span>Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>long sum = 0l;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 1 </span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>汇总</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>for (LongWritable value : values) {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>            </span>sum += value.get();<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>}<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>v.set(sum);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 2 </span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>输出</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>context.write(key, v);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'></span></span></span></span></span>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>（</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>3</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>）编写</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>Driver</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>类</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=969
 style='width:581.2pt;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=969 valign=top style='width:581.2pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.nline;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import java.net.URISyntaxException;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.NLineInputFormat;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>public class NLineDriver {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  static void main(String[] args) throws IOException, URISyntaxException,
  ClassNotFoundException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span lang=EN-US
  style='font-size:10.5pt'>// </span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输入输出路径需要根据自己电脑上实际的输入输出路径设置</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>args = new String[] { &quot;e:/input/inputword&quot;,
  &quot;e:/output1&quot; };<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='mso-spacerun:yes'> </span>// 1 </span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>获取</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>job</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>对象</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='mso-spacerun:yes'> </span>Configuration configuration = new
  Configuration();<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>Job job = Job.getInstance(configuration);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span
  style='mso-spacerun:yes'>        </span>// 7</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>设置每个切片</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt;
  color:red'>InputSplit</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>中划分三条记录</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span
  style='mso-spacerun:yes'>       
  </span>NLineInputFormat.setNumLinesPerSplit(job, 3);<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>         
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span><span style='color:red'>// 8</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>使用</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt;
  color:red'>NLineInputFormat</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>处理记录数</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span
  style='mso-spacerun:yes'>       
  </span>job.setInputFormatClass(NLineInputFormat.class); </span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'> </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>         
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 2</span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>jar</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包位置，关联</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>mapper</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>和</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>reducer<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>job.setJarByClass(NLineDriver.class);<span style='mso-spacerun:yes'> 
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>job.setMapperClass(NLineMapper.class);<span style='mso-spacerun:yes'> 
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>job.setReducerClass(NLineReducer.class);<span
  style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 3</span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>map</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输出</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>kv</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>job.setMapOutputKeyClass(Text.class);<span style='mso-spacerun:yes'> 
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>job.setMapOutputValueClass(LongWritable.class);<span
  style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 4</span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置最终输出</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>kv</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>job.setOutputKeyClass(Text.class);<span style='mso-spacerun:yes'> 
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>job.setOutputValueClass(LongWritable.class);<span
  style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>         
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 5</span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置输入输出数据路径</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>FileInputFormat.setInputPaths(job, new Path(args[0]));<span
  style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>FileOutputFormat.setOutputPath(job, new Path(args[1]));<span
  style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>         
  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 6</span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>提交</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:10.5pt'>job<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>job.waitForCompletion(true);<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'></span></span></span></span></span>
 </tr>
</table>

</div>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>4</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>．</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial;mso-ansi-language:ZH-CN'>测试</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>（</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'>1</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-ansi-language:
ZH-CN'>）输入数据</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>xihuan hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>xihuan hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>xihuan hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>xihuan hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>xihuan hadoop banzhang banzhang ni hao<o:p></o:p></span></span></span></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:10.5pt'>xihuan hadoop banzhang<o:p></o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）输出结果的切片数，如图</span><span lang=EN-US>4-10</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>所示：</span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_91" o:spid="_x0000_i1319"
 type="#_x0000_t75" style='width:445.8pt;height:114.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image112.png" o:title="" croptop="1143f"/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:9.0pt'>4-10
</span></span></span></span></span></span><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>输出结果的切片数</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></span></span></span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.9 </span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>自定义</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>InputFormat<o:p></o:p></span></span></span></span></span></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><v:shape id="_x0000_i1051" type="#_x0000_t75" style='width:411pt;
 height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image113.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1051"
  DrawAspect="Content" ObjectID="_1629748228">
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.1.10 </span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>自定义</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>InputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>案例实操</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></span></span></span></span></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>无论</span><span
lang=EN-US>HDFS</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>还是</span><span
lang=EN-US>MapReduce</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，在处理小文件时效率都非常低，但又难免面临处理大量小文件的场景，此时，就需要有相应解决方案。可以自定义</span><span
lang=EN-US>InputFormat</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>实现小文件的合并。</span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>将多个小文件合并成一个</span><span
lang=EN-US>SequenceFile</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（处理小文件的）文件（</span><span
lang=EN-US>SequenceFile</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件是</span><span
lang=EN-US>Hadoop</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用来存储二进制形式的</span><span
lang=EN-US>key-value</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对的文件格式），</span><span
lang=EN-US>SequenceFile</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>里面存储着多个文件，存储的形式为文件路径</span><span
lang=EN-US>+</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>名称为</span><span lang=EN-US>key</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，文件内容为</span><span
lang=EN-US>value</span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）输入数据</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US><v:shape id="_x0000_i1052"
 type="#_x0000_t75" style='width:36pt;height:39.6pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image114.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1052"
  DrawAspect="Content" ObjectID="_1629748229">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'>     </span><v:shape id="_x0000_i1053"
 type="#_x0000_t75" style='width:36pt;height:39.6pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image115.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1053"
  DrawAspect="Content" ObjectID="_1629748230">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'>     </span><v:shape id="_x0000_i1054"
 type="#_x0000_t75" style='width:39.6pt;height:39.6pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image116.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1054"
  DrawAspect="Content" ObjectID="_1629748231">
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_99" o:spid="_x0000_i1318" type="#_x0000_t75" style='width:204.6pt;
 height:83.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image117.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_100" o:spid="_x0000_i1317" type="#_x0000_t75" style='width:234.6pt;
 height:127.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image118.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_101" o:spid="_x0000_i1316" type="#_x0000_t75" style='width:245.4pt;
 height:93pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image119.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）期望输出文件格式</span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:1.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US><v:shape id="_x0000_i1055"
 type="#_x0000_t75" style='width:51.6pt;height:33pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image120.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1055"
  DrawAspect="Content" ObjectID="_1629748232">
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:1.0pt;text-indent:21.0pt;line-height:
150%'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_102" o:spid="_x0000_i1315" type="#_x0000_t75" style='width:541.8pt;
 height:88.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image121.png" o:title=""/>
</v:shape></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>2</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></span></span></span></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US><v:shape id="_x0000_i1056" type="#_x0000_t75" style='width:507pt;
 height:284.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image122.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1056"
  DrawAspect="Content" ObjectID="_1629748233">
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
lang=EN-US>3</span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．程序实现</span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><a name="_Toc439079675"><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>（</span></a></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>1</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>）自定义</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>InputFromat<o:p></o:p></span></span></span></span></span></span></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.inputformat;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.Path;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.BytesWritable;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.NullWritable;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.InputSplit;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.JobContext;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.RecordReader;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.TaskAttemptContext;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>//
  </span></span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>定义类继承</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>FileInputFormat<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>public
  class WholeFileInputformat extends FileInputFormat&lt;Text,
  BytesWritable&gt;{<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected boolean isSplitable(JobContext
  context, Path filename) {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return false;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public RecordReader&lt;Text,
  BytesWritable&gt; createRecordReader(InputSplit split, TaskAttemptContext
  context)<span style='mso-tab-count:1'> </span>throws IOException,
  InterruptedException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>     
  </span>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>每读一个文件就</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>new</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>一个这个对象</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>WholeRecordReader recordReader = new
  WholeRecordReader();<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>     
  </span>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>创建的时候初始化，值就传递过去了</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>recordReader.initialize(split, context);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return recordReader;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>}</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial'><o:p></o:p></span></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'></span></span></span></span></span></span>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>（</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>2</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>）自定义</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>RecordReader</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>类</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.inputformat;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.FSDataInputStream;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.FileSystem;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.Path;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.BytesWritable;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.IOUtils;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.NullWritable;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.InputSplit;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.RecordReader;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.TaskAttemptContext;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileSplit;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>//
  Text</span></span></span></span></span></span></span><span style='mso-bookmark:
  _Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
  _Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:
  _Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>是文件路径，</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>BytesWritable</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>是文件内容</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>public
  class WholeRecordReader extends RecordReader&lt;Text, BytesWritable&gt;{<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private Configuration configuration;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private FileSplit split;<span
  style='mso-spacerun:yes'>  </span>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>读的数据就是</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>File</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>格式的</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private boolean isProgress= true;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private BytesWritable value = new
  BytesWritable();<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private Text k = new Text();<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override // </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>初始化</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void initialize(InputSplit split,
  TaskAttemptContext context) throws IOException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.split = (FileSplit)split;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>configuration =
  context.getConfiguration();<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<span style='mso-spacerun:yes'> 
  </span>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>核心业务逻辑处理</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public boolean <span style='color:red'>nextKeyValue</span>()
  throws IOException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>if (isProgress) {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>// 1 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>定义缓存区（文件的长度）</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>byte[] contents = new
  byte[(int)split.getLength()];<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>FileSystem fs = null;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>FSDataInputStream fis = null;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>try {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>// 2 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取文件系统（通过文件路径反过来获取文件系统）</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>Path path = split.getPath();<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>fs =
  path.getFileSystem(configuration);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>// 3 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>读取数据</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>fis = fs.open(path);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>// 4 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>读取文件内容</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>IOUtils.readFully(fis, contents,
  0, contents.length);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>// 5 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>输出文件内容</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>value.set(contents, 0,
  contents.length);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  78.75pt;mso-char-indent-count:7.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:
  _Toc439079675'><span lang=EN-US style='font-size:10.5pt'>// 6 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取文件路径及名称</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  78.75pt;mso-char-indent-count:7.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:
  _Toc439079675'><span lang=EN-US style='font-size:10.5pt'>String name = split.getPath().toString();<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  78.75pt;mso-char-indent-count:7.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:
  _Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  78.75pt;mso-char-indent-count:7.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:
  _Toc439079675'><span lang=EN-US style='font-size:10.5pt'>// 7 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置输出的</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>key</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>值</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  78.75pt;mso-char-indent-count:7.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:
  _Toc439079675'><span lang=EN-US style='font-size:10.5pt'>k.set(name);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>} catch (Exception e) {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>}finally {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:4'>            </span>IOUtils.closeStream(fis);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>默认是</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>true</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>，所以每读一个文件肯定会进来这里，然后就是</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>false</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>了，读下一个文件就重新</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>new</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>本类的对象了</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>isProgress = false;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><span style='mso-tab-count:1'>   </span>return
  true;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>     
  </span>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>读完一个文件，这里就返回</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>false</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>，就退出循环了</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return false;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override // </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>当前的</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>key</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>，与</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>RecordReader&lt;Text, BytesWritable&gt;</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>的</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>key</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>一样</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public Text getCurrentKey() throws
  IOException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return k;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public BytesWritable getCurrentValue()
  throws IOException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return value;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override // </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>相当于进度条</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public float getProgress() throws
  IOException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return 0;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void close() throws IOException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;color:red'>nextKeyValue</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:red'>调用</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_105" o:spid="_x0000_i1314" type="#_x0000_t75" style='width:480pt;
   height:295.8pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image123.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'></span></span></span></span></span></span>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>（</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>3</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>）编写</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>SequenceFileMapper</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>类处理流程</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'>package com.atguigu.mapreduce.inputformat;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'>import org.apache.hadoop.io.BytesWritable;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'>import org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileSplit;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'>public class SequenceFileMapper extends Mapper&lt;Text,
  BytesWritable, Text, BytesWritable&gt;{<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>   </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>   </span>@Override<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>   </span>protected
  void map(Text key, BytesWritable value, Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>      </span>context.write(key,
  value);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt'>}</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial'><o:p></o:p></span></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'></span></span></span></span></span></span>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>（</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>4</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>）编写</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>SequenceFileReducer</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>类处理流程</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.inputformat;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.BytesWritable;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>public
  class SequenceFileReducer extends Reducer&lt;Text, BytesWritable, Text,
  BytesWritable&gt; {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void reduce(Text key,
  Iterable&lt;BytesWritable&gt; values, Context context)<span style='mso-tab-count:
  2'>      </span>throws IOException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>     
  </span>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>循环写出到一个文件</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>context.write(key,
  values.iterator().next());<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>其实就是这样子的</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_106" o:spid="_x0000_i1313" type="#_x0000_t75" style='width:309.6pt;
   height:78pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image124.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'></span></span></span></span></span></span>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>（</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>5</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>）编写</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'>SequenceFileDriver</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-ansi-language:ZH-CN'>类处理流程</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='mso-ansi-language:ZH-CN'><o:p></o:p></span></span></span></span></span></span></span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.inputformat;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.Path;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.BytesWritable;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.SequenceFileOutputFormat;<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>public
  class SequenceFileDriver {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public static void main(String[] args)
  throws IOException, ClassNotFoundException, InterruptedException {<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span>// </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>输入输出路径需要根据自己电脑上实际的输入输出路径设置</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>args = new String[] {
  &quot;e:/input/inputinputformat&quot;, &quot;e:/output1&quot; };<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span>// 1 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>job</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>对象</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Configuration conf = new
  Configuration();<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Job job = Job.getInstance(conf);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span>// 2 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>jar</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>包存储位置、关联自定义的</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>mapper</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>和</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>reducer<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setJarByClass(SequenceFileDriver.class);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapperClass(SequenceFileMapper.class);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setReducerClass(SequenceFileReducer.class);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span><span style='color:red'>// 7</span></span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>设置输入的</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt;color:red'>inputFormat<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>      </span>job.setInputFormatClass(WholeFileInputformat.class);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-spacerun:yes'>       </span>// 8</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>设置输出的</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt;color:red'>outputFormat</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>，默认是</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt;color:red'>textFile</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>，这个无法输出</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt;color:red'>byte</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>数据</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:2.5gd;text-indent:
  -5.25pt;mso-char-indent-count:-.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:
  _Toc439079675'><span lang=EN-US style='font-size:10.5pt;color:red'><span
  style='mso-tab-count:1'> </span><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>     </span>job.setOutputFormatClass(SequenceFileOutputFormat.class);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:
  _Toc17018'><span style='mso-bookmark:_Toc13977'><span style='mso-bookmark:
  _Toc28720'><span style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:
  _Toc439079675'><span lang=EN-US style='font-size:10.5pt'>// 3 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>map</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>输出端的</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>kv</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>类型</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(BytesWritable.class);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span>// 4 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置最终输出端的</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>kv</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>类型</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputValueClass(BytesWritable.class);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span>// 5 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>设置输入输出路径</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job, new
  Path(args[0]));<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job, new
  Path(args[1]));<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span>// 6 </span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>提交</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  lang=EN-US style='font-size:10.5pt'>job<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>boolean result =
  job.waitForCompletion(true);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>System.exit(result ? 0 : 1);<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>结果</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_107" o:spid="_x0000_i1312" type="#_x0000_t75" style='width:562.8pt;
   height:99.6pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image125.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>类似于这个</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_108" o:spid="_x0000_i1311" type="#_x0000_t75" style='width:563.4pt;
   height:313.8pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image126.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><b style='mso-bidi-font-weight:normal'><span
  lang=EN-US style='font-size:20.0pt;mso-bidi-font-size:11.0pt'>debug</span></b></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><b
  style='mso-bidi-font-weight:normal'><span style='font-size:20.0pt;mso-bidi-font-size:
  11.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>调试一下</span></b></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><b
  style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:20.0pt;
  mso-bidi-font-size:11.0pt'><o:p></o:p></span></b></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>断点</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_113" o:spid="_x0000_i1310" type="#_x0000_t75" style='width:563.4pt;
   height:154.8pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image127.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_114" o:spid="_x0000_i1309" type="#_x0000_t75" style='width:454.8pt;
   height:241.2pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image128.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_115" o:spid="_x0000_i1308" type="#_x0000_t75" style='width:461.4pt;
   height:188.4pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image129.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>然后</span><span
  lang=EN-US>debug</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>进来到这里</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_111" o:spid="_x0000_i1307" type="#_x0000_t75" style='width:444.6pt;
   height:304.8pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image130.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>读取到</span><span
  lang=EN-US>two.txt</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>文件</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_117" o:spid="_x0000_i1306" type="#_x0000_t75" style='width:447.6pt;
   height:210.6pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image131.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US>key</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_118" o:spid="_x0000_i1305" type="#_x0000_t75" style='width:415.2pt;
   height:121.8pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image132.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_119" o:spid="_x0000_i1304" type="#_x0000_t75" style='width:562.8pt;
   height:199.8pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image133.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>回到</span><span
  lang=EN-US>Mapper</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>的</span><span lang=EN-US>run</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>方法</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_120" o:spid="_x0000_i1303" type="#_x0000_t75" style='width:562.8pt;
   height:262.8pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image134.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>然后执行</span><span
  lang=EN-US>map</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>方法</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_121" o:spid="_x0000_i1302" type="#_x0000_t75" style='width:418.8pt;
   height:124.8pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image135.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_123" o:spid="_x0000_i1301" type="#_x0000_t75" style='width:427.2pt;
   height:136.2pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image136.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>然后回到</span><span
  lang=EN-US>Map</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>的</span><span lang=EN-US>run</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>方法，开始下一次的循环</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_124" o:spid="_x0000_i1300" type="#_x0000_t75" style='width:563.4pt;
   height:163.8pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image137.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>再循环</span><span
  lang=EN-US>nextKeyValue()</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>时，此时标志位为</span><span lang=EN-US>false</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>，那么最后就返回</span><span lang=EN-US>false</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_125" o:spid="_x0000_i1299" type="#_x0000_t75" style='width:520.2pt;
   height:216.6pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image138.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_126" o:spid="_x0000_i1298" type="#_x0000_t75" style='width:294.6pt;
   height:134.4pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image139.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US>Map</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>端就开始清理了，表示当前</span><span lang=EN-US>MapTask</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>结束了</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_127" o:spid="_x0000_i1297" type="#_x0000_t75" style='width:523.2pt;
   height:166.2pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image140.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>读取下一个文件的时候，开启新的</span><span
  lang=EN-US>MapTask</span></span></span></span></span></span></span><span
  style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>读取第二个文件，跟上面一样，直到读完三个</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>最后走</span><span
  lang=EN-US>Reducer</span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
   id="图片_x0020_128" o:spid="_x0000_i1296" type="#_x0000_t75" style='width:492.6pt;
   height:183.6pt;visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image141.png" o:title=""/>
  </v:shape></span></span></span></span></span></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'></span></span></span></span></span></span>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
  style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
  style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
  style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
  style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
  style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'></span></span></span></span></span></span>
 </tr>
</table>

</div>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><a
name="_Toc439079695"><span lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'>3.2
</span></a></span></span></span></span></span></span><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US style='font-size:14.0pt;
font-family:"Times New Roman","serif"'>MapReduce</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>工作流程</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'><o:p></o:p></span></span></span></span></span></span></span></h2>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>1</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．流程示意图，如图</span><span
lang=EN-US>4-6</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>，</span><span
lang=EN-US>4-7</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>所示</span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><v:shape id="_x0000_i1057"
 type="#_x0000_t75" style='width:558pt;height:315pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image142.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1057"
  DrawAspect="Content" ObjectID="_1629748234">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%'>4-6<span
style='mso-spacerun:yes'>  </span>MapReduce</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>详细工作流程（一）</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分析</span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>怎么读由他决定</span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_129" o:spid="_x0000_i1295" type="#_x0000_t75" style='width:227.4pt;
 height:112.2pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image143.png" o:title=""/>
</v:shape></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>来回写</span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_130" o:spid="_x0000_i1294" type="#_x0000_t75" style='width:352.8pt;
 height:259.2pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image144.png" o:title=""/>
</v:shape></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>环形缓冲区也可以这么看</span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_132" o:spid="_x0000_i1293" type="#_x0000_t75" style='width:399.6pt;
 height:158.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image145.png" o:title=""/>
</v:shape></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_133" o:spid="_x0000_i1292" type="#_x0000_t75" style='width:320.4pt;
 height:140.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image146.png" o:title=""/>
</v:shape></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><v:shape id="_x0000_i1058"
 type="#_x0000_t75" style='width:558pt;height:316.2pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image147.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1058"
  DrawAspect="Content" ObjectID="_1629748235">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--></span></span></span></span></span></span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'>4-7<span
style='mso-spacerun:yes'>  </span>MapReduce</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>详细工作流程（二）</span></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>2</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．流程详解</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上面的流程是整个</span><span lang=EN-US>MapReduce</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>最全工作流程，但是</span><span lang=EN-US>Shuffle</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>过程只是从第</span><span lang=EN-US>7</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>步开始到第</span><span lang=EN-US>16</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>步结束，具体</span><span lang=EN-US>Shuffle</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>过程详解，如下：</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='color:black'>1</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>MapTask</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>收集我们的</span><span lang=EN-US style='color:black'>map()</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>方法输出的</span><span lang=EN-US style='color:black'>kv</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>对，放到内存缓冲区中</span><span lang=EN-US
style='color:black'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='color:black'>2</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）从内存缓冲区不断溢出本地磁盘文件，可能会溢出多个文件</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='color:black'>3</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）多个溢出文件会被合并成大的溢出文件</span><span lang=EN-US
style='color:black'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='color:black'>4</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）在溢出过程及合并的过程中，都要调用</span><span lang=EN-US
style='color:black'>Partitioner</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>进行分区和针对</span><span lang=EN-US style='color:
black'>key</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>进行排序</span><span lang=EN-US style='color:black'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='color:black'>5</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>ReduceTask</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>根据自己的分区号，去各个</span><span lang=EN-US
style='color:black'>MapTask</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>机器上取相应的结果分区数据</span><span lang=EN-US
style='color:black'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='color:black'>6</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>ReduceTask</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>会取到同一个分区的来自不同</span><span lang=EN-US
style='color:black'>MapTask</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>的结果文件，</span><span lang=EN-US style='color:black'>ReduceTask</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>会将这些文件再进行合并（归并排序）</span><span lang=EN-US
style='color:black'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='color:black'>7</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）合并成大文件后，</span><span lang=EN-US
style='color:black'>Shuffle</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>的过程也就结束了，后面进入</span><span lang=EN-US
style='color:black'>ReduceTask</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>的逻辑运算过程（从文件中取出一个一个的键值对</span><span lang=EN-US
style='color:black'>Group</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>，调用用户自定义的</span><span lang=EN-US
style='color:black'>reduce()</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>方法）</span><span lang=EN-US style='color:black'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>3</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．注意</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US style='color:black'>Shuffle</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>中的缓冲区大小会影响到</span><span lang=EN-US
style='color:black'>MapReduce</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>程序的执行效率，原则上说，缓冲区越大，磁盘</span><span lang=EN-US
style='color:black'>io</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>的次数越少，执行速度就越快。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>缓冲区的大小可以通过参数调整，参数：</span><span lang=EN-US
style='color:black'>io.sort.mb</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>默认</span><span lang=EN-US style='color:black'>100M</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>。</span><span lang=EN-US style='color:black'><o:p></o:p></span></span></span></span></span></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079663'><span style='mso-bookmark:_Toc17018'><span style='mso-bookmark:
_Toc13977'><span style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>4</span></span></span></span></span></span></span><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．源码解析流程</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
style='mso-bookmark:_Toc439079663'><span style='mso-bookmark:_Toc17018'><span
style='mso-bookmark:_Toc13977'><span style='mso-bookmark:_Toc28720'><span
style='mso-bookmark:_Toc421731836'><span style='mso-bookmark:_Toc439079675'><span
lang=EN-US>context.write(k, NullWritable.get());</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>output.write(key, value);</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>collector.collect(key,
value,partitioner.getPartition(key, value, partitions));</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><span style='mso-tab-count:
1'>       </span>HashPartitioner();</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>collect()</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><span style='mso-tab-count:
1'>       </span>close()</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:63.0pt;mso-para-margin-left:6.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><span style='mso-tab-count:
1'>       </span>collect.flush()</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:94.5pt;mso-para-margin-left:9.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>sortAndSpill()</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:94.5pt;mso-para-margin-left:9.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><span style='mso-tab-count:
1'>   </span>sort()<span style='mso-spacerun:yes'>   </span>QuickSort</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:94.5pt;mso-para-margin-left:9.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>mergeParts();</span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:94.5pt;mso-para-margin-left:9.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US><span style='mso-tab-count:
1'>   </span><span style='mso-no-proof:yes'><v:shape id="图片_x0020_13" o:spid="_x0000_i1291"
 type="#_x0000_t75" style='width:81pt;height:35.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image148.png" o:title="" croptop="11042f"
  cropbottom="11675f" cropleft="3246f" cropright="27087f"/>
</v:shape></span></span></span></span></span></span></span></span></p>

<p class=MsoNormal style='margin-left:84.0pt;mso-para-margin-left:8.0gd;
text-indent:21.0pt'><span style='mso-bookmark:_Toc439079663'><span
style='mso-bookmark:_Toc17018'><span style='mso-bookmark:_Toc13977'><span
style='mso-bookmark:_Toc28720'><span style='mso-bookmark:_Toc421731836'><span
style='mso-bookmark:_Toc439079675'><span lang=EN-US>collector.close();</span></span></span></span></span></span></span></p>

<span style='mso-bookmark:_Toc439079675'></span><span style='mso-bookmark:_Toc421731836'></span><span
style='mso-bookmark:_Toc28720'></span><span style='mso-bookmark:_Toc13977'></span><span
style='mso-bookmark:_Toc17018'></span><span style='mso-bookmark:_Toc439079663'></span>

<h2 style='margin:0cm;margin-bottom:.0001pt'><a name="_Toc439079692"><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.3
Shuffle</span></a><span style='mso-bookmark:_Toc439079692'><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>机制</span></span><span
style='mso-bookmark:_Toc439079692'></span><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><a name="_Toc439079693"><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>3.3.1 </span></a><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>Shuffle</span><span
style='font-size:14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>机制</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:red'>Map</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>方法（注意是方法）之后，</span><span
lang=EN-US style='color:red'>Reduce</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>方法之前</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的数据处理过程称之为</span><span lang=EN-US>Shuffle</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，又称作洗牌。</span><span lang=EN-US>Shuffle</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>过程与</span><span lang=EN-US>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是有重合部分的。如图</span><span lang=EN-US>4-14</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示。</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'><v:shape id="_x0000_i1059"
 type="#_x0000_t75" style='width:558pt;height:315pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image149.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1059"
  DrawAspect="Content" ObjectID="_1629748236">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;mso-bidi-font-family:Calibri'>图</span><span lang=EN-US
style='font-size:9.0pt;font-family:"Calibri","sans-serif"'>4-14<span
style='mso-spacerun:yes'>  </span>Shuffle</span><span style='font-size:9.0pt;
font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
mso-bidi-font-family:Calibri'>机制</span><span lang=EN-US style='font-size:9.0pt;
font-family:"Calibri","sans-serif"'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>这是整个</span><span lang=EN-US>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span><span lang=EN-US>Shuffle</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>过程</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_208"
 o:spid="_x0000_i1290" type="#_x0000_t75" style='width:566.4pt;height:163.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image150.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_209"
 o:spid="_x0000_i1289" type="#_x0000_t75" style='width:437.4pt;height:141pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image151.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>debug</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>一下</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_210"
 o:spid="_x0000_i1288" type="#_x0000_t75" style='width:405.6pt;height:305.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image152.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_211"
 o:spid="_x0000_i1287" type="#_x0000_t75" style='width:448.2pt;height:156.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image153.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_212"
 o:spid="_x0000_i1286" type="#_x0000_t75" style='width:428.4pt;height:152.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image154.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_213"
 o:spid="_x0000_i1285" type="#_x0000_t75" style='width:464.4pt;height:153pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image155.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_214"
 o:spid="_x0000_i1284" type="#_x0000_t75" style='width:374.4pt;height:319.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image156.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_215"
 o:spid="_x0000_i1283" type="#_x0000_t75" style='width:567pt;height:249pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image157.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_216"
 o:spid="_x0000_i1282" type="#_x0000_t75" style='width:566.4pt;height:253.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image158.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_217"
 o:spid="_x0000_i1281" type="#_x0000_t75" style='width:567pt;height:322.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image159.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_218"
 o:spid="_x0000_i1280" type="#_x0000_t75" style='width:567pt;height:261pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image160.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_219"
 o:spid="_x0000_i1279" type="#_x0000_t75" style='width:567pt;height:252.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image161.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_220"
 o:spid="_x0000_i1278" type="#_x0000_t75" style='width:567pt;height:335.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image162.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_221"
 o:spid="_x0000_i1277" type="#_x0000_t75" style='width:480pt;height:169.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image163.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_223"
 o:spid="_x0000_i1276" type="#_x0000_t75" style='width:567pt;height:271.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image164.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_225"
 o:spid="_x0000_i1275" type="#_x0000_t75" style='width:566.4pt;height:259.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image165.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_226"
 o:spid="_x0000_i1274" type="#_x0000_t75" style='width:532.8pt;height:160.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image166.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_227"
 o:spid="_x0000_i1273" type="#_x0000_t75" style='width:567pt;height:199.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image167.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_228"
 o:spid="_x0000_i1272" type="#_x0000_t75" style='width:567pt;height:177pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image168.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_230"
 o:spid="_x0000_i1271" type="#_x0000_t75" style='width:567pt;height:201.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image169.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_231"
 o:spid="_x0000_i1270" type="#_x0000_t75" style='width:567pt;height:205.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image170.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_232"
 o:spid="_x0000_i1269" type="#_x0000_t75" style='width:567pt;height:163.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image171.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_233"
 o:spid="_x0000_i1268" type="#_x0000_t75" style='width:567pt;height:267pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image172.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>3.3.2 Partition</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分区</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1060"
 type="#_x0000_t75" style='width:481.2pt;height:271.8pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image173.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1060"
  DrawAspect="Content" ObjectID="_1629748237">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分析</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_134" o:spid="_x0000_i1267" type="#_x0000_t75"
 style='width:453pt;height:117.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image174.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>Hash</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分区的源码</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_135" o:spid="_x0000_i1266" type="#_x0000_t75"
 style='width:451.8pt;height:181.2pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image175.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>拿</span><span
lang=EN-US>WordCount</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>程序</span><span
lang=EN-US>debug</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，设置</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的个数</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_137" o:spid="_x0000_i1265" type="#_x0000_t75"
 style='width:460.8pt;height:206.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image176.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>debug</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>开始</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_138" o:spid="_x0000_i1264" type="#_x0000_t75"
 style='width:445.8pt;height:234pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image177.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_139" o:spid="_x0000_i1263" type="#_x0000_t75"
 style='width:409.8pt;height:272.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image178.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_140" o:spid="_x0000_i1262" type="#_x0000_t75"
 style='width:419.4pt;height:167.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image179.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_141" o:spid="_x0000_i1261" type="#_x0000_t75"
 style='width:436.8pt;height:277.2pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image180.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_142" o:spid="_x0000_i1260" type="#_x0000_t75"
 style='width:444.6pt;height:182.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image181.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_144" o:spid="_x0000_i1259" type="#_x0000_t75"
 style='width:423.6pt;height:287.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image182.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>上面</span><span
lang=EN-US>debug</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>就是这一部分</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_149" o:spid="_x0000_i1258" type="#_x0000_t75"
 style='width:315pt;height:158.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image183.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_145" o:spid="_x0000_i1257" type="#_x0000_t75"
 style='width:447pt;height:281.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image184.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_146" o:spid="_x0000_i1256" type="#_x0000_t75"
 style='width:427.2pt;height:210pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image185.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_147" o:spid="_x0000_i1255" type="#_x0000_t75"
 style='width:428.4pt;height:241.2pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image186.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_148" o:spid="_x0000_i1254" type="#_x0000_t75"
 style='width:481.2pt;height:234.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image187.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>输出结果</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_150" o:spid="_x0000_i1253" type="#_x0000_t75"
 style='width:297.6pt;height:157.2pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image188.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1061"
 type="#_x0000_t75" style='width:486pt;height:273.6pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image189.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1061"
  DrawAspect="Content" ObjectID="_1629748238">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1062"
 type="#_x0000_t75" style='width:519pt;height:292.8pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image190.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1062"
  DrawAspect="Content" ObjectID="_1629748240">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>3.3.3 Partition</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分区案例实操</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>将统计结果按照手机归属地不同省份输出到不同文件中（分区）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）输入数据</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span><v:shape id="_x0000_i1063" type="#_x0000_t75"
 style='width:81.6pt;height:42pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image191.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1063"
  DrawAspect="Content" ObjectID="_1629748241">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_151" o:spid="_x0000_i1252" type="#_x0000_t75"
 style='width:375.6pt;height:250.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image192.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）期望输出数据</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>手机号</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>136</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>、</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>137</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>、</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>138</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>、</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>139</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>开头都分别放到一个独立的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>4</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>个文件中，其他开头的放到一个文件中。</span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1064" type="#_x0000_t75" style='width:517.2pt;height:289.8pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image193.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1064"
  DrawAspect="Content" ObjectID="_1629748242">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．在案例</span><span
lang=EN-US>2.3</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>的基础上，增加一个分区类</span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:21.0pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.flowsum;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.mapreduce.Partitioner;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>public class ProvincePartitioner extends
Partitioner&lt;Text, FlowBean&gt; {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>@Override<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>public
int getPartition(Text key, FlowBean value, int numPartitions) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>获取电话号码的前三位</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
preNum = key.toString().substring(0, 3);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>int
partition = 4;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>判断是哪个省</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>if
(&quot;136&quot;.equals(preNum)) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>partition
= 0;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}else
if (&quot;137&quot;.equals(preNum)) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>partition
= 1;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}else
if (&quot;138&quot;.equals(preNum)) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>partition
= 2;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}else
if (&quot;139&quot;.equals(preNum)) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>partition
= 3;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
partition;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>

</div>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．在驱动函数中增加自定义数据分区设置和</span><span
lang=EN-US>ReduceTask</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>设置</span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:21.0pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.flowsum;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>public class FlowsumDriver {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>public
static void main(String[] args) throws IllegalArgumentException, IOException,
ClassNotFoundException, InterruptedException {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>输入输出路径需要根据自己电脑上实际的输入输出路径设置</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>args
= new String[]{&quot;e:/output1&quot;,&quot;e:/output2&quot;};<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>获取配置信息，或者</span><span
lang=EN-US style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>对象实例</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
configuration = new Configuration();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job
job = Job.getInstance(configuration);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定本程序的</span><span
lang=EN-US style='font-size:10.5pt'>jar</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包所在的本地路径</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setJarByClass(FlowsumDriver.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定本业务</span><span
lang=EN-US style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>要使用的</span><span
lang=EN-US style='font-size:10.5pt'>mapper/Reducer</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>业务类</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(FlowCountMapper.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setReducerClass(FlowCountReducer.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定</span><span lang=EN-US
style='font-size:10.5pt'>mapper</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输出数据的</span><span
lang=EN-US style='font-size:10.5pt'>kv</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(FlowBean.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
5 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定最终输出的数据的</span><span
lang=EN-US style='font-size:10.5pt'>kv</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputValueClass(FlowBean.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
style='color:red'>// 8 </span></span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:red'>指定自定义数据分区</span><span lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>      </span>job.setPartitionerClass(ProvincePartitioner.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>      </span>//
9 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New";color:red'>同时指定相应数量的</span><span
lang=EN-US style='font-size:10.5pt;color:red'>reduce task<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>      </span>job.setNumReduceTasks(5);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
6 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定</span><span lang=EN-US
style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>的输入原始文件所在目录</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
new Path(args[0]));<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
new Path(args[1]));<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
7 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>将</span><span lang=EN-US
style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>中配置的相关参数，以及</span><span
lang=EN-US style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>所用的</span><span
lang=EN-US style='font-size:10.5pt'>java</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类所在的</span><span
lang=EN-US style='font-size:10.5pt'>jar</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包，</span><span
style='font-size:10.5pt'> </span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>提交给</span><span
lang=EN-US style='font-size:10.5pt'>yarn</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>去运行</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>boolean
result = job.waitForCompletion(true);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>System.exit(result
? 0 : 1);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>

</div>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_152"
 o:spid="_x0000_i1251" type="#_x0000_t75" style='width:393.6pt;height:249.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image194.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_153"
 o:spid="_x0000_i1250" type="#_x0000_t75" style='width:406.8pt;height:128.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image195.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_154"
 o:spid="_x0000_i1249" type="#_x0000_t75" style='width:401.4pt;height:127.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image196.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>指定</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，但分区是还是</span><span lang=EN-US>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_155"
 o:spid="_x0000_i1248" type="#_x0000_t75" style='width:477.6pt;height:196.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image197.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果一个文件，前面</span><span lang=EN-US>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>分区都是这一个</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>处理，所以结果就只有一个</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_156"
 o:spid="_x0000_i1247" type="#_x0000_t75" style='width:459.6pt;height:169.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image198.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_157"
 o:spid="_x0000_i1246" type="#_x0000_t75" style='width:341.4pt;height:324.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image199.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>再改</span><span lang=EN-US>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span><span lang=EN-US>task</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为</span><span
lang=EN-US>2</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_158"
 o:spid="_x0000_i1245" type="#_x0000_t75" style='width:441.6pt;height:184.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image200.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>有</span><span lang=EN-US>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个分区，但只有两个</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>端的</span><span lang=EN-US>Task</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>），不知道分区数据给哪个</span><span
lang=EN-US>Reduce</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，所以</span><span lang=EN-US>IO</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>异常。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_159"
 o:spid="_x0000_i1244" type="#_x0000_t75" style='width:566.4pt;height:127.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image201.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>再来，设置为</span><span lang=EN-US>6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_160"
 o:spid="_x0000_i1243" type="#_x0000_t75" style='width:339pt;height:157.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image202.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>说明有一个</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是闲着的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_161"
 o:spid="_x0000_i1242" type="#_x0000_t75" style='width:378pt;height:253.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image203.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>总结</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_162"
 o:spid="_x0000_i1241" type="#_x0000_t75" style='width:471pt;height:247.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image204.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>3.3.4 WritableComparable</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>排序</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1065"
 type="#_x0000_t75" style='width:416.4pt;height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image205.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1065"
  DrawAspect="Content" ObjectID="_1629748243">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1066"
 type="#_x0000_t75" style='width:415.2pt;height:232.8pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image206.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1066"
  DrawAspect="Content" ObjectID="_1629748244">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．排序的分类</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1067"
 type="#_x0000_t75" style='width:412.2pt;height:234pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image207.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1067"
  DrawAspect="Content" ObjectID="_1629748245">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．自定义排序</span><span
lang=EN-US>WritableComparable</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）原理分析</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>bean</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>对象做为</span><span lang=EN-US>key</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>传输，需要实现</span><span lang=EN-US style='color:red'>WritableComparable</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>接口重写</span><span lang=EN-US>compareTo</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>方法，就可以实现排序。</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>@Override<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
int compareTo(FlowBean o) {<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>int result;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span><o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>// </span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>按照总流量大小，倒序排列</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>if (sumFlow &gt; bean.getSumFlow()) {<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>result = -1;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>}else if (sumFlow &lt; bean.getSumFlow()) {<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>result = 1;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>}else {<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>result = 0;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>return result;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>3.3.5 WritableComparable</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>排序案例实操（全排序）</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>根据案例</span><span lang=EN-US>2.3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>产生的结果再次对总流量进行排序。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）输入数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:26.25pt;mso-char-indent-count:
2.5;line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>原始数据</span><span
lang=EN-US style='color:black'><span
style='mso-spacerun:yes'>                          </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='color:black'><v:shape id="_x0000_i1068" type="#_x0000_t75"
 style='width:81.6pt;height:42pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image208.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1068"
  DrawAspect="Content" ObjectID="_1629748246">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_163"
 o:spid="_x0000_i1240" type="#_x0000_t75" style='width:369.6pt;height:247.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image209.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>第一次处理后的数据</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='color:black'><v:shape id="_x0000_i1069" type="#_x0000_t75"
 style='width:69.6pt;height:42pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image210.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1069"
  DrawAspect="Content" ObjectID="_1629748247">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_164"
 o:spid="_x0000_i1239" type="#_x0000_t75" style='width:211.8pt;height:229.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image211.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='color:black'>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）期望输出数据</span><span lang=EN-US style='color:
black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='color:black'>13509468723<span style='mso-tab-count:1'> </span>7335<span
style='mso-tab-count:1'>       </span>110349<span style='mso-tab-count:1'>   </span></span><span
lang=EN-US style='color:red'>117684<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='color:black'>13736230513<span style='mso-tab-count:1'> </span>2481<span
style='mso-tab-count:1'>       </span>24681<span style='mso-tab-count:1'>     </span></span><span
lang=EN-US style='color:red'>27162<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='color:black'>13956435636<span style='mso-tab-count:1'> </span>132<span
style='mso-tab-count:1'>  </span><span style='mso-tab-count:1'>       </span>1512<span
style='mso-tab-count:1'>       </span></span><span lang=EN-US style='color:
red'>1644<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='color:black'>13846544121<span style='mso-tab-count:1'> </span>264<span
style='mso-tab-count:1'>  </span><span style='mso-tab-count:1'>       </span>0<span
style='mso-tab-count:1'>     </span><span style='mso-tab-count:1'>       </span></span><span
lang=EN-US style='color:red'>264<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>。。。</span><span style='color:black'> </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>。。。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'> </span><v:shape id="_x0000_i1070" type="#_x0000_t75"
 style='width:463.2pt;height:262.8pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image212.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1070"
  DrawAspect="Content" ObjectID="_1629748248">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．代码实现</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>FlowBean</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对象在在需求</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>基础上增加了比较功能</span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
border-top:none;mso-border-left-alt:none windowtext 0cm;mso-border-bottom-alt:
none windowtext 0cm;mso-border-right-alt:none windowtext 0cm;padding:0cm 4.0pt 1.0pt 4.0pt;
background:#E0E0E0;margin-left:31.5pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.sort;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import java.io.DataInput;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import java.io.DataOutput;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.io.WritableComparable;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>public class FlowBean implements
WritableComparable&lt;FlowBean&gt; {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
long upFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
long downFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
long sumFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>// </span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>反序列化时，需要反射调用空参构造函数，所以必须有</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
FlowBean() {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>super();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
FlowBean(long upFlow, long downFlow) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>super();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>this.upFlow
= upFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>this.downFlow
= downFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>this.sumFlow
= upFlow + downFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
void set(long upFlow, long downFlow) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>this.upFlow
= upFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>this.downFlow
= downFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>this.sumFlow
= upFlow + downFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-left-alt:
none windowtext 0cm;mso-border-bottom-alt:none windowtext 0cm;mso-border-right-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:0cm 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

</div>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:31.5pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
long getSumFlow() {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>return
sumFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
void setSumFlow(long sumFlow) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>this.sumFlow
= sumFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;tab-stops:21.0pt 42.0pt 193.05pt;
background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:leading;
border:none;mso-border-alt:none windowtext 0cm;padding:0cm;mso-padding-alt:
1.0pt 4.0pt 1.0pt 4.0pt'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>  </span>}<span style='mso-tab-count:1'>                      </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
long getUpFlow() {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>return
upFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
void setUpFlow(long upFlow) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>this.upFlow
= upFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
long getDownFlow() {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>return
downFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
void setDownFlow(long downFlow) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>this.downFlow
= downFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>/**<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
style='mso-spacerun:yes'> </span>* </span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>序列化方法</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
style='mso-spacerun:yes'> </span>* @param out<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
style='mso-spacerun:yes'> </span>* @throws IOException<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
style='mso-spacerun:yes'> </span>*/<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
void write(DataOutput out) throws IOException {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>out.writeLong(upFlow);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>out.writeLong(downFlow);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>out.writeLong(sumFlow);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>/**<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
style='mso-spacerun:yes'> </span>* </span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>反序列化方法</span><span
style='font-size:10.5pt'> </span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>注意反序列化的顺序和序列化的顺序完全一致</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
style='mso-spacerun:yes'> </span>* @param in<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
style='mso-spacerun:yes'> </span>* @throws IOException<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
style='mso-spacerun:yes'> </span>*/<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
void readFields(DataInput in) throws IOException {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>upFlow
= in.readLong();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>downFlow
= in.readLong();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>sumFlow
= in.readLong();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
String toString() {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>return
upFlow + &quot;\t&quot; + downFlow + &quot;\t&quot; + sumFlow;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:1'>  </span>public
int <b style='mso-bidi-font-weight:normal'>compareTo</b>(FlowBean o) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span>int
result;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span>//
</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:red'>按照总流量大小，倒序排列</span><span
lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span>if
(sumFlow &gt; bean.getSumFlow()) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:3'>        </span>result
= -1;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span>}else
if (sumFlow &lt; bean.getSumFlow()) {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:3'>        </span>result
= 1;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span>}else
{<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:3'>        </span>result
= 0;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span>return
result;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>Mapper</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>类</span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:31.5pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.sort;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>public class FlowCountSortMapper extends
Mapper&lt;LongWritable, Text, FlowBean, Text&gt;{<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>FlowBean
bean = new FlowBean();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>Text
v = new Text();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
void map(LongWritable key, Text value, Context context)<span style='mso-tab-count:
1'>   </span>throws IOException, InterruptedException {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>获取一行</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String
line = value.toString();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>截取</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String[]
fields = line.split(&quot;\t&quot;);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>封装对象</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String
phoneNbr = fields[0];<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>long
upFlow = Long.parseLong(fields[1]);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>long
downFlow = Long.parseLong(fields[2]);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>bean.set(upFlow,
downFlow);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>v.set(phoneNbr);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>输出</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><span
style='color:red'>context.write(bean, v);</span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>Reducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:31.5pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.sort;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>public class FlowCountSortReducer extends
Reducer&lt;FlowBean, Text, Text, FlowBean&gt;{<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
void reduce(FlowBean key, Iterable&lt;Text&gt; values, Context context)<span
style='mso-tab-count:1'> </span>throws IOException, InterruptedException {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>循环输出，避免总流量相同情况</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><span
style='color:red'>for (Text text : values) {<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span><span
style='mso-tab-count:1'>   </span>context.write(text, key);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>     </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>

</div>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>Driver</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>类</span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:31.5pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.sort;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>public class FlowCountSortDriver {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
static void main(String[] args) throws ClassNotFoundException, IOException,
InterruptedException {<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>输入输出路径需要根据自己电脑上实际的输入输出路径设置</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>args
= new String[]{&quot;e:/output1&quot;,&quot;e:/output2&quot;};<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>获取配置信息，或者</span><span
lang=EN-US style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>对象实例</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>Configuration
configuration = new Configuration();<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>Job
job = Job.getInstance(configuration);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定本程序的</span><span
lang=EN-US style='font-size:10.5pt'>jar</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包所在的本地路径</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setJarByClass(FlowCountSortDriver.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定本业务</span><span
lang=EN-US style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>要使用的</span><span
lang=EN-US style='font-size:10.5pt'>mapper/Reducer</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>业务类</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setMapperClass(FlowCountSortMapper.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setReducerClass(FlowCountSortReducer.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定</span><span lang=EN-US
style='font-size:10.5pt'>mapper</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输出数据的</span><span
lang=EN-US style='font-size:10.5pt'>kv</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setMapOutputKeyClass(FlowBean.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setMapOutputValueClass(Text.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
5 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定最终输出的数据的</span><span
lang=EN-US style='font-size:10.5pt'>kv</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setOutputValueClass(FlowBean.class);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
6 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>指定</span><span lang=EN-US
style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>的输入原始文件所在目录</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>FileInputFormat.setInputPaths(job,
new Path(args[0]));<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>FileOutputFormat.setOutputPath(job,
new Path(args[1]));<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
7 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>将</span><span lang=EN-US
style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>中配置的相关参数，以及</span><span
lang=EN-US style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>所用的</span><span
lang=EN-US style='font-size:10.5pt'>java</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类所在的</span><span
lang=EN-US style='font-size:10.5pt'>jar</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包，</span><span
style='font-size:10.5pt'> </span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>提交给</span><span
lang=EN-US style='font-size:10.5pt'>yarn</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>去运行</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>boolean
result = job.waitForCompletion(true);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>System.exit(result
? 0 : 1);<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:3.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>

</div>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>全排序就是一个</span><span lang=EN-US>ReduceTask</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_165"
 o:spid="_x0000_i1238" type="#_x0000_t75" style='width:282pt;height:250.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image213.png" o:title=""/>
</v:shape></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>3.3.6 WritableComparable</span><span style='font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>排序案例实操（区内排序）</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>要求每个省份手机号输出的文件中按照总流量内部排序。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>基于前一个需求，增加自定义分区类，分区按照省份手机号设置。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1071" type="#_x0000_t75" style='width:531.6pt;height:300.6pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image214.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1071"
  DrawAspect="Content" ObjectID="_1629748249">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操（接着上一个例子，增加分区、</span><span
lang=EN-US>ReduceTask</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>就是区内排序了）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><a
name="_Toc439079679"></a><a name="_Toc421731842"><span style='mso-bookmark:
_Toc439079679'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>（</span><span lang=EN-US>1</span></span></a><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）增加自定义分区类</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'>package
com.atguigu.mapreduce.sort;<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.io.Text;<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.mapreduce.Partitioner;<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'>public
class ProvincePartitioner extends Partitioner&lt;FlowBean, Text&gt; {<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>  </span>public int getPartition(FlowBean key, Text
value, int numPartitions) {<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span><o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>// 1 </span></span></span><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>获取手机号码前三位</span></span></span><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>String preNum =
value.toString().substring(0, 3);<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span><o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>int partition = 4;<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span><o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>// 2 </span></span></span><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>根据手机号归属地设置分区</span></span></span><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>if (&quot;136&quot;.equals(preNum)) {<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>        </span>partition = 0;<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>}else if (&quot;137&quot;.equals(preNum)) {<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>        </span>partition = 1;<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>}else if (&quot;138&quot;.equals(preNum)) {<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>        </span>partition = 2;<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>}else if (&quot;139&quot;.equals(preNum)) {<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>        </span>partition = 3;<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>}<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>     </span>return partition;<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span></span></span><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在驱动类中添加分区类</span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'>//
</span></span></span><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>加载自定义分区类</span></span></span><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'>job.setPartitionerClass(ProvincePartitioner.class);<o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'>//
</span></span></span><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>设置</span></span></span><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
lang=EN-US style='font-size:10.5pt'>Reducetask</span></span></span><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>个数</span></span></span><span
style='mso-bookmark:_Toc421731842'><span style='mso-bookmark:_Toc439079679'><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></p>

<p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:10.5pt'>job.setNumReduceTasks(5);<o:p></o:p></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_166" o:spid="_x0000_i1237" type="#_x0000_t75" style='width:407.4pt;
 height:86.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image215.png" o:title=""/>
</v:shape></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_167" o:spid="_x0000_i1236" type="#_x0000_t75" style='width:368.4pt;
 height:126.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image216.png" o:title=""/>
</v:shape></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_168" o:spid="_x0000_i1235" type="#_x0000_t75" style='width:316.8pt;
 height:128.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image217.png" o:title=""/>
</v:shape></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc421731842'><span
style='mso-bookmark:_Toc439079679'><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>3.3.7 Combiner</span></span></span><span style='mso-bookmark:
_Toc439079679'></span><span style='mso-bookmark:_Toc421731842'></span><span
style='font-size:14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>合并</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1072" type="#_x0000_t75" style='width:479.4pt;height:268.8pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image218.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1072"
  DrawAspect="Content" ObjectID="_1629748250">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>分析</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>像这种求平均值的就不适合先合并再</span><span lang=EN-US style='color:black'>Reduce<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_169" o:spid="_x0000_i1234" type="#_x0000_t75"
 style='width:255.6pt;height:44.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image219.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>（</span><span lang=EN-US style='color:red'>6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>）自定义</span><span lang=EN-US style='color:red'>Combiner</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>实现步骤</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>（</span><span lang=EN-US
style='color:black;mso-themecolor:text1'>a</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black;mso-themecolor:text1'>）自定义一个</span><span lang=EN-US
style='color:black;mso-themecolor:text1'>Combiner</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black;mso-themecolor:text1'>继承</span><span lang=EN-US style='color:black;
mso-themecolor:text1'>Reducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-themecolor:text1'>，重写</span><span lang=EN-US style='color:black;mso-themecolor:
text1'>Reduce</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;mso-themecolor:text1'>方法</span><span
lang=EN-US style='color:black;mso-themecolor:text1'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=901
 style='width:540.35pt;margin-left:33.75pt;border-collapse:collapse;border:
 none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=901 valign=top style='width:540.35pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US style='font-size:10.5pt'>public class
  WordcountCombiner extends <span style='color:red'>Reducer</span>&lt;Text,
  IntWritable, Text,IntWritable&gt;{<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
  1'>   </span>@Override<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
  1'>   </span>protected void reduce(Text key, Iterable&lt;IntWritable&gt;
  values,Context context) throws IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span>// 1 </span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>汇总操作</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
  2'>      </span>int count = 0;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
  2'>      </span>for(IntWritable v :values){<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
  3'>          </span>count += v.get();<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
  2'>      </span>}<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>        </span>// 2 </span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>写出</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
  2'>      </span>context.write(key, new IntWritable(count));<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
  1'>   </span>}<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:red'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;mso-themecolor:text1'>（</span><span lang=EN-US
style='color:black;mso-themecolor:text1'>b</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black;mso-themecolor:text1'>）在</span><span lang=EN-US style='color:black;
mso-themecolor:text1'>Job</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
mso-themecolor:text1'>驱动类中设置：</span><span lang=EN-US style='color:black;
mso-themecolor:text1'><span style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:37.95pt;background:#E6E0EC;border-collapse:collapse;
 border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=621 valign=top style='width:372.75pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span lang=EN-US style='font-size:10.5pt'>job.setCombinerClass(WordcountCombiner.class);<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>3.3.8 Combiner</span><span
style='font-size:14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>合并案例实操</span><span lang=EN-US
style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><a name="_Toc439079678"><span
lang=EN-US>1</span></a><span style='mso-bookmark:_Toc439079678'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>统计过程中对每一个</span><span
lang=EN-US>MapTask</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的输出进行局部汇总，以减小网络传输量即采用</span><span lang=EN-US>Combiner</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>功能。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）数据输入</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1073" type="#_x0000_t75" style='width:44.4pt;height:42.6pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image220.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1073"
  DrawAspect="Content" ObjectID="_1629748251">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_170" o:spid="_x0000_i1233" type="#_x0000_t75" style='width:176.4pt;
 height:97.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image221.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='color:black'>2</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）期望输出数据</span><span lang=EN-US style='color:
black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>期望：</span><span
lang=EN-US style='color:black'>Combine</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>输入数据多，输出时经过合并，输出数据降低。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079678'><span lang=EN-US>2</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US><v:shape id="_x0000_i1074" type="#_x0000_t75" style='width:518.4pt;
 height:292.8pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image222.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1074"
  DrawAspect="Content" ObjectID="_1629748252">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--></span></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-size:9.0pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
mso-bidi-font-family:Calibri'>图</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'>4-15
<span style='mso-spacerun:yes'> </span>Combiner</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:9.0pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
mso-bidi-font-family:Calibri'>的合并案例</span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079678'><span lang=EN-US>3</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span><span
lang=EN-US>-</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>方案一</span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US>1</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）增加一个</span><span lang=EN-US>WordcountCombiner</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类继承</span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='color:red'>Reducer</span></b></span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:21.0pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>package
com.atguigu.mr.combiner;<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
java.io.IOException;<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.io.IntWritable;<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
color:red'>// </span><span lang=EN-US style='color:red'>Combiner</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New";color:red'>是继承</span><span
lang=EN-US style='color:red'>Reducer</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:red'>的，其实就是一个</span><span lang=EN-US
style='color:red'>Reducer</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:red'>，只是在</span><span lang=EN-US style='color:red'>Map</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New";color:red'>端执行</span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
color:red'><o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>public
class WordcountCombiner extends <span style='color:red'>Reducer</span>&lt;Text,
IntWritable, Text, IntWritable&gt;{<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;text-indent:21.0pt;
background:#E0E0E0;mso-layout-grid-align:none;punctuation-trim:leading;
border:none;mso-border-alt:none windowtext 0cm;padding:0cm;mso-padding-alt:
1.0pt 4.0pt 1.0pt 4.0pt'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt'>IntWritable v = new IntWritable();<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>@Override <span style='color:red'>// </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:red'>这聚合是在</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt;color:red'>Map</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:red'>端提前合并的</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>protected void reduce(Text key,
Iterable&lt;IntWritable&gt; values, Context context) throws IOException,
InterruptedException {<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-spacerun:yes'>        </span>// 1 </span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>汇总</span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>int sum = 0;<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span><span style='mso-tab-count:1'>   </span>for(IntWritable
value :values){<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:3'>          </span>sum += value.get();<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>}<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>v.set(sum);<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>// 2 </span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New"'>写出</span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:2'>      </span>context.write(key, v);<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-tab-count:1'>   </span>}<o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></p>

</div>

<p class=MsoNormal style='line-height:150%;mso-layout-grid-align:none;
punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US>2</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US>WordcountDriver</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>驱动类中指定</span><span
lang=EN-US>Combiner</span></span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:21.0pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>//
</span></span><span style='mso-bookmark:_Toc439079678'><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>指定需要使用</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt'>combiner</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>，以及用哪个类作为</span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>combiner</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>的逻辑</span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>job.setCombinerClass(WordcountCombiner.class);<o:p></o:p></span></span></p>

</div>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>结果跟</span><span lang=EN-US>Reducer</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>输出是一样的</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="图片_x0020_172" o:spid="_x0000_i1232"
 type="#_x0000_t75" style='width:234.6pt;height:148.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image223.png" o:title=""/>
</v:shape></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="图片_x0020_173" o:spid="_x0000_i1231"
 type="#_x0000_t75" style='width:387pt;height:234pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image224.png" o:title=""/>
</v:shape></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="图片_x0020_171" o:spid="_x0000_i1230"
 type="#_x0000_t75" style='width:324.6pt;height:159pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image225.png" o:title=""/>
</v:shape></span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079678'><span lang=EN-US>4</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span><span
lang=EN-US>-</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>方案二</span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US>1</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）将</span><span lang=EN-US>WordcountReducer</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>作为</span><span
lang=EN-US>Combiner</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（<span style='color:red'>因为</span></span><span lang=EN-US
style='color:red'>Combiner</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>是继承</span><span lang=EN-US style='color:red'>Reducer</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:red'>的，所以可以与</span><span
lang=EN-US style='color:red'>Reducer</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:red'>公用一个</span><span lang=EN-US
style='color:red'>Reducer</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:red'>，只要逻辑一样</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）在</span><span lang=EN-US>WordcountDriver</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>驱动类中指定</span></span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:21.0pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><a name="_Hlk510261908"><span lang=EN-US
style='font-size:10.5pt'>// </span></a></span><span style='mso-bookmark:_Toc439079678'><span
style='mso-bookmark:_Hlk510261908'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>指定需要使用</span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='mso-bookmark:_Hlk510261908'><span
lang=EN-US style='font-size:10.5pt'>Combiner</span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='mso-bookmark:_Hlk510261908'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>，以及用哪个类作为</span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='mso-bookmark:_Hlk510261908'><span
lang=EN-US style='font-size:10.5pt'>Combiner</span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='mso-bookmark:_Hlk510261908'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>的逻辑</span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='mso-bookmark:_Hlk510261908'><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.0gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
style='mso-bookmark:_Toc439079678'><span style='mso-bookmark:_Hlk510261908'><span
lang=EN-US style='font-size:10.5pt'>job.setCombinerClass(WordcountReducer.class);</span></span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>
// </span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New"'>就不用重写</span></span><span style='mso-bookmark:
_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>Combiner</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>了</span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>

</div>

<p class=MsoNormal style='text-indent:15.75pt;mso-char-indent-count:1.5;
line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>运行程序，如图</span><span lang=EN-US>4-16</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，</span><span
lang=EN-US>4-17</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_7" o:spid="_x0000_i1229" type="#_x0000_t75" style='width:204pt;
 height:105.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image226.png" o:title=""
  cropright="5316f"/>
</v:shape></span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc439079678'><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>图</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'>4-16 </span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>未使用前</span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='mso-no-proof:yes'><v:shape
 id="图片_x0020_8" o:spid="_x0000_i1228" type="#_x0000_t75" style='width:191.4pt;
 height:102.6pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image227.png" o:title=""
  cropright="8029f"/>
</v:shape></span></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='mso-bookmark:_Toc439079678'><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>图</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'>4-17 </span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>使用后</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>结果是一样的</span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:14.0pt'>3.3.9
GroupingComparator</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-size:14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分组（辅助排序）</span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></span></h3>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>这组在</span><span lang=EN-US>MR</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>工作流程的位置</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="图片_x0020_175" o:spid="_x0000_i1227"
 type="#_x0000_t75" style='width:460.8pt;height:191.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image228.png" o:title=""/>
</v:shape></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对</span><span
lang=EN-US>Reduce</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>阶段的数据根据某一个或几个字段进行分组。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分组排序步骤：</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）自定义类继承</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>WritableComparator<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）重写</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>compare()</span></span><span
style='mso-bookmark:_Toc439079678'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>方法</span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt'>@Override<o:p></o:p></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt'>public int compare(WritableComparable a,
WritableComparable b) {<o:p></o:p></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
</span></span><span style='mso-bookmark:_Toc439079678'><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>比较的业务逻辑</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
result;<o:p></o:p></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）创建一个构造将比较对象的类传给父类，比较的是一个类，父类不知道是哪个就做比较会报错</span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt;color:black;mso-themecolor:text1'>protected
OrderGroupingComparator() {<o:p></o:p></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt;color:black;mso-themecolor:text1'><span
style='mso-tab-count:2'>      </span>super(OrderBean.class, true);<o:p></o:p></span></span></p>

<p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:10.5pt;color:black;mso-themecolor:text1'>}<o:p></o:p></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:14.0pt'>3.3.10
GroupingComparator</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-size:14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分组案例实操</span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079678'><span lang=EN-US>1</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>有如下订单数据</span></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>表</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;
font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>4-2 </span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>订单数据</span></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=685
 style='width:411.1pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=228 valign=top style='width:136.6pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>订单</span></span><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>id<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=237 valign=top style='width:142.05pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>商品</span></span><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>id<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=221 valign=top style='width:132.45pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>成交金额</span></span><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=228 rowspan=2 valign=top style='width:136.6pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>0000001<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>Pdt_01<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt;color:red'>222.8</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>Pdt_02<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>33.8<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
 <tr style='mso-yfti-irow:3;height:14.55pt'>
  <td width=228 rowspan=3 valign=top style='width:136.6pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.55pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>0000002<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;height:14.55pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>Pdt_03<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt;height:14.55pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>522.8<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>Pdt_04<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>122.4<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>Pdt_05<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt;color:red'>722.4</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=228 rowspan=2 valign=top style='width:136.6pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>0000003<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>Pdt_06<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt;color:red'>232.8</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=237 valign=top style='width:142.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>Pdt_02<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
  <td width=221 valign=top style='width:132.45pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt'>33.8<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>现在需要求出每一个订单中最贵的商品。</span></span></p>

<p class=MsoNormal style='text-indent:15.75pt;mso-char-indent-count:1.5;
line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）输入数据</span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US><v:shape id="_x0000_i1075" type="#_x0000_t75" style='width:129.6pt;
 height:39.6pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image229.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1075"
  DrawAspect="Content" ObjectID="_1629748253">
 </o:OLEObject>
</xml><![endif]--></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_176" o:spid="_x0000_i1226"
 type="#_x0000_t75" style='width:205.2pt;height:126pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image230.png" o:title=""/>
</v:shape></span></span></p>

<p class=MsoNormal style='text-indent:15.75pt;mso-char-indent-count:1.5;
line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）期望输出数据</span></span></p>

<p class=MsoNormal style='text-indent:15.75pt;mso-char-indent-count:1.5'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US>1<span style='mso-tab-count:
1'>       </span>222.8</span></span></p>

<p class=MsoNormal style='text-indent:15.75pt;mso-char-indent-count:1.5'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US>2<span style='mso-tab-count:
1'>       </span>722.4</span></span></p>

<p class=MsoNormal style='text-indent:15.75pt;mso-char-indent-count:1.5'><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US>3<span style='mso-tab-count:
1'>       </span>232.8</span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079678'><span lang=EN-US>2</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）利用“订单</span><span lang=EN-US>id</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>和成交金额”作为</span><span
lang=EN-US>key</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，可以将</span><span lang=EN-US>Map</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>阶段读取到的所有订单数据按照</span><span
lang=EN-US>id</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>升序排序，如果</span><span lang=EN-US>id</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>相同再按照金额降序排序，发送到</span><span
lang=EN-US>Reduce</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US>Reduce</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>端利用</span><span
lang=EN-US>groupingComparator</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>将订单</span><span lang=EN-US>id</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>相同的</span><span
lang=EN-US>kv</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>聚合成组，然后取第一个即是该订单中最贵商品，如图</span><span lang=EN-US>4-18</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>所示。</span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US><v:shape id="_x0000_i1076" type="#_x0000_t75" style='width:557.4pt;
 height:314.4pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image231.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1076"
  DrawAspect="Content" ObjectID="_1629748254">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--></span></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US>4-18 </span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>过程分析</span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079678'><span lang=EN-US>3</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．代码实现</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）定义订单信息</span><span lang=EN-US>OrderBean</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.order;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.DataInput;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.DataOutput;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.WritableComparable;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>public class OrderBean implements
  WritableComparable&lt;OrderBean&gt; {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  int order_id; // </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>订单</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-size:10.5pt'>id</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>号</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  double price; // </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>价格</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  OrderBean() {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>super();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  OrderBean(int order_id, double price) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>super();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.order_id
  = order_id;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.price
  = price;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void <span style='color:red'>write</span>(DataOutput out) throws IOException
  {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>out.writeInt(order_id);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>out.writeDouble(price);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void <span style='color:red'>readFields</span>(DataInput in) throws
  IOException {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>order_id
  = in.readInt();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>price
  = in.readDouble();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String toString() {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  order_id + &quot;\t&quot; + price;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  int getOrder_id() {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  order_id;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setOrder_id(int order_id) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.order_id
  = order_id;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  double getPrice() {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  price;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setPrice(double price) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.price
  = price;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>// </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>二次排序</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>public int compareTo(OrderBean o) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>int result;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>if (order_id &gt; o.getOrder_id()) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  3'>         </span>result = 1;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>} else if (order_id &lt; o.getOrder_id()) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  3'>         </span>result = -1;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>} else {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  3'>         </span>// </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>价格倒序排序</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  3'>         </span>result = price &gt; o.getPrice() ? -1 : 1;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>return result;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）编写</span><span lang=EN-US>OrderSortMapper</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=948
 style='width:568.7pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=948 valign=top style='width:568.7pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.order;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>public class OrderMapper extends
  Mapper&lt;LongWritable, Text, OrderBean, NullWritable&gt; {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>OrderBean
  k = new OrderBean();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void map(LongWritable key, Text value, Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取一行</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
  line = value.toString();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>截取</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String[]
  fields = line.split(&quot;\t&quot;);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>封装对象</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>k.setOrder_id(Integer.parseInt(fields[0]));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>k.setPrice(Double.parseDouble(fields[2]));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  4 </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>写出</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>context.write(k,
  NullWritable.get());<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:
  _Toc439079678'><b><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></b></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）编写</span><span lang=EN-US>OrderSortGroupingComparator</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.order;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.WritableComparable;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.WritableComparator;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>public class OrderGroupingComparator
  extends WritableComparator {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span
  style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  </span>// </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>创建一个构造将比较对象的类传给父类，比较的是一个类，父类不知道是哪个就做比较会报错</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>protected OrderGroupingComparator() {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>super(OrderBean.class, <b style='mso-bidi-font-weight:normal'>true</b>);
  // </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>为什么是</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
  color:red'>true</span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>，后面讲</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
  style='color:red'>@Override<o:p></o:p></span></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>public int compare(WritableComparable a, WritableComparable b) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>OrderBean aBean = (OrderBean) a;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>OrderBean bBean = (OrderBean) b;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span
  style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>     
  </span>// </span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>只要</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
  color:red'>id</span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>相同，就是认为是相同的</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
  color:red'>key<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>int result;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>if (aBean.getOrder_id() &gt; bBean.getOrder_id()) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  3'>         </span>result = 1;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:2.5gd;text-indent:
  -5.25pt;mso-char-indent-count:-.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>  </span><span
  style='mso-spacerun:yes'>    </span>} else if (aBean.getOrder_id() &lt;
  bBean.getOrder_id()) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  3'>         </span>result = -1;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>} else {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  3'>         </span>result = 0;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>return result;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>4</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）编写</span><span lang=EN-US>OrderSortReducer</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0;margin-left:26.25pt;margin-right:0cm'>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.order;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.NullWritable;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>public
  class OrderReducer extends Reducer&lt;OrderBean, NullWritable, OrderBean,
  NullWritable&gt; {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void reduce(OrderBean key, Iterable&lt;NullWritable&gt;
  values, Context context)<span style='mso-tab-count:2'>    </span>throws
  IOException, InterruptedException {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><span style='color:red'>// </span></span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>如果没有</span></span><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'>OrderSortGroupingComparator</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>想只输出第一个，结果还是会多个的。</span></span><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>      </span>// </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>如果有，则两个对象一样就会传递到同一个</span></span><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'>reduce</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>，然后这里没有循环打印，只输出第一个结果即可</span></span><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>context.write(key, NullWritable.get());<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></p>
  </div>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>没有</span></span><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='mso-bidi-font-size:10.5pt;color:red'>OrderSortGroupingComparator</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>的时候的结果</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_177" o:spid="_x0000_i1225"
   type="#_x0000_t75" style='width:551.4pt;height:130.8pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image232.png" o:title=""/>
  </v:shape></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>5</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）编写</span><span lang=EN-US>OrderSortDriver</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <div style='mso-element:para-border-div;border:none windowtext 1.0pt;
  mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#E0E0E0;margin-left:26.25pt;margin-right:0cm'>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.order;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.Path;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.NullWritable;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>public
  class OrderDriver {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public static void main(String[] args)
  throws Exception, IOException {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5;background:#E0E0E0;mso-layout-grid-align:
  none;punctuation-trim:leading;border:none;mso-border-alt:none windowtext 0cm;
  padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span style='mso-bookmark:
  _Toc439079678'><span lang=EN-US style='font-size:10.5pt'>// </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输入输出路径需要根据自己电脑上实际的输入输出路径设置</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>args<span style='mso-spacerun:yes'> 
  </span>= new String[]{&quot;e:/input/inputorder&quot; , &quot;e:/output1&quot;};<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>获取配置信息</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Configuration conf = new
  Configuration();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Job job = Job.getInstance(conf);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2 </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>设置</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>jar</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包加载路径</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setJarByClass(OrderDriver.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 3 </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>加载</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>map/reduce</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapperClass(OrderMapper.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setReducerClass(OrderReducer.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 4 </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>设置</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>map</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输出数据</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>key</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>和</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>value</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(OrderBean.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(NullWritable.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 5 </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>设置最终输出数据的</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>key</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>和</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>value</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputKeyClass(OrderBean.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputValueClass(NullWritable.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 6 </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>设置输入数据和输出数据路径</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job, new
  Path(args[0]));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job, new
  Path(args[1]));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><span style='color:red'><span
  style='mso-tab-count:1'>   </span>// 8 </span></span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>设置</span></span><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'>reduce</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>端的分组</span></span><span style='mso-bookmark:_Toc439079678'><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><span style='color:red'>job.setGroupingComparatorClass(OrderGroupingComparator.class);<o:p></o:p></span></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 7 </span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>提交</span></span><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>boolean result =
  job.waitForCompletion(true);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>System.exit(result ? 0 : 1);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
  mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
  none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
  style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></span></p>
  </div>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>为什么要为</span><span lang=EN-US>true</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>。</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_178" o:spid="_x0000_i1224"
   type="#_x0000_t75" style='width:550.8pt;height:181.2pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image233.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US>false</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>的话，</span><span
  lang=EN-US>key=null</span></span><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>，就会报空指针</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_179" o:spid="_x0000_i1223"
   type="#_x0000_t75" style='width:550.8pt;height:265.2pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image234.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>为</span><span lang=EN-US>false</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_181" o:spid="_x0000_i1222"
   type="#_x0000_t75" style='width:550.8pt;height:124.8pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image235.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>执行程序，输出的结果</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_180" o:spid="_x0000_i1221"
   type="#_x0000_t75" style='width:213pt;height:102pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image236.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US>debug</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>一下</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_182" o:spid="_x0000_i1220"
   type="#_x0000_t75" style='width:344.4pt;height:251.4pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image237.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_183" o:spid="_x0000_i1219"
   type="#_x0000_t75" style='width:367.2pt;height:147.6pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image238.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>原始数据，可以看到</span><span lang=EN-US>00000001</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>的都包含了</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_184" o:spid="_x0000_i1218"
   type="#_x0000_t75" style='width:184.2pt;height:148.2pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image239.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_185" o:spid="_x0000_i1217"
   type="#_x0000_t75" style='width:375pt;height:260.4pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image240.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_186" o:spid="_x0000_i1216"
   type="#_x0000_t75" style='width:466.8pt;height:177.6pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image241.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_187" o:spid="_x0000_i1215"
   type="#_x0000_t75" style='width:328.8pt;height:255pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image242.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_188" o:spid="_x0000_i1214"
   type="#_x0000_t75" style='width:387pt;height:220.8pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image243.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>跟下一个比较</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_189" o:spid="_x0000_i1213"
   type="#_x0000_t75" style='width:387.6pt;height:298.2pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image244.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_190" o:spid="_x0000_i1212"
   type="#_x0000_t75" style='width:384.6pt;height:192pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image245.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_191" o:spid="_x0000_i1211"
   type="#_x0000_t75" style='width:387pt;height:232.8pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image246.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US>false</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>表示不是同一个</span><span
  lang=EN-US>key</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_192" o:spid="_x0000_i1210"
   type="#_x0000_t75" style='width:444.6pt;height:241.2pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image247.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_193" o:spid="_x0000_i1209"
   type="#_x0000_t75" style='width:402pt;height:244.8pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image248.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>退出循环</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_194" o:spid="_x0000_i1208"
   type="#_x0000_t75" style='width:400.8pt;height:230.4pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image249.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>后面就是走</span><span lang=EN-US>reduce</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>了</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_195" o:spid="_x0000_i1207"
   type="#_x0000_t75" style='width:462pt;height:229.8pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image250.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>下一个</span><span lang=EN-US>MapTask</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_196" o:spid="_x0000_i1206"
   type="#_x0000_t75" style='width:366.6pt;height:282.6pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image251.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_197" o:spid="_x0000_i1205"
   type="#_x0000_t75" style='width:355.8pt;height:280.2pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image252.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_200" o:spid="_x0000_i1204"
   type="#_x0000_t75" style='width:406.8pt;height:234.6pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image253.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>再循环到这里</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_198" o:spid="_x0000_i1203"
   type="#_x0000_t75" style='width:426.6pt;height:232.8pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image254.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_199" o:spid="_x0000_i1202"
   type="#_x0000_t75" style='width:372pt;height:212.4pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image255.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_201" o:spid="_x0000_i1201"
   type="#_x0000_t75" style='width:406.8pt;height:230.4pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image256.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_202" o:spid="_x0000_i1200"
   type="#_x0000_t75" style='width:551.4pt;height:203.4pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image257.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>上面的操作就是把原来</span><span lang=EN-US>key</span></span><span
  style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>不同的伪装成相同的</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_203" o:spid="_x0000_i1199"
   type="#_x0000_t75" style='width:391.2pt;height:190.8pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image258.png" o:title=""/>
  </v:shape></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <span style='mso-bookmark:_Toc439079678'></span>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079678'></span>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.4
MapTask</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>工作机制</span></span><span
style='mso-bookmark:_Toc439079678'><span lang=EN-US style='font-size:14.0pt;
line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></span></h2>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US>MapTask</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>工作机制如图</span><span lang=EN-US>4-12</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>所示。</span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><v:shape id="_x0000_i1077" type="#_x0000_t75"
 style='width:563.4pt;height:318pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image259.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1077"
  DrawAspect="Content" ObjectID="_1629748256">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='mso-bookmark:_Toc439079678'><span style='font-size:9.0pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
mso-bidi-font-family:Calibri'>图</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'>4-12
<span style='mso-spacerun:yes'> </span>MapTask</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-size:9.0pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
mso-bidi-font-family:Calibri'>工作机制</span></span><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:9.0pt;line-height:150%;font-family:"Calibri","sans-serif"'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="图片_x0020_204" o:spid="_x0000_i1198"
 type="#_x0000_t75" style='width:566.4pt;height:320.4pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image260.png" o:title=""/>
</v:shape></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079678'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='color:black'>1</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>Read</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>阶段：</span><span
lang=EN-US style='color:black'>MapTask</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>通过用户编写的</span><span
lang=EN-US style='color:black'>RecordReader</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>，从输入</span><span
lang=EN-US style='color:black'>InputSplit</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>中解析出一个个</span><span
lang=EN-US style='color:black'>key/value</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='color:black'>2</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>Map</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>阶段：该节点主要是将解析出的</span><span
lang=EN-US style='color:black'>key/value</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>交给用户编写</span><span
lang=EN-US style='color:black'>map()</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>函数处理，并产生一系列新的</span><span
lang=EN-US style='color:black'>key/value</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='color:black'>3</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>Collect</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>收集阶段：在用户编写</span><span
lang=EN-US style='color:black'>map()</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>函数中，当数据处理完成后，一般会调用</span><span
lang=EN-US style='color:black'>OutputCollector.collect()</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>输出结果。在该函数内部，它会将生成的</span><span
lang=EN-US style='color:black'>key/value</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>分区（调用</span><span
lang=EN-US style='color:black'>Partitioner</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>），并写入一个环形内存缓冲区中。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='color:black'>4</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>Spill</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>阶段：即</span><span
lang=EN-US style='color:black'>“</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>溢写</span><span lang=EN-US style='color:black'>”</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>，当环形缓冲区满后，</span><span
lang=EN-US style='color:black'>MapReduce</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>会将数据写到本地磁盘上，生成一个临时文件。需要注意的是，将数据写入本地磁盘之前，先要对数据进行一次本地排序，并在必要时对数据进行合并、压缩等操作。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>溢写阶段详情：</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>步骤</span><span
lang=EN-US style='color:black'>1</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>：利用快速排序算法对缓存区内的数据进行排序，排序方式是，先按照分区编号</span><span
lang=EN-US style='color:black'>Partition</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>进行排序，然后按照</span><span
lang=EN-US style='color:black'>key</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>进行排序。这样，经过排序后，数据以分区为单位聚集在一起，且同一分区内所有数据按照</span><span
lang=EN-US style='color:black'>key</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>有序。</span><span lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>步骤</span><span
lang=EN-US style='color:black'>2</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>：按照分区编号由小到大依次将每个分区中的数据写入任务工作目录下的临时文件</span><span
lang=EN-US style='color:black'>output/spillN.out</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='color:black'>N</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>表示当前溢写次数）中。如果用户设置了</span><span lang=EN-US
style='color:black'>Combiner</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>，则写入文件之前，对每个分区中的数据进行一次聚集操作。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>步骤</span><span
lang=EN-US style='color:black'>3</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>：将分区数据的元信息写到内存索引数据结构</span><span lang=EN-US
style='color:black'>SpillRecord</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>中，其中每个分区的元信息包括在临时文件中的偏移量、压缩前数据大小和压缩后数据大小。如果当前内存索引大小超过</span><span
lang=EN-US style='color:black'>1MB</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>，则将内存索引写到文件</span><span lang=EN-US
style='color:black'>output/spillN.out.index</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>中。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='color:black'>5</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>Combine</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>阶段：当所有数据处理完成后，</span><span
lang=EN-US style='color:black'>MapTask</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>对所有临时文件进行一次合并，以确保最终只会生成一个数据文件。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>当所有数据处理完后，</span><span
lang=EN-US style='color:black'>MapTask</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>会将所有临时文件合并成一个大文件，并保存到文件</span><span
lang=EN-US style='color:black'>output/file.out</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>中，同时生成相应的索引文件</span><span
lang=EN-US style='color:black'>output/file.out.index</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>在进行文件合并过程中，</span><span
lang=EN-US style='color:black'>MapTask</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>以分区为单位进行合并。对于某个分区，它将采用多轮递归合并的方式。每轮合并</span><span
lang=EN-US style='color:black'>io.sort.factor</span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（默认</span><span
lang=EN-US style='color:black'>10</span></span><span style='mso-bookmark:_Toc439079678'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）个文件，并将产生的文件重新加入待合并列表中，对文件排序后，重复以上过程，直到最终得到一个大文件。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span></span><span
style='mso-bookmark:_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>让每个</span><span
lang=EN-US style='color:black'>MapTask</span></span><span style='mso-bookmark:
_Toc439079678'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>最终只生成一个数据文件，可避免同时打开大量文件和同时读取大量小文件产生的随机读取带来的开销。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079678'><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.5
ReduceTask</span></span><span style='mso-bookmark:_Toc439079678'></span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>工作机制</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>ReduceTask</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>工作机制</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>工作机制，如图</span><span lang=EN-US>4-19</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1078"
 type="#_x0000_t75" style='width:567pt;height:320.4pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image261.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1078"
  DrawAspect="Content" ObjectID="_1629748257">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-19 ReduceTask</span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>工作机制</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_205"
 o:spid="_x0000_i1197" type="#_x0000_t75" style='width:343.2pt;height:144.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image262.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_206"
 o:spid="_x0000_i1196" type="#_x0000_t75" style='width:236.4pt;height:158.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image263.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span><span lang=EN-US>Copy</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>阶段：</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>从各个</span><span lang=EN-US>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上远程拷贝一片数据，并针对某一片数据，如果其大小超过一定阈值，则写到磁盘上，否则直接放到内存中。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span><span lang=EN-US>Merge</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>阶段：在远程拷贝数据的同时，</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>启动了两个后台线程对内存和磁盘上的文件进行合并，以防止内存使用过多或磁盘上文件过多。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span><span lang=EN-US>Sort</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>阶段：按照</span><span lang=EN-US>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>语义，用户编写</span><span lang=EN-US>reduce()</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数输入数据是按</span><span lang=EN-US>key</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>进行聚集的一组数据。为了将</span><span lang=EN-US>key</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>相同的数据聚在一起，</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>采用了基于排序的策略。由于各个</span><span lang=EN-US>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>已经实现对自己的处理结果进行了局部排序，因此，</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>只需对所有数据进行一次归并排序即可。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>4</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>阶段：</span><span lang=EN-US>reduce()</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>函数将计算结果写到</span><span lang=EN-US>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上。</span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．设置</span><span
lang=EN-US>ReduceTask</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>并行度（个数）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>ReduceTask</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>的并行度同样影响整个</span><span lang=EN-US style='color:black'>Job</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>的执行并发度和执行效率，但与</span><span lang=EN-US
style='color:black'>MapTask</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>的并发数由切片数决定不同，</span><span
lang=EN-US style='color:black'>ReduceTask</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>数量的决定是可以直接手动设置：</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<div style='mso-element:para-border-div;border:none windowtext 1.0pt;
mso-border-alt:none windowtext 0cm;padding:1.0pt 4.0pt 1.0pt 4.0pt;background:
#E0E0E0;margin-left:26.25pt;margin-right:0cm'>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>// </span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>默认值是</span><span
lang=EN-US style='font-size:10.5pt'>1</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>，手动设置为</span><span
lang=EN-US style='font-size:10.5pt'>4<o:p></o:p></span></p>

<p class=a style='margin-left:0cm;mso-para-margin-left:2.5gd;background:#E0E0E0;
mso-layout-grid-align:none;punctuation-trim:leading;border:none;mso-border-alt:
none windowtext 0cm;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=EN-US style='font-size:10.5pt'>job.setNumReduceTasks(4);<o:p></o:p></span></p>

</div>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．实验：测试</span><span
lang=EN-US>ReduceTask</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>多少合适</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）实验环境：</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>个</span><span lang=EN-US>Master</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>节点，</span><span lang=EN-US>16</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>个</span><span
lang=EN-US>Slave</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>节点：</span><span lang=EN-US>CPU:8GHZ</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，内存</span><span lang=EN-US>:&nbsp;2G</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）实验结论：（这是</span><span
lang=EN-US>IBM</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>测的，不考虑分区，即分区与</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>一样的情况下，性能呈正态分布）</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>4-3 </span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>改变</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>ReduceTask </span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>（数据量为</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'>1GB</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>）</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=685 colspan=11 valign=top style='width:411.1pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>MapTask =16<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=118 valign=top style='width:70.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>ReduceTask<o:p></o:p></span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>1<o:p></o:p></span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>5<o:p></o:p></span></p>
  </td>
  <td width=59 valign=top style='width:35.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>10<o:p></o:p></span></p>
  </td>
  <td width=59 valign=top style='width:35.4pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>15<o:p></o:p></span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>16<o:p></o:p></span></p>
  </td>
  <td width=59 valign=top style='width:35.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>20<o:p></o:p></span></p>
  </td>
  <td width=59 valign=top style='width:35.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>25<o:p></o:p></span></p>
  </td>
  <td width=71 valign=top style='width:42.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>30<o:p></o:p></span></p>
  </td>
  <td width=60 valign=top style='width:35.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>45<o:p></o:p></span></p>
  </td>
  <td width=58 valign=top style='width:35.0pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>60<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes'>
  <td width=118 valign=top style='width:70.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>总时间</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>892<o:p></o:p></span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>146<o:p></o:p></span></p>
  </td>
  <td width=59 valign=top style='width:35.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>110<o:p></o:p></span></p>
  </td>
  <td width=59 valign=top style='width:35.4pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>92<o:p></o:p></span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>88<o:p></o:p></span></p>
  </td>
  <td width=59 valign=top style='width:35.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>100<o:p></o:p></span></p>
  </td>
  <td width=59 valign=top style='width:35.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>128<o:p></o:p></span></p>
  </td>
  <td width=71 valign=top style='width:42.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>101<o:p></o:p></span></p>
  </td>
  <td width=60 valign=top style='width:35.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>145<o:p></o:p></span></p>
  </td>
  <td width=58 valign=top style='width:35.0pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>104<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．注意事项</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1079" type="#_x0000_t75" style='width:412.2pt;height:234pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image264.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1079"
  DrawAspect="Content" ObjectID="_1629748258">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>分析</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_207" o:spid="_x0000_i1195" type="#_x0000_t75"
 style='width:493.8pt;height:47.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image265.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>如果必须只有一个</span><span lang=EN-US style='color:black'>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>，但压力很大的话，就可以吸纳用几个</span><span lang=EN-US
style='color:black'>ReduceTask</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>分担一下，最后再用一个</span><span
lang=EN-US style='color:black'>ReduceTask</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>处理。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.6 OutputFormat</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据输出</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>3.6.1 OutputFormat</span><span
style='font-size:14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>接口实现类</span><span lang=EN-US
style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1080"
 type="#_x0000_t75" style='width:416.4pt;height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image266.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1080"
  DrawAspect="Content" ObjectID="_1629748259">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>3.6.2 </span><span style='font-size:14.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>自定义</span><span lang=EN-US style='font-size:14.0pt'>OutputFormat<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1081"
 type="#_x0000_t75" style='width:411pt;height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image267.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1081"
  DrawAspect="Content" ObjectID="_1629748260">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>3.6.3 </span><span style='font-size:14.0pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>自定义</span><span lang=EN-US style='font-size:14.0pt'>OutputFormat</span><span
style='font-size:14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>案例实操</span><span lang=EN-US
style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>过滤输入的</span><span
lang=EN-US>log</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>日志，包含</span><span lang=EN-US>atguigu</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的网站输出到</span><span lang=EN-US>e:/atguigu.log</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，不包含</span><span lang=EN-US>atguigu</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的网站输出到</span><span lang=EN-US>e:/other.log</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）输入数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US><v:shape id="_x0000_i1082" type="#_x0000_t75" style='width:35.4pt;
 height:47.4pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image268.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1082"
  DrawAspect="Content" ObjectID="_1629748261">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_234"
 o:spid="_x0000_i1194" type="#_x0000_t75" style='width:194.4pt;height:120pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image269.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）期望输出数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US><v:shape id="_x0000_i1083" type="#_x0000_t75" style='width:45.6pt;
 height:33pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image270.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1083"
  DrawAspect="Content" ObjectID="_1629748262">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'>  </span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_235"
 o:spid="_x0000_i1193" type="#_x0000_t75" style='width:188.4pt;height:64.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image271.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US><v:shape id="_x0000_i1084" type="#_x0000_t75" style='width:36pt;
 height:33pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image272.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1084"
  DrawAspect="Content" ObjectID="_1629748263">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_236"
 o:spid="_x0000_i1192" type="#_x0000_t75" style='width:157.2pt;height:139.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image273.png" o:title=""/>
</v:shape></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1085"
 type="#_x0000_t75" style='width:558pt;height:315pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image274.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1085"
  DrawAspect="Content" ObjectID="_1629748264">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．案例实操</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>FilterMapper</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.outputformat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class FilterMapper extends
  Mapper&lt;LongWritable, Text, Text, NullWritable&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void map(LongWritable key, Text value, Context context)<span
  style='mso-tab-count:1'>  </span>throws IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>写出</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>context.write(value,
  NullWritable.get());<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='font-family:"Times New Roman","serif";mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>FilterReducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=948
 style='width:568.7pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=948 valign=top style='width:568.7pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.outputformat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class FilterReducer extends
  Reducer&lt;Text, NullWritable, Text, NullWritable&gt; {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  15.75pt;mso-char-indent-count:1.5'><span lang=EN-US style='font-size:10.5pt'>Text
  k = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void reduce(Text key, Iterable&lt;NullWritable&gt; values, Context context)<span
  style='mso-tab-count:2'>      </span>throws IOException, InterruptedException
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>      </span>String line = key.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>      </span>// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>换行符，否则会一行输出所有</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>      </span>line = line + &quot;\r'n&quot;;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>      </span>k.set(line);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>      
  </span>// </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>防止有重复的数据</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>      </span>for (NullWritable nullWritable :
  values) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='mso-spacerun:yes'>     </span>context.write(k, NullWritable.get());<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>不换行输出是这样子的</span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_243"
   o:spid="_x0000_i1191" type="#_x0000_t75" style='width:558pt;height:80.4pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image275.png" o:title=""/>
  </v:shape></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>换行输出是这样子的</span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_244"
   o:spid="_x0000_i1190" type="#_x0000_t75" style='width:157.2pt;height:139.8pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image273.png" o:title=""/>
  </v:shape></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）自定义一个</span><span
lang=EN-US>OutputFormat</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.outputformat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.RecordWriter;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.TaskAttemptContext;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class FilterOutputFormat extends
  FileOutputFormat&lt;Text, NullWritable&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  RecordWriter&lt;Text, NullWritable&gt; getRecordWriter(TaskAttemptContext
  job)<span style='mso-tab-count:3'>        </span>throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>创建一个</span><span
  lang=EN-US style='font-size:10.5pt'>RecordWriter<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  new FilterRecordWriter(job);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='font-family:"Times New Roman","serif";mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>RecordWriter</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.outputformat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.FSDataOutputStream;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.FileSystem;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.RecordWriter;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.TaskAttemptContext;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class FilterRecordWriter extends
  RecordWriter&lt;Text, NullWritable&gt; {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>FSDataOutputStream
  atguiguOut = null;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>FSDataOutputStream
  otherOut = null;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  FilterRecordWriter(TaskAttemptContext job) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取文件系统</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileSystem
  fs;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>try
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>fs
  = FileSystem.get(job.getConfiguration());<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>创建输出文件路径</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>Path
  atguiguPath = new Path(&quot;e:/atguigu.log&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>Path
  otherPath = new Path(&quot;e:/other.log&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>创建输出流</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>atguiguOut
  = fs.create(atguiguPath);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>otherOut
  = fs.create(otherPath);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}
  catch (IOException e) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>e.printStackTrace();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void write(Text key, NullWritable value) throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_237" o:spid="_x0000_i1189"
   type="#_x0000_t75" style='width:426.6pt;height:20.4pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image276.png" o:title=""/>
  </v:shape></span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>判断是否包含“</span><span
  lang=EN-US style='font-size:10.5pt'>atguigu</span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>”输出到不同文件</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>if
  (key.toString().contains(&quot;atguigu&quot;)) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>atguiguOut.write(key.toString().getBytes());<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}
  else {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>otherOut.write(key.toString().getBytes());<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void close(TaskAttemptContext context) throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>关闭资源</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5'><span lang=EN-US style='font-size:10.5pt'>IOUtils.closeStream(atguiguOut);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>IOUtils.closeStream(otherOut);<span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  15.75pt;mso-char-indent-count:1.5'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-bidi-font-size:10.5pt'>closeStream</span><span
  style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>源码，里面是有判断是否为空的</span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_238"
   o:spid="_x0000_i1188" type="#_x0000_t75" style='width:550.8pt;height:192pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image277.png" o:title=""/>
  </v:shape></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_239"
 o:spid="_x0000_i1187" type="#_x0000_t75" style='width:567pt;height:232.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image278.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>5</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>FilterDriver</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.outputformat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class FilterDriver {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  static void main(String[] args) throws Exception {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>输入输出路径需要根据自己电脑上实际的输入输出路径设置</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>args = new String[] { &quot;e:/input/inputoutputformat&quot;,
  &quot;e:/output2&quot; };<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
  conf = new Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job
  job = Job.getInstance(conf);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setJarByClass(FilterDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(FilterMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setReducerClass(FilterReducer.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
  style='mso-tab-count:1'>   </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(NullWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputValueClass(NullWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='color:red'>// </span></span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>要将自定义的输出格式组件设置到</span><span lang=EN-US style='font-size:10.5pt;
  color:red'>job</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:red'>中</span><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>job.setOutputFormatClass(FilterOutputFormat.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>虽然我们自定义了</span><span
  lang=EN-US style='font-size:10.5pt'>outputformat</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>，但是因为我们的</span><span lang=EN-US
  style='font-size:10.5pt'>outputformat</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>继承自</span><span lang=EN-US style='font-size:10.5pt'>fileoutputformat<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>而</span><span lang=EN-US
  style='font-size:10.5pt'>fileoutputformat</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>要输出一个</span><span lang=EN-US style='font-size:10.5pt'>_SUCCESS</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>文件，所以，在这还得指定一个输出目录</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>boolean
  result = job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>System.exit(result
  ? 0 : 1);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>结果</span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_240"
   o:spid="_x0000_i1186" type="#_x0000_t75" style='width:525pt;height:69.6pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image279.png" o:title=""/>
  </v:shape></span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_242"
   o:spid="_x0000_i1185" type="#_x0000_t75" style='width:249pt;height:84.6pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image280.png" o:title=""/>
  </v:shape></span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_245"
   o:spid="_x0000_i1184" type="#_x0000_t75" style='width:157.2pt;height:139.8pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image273.png" o:title=""/>
  </v:shape></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_241"
   o:spid="_x0000_i1183" type="#_x0000_t75" style='width:550.8pt;height:136.2pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image281.png" o:title=""/>
  </v:shape></span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.7 Join</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>多种应用</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>3.7.1 Reduce Join<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1086"
 type="#_x0000_t75" style='width:407.4pt;height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image282.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1086"
  DrawAspect="Content" ObjectID="_1629748265">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>3.7.2 Reduce Join</span><span
style='font-size:14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>案例实操</span><span lang=EN-US
style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:31.5pt;
mso-char-indent-count:3.0;line-height:150%'><v:shape id="_x0000_s1133" type="#_x0000_t75"
 style='position:absolute;left:0;text-align:left;margin-left:24.15pt;
 margin-top:26.35pt;width:46.4pt;height:41.9pt;z-index:251659264;
 mso-position-horizontal-relative:text;mso-position-vertical-relative:text'>
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image283.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_s1133"
  DrawAspect="Content" ObjectID="_1629748266">
 </o:OLEObject>
</xml><![endif]--><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>表</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'>4-4 </span><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;line-height:150%;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>订单数据表</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:"Times New Roman"'>t_order<o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=71 valign=top style='width:42.55pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>id<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>pid<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>amount<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1001<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>01<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1002<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>02<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>2<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1003<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>03<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>3<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1004<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>01<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>4<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1005<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>02<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>5<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1006<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>03<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>6<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center style='text-align:center;text-indent:27.0pt;
mso-char-indent-count:3.0;line-height:150%'><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;line-height:150%;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:"Arial","sans-serif";
mso-fareast-font-family:黑体;mso-bidi-font-family:"Times New Roman"'>4-5 </span><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>商品信息表</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;
font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>t_product<o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:15.4pt'>
  <td width=103 valign=top style='width:62.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt;height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>pid<o:p></o:p></span></p>
  </td>
  <td width=155 valign=top style='width:93.0pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>pname<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;height:15.4pt'>
  <td width=103 valign=top style='width:62.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>01<o:p></o:p></span></p>
  </td>
  <td width=155 valign=top style='width:93.0pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>小米</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;height:15.4pt'>
  <td width=103 valign=top style='width:62.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>02<o:p></o:p></span></p>
  </td>
  <td width=155 valign=top style='width:93.0pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>华为</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes;height:15.85pt'>
  <td width=103 valign=top style='width:62.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:15.85pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>03<o:p></o:p></span></p>
  </td>
  <td width=155 valign=top style='width:93.0pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:15.85pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>格力</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='line-height:150%'><v:shape id="_x0000_s1134" type="#_x0000_t75"
 style='position:absolute;left:0;text-align:left;margin-left:38.2pt;
 margin-top:-54.15pt;width:32.4pt;height:41.9pt;z-index:251661312;
 mso-position-horizontal-relative:text;mso-position-vertical-relative:text'>
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image284.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_s1134"
  DrawAspect="Content" ObjectID="_1629748267">
 </o:OLEObject>
</xml><![endif]--><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;color:black'><span style='mso-tab-count:1'>       </span></span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>将商品信息表中数据根据商品</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>pid</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>合并到订单数据表中。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:31.5pt;
mso-char-indent-count:3.0;line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>表</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>4-6 </span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>最终数据形式</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=71 valign=top style='width:42.55pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>id<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>pname<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>amount<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1001<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>小米</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1004<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>小米</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>4<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1002<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>华为</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>2<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1005<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>华为</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>5<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1003<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>格力</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>3<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1006<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>格力</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>6<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>通过将关联条件作为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>Map</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>输出的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>，将两表满足</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>Join</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>条件的数据并携带数据所来源的文件信息，发往同一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>ReduceTask</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>，在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>Reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>中进行数据的串联，如图</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>4-20</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>所示。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black'><v:shape id="_x0000_i1087" type="#_x0000_t75"
 style='width:535.8pt;height:303pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image285.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1087"
  DrawAspect="Content" ObjectID="_1629748268">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-20 Reduce</span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>端表合并</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_246"
 o:spid="_x0000_i1182" type="#_x0000_t75" style='width:251.4pt;height:165.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image286.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_247"
 o:spid="_x0000_i1181" type="#_x0000_t75" style='width:246pt;height:211.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image287.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_248"
 o:spid="_x0000_i1180" type="#_x0000_t75" style='width:246.6pt;height:174.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image288.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．代码实现</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）创建商品和订合并后的</span><span lang=EN-US>Bean</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>package
  com.atguigu.mapreduce.table;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>import
  java.io.DataInput;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>import
  java.io.DataOutput;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>import
  org.apache.hadoop.io.Writable;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>public class
  TableBean implements Writable {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// id pid amount<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// pid pname<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>private String order_id; // </span><span
  style='font-size:10.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>订单</span><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>id<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>private String p_id; <span
  style='mso-spacerun:yes'>     </span>// </span><span style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>产品</span><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>id<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>private int amount; <span
  style='mso-spacerun:yes'>      </span>// </span><span style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>产品数量</span><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>private String pname; <span
  style='mso-spacerun:yes'>    </span>// </span><span style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>产品名称</span><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>private String flag;<span
  style='mso-spacerun:yes'>      </span>// </span><span style='font-size:10.0pt;
  mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>表的标记，标记是订单表还是产品表</span><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public TableBean() {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>super();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public TableBean(String order_id, String
  p_id, int amount, String pname, String flag) {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>super();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.order_id = order_id;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.p_id = p_id;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.amount = amount;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.pname = pname;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.flag = flag;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public String getFlag() {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>return flag;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public void setFlag(String flag) {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.flag = flag;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public String getOrder_id() {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>return order_id;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public void setOrder_id(String order_id) {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.order_id = order_id;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public String getP_id() {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>return p_id;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public void setP_id(String p_id) {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.p_id = p_id;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public int getAmount() {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>return amount;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public void setAmount(int amount) {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.amount = amount;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public String getPname() {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>return pname;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public void setPname(String pname) {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.pname = pname;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public void write(DataOutput out) throws
  IOException {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>out.writeUTF(order_id);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>out.writeUTF(p_id);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>out.writeInt(amount);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>out.writeUTF(pname);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>out.writeUTF(flag);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public void readFields(DataInput in)
  throws IOException {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.order_id = in.readUTF();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.p_id = in.readUTF();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.amount = in.readInt();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.pname = in.readUTF();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>this.flag = in.readUTF();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>@Override // </span><span
  style='font-size:10.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>最终只要这三个，所以只输出这仨就行</span><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>public String toString() {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:2'>       </span>return order_id + &quot;\t&quot; +
  pname + &quot;\t&quot; + amount + &quot;\t&quot; ;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'><span
  style='mso-tab-count:1'>    </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>}</span><span
  lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）编写</span><span lang=EN-US>TableMapper</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.table;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileSplit;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>public class TableMapper extends
  Mapper&lt;LongWritable, Text, Text, TableBean&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  21.0pt;mso-char-indent-count:2.0'><span lang=EN-US style='font-size:10.5pt'>String
  name;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>TableBean
  bean = new TableBean();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>Text
  k = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>protected
  void setup(Context context) throws IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取输入文件切片</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileSplit
  split = (FileSplit) context.getInputSplit();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取输入文件名称</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>name
  = split.getPath().getName();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>protected
  void map(LongWritable key, Text value, Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// id<span style='mso-spacerun:yes'>   </span>pid amount<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// 1001 01<span style='mso-spacerun:yes'>   </span>1<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// pid<span style='mso-spacerun:yes'>  </span>pname<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>//<span style='mso-spacerun:yes'>  </span>01<span
  style='mso-spacerun:yes'>    </span></span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>小米</span><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取输入数据</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
  line = value.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>不同文件分别处理</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>if
  (name.startsWith(&quot;order&quot;)) {// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>订单表处理</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>//
  2.1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>切割</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>String[]
  fields = line.split(&quot;\t&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>//
  2.2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>封装</span><span lang=EN-US
  style='font-size:10.5pt'>bean</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>对象</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setOrder_id(fields[0]);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setP_id(fields[1]);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setAmount(Integer.parseInt(fields[2]));<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setPname(&quot;&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setFlag(&quot;order&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>k.set(fields[1]);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}else
  {// </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>产品表处理</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>//
  2.3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>切割</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>String[]
  fields = line.split(&quot;\t&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>//
  2.4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>封装</span><span lang=EN-US
  style='font-size:10.5pt'>bean</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>对象</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setP_id(fields[0]);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setPname(fields[1]);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setFlag(&quot;pd&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setAmount(0);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setOrder_id(&quot;&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>k.set(fields[0]);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>写出</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>context.write(k,
  bean);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='mso-bidi-font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）编写</span><span lang=EN-US>TableReducer</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.table;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.util.ArrayList;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.commons.beanutils.BeanUtils;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>public class TableReducer extends
  Reducer&lt;Text, TableBean, TableBean, NullWritable&gt; {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>protected
  void reduce(Text key, Iterable&lt;TableBean&gt; values, Context context)<span
  style='mso-tab-count:1'>   </span>throws IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>准备存储订单的集合</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>ArrayList&lt;TableBean&gt;
  orderBeans = new ArrayList&lt;&gt;();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>准备</span><span lang=EN-US
  style='font-size:10.5pt'>bean</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>对象</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>TableBean
  pdBean = new TableBean();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>for
  (TableBean bean : values) {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>if
  (&quot;order&quot;.equals(bean.getFlag())) {// </span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>订单表</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>             </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>拷贝传递过来的每条订单数据到集合中</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>             </span>TableBean
  orderBean = new TableBean();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>             </span>try
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:5'>                </span>BeanUtils.copyProperties(orderBean,
  bean);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>             </span>}
  catch (Exception e) {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:5'>                </span>e.printStackTrace();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>             </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_249" o:spid="_x0000_i1179"
   type="#_x0000_t75" style='width:277.8pt;height:27.6pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image289.png" o:title=""/>
  </v:shape></span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>             </span>orderBeans.add(orderBean);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span><span
  style='mso-tab-count:2'>      </span>} else {// </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>产品表</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>             </span>try
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:5'>                </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>拷贝传递过来的产品表到内存中（产品只有一个）</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:5'>                </span>BeanUtils.copyProperties(pdBean,
  bean);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>             </span>}
  catch (Exception e) {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:5'>                </span>e.printStackTrace();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>             </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_250" o:spid="_x0000_i1178"
   type="#_x0000_t75" style='width:410.4pt;height:54.6pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image290.png" o:title=""/>
  </v:shape></span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_251" o:spid="_x0000_i1177"
   type="#_x0000_t75" style='width:100.8pt;height:55.2pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image291.png" o:title=""/>
  </v:shape></span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>表的拼接</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>for(TableBean
  bean:orderBeans){<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>bean.setPname
  (pdBean.getPname());<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>//
  4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>数据写出去</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>context.write(bean,
  NullWritable.get());<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='mso-bidi-font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
lang=EN-US>4</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）编写</span><span lang=EN-US>TableDriver</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=948
 style='width:568.7pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=948 valign=top style='width:568.7pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.table;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>public class TableDriver {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>public
  static void main(String[] args) throws Exception {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'>//
  0 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>根据自己电脑路径重新配置</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'>args
  = new String[]{&quot;e:/input/inputtable&quot;,&quot;e:/output1&quot;};<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取配置信息，或者</span><span
  lang=EN-US style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>对象实例</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
  configuration = new Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job
  job = Job.getInstance(configuration);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>指定本程序的</span><span
  lang=EN-US style='font-size:10.5pt'>jar</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>包所在的本地路径</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setJarByClass(TableDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>指定本业务</span><span
  lang=EN-US style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>要使用的</span><span lang=EN-US style='font-size:10.5pt'>Mapper/Reducer</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>业务类</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(TableMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setReducerClass(TableReducer.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>指定</span><span lang=EN-US
  style='font-size:10.5pt'>Mapper</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>输出数据的</span><span lang=EN-US style='font-size:10.5pt'>kv</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>类型</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(TableBean.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  5 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>指定最终输出的数据的</span><span
  lang=EN-US style='font-size:10.5pt'>kv</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>类型</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(TableBean.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputValueClass(NullWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  6 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>指定</span><span lang=EN-US
  style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>的输入原始文件所在目录</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  7 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>将</span><span lang=EN-US
  style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>中配置的相关参数，以及</span><span
  lang=EN-US style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>所用的</span><span lang=EN-US style='font-size:10.5pt'>java</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>类所在的</span><span lang=EN-US
  style='font-size:10.5pt'>jar</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包，</span><span
  style='font-size:10.5pt'> </span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>提交给</span><span
  lang=EN-US style='font-size:10.5pt'>yarn</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>去运行</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>boolean
  result = job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>System.exit(result
  ? 0 : 1);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='mso-bidi-font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．测试</span></p>

<p class=MsoNormal style='text-indent:26.25pt;mso-char-indent-count:2.5;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>运行程序查看结果</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=685
 style='width:411.1pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>1001<span style='mso-tab-count:1'>  </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>小米</span><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>1<span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>1001<span style='mso-tab-count:1'>  </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>小米</span><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>1<span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>1002<span style='mso-tab-count:1'>  </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>华为</span><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>2<span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>1002<span style='mso-tab-count:1'>  </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>华为</span><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>2<span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>1003<span style='mso-tab-count:1'>  </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>格力</span><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>3<span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>1003<span style='mso-tab-count:1'>  </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>格力</span><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>3</span><span
  lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><span style='mso-tab-count:1'>     </span><o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．总结</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><v:shape
 id="_x0000_i1088" type="#_x0000_t75" style='width:393pt;height:222pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image292.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1088"
  DrawAspect="Content" ObjectID="_1629748269">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>3.7.3 Map Join<o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．使用场景</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>Map Join</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>适用于一张表十分小、一张表很大的场景。</span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．优点</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>思考：在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>Reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>端处理过多的表，非常容易产生数据倾斜。怎么办？</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>Map</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>端缓存多张表，提前处理业务逻辑，这样增加</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>Map</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>端业务，减少</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>Reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>端数据的压力，尽可能的减少数据倾斜。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．具体办法：采用</span><span
lang=EN-US>DistributedCache</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black'><span style='mso-tab-count:1'>       </span></span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>Mapper</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>setup</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>阶段，将文件读取到缓存集合中。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black'><span style='mso-tab-count:1'>       </span></span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）在驱动函数中加载缓存。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black'>// </span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>缓存普通文件到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black'>Task</span><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>运行节点。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;color:black'>job.addCacheFile(new
URI(&quot;file://e:/cache/pd.txt&quot;));<o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>3.7.4 Map Join</span><span
style='font-size:14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>案例实操</span><span lang=EN-US
style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:31.5pt;
mso-char-indent-count:3.0;line-height:150%'><v:shape id="_x0000_s1135" type="#_x0000_t75"
 style='position:absolute;left:0;text-align:left;margin-left:32.5pt;
 margin-top:30.15pt;width:61.65pt;height:55.85pt;z-index:251663360;
 mso-position-horizontal-relative:text;mso-position-vertical-relative:text'>
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image293.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_s1135"
  DrawAspect="Content" ObjectID="_1629748270">
 </o:OLEObject>
</xml><![endif]--><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>表</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'>4-4 </span><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;line-height:150%;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>订单数据表</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:"Times New Roman"'>t_order<o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=71 valign=top style='width:42.55pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>id<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>pid<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>amount<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1001<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>01<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1002<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>02<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>2<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1003<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>03<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>3<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1004<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>01<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>4<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1005<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>02<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>5<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1006<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>03<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>6<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center style='text-align:center;text-indent:27.0pt;
mso-char-indent-count:3.0;line-height:150%'><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;line-height:150%;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:"Arial","sans-serif";
mso-fareast-font-family:黑体;mso-bidi-font-family:"Times New Roman"'>4-5 </span><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>商品信息表</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;
font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>t_product<o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:15.4pt'>
  <td width=103 valign=top style='width:62.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt;height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>pid<o:p></o:p></span></p>
  </td>
  <td width=155 valign=top style='width:93.0pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>pname<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;height:15.4pt'>
  <td width=103 valign=top style='width:62.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>01<o:p></o:p></span></p>
  </td>
  <td width=155 valign=top style='width:93.0pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>小米</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;height:15.4pt'>
  <td width=103 valign=top style='width:62.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>02<o:p></o:p></span></p>
  </td>
  <td width=155 valign=top style='width:93.0pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:15.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>华为</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes;height:15.85pt'>
  <td width=103 valign=top style='width:62.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:15.85pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt;color:red'>03<o:p></o:p></span></p>
  </td>
  <td width=155 valign=top style='width:93.0pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:15.85pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>格力</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='line-height:150%'><v:shape id="_x0000_s1136" type="#_x0000_t75"
 style='position:absolute;left:0;text-align:left;margin-left:44.35pt;
 margin-top:-59.1pt;width:43.2pt;height:55.85pt;z-index:251665408;
 mso-position-horizontal-relative:text;mso-position-vertical-relative:text'>
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image294.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_s1136"
  DrawAspect="Content" ObjectID="_1629748271">
 </o:OLEObject>
</xml><![endif]--><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;color:black'><span style='mso-tab-count:1'>       </span></span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>将商品信息表中数据根据商品</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>pid</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>合并到订单数据表中。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:31.5pt;
mso-char-indent-count:3.0;line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>表</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>4-6 </span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>最终数据形式</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:.5pt solid windowtext;
 mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=71 valign=top style='width:42.55pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>id<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>pname<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>amount<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1001<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>小米</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1004<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>小米</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>4<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1002<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>华为</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>2<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1005<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>华为</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>5<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1003<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>格力</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>3<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=71 valign=top style='width:42.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>1006<o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>格力</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0 align=center style='text-align:center'><span lang=EN-US
  style='font-size:10.5pt'>6<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>2</span><span style='mso-bidi-font-size:10.5pt;
font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>需求分析</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'>MapJoin</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>适用于关联表中有小表的情形。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1089"
 type="#_x0000_t75" style='width:412.2pt;height:233.4pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image295.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1089"
  DrawAspect="Content" ObjectID="_1629748273">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>图</span><span lang=EN-US>4-21 Map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>端表合并</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>没有</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，也没有</span><span lang=EN-US>Shuffle</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，减少</span><span lang=EN-US>IO</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_252"
 o:spid="_x0000_i1176" type="#_x0000_t75" style='width:192pt;height:26.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image296.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>setup</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的时候缓存</span><span
lang=EN-US>pd.txt</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>对应的数据，因为数据量小，</span><span lang=EN-US>order.txt</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的数据在</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>端的</span><span lang=EN-US>map</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>方法一拼接即可。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_253"
 o:spid="_x0000_i1175" type="#_x0000_t75" style='width:243.6pt;height:199.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image297.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>3</span><span style='mso-bidi-font-size:10.5pt;
font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>实现代码</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）先在驱动模块中添加缓存文件</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>package test;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.net.URI;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>public class DistributedCacheDriver {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>public
  static void main(String[] args) throws Exception {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'>//
  0 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>根据自己电脑路径重新配置</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'>args
  = new String[]{&quot;e:/input/inputtable2&quot;, &quot;e:/output1&quot;};<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取</span><span lang=EN-US
  style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>信息</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
  configuration = new Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job
  job = Job.getInstance(configuration);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置加载</span><span
  lang=EN-US style='font-size:10.5pt'>jar</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>包路径</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setJarByClass(DistributedCacheDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>关联</span><span lang=EN-US
  style='font-size:10.5pt'>map<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(DistributedCacheMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;text-indent:
  42.0pt;mso-char-indent-count:4.0'><span lang=EN-US style='font-size:10.5pt'>//
  4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置最终输出数据类型</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputValueClass(NullWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  5 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置输入输出路径</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>// 6 </span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>加载缓存数据</span><span lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>job.addCacheFile(new URI(&quot;file:///e:/input/inputcache/pd.txt&quot;));<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='color:red'>// 7 Map</span></span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>端</span><span lang=EN-US style='font-size:10.5pt;
  color:red'>Join</span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>的逻辑不需要</span><span lang=EN-US style='font-size:10.5pt;color:red'>Reduce</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>阶段，设置</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>reduceTask</span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>数量为</span><span lang=EN-US style='font-size:10.5pt;
  color:red'>0<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>job.setNumReduceTasks(0);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  8 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>提交</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>boolean
  result = job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>System.exit(result
  ? 0 : 1);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='mso-bidi-font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）读取缓存的文件数据</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>package test;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.BufferedReader;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.FileInputStream;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.InputStreamReader;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.util.HashMap;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.util.Map;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.commons.lang.StringUtils;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>public class DistributedCacheMapper
  extends Mapper&lt;LongWritable, Text, Text, NullWritable&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>Map&lt;String,
  String&gt; pdMap = new HashMap&lt;&gt;();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>protected
  void setup(Mapper&lt;LongWritable, Text, Text, NullWritable&gt;.Context
  context) throws IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取缓存的文件</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='color:red'>URI[] cacheFiles = context.getCacheFiles();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span
  style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>      
  </span>// </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:red'>从缓存中获取文件的路径</span><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>String path = cacheFiles[0].getPath().toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>BufferedReader reader = new BufferedReader(new InputStreamReader(new
  FileInputStream(path), &quot;UTF-8&quot;));<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
  line;<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>while(StringUtils.isNotEmpty(line
  = reader.readLine())){<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// pid name<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// 01<span style='mso-spacerun:yes'>   </span></span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>小米</span><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>切割</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>String[]
  fields = line.split(&quot;\t&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>缓存数据到集合</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>pdMap.put(fields[0],
  fields[1]);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>关流</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>reader.close();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>Text
  k = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>protected
  void map(LongWritable key, Text value, Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// id<span style='mso-spacerun:yes'>   </span>pid amount<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// 1001 01<span style='mso-spacerun:yes'>   </span>1<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// pid<span style='mso-spacerun:yes'>  </span>pname<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>//<span style='mso-spacerun:yes'>  </span>01<span
  style='mso-spacerun:yes'>    </span></span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>小米</span><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取一行</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
  line = value.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>截取</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String[]
  fields = line.split(&quot;\t&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取产品</span><span
  lang=EN-US style='font-size:10.5pt'>id<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
  pId = fields[1];<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取商品名称</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
  pdName = pdMap.get(pId);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  5 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>拼接</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>k.set(line
  + &quot;\t&quot;+ pdName);<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  6 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>写出</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>context.write(k,
  NullWritable.get());<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
  lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>结果</span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_254"
   o:spid="_x0000_i1174" type="#_x0000_t75" style='width:250.8pt;height:130.2pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image298.png" o:title=""/>
  </v:shape></span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.8 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>计数器应用</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1090"
 type="#_x0000_t75" style='width:411pt;height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image299.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1090"
  DrawAspect="Content" ObjectID="_1629748274">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.9 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据清洗（</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>ETL</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>在运行核心业务</span><span lang=EN-US style='color:
black'>MapReduce</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>程序之前，往往要先对数据进行清洗，清理掉不符合用户要求的数据。清理的过程往往只需要运行</span><span
lang=EN-US style='color:black'>Mapper</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>程序，不需要运行</span><span lang=EN-US style='color:black'>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>程序。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>3.9.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据清洗案例实操</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>-</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>简单解析版</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>去除日志中字段长度小于等于</span><span
lang=EN-US style='color:black'>11</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>的日志。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='color:black'>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）输入数据</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='color:black'><v:shape id="_x0000_i1091" type="#_x0000_t75"
 style='width:46.2pt;height:47.4pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image300.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1091"
  DrawAspect="Content" ObjectID="_1629748275">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_255"
 o:spid="_x0000_i1173" type="#_x0000_t75" style='width:528.6pt;height:157.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image301.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='color:black'>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）期望输出数据</span><span lang=EN-US style='color:
black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>每行字段长度都大于</span><span
lang=EN-US style='color:black'>11</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'><span style='mso-tab-count:1'>       </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>需要在</span><span lang=EN-US style='color:black'>Map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>阶段对输入的数据根据规则进行过滤清洗。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．实现代码</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>LogMapper</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.weblog;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class LogMapper extends
  Mapper&lt;LongWritable, Text, Text, NullWritable&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>Text
  k = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void map(LongWritable key, Text value, Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取</span><span lang=EN-US
  style='font-size:10.5pt'>1</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>行数据</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
  line = value.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>解析日志</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>boolean
  result = parseLog(line,context);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>日志不合法退出，这条数据就不要了</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>if
  (!result) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>return;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置</span><span lang=EN-US
  style='font-size:10.5pt'>key<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>k.set(line);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  5 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>写出数据</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><span
  style='mso-tab-count:1'>   </span>context.write(k, NullWritable.get());<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>解析日志</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  boolean parseLog(String line, Context context) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>截取</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String[]
  fields = line.split(&quot; &quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>日志长度大于</span><span
  lang=EN-US style='font-size:10.5pt'>11</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>的为合法</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>if
  (fields.length &gt; 11) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>系统计数器，名字是</span><span
  lang=EN-US style='font-size:10.5pt'>map</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>，值是</span><span lang=EN-US style='font-size:10.5pt'>true</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>的计数器递增</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>context.getCounter(&quot;map&quot;,
  &quot;true&quot;).increment(1);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>return
  true;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}else
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>context.getCounter(&quot;map&quot;,
  &quot;false&quot;).increment(1);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>return
  false;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='font-family:"Times New Roman","serif";mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>LogDriver</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.weblog;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class LogDriver {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  static void main(String[] args) throws Exception {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5'><span lang=EN-US style='font-size:10.5pt'>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>输入输出路径需要根据自己电脑上实际的输入输出路径设置</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>args = new String[] { &quot;e:/input/inputlog&quot;,
  &quot;e:/output1&quot; };<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取</span><span lang=EN-US
  style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>信息</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
  conf = new Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job
  job = Job.getInstance(conf);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>加载</span><span lang=EN-US
  style='font-size:10.5pt'>jar</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setJarByClass(LogDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>关联</span><span lang=EN-US
  style='font-size:10.5pt'>map<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(LogMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置最终输出类型</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputValueClass(NullWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='color:red'>// </span></span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>设置</span><span lang=EN-US style='font-size:10.5pt;color:red'>reducetask</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>个数为</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>0<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt;color:red'><span style='mso-tab-count:
  2'>      </span>job.setNumReduceTasks(0);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  5 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置输入和输出路径</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  6 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>提交</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>结果</span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_256"
   o:spid="_x0000_i1172" type="#_x0000_t75" style='width:550.8pt;height:178.8pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image302.png" o:title=""/>
  </v:shape></span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_257"
   o:spid="_x0000_i1171" type="#_x0000_t75" style='width:374.4pt;height:265.2pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image303.png" o:title=""/>
  </v:shape></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>3.9.2 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据清洗案例实操</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'>-</span><span style='font-size:14.0pt;line-height:172%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>复杂解析版</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>对</span><span
lang=EN-US style='color:black'>Web</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>访问日志中的各字段识别切分，去除日志中不合法的记录。根据清洗规则，输出过滤后的数据。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;mso-para-margin-left:2.0gd;
text-indent:21.0pt;line-height:150%'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>（</span><span
lang=EN-US style='color:black'>1</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）输入数据</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='color:black'><v:shape id="_x0000_i1092" type="#_x0000_t75"
 style='width:45.6pt;height:43.8pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image304.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1092"
  DrawAspect="Content" ObjectID="_1629748276">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_258"
 o:spid="_x0000_i1170" type="#_x0000_t75" style='width:513.6pt;height:138pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image305.png" o:title=""/>
</v:shape></span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>）期望输出数据</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black'>都是合法的数据</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．实现代码</span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）定义一个</span><span
lang=EN-US>bean</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，用来记录日志数据中的各数据字段</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.log;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class LogBean {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  String remote_addr;// </span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>记录客户端的</span><span
  lang=EN-US style='font-size:10.5pt'>ip</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>地址</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  String remote_user;// </span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>记录客户端用户名称</span><span
  lang=EN-US style='font-size:10.5pt'>,</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>忽略属性</span><span lang=EN-US style='font-size:10.5pt'>&quot;-&quot;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  String time_local;// </span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>记录访问时间与时区</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  String request;// </span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>记录请求的</span><span
  lang=EN-US style='font-size:10.5pt'>url</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>与</span><span lang=EN-US style='font-size:10.5pt'>http</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>协议</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  String status;// </span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>记录请求状态；成功是</span><span
  lang=EN-US style='font-size:10.5pt'>200<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  String body_bytes_sent;// </span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>记录发送给客户端文件主体内容大小</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  String http_referer;// </span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>用来记录从那个页面链接访问过来的</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  String http_user_agent;// </span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>记录客户浏览器的相关信息</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  boolean valid = true;// </span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>判断数据是否合法</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String getRemote_addr() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  remote_addr;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setRemote_addr(String remote_addr) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.remote_addr
  = remote_addr;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String getRemote_user() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  remote_user;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setRemote_user(String remote_user) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.remote_user
  = remote_user;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String getTime_local() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  time_local;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setTime_local(String time_local) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.time_local
  = time_local;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String getRequest() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  request;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setRequest(String request) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.request
  = request;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String getStatus() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  status;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setStatus(String status) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.status
  = status;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String getBody_bytes_sent() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  body_bytes_sent;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setBody_bytes_sent(String body_bytes_sent) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.body_bytes_sent
  = body_bytes_sent;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String getHttp_referer() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  http_referer;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setHttp_referer(String http_referer) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.http_referer
  = http_referer;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String getHttp_user_agent() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  http_user_agent;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setHttp_user_agent(String http_user_agent) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.http_user_agent
  = http_user_agent;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  boolean isValid() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  valid;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  void setValid(boolean valid) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>this.valid
  = valid;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  String toString() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>StringBuilder
  sb = new StringBuilder();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>sb.append(this.valid);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'> </span><span
  style='mso-spacerun:yes'>      </span>// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>用特殊字符</span><span lang=EN-US style='font-size:10.5pt'>\001</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>来分割</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>sb.append(&quot;\001&quot;).append(this.remote_addr);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>sb.append(&quot;\001&quot;).append(this.remote_user);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>sb.append(&quot;\001&quot;).append(this.time_local);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>sb.append(&quot;\001&quot;).append(this.request);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>sb.append(&quot;\001&quot;).append(this.status);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>sb.append(&quot;\001&quot;).append(this.body_bytes_sent);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>sb.append(&quot;\001&quot;).append(this.http_referer);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>sb.append(&quot;\001&quot;).append(this.http_user_agent);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  sb.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><b><span lang=EN-US
  style='mso-bidi-font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>LogMapper</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.log;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class LogMapper extends
  Mapper&lt;LongWritable, Text, Text, NullWritable&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>Text
  k = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void map(LongWritable key, Text value, Context context)<span
  style='mso-tab-count:1'>  </span>throws IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取</span><span lang=EN-US
  style='font-size:10.5pt'>1</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>行</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
  line = value.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>解析日志是否合法</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>LogBean
  bean = parseLog(line);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>if
  (!bean.isValid()) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>return;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>k.set(bean.toString());<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>输出</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>context.write(k,
  NullWritable.get());<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>解析日志</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>private
  LogBean parseLog(String line) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>LogBean
  logBean = new LogBean();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>截取</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String[]
  fields = line.split(&quot; &quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>if
  (fields.length &gt; 11) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>//
  2</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>封装数据</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>logBean.setRemote_addr(fields[0]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>logBean.setRemote_user(fields[1]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>logBean.setTime_local(fields[3].substring(1));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>logBean.setRequest(fields[6]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>logBean.setStatus(fields[8]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>logBean.setBody_bytes_sent(fields[9]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>logBean.setHttp_referer(fields[10]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>if
  (fields.length &gt; 12) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>            </span>logBean.setHttp_user_agent(fields[11]
  + &quot; &quot;+ fields[12]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>}else
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>            </span>logBean.setHttp_user_agent(fields[11]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>//
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>大于</span><span lang=EN-US
  style='font-size:10.5pt'>400</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>，</span><span
  lang=EN-US style='font-size:10.5pt'>HTTP</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>错误</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>if
  (Integer.parseInt(logBean.getStatus()) &gt;= 400) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>            </span>logBean.setValid(false);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}else
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>logBean.setValid(false);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>return
  logBean;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><b><span lang=EN-US
  style='mso-bidi-font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;color:black'><o:p></o:p></span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%;mso-layout-grid-align:none;punctuation-trim:leading'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>LogDriver</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=924 valign=top style='width:554.55pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.log;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.NullWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class LogDriver {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  static void main(String[] args) throws Exception {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5'><span lang=EN-US style='font-size:10.5pt'>//
  1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>获取</span><span lang=EN-US
  style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>信息</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
  conf = new Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job
  job = Job.getInstance(conf);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>加载</span><span lang=EN-US
  style='font-size:10.5pt'>jar</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setJarByClass(LogDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  3 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>关联</span><span lang=EN-US
  style='font-size:10.5pt'>map<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(LogMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  4 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置最终输出类型</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputValueClass(NullWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  5 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>设置输入和输出路径</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  6 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>提交</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='font-family:"Times New Roman","serif";mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>3.10 MapReduce</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>开发总结</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>在编写</span><span lang=EN-US style='color:black'>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>程序时，需要考虑如下几个方面：</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1093" type="#_x0000_t75" style='width:412.8pt;height:233.4pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image306.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1093"
  DrawAspect="Content" ObjectID="_1629748277">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1094" type="#_x0000_t75" style='width:407.4pt;height:230.4pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image307.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1094"
  DrawAspect="Content" ObjectID="_1629748278">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1095" type="#_x0000_t75" style='width:407.4pt;height:230.4pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image308.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1095"
  DrawAspect="Content" ObjectID="_1629748279">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1096" type="#_x0000_t75" style='width:405pt;height:229.2pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image309.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1096"
  DrawAspect="Content" ObjectID="_1629748280">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1097" type="#_x0000_t75" style='width:403.8pt;height:229.2pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image310.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1097"
  DrawAspect="Content" ObjectID="_1629748281">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>画出来的红色框的都是可以自定义的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_259"
 o:spid="_x0000_i1169" type="#_x0000_t75" style='width:567pt;height:244.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image311.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_260"
 o:spid="_x0000_i1168" type="#_x0000_t75" style='width:567.6pt;height:187.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image312.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>4</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> <span lang=EN-US>Hadoop</span></span><span style='font-size:
15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>数据压缩</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><a name="_Toc439079698"><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.1
</span></a><span style='mso-bookmark:_Toc439079698'><span style='font-size:
14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>概述</span></span><span
style='mso-bookmark:_Toc439079698'></span><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1098"
 type="#_x0000_t75" style='width:412.2pt;height:234pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image313.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1098"
  DrawAspect="Content" ObjectID="_1629748282">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>红色框的内容指的是</span><span
lang=EN-US>map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>之前、</span><span lang=EN-US>map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>之后、</span><span lang=EN-US>reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>之后都可以压缩</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_261" o:spid="_x0000_i1167" type="#_x0000_t75"
 style='width:434.4pt;height:68.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image314.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1099"
 type="#_x0000_t75" style='width:411pt;height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image315.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1099"
  DrawAspect="Content" ObjectID="_1629748283">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><a name="_Toc439079699"><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.2
MR</span></a><span style='mso-bookmark:_Toc439079699'><span style='font-size:
14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>支持的压缩编码</span></span><span
style='mso-bookmark:_Toc439079699'></span><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>表</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:
黑体;mso-bidi-font-family:"Times New Roman"'>4-7<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=95 valign=top style='width:56.9pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>压缩格式</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=130 valign=top style='width:77.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>hadoop</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>自带？</span><span lang=EN-US style='font-size:
  10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:56.9pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>算法</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.55pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>文件扩展名</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=133 valign=top style='width:79.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>是否可切分</span><span lang=EN-US
  style='font-size:10.5pt'>(</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>压缩后是否支持切分</span><span
  lang=EN-US style='font-size:10.5pt'>)<o:p></o:p></span></p>
  </td>
  <td width=354 valign=top style='width:212.65pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>换成压缩格式后，原来的程序是否需要修改</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>DEFLATE<o:p></o:p></span></p>
  </td>
  <td width=130 valign=top style='width:77.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>是，直接使用</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>DEFLATE<o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>.deflate<o:p></o:p></span></p>
  </td>
  <td width=133 valign=top style='width:79.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>否</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=354 valign=top style='width:212.65pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>和文本处理一样，不需要修改</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>Gzip<o:p></o:p></span></p>
  </td>
  <td width=130 valign=top style='width:77.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>是，直接使用</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>DEFLATE<o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>.gz<o:p></o:p></span></p>
  </td>
  <td width=133 valign=top style='width:79.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>否</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=354 valign=top style='width:212.65pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>和文本处理一样，不需要修改</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>bzip2<o:p></o:p></span></p>
  </td>
  <td width=130 valign=top style='width:77.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>是，直接使用</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>bzip2<o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>.bz2<o:p></o:p></span></p>
  </td>
  <td width=133 valign=top style='width:79.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:red'>是</span><span lang=EN-US
  style='font-size:10.5pt;color:red'><o:p></o:p></span></p>
  </td>
  <td width=354 valign=top style='width:212.65pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>和文本处理一样，不需要修改</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>LZO<o:p></o:p></span></p>
  </td>
  <td width=130 valign=top style='width:77.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>否，需要安装</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>LZO<o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>.lzo<o:p></o:p></span></p>
  </td>
  <td width=133 valign=top style='width:79.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:red'>是</span><span lang=EN-US
  style='font-size:10.5pt;color:red'><o:p></o:p></span></p>
  </td>
  <td width=354 valign=top style='width:212.65pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>需要建索引，还需要指定输入格式</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>Snappy<o:p></o:p></span></p>
  </td>
  <td width=130 valign=top style='width:77.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>否，需要安装</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=95 valign=top style='width:56.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>Snappy<o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>.snappy<o:p></o:p></span></p>
  </td>
  <td width=133 valign=top style='width:79.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>否</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=354 valign=top style='width:212.65pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>和文本处理一样，不需要修改</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:16.5pt;mso-layout-grid-align:none;
punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为了支持多种压缩</span><span
lang=EN-US>/</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>解压缩算法，</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>引入了编码</span><span lang=EN-US>/</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>解码器，如下表所示。</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>表</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;
font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>4-8</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=272 style='width:163.05pt;border:solid windowtext 1.0pt;border-left:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  mso-border-right-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>压缩格式</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>对应的编码</span><span lang=EN-US
  style='font-size:10.5pt'>/</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>解码器</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>DEFLATE<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>org.apache.hadoop.io.compress.DefaultCodec<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>gzip<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>org.apache.hadoop.io.compress.GzipCodec<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>bzip2<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>org.apache.hadoop.io.compress.BZip2Codec<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>LZO<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>com.hadoop.compression.lzo.LzopCodec<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=272 style='width:163.05pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>Snappy<o:p></o:p></span></p>
  </td>
  <td width=414 style='width:248.55pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>org.apache.hadoop.io.compress.SnappyCodec<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:16.5pt;mso-layout-grid-align:none;
punctuation-trim:leading'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>压缩性能的比较</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>表</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;
font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>4-9</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=133 valign=bottom style='width:79.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>压缩算法</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=bottom style='width:85.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>原始文件大小</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=bottom style='width:85.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>压缩文件大小</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=142 valign=bottom style='width:85.25pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>压缩速度</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=126 valign=bottom style='width:75.65pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>解压速度</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>gzip<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>8.3GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>1.8GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>17.5MB/s<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>58MB/s<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>bzip2<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>8.3GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>1.1GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>2.4MB/s<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>9.5MB/s<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=133 valign=top style='width:79.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>LZO<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>8.3GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>2.9GB<o:p></o:p></span></p>
  </td>
  <td width=142 valign=top style='width:85.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>49.3MB/s<o:p></o:p></span></p>
  </td>
  <td width=126 valign=top style='width:75.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>74.6MB/s<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><a href="http://google.github.io/snappy/">http://google.github.io/snappy/</a></span></p>

<p class=MsoNormal><span lang=EN-US>On a single core of a Core i7 processor in
64-bit mode, Snappy <span style='color:red'>compresses</span> at about <span
style='color:red'>250 MB/</span>sec or more and<span style='color:red'>
decompresses</span> at about<span style='color:red'> 500 MB</span>/sec or more.</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>压缩方式选择</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>4.3.1 Gzip</span><span style='font-size:
14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>压缩</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1100"
 type="#_x0000_t75" style='width:416.4pt;height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image316.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1100"
  DrawAspect="Content" ObjectID="_1629748284">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>4.3.2 Bzip2</span><span style='font-size:
14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>压缩</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1101"
 type="#_x0000_t75" style='width:412.2pt;height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image317.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1101"
  DrawAspect="Content" ObjectID="_1629748285">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>4.3.3 Lzo</span><span style='font-size:
14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>压缩</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1102"
 type="#_x0000_t75" style='width:416.4pt;height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image318.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1102"
  DrawAspect="Content" ObjectID="_1629748286">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt'>4.3.4 Snappy</span><span style='font-size:
14.0pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>压缩</span><span lang=EN-US style='font-size:14.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1103"
 type="#_x0000_t75" style='width:415.2pt;height:234pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image319.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1103"
  DrawAspect="Content" ObjectID="_1629748287">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_262" o:spid="_x0000_i1166" type="#_x0000_t75"
 style='width:542.4pt;height:109.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image320.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.4 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>压缩位置选择</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>压缩可以在</span><span lang=EN-US>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>作用的任意阶段启用，如图</span><span lang=EN-US>4-22</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1104"
 type="#_x0000_t75" style='width:412.2pt;height:233.4pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image321.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1104"
  DrawAspect="Content" ObjectID="_1629748288">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-22 MapReduce</span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据压缩</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.5 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>压缩参数配置</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>要在</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中启用压缩，可以配置如下参数：</span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt;
line-height:150%'><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>表</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'>4-10 </span><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>配置参数</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=213 valign=top style='width:127.6pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>参数</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=310 valign=top style='width:185.95pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>默认值</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>阶段</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=295 valign=top style='width:177.2pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>建议</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=213 valign=top style='width:127.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:red'>io.compression.codecs<span style='mso-spacerun:yes'>   </span><o:p></o:p></span></p>
  <p class=a0><span style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
  color:red'>（在</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.5pt;color:red'>core-site.xml</span><span style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;color:red'>中配置）</span><span lang=EN-US
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:red'><o:p></o:p></span></p>
  </td>
  <td width=310 valign=top style='width:185.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:red'>org.apache.hadoop.io.compress.DefaultCodec,
  org.apache.hadoop.io.compress.GzipCodec,
  org.apache.hadoop.io.compress.BZip2Codec<o:p></o:p></span></p>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:red'><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
  color:red'>输入压缩</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.5pt;color:red'><o:p></o:p></span></p>
  </td>
  <td width=295 valign=top style='width:177.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:red'>Hadoop</span><span style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
  color:red'>使用文件扩展名判断是否支持某种编解码器</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:red'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=213 valign=top style='width:127.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#00B0F0'>mapreduce.map.output.compress</span><span style='font-size:
  9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;color:#00B0F0'>（在</span><span lang=EN-US
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#00B0F0'>mapred-site.xml</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#00B0F0'>中配置）</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#00B0F0'><o:p></o:p></span></p>
  </td>
  <td width=310 valign=top style='width:185.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#00B0F0'>false<o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#00B0F0'>mapper</span><span style='font-size:9.0pt;mso-bidi-font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;color:#00B0F0'>输出</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#00B0F0'><o:p></o:p></span></p>
  </td>
  <td width=295 valign=top style='width:177.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
  color:#00B0F0'>这个参数设为</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#00B0F0'>true</span><span style='font-size:
  9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;color:#00B0F0'>启用压缩</span><span lang=EN-US
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#00B0F0'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=213 valign=top style='width:127.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#00B0F0'>mapreduce.map.output.compress.codec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#00B0F0'>（在</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#00B0F0'>mapred-site.xml</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#00B0F0'>中配置）</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#00B0F0'><o:p></o:p></span></p>
  </td>
  <td width=310 valign=top style='width:185.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#00B0F0'>org.apache.hadoop.io.compress.DefaultCodec<o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#00B0F0'>mapper</span><span style='font-size:9.0pt;mso-bidi-font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;color:#00B0F0'>输出</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#00B0F0'><o:p></o:p></span></p>
  </td>
  <td width=295 valign=top style='width:177.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
  color:#00B0F0'>企业多使用</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#00B0F0'>LZO</span><span style='font-size:
  9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;color:#00B0F0'>或</span><span lang=EN-US
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#00B0F0'>Snappy</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#00B0F0'>编解码器在此阶段压缩数据</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#00B0F0'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=213 valign=top style='width:127.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>mapreduce.output.fileoutputformat.compress</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#7030A0'>（在</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'>mapred-site.xml</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#7030A0'>中配置）</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'><o:p></o:p></span></p>
  </td>
  <td width=310 valign=top style='width:185.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>false<o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>reducer</span><span style='font-size:9.0pt;mso-bidi-font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;color:#7030A0'>输出</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#7030A0'><o:p></o:p></span></p>
  </td>
  <td width=295 valign=top style='width:177.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
  color:#7030A0'>这个参数设为</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#7030A0'>true</span><span style='font-size:
  9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;color:#7030A0'>启用压缩</span><span lang=EN-US
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=213 valign=top style='width:127.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>mapreduce.output.fileoutputformat.compress.codec</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#7030A0'>（在</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'>mapred-site.xml</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#7030A0'>中配置）</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'><o:p></o:p></span></p>
  </td>
  <td width=310 valign=top style='width:185.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>org.apache.hadoop.io.compress. DefaultCodec<o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>reducer</span><span style='font-size:9.0pt;mso-bidi-font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;color:#7030A0'>输出</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#7030A0'><o:p></o:p></span></p>
  </td>
  <td width=295 valign=top style='width:177.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;
  color:#7030A0'>使用标准工具或者编解码器，如</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#7030A0'>gzip</span><span style='font-size:
  9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri;color:#7030A0'>和</span><span lang=EN-US
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'>bzip2<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=213 valign=top style='width:127.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>mapreduce.output.fileoutputformat.compress.type</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#7030A0'>（在</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'>mapred-site.xml</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#7030A0'>中配置）</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'><o:p></o:p></span></p>
  </td>
  <td width=310 valign=top style='width:185.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>RECORD</span><span style='font-size:9.0pt;mso-bidi-font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;color:#7030A0'>（行压缩）</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#7030A0'><o:p></o:p></span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>reducer</span><span style='font-size:9.0pt;mso-bidi-font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;color:#7030A0'>输出</span><span lang=EN-US style='font-size:9.0pt;
  mso-bidi-font-size:10.5pt;color:#7030A0'><o:p></o:p></span></p>
  </td>
  <td width=295 valign=top style='width:177.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;
  color:#7030A0'>SequenceFile</span><span style='font-size:9.0pt;mso-bidi-font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri;color:#7030A0'>输出使用的压缩类型：</span><span lang=EN-US style='font-size:
  9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'>NONE</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#7030A0'>和</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'>BLOCK</span><span
  style='font-size:9.0pt;mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri;color:#7030A0'>（块压缩）</span><span
  lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.5pt;color:#7030A0'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><a name="_Toc439079703"><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>4.6
</span></a><span style='mso-bookmark:_Toc439079703'><span style='font-size:
14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>压缩实操案例</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:14.0pt;
line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>4.6.1 </span></span><span
style='mso-bookmark:_Toc439079703'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据流的压缩和解压缩</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US><v:shape id="_x0000_i1105" type="#_x0000_t75" style='width:417.6pt;
 height:235.2pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image322.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1105"
  DrawAspect="Content" ObjectID="_1629748289">
 </o:OLEObject>
</xml><![endif]--></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_263" o:spid="_x0000_i1165"
 type="#_x0000_t75" style='width:407.4pt;height:82.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image323.png" o:title=""/>
</v:shape></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_264" o:spid="_x0000_i1164"
 type="#_x0000_t75" style='width:396.6pt;height:88.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image324.png" o:title=""/>
</v:shape></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079703'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>测试一下如下压缩方式：</span></span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt;
line-height:150%'><span style='mso-bookmark:_Toc439079703'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>表</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;line-height:150%;font-family:"Arial","sans-serif";
mso-fareast-font-family:黑体;mso-bidi-font-family:"Times New Roman"'>4-11<o:p></o:p></span></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=319 style='width:191.4pt;border:solid windowtext 1.0pt;border-left:
  none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  mso-border-right-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>DEFLATE<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
  <td width=367 style='width:220.2pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>org.apache.hadoop.io.compress.DefaultCodec<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=319 style='width:191.4pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>gzip<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
  <td width=367 style='width:220.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>org.apache.hadoop.io.compress.GzipCodec<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes'>
  <td width=319 style='width:191.4pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>bzip2<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
  <td width=367 style='width:220.2pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>org.apache.hadoop.io.compress.BZip2Codec<o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
 </tr>
</table>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>package com.atguigu.mapreduce.compress;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import java.io.File;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import java.io.FileInputStream;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import java.io.FileNotFoundException;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import java.io.FileOutputStream;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import org.apache.hadoop.io.IOUtils;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import
org.apache.hadoop.io.compress.CompressionCodec;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import
org.apache.hadoop.io.compress.CompressionCodecFactory;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import
org.apache.hadoop.io.compress.CompressionInputStream;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import org.apache.hadoop.io.compress.CompressionOutputStream;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>import
org.apache.hadoop.util.ReflectionUtils;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>public class TestCompress {<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>public
static void <span style='color:red'>main</span>(String[] args) throws Exception
{<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>compress(&quot;e:/hello.txt&quot;,&quot;org.apache.hadoop.io.compress.BZip2Codec&quot;);<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>//<span style='mso-tab-count:2'>       </span>compress(&quot;e:/hello.txt&quot;,&quot;org.apache.hadoop.io.compress.GZip2Codec&quot;);<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>//<span style='mso-tab-count:2'>       </span>compress(&quot;e:/hello.txt&quot;,&quot;org.apache.hadoop.io.compress.DefaultCodec&quot;);<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>//<span style='mso-tab-count:2'>       </span>decompress(&quot;e:/hello.txt.bz2&quot;);<span
style='mso-spacerun:yes'>  </span>// </span></span><span style='mso-bookmark:
_Toc439079703'><span style='mso-bidi-font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>解压缩</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span><span
style='color:red'>// 1</span></span></span><span style='mso-bookmark:_Toc439079703'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:red'>、压缩</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>private
static void compress(String filename, String method) throws Exception {<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>//
</span></span><span style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></span><span
style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）获取输入流</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>FileInputStream
fis = new FileInputStream(new File(filename));<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>Class
codecClass = Class.forName(method);<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>CompressionCodec
codec = (CompressionCodec) ReflectionUtils.newInstance(codecClass, new
Configuration());<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>//
</span></span><span style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></span><span
style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）获取输出流</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>FileOutputStream
fos = new FileOutputStream(new File(filename + codec.getDefaultExtension()));<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>CompressionOutputStream
cos = codec.createOutputStream(fos);<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>//
</span></span><span style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></span><span
style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）流的对拷</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>IOUtils.copyBytes(fis,
cos, 1024*1024*5, false);<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>//
</span></span><span style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></span><span
style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）关闭资源</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>cos.close();<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>fos.close();<o:p></o:p></span></span></p>

<p class=a style='text-indent:32.0pt;mso-char-indent-count:4.0'><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'>fis.close();<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span><span
style='color:red'>// 2</span></span></span><span style='mso-bookmark:_Toc439079703'><span
style='mso-bidi-font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:red'>、解压缩</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>private
static void decompress(String filename) throws FileNotFoundException,
IOException {<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>//
</span></span><span style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>0</span></span><span
style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）校验是否能解压缩</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>CompressionCodecFactory
factory = new CompressionCodecFactory(new Configuration());<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>CompressionCodec
codec = factory.getCodec(new Path(filename));<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>if
(codec == null) {<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:3'>             </span>System.out.println(&quot;cannot
find codec for file &quot; + filename);<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:3'>             </span>return;<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>}<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>//
</span></span><span style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></span><span
style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）获取输入流</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>CompressionInputStream
cis = codec.createInputStream(new FileInputStream(new File(filename)));<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>//
</span></span><span style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></span><span
style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）获取输出流（后缀名自己定义）</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>FileOutputStream
fos = new FileOutputStream(new File(filename + &quot;.decoded&quot;));<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>//
</span></span><span style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></span><span
style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）流的对拷</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>IOUtils.copyBytes(cis,
fos, 1024*1024*5, false);<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>//
</span></span><span style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New"'>（</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></span><span
style='mso-bookmark:_Toc439079703'><span style='mso-bidi-font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>）关闭资源</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='mso-bidi-font-size:
10.5pt'><o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>cis.close();<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:2'>         </span>fos.close();<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'><span style='mso-tab-count:1'>    </span>}<o:p></o:p></span></span></p>

<p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-bidi-font-size:10.5pt'>}<o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="图片_x0020_265" o:spid="_x0000_i1163"
 type="#_x0000_t75" style='width:502.8pt;height:57.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image325.png" o:title=""/>
</v:shape></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>解压之后</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
style='mso-no-proof:yes'><v:shape id="图片_x0020_266" o:spid="_x0000_i1162"
 type="#_x0000_t75" style='width:285pt;height:127.8pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image326.png" o:title=""/>
</v:shape></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>4.6.2 Map</span></span><span
style='mso-bookmark:_Toc439079703'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>输出端采用压缩</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Toc439079703'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>即使你的</span><span
lang=EN-US>MapReduce</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的输入输出文件都是未压缩的文件，你仍然可以对</span><span lang=EN-US>Map</span></span><span
style='mso-bookmark:_Toc439079703'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>任务的中间结果输出做压缩，因为它要写在硬盘并且通过网络传输到</span><span
lang=EN-US>Reduce</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>节点，对其压缩可以提高很多性能，这些工作只要设置两个属性即可，我们来看下代码怎么设置。</span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079703'><span lang=EN-US>1</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．给大家提供的</span><span
lang=EN-US>Hadoop</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>源码支持的压缩格式有：</span><span
lang=EN-US style='color:red'>BZip2Codec </span></span><span style='mso-bookmark:
_Toc439079703'><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial;color:red'>、</span><span lang=EN-US
style='color:red'>DefaultCodec</span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=948
 style='width:568.7pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=948 valign=top style='width:568.7pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>package com.atguigu.mapreduce.compress;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.IntWritable;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.compress.BZip2Codec;<span
  style='mso-tab-count:1'>   </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import
  org.apache.hadoop.io.compress.CompressionCodec;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.compress.GzipCodec;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>public class WordCountDriver {<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>public
  static void main(String[] args) throws IOException, ClassNotFoundException,
  InterruptedException {<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
  configuration = new Configuration();<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='color:red'>// </span></span></span><span style='mso-bookmark:_Toc439079703'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>开启</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt;
  color:red'>map</span></span><span style='mso-bookmark:_Toc439079703'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>端输出压缩</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt;color:red'><span style='mso-tab-count:1'>   </span>configuration.setBoolean(&quot;mapreduce.map.output.compress&quot;,
  true);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>      </span>//
  </span></span><span style='mso-bookmark:_Toc439079703'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>设置</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt;
  color:red'>map</span></span><span style='mso-bookmark:_Toc439079703'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>端输出压缩方式</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt;color:red'><span style='mso-tab-count:1'>   </span>configuration.setClass(&quot;mapreduce.map.output.compress.codec&quot;,
  BZip2Codec.class, CompressionCodec.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job job =
  Job.getInstance(configuration);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setJarByClass(WordCountDriver.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(WordCountMapper.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setReducerClass(WordCountReducer.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(IntWritable.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputValueClass(IntWritable.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>boolean
  result = job.waitForCompletion(true);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>System.exit(result
  ? 1 : 0);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>}<o:p></o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US>MR</span></span><span
  style='mso-bookmark:_Toc439079703'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>的整个过程的结果，表面是看不到压缩的，因为压缩不影响</span><span
  lang=EN-US>Reduce</span></span><span style='mso-bookmark:_Toc439079703'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>，只是减少</span><span lang=EN-US>IO</span></span><span
  style='mso-bookmark:_Toc439079703'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>的传输</span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_267" o:spid="_x0000_i1161"
   type="#_x0000_t75" style='width:255.6pt;height:165.6pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image327.png" o:title=""/>
  </v:shape></span></span></p>
  <span style='mso-bookmark:_Toc439079703'></span>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079703'><span lang=EN-US>2</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Mapper</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>保持不变</span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=948
 style='width:568.7pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=948 valign=top style='width:568.7pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>package com.atguigu.mapreduce.compress;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.IntWritable;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>public class WordCountMapper extends
  Mapper&lt;LongWritable, Text, Text, IntWritable&gt;{<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='text-indent:21.0pt;mso-char-indent-count:2.0'><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt'>Text
  k = new Text();<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>IntWritable v
  = new IntWritable(1);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>@Override<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>protected
  void map(LongWritable key, Text value, Context context)throws IOException,
  InterruptedException {<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>// 1 </span></span><span
  style='mso-bookmark:_Toc439079703'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>获取一行</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String
  line = value.toString();<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>// 2 </span></span><span
  style='mso-bookmark:_Toc439079703'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>切割</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>String[]
  words = line.split(&quot; &quot;);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>// 3 </span></span><span
  style='mso-bookmark:_Toc439079703'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>循环写出</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>for(String
  word:words){<o:p></o:p></span></span></p>
  <p class=a style='text-indent:63.0pt;mso-char-indent-count:6.0'><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt'>k.set(word);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>context.write(k,
  v);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:_Toc439079703'><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079703'><span lang=EN-US>3</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Reducer</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>保持不变</span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>package com.atguigu.mapreduce.compress;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.IntWritable;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>public class WordCountReducer extends
  Reducer&lt;Text, IntWritable, Text, IntWritable&gt;{<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>IntWritable v
  = new IntWritable();<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>@Override<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>protected
  void reduce(Text key, Iterable&lt;IntWritable&gt; values,<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>Context
  context) throws IOException, InterruptedException {<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>int sum =
  0;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>// 1 </span></span><span
  style='mso-bookmark:_Toc439079703'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>汇总</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>for(IntWritable
  value:values){<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:3'>          </span>sum
  += value.get();<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-spacerun:yes'>        </span>v.set(sum);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-spacerun:yes'>        </span>// 2 </span></span><span
  style='mso-bookmark:_Toc439079703'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输出</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>context.write(key,
  v);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:_Toc439079703'><span
  lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
 </tr>
</table>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'>4.6.3 Reduce</span></span><span
style='mso-bookmark:_Toc439079703'><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>输出端采用压缩</span></span><span style='mso-bookmark:_Toc439079703'><span
lang=EN-US style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bookmark:_Toc439079703'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>基于</span><span lang=EN-US>WordCount</span></span><span
style='mso-bookmark:_Toc439079703'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例处理。</span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079703'><span lang=EN-US>1</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．修改驱动</span></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>package com.atguigu.mapreduce.compress;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.IntWritable;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.compress.BZip2Codec;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.compress.DefaultCodec;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.compress.GzipCodec;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.compress.Lz4Codec;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.io.compress.SnappyCodec;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>public class WordCountDriver {<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>public
  static void main(String[] args) throws IOException, ClassNotFoundException,
  InterruptedException {<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
  configuration = new Configuration();<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job job =
  Job.getInstance(configuration);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setJarByClass(WordCountDriver.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(WordCountMapper.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setReducerClass(WordCountReducer.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(IntWritable.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputValueClass(IntWritable.class);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='color:red'>// </span></span></span><span style='mso-bookmark:_Toc439079703'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>设置</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt;
  color:red'>reduce</span></span><span style='mso-bookmark:_Toc439079703'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>端输出压缩开启</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt;color:red'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setCompressOutput(job,
  true);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><span
  style='color:red'>// </span></span></span><span style='mso-bookmark:_Toc439079703'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>设置压缩的方式</span></span><span
  style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt;color:red'><span style='mso-tab-count:1'>   </span><span
  style='mso-spacerun:yes'>   
  </span>FileOutputFormat.setOutputCompressorClass(job, BZip2Codec.class); <o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>//<span style='mso-tab-count:1'> </span><span
  style='mso-spacerun:yes'>   
  </span>FileOutputFormat.setOutputCompressorClass(job, GzipCodec.class); <o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>//<span style='mso-tab-count:1'> </span><span
  style='mso-spacerun:yes'>   
  </span>FileOutputFormat.setOutputCompressorClass(job, DefaultCodec.class); <o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span><span
  style='mso-spacerun:yes'>    </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>boolean
  result = job.waitForCompletion(true);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>System.exit(result?1:0);<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'><span style='mso-tab-count:1'>   </span>}<o:p></o:p></span></span></p>
  <p class=a><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='font-size:10.5pt'>}<o:p></o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></p>
  <p class=MsoNormal><span style='mso-bookmark:_Toc439079703'><span lang=EN-US
  style='mso-no-proof:yes'><v:shape id="图片_x0020_268" o:spid="_x0000_i1160"
   type="#_x0000_t75" style='width:211.8pt;height:135.6pt;visibility:visible;
   mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image328.png" o:title=""/>
  </v:shape></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc439079703'></span>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Toc439079703'><span lang=EN-US>2</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Mapper</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>和</span><span
lang=EN-US>Reducer</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>保持不变（<span
style='color:red;background:yellow;mso-highlight:yellow'>详见</span></span><span
lang=EN-US style='color:red;background:yellow;mso-highlight:yellow'>4.6.2</span></span><span
style='mso-bookmark:_Toc439079703'><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>）</span></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='mso-bookmark:_Toc439079703'><span
style='font-size:15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>第</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:15.0pt;
line-height:240%'>5</span></span><span style='mso-bookmark:_Toc439079703'><span
style='font-size:15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>章</span></span><span
style='mso-bookmark:_Toc439079703'><span style='font-size:15.0pt;line-height:
240%'> <span lang=EN-US>Yarn</span></span></span><span style='mso-bookmark:
_Toc439079703'><span style='font-size:15.0pt;line-height:240%;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>资源调度器</span></span><span
style='mso-bookmark:_Toc439079703'><span lang=EN-US style='font-size:15.0pt;
line-height:240%'><o:p></o:p></span></span></h1>

<span style='mso-bookmark:_Toc439079703'></span>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:red'>Yarn</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是一个资源调度平台，负责为运算程序提供服务器运算资源，相当于一个分布式的<span
style='color:red'>操作系统平台</span>，而</span><span lang=EN-US style='color:red'>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>等运算程序则相当于运行于<span style='color:red'>操作系统之上的应用程序</span>。</span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>5.1 Yarn</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>基本架构</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>&nbsp;<span
style='mso-tab-count:1'>      </span>YARN</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>主要由</span><span lang=EN-US style='color:black'>ResourceManager</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>、</span><span lang=EN-US style='color:black'>NodeManager</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>、</span><span lang=EN-US style='color:black'>ApplicationMaster</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>和</span><span lang=EN-US style='color:black'>Container</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>等组件构成，如图</span><span lang=EN-US
style='color:black'>4-23</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>所示。</span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='font-family:"Times New Roman","serif"'><v:shape id="_x0000_i1106"
 type="#_x0000_t75" style='width:559.8pt;height:316.2pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image329.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1106"
  DrawAspect="Content" ObjectID="_1629748291">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=1 align=center style='text-align:center;text-indent:0cm;mso-char-indent-count:
0;line-height:150%'><span style='font-size:9.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-23 Yarn</span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>基本架构</span><span lang=EN-US
style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_269"
 o:spid="_x0000_i1159" type="#_x0000_t75" style='width:328.2pt;height:117pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image330.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_270"
 o:spid="_x0000_i1158" type="#_x0000_t75" style='width:270pt;height:102pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image331.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><a name="_Toc439079706"><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>5.3
Yarn</span></a><span style='mso-bookmark:_Toc439079706'></span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>工作机制</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．</span><span
lang=EN-US>Yarn</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>运行机制，如图</span><span lang=EN-US>4-24</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>所示。</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'><v:shape id="_x0000_i1107"
 type="#_x0000_t75" style='width:561pt;height:316.8pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image332.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1107"
  DrawAspect="Content" ObjectID="_1629748292">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>图</span><span lang=EN-US>4-24 <span
style='mso-spacerun:yes'> </span>Yarn</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>工作机制</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_271"
 o:spid="_x0000_i1157" type="#_x0000_t75" style='width:301.2pt;height:129.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image333.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_272"
 o:spid="_x0000_i1156" type="#_x0000_t75" style='width:225.6pt;height:141pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image334.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_273"
 o:spid="_x0000_i1155" type="#_x0000_t75" style='width:257.4pt;height:106.8pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image335.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．工作机制详解</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>MR</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>程序提交到客户端所在的节点。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>YarnRunner</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>向</span><span lang=EN-US style='color:black'>ResourceManager</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>申请一个</span><span lang=EN-US style='color:black'>Application</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>RM</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>将该应用程序的资源路径返回给</span><span lang=EN-US
style='color:black'>YarnRunner</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）该程序将运行所需资源提交到</span><span lang=EN-US
style='color:black'>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>上。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）程序资源提交完毕后，申请运行</span><span lang=EN-US
style='color:black'>mrAppMaster</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>RM</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>将用户的请求初始化成一个</span><span lang=EN-US
style='color:black'>Task</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>7</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）其中一个</span><span lang=EN-US style='color:black'>NodeManager</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>领取到</span><span lang=EN-US style='color:black'>Task</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>任务。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>8</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）该</span><span lang=EN-US style='color:black'>NodeManager</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>创建容器</span><span lang=EN-US style='color:black'>Container</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>，并产生</span><span lang=EN-US style='color:black'>MRAppmaster</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>9</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>Container</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>从</span><span lang=EN-US style='color:black'>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>上拷贝资源到本地。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>10</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>MRAppmaster</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>向</span><span lang=EN-US style='color:black'>RM </span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>申请运行</span><span lang=EN-US style='color:black'>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>资源。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>11</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>RM</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>将运行</span><span lang=EN-US style='color:black'>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>任务分配给另外两个</span><span lang=EN-US
style='color:black'>NodeManager</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>，另两个</span><span
lang=EN-US style='color:black'>NodeManager</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>分别领取任务并创建容器。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>12</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>MR</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>向两个接收到任务的</span><span lang=EN-US
style='color:black'>NodeManager</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>发送程序启动脚本，这两个</span><span
lang=EN-US style='color:black'>NodeManager</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>分别启动</span><span lang=EN-US style='color:black'>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>，</span><span lang=EN-US style='color:black'>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>对数据分区排序。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（</span><span lang=EN-US style='color:black'>13</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>MrAppMaster</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>等待所有</span><span lang=EN-US style='color:black'>MapTask</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>运行完毕后，向</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>RM</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>申请容器，运行</span><span lang=EN-US style='color:black'>ReduceTask</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>14</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）</span><span lang=EN-US style='color:black'>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>向</span><span lang=EN-US style='color:black'>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>获取相应分区的数据。</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><span
style='mso-tab-count:1'>       </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（</span><span lang=EN-US style='color:black'>15</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>）程序运行完毕后，</span><span lang=EN-US
style='color:black'>MR</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>会向</span><span
lang=EN-US style='color:black'>RM</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>申请注销自己。</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>5.4 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>作业提交全过程</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．作业提交过程之</span><span
lang=EN-US>YARN</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>，如图</span><span lang=EN-US>4-25</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>所示。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1108" type="#_x0000_t75" style='width:558pt;height:315.6pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image332.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1108"
  DrawAspect="Content" ObjectID="_1629748293">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-25 </span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>作业提交过程之</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>Yarn<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_274"
 o:spid="_x0000_i1154" type="#_x0000_t75" style='width:538.2pt;height:303.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image336.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_275"
 o:spid="_x0000_i1153" type="#_x0000_t75" style='width:567pt;height:325.2pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image337.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>联系一起，下图就是</span><span lang=EN-US>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>过程的详情。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_276"
 o:spid="_x0000_i1152" type="#_x0000_t75" style='width:567pt;height:324pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image338.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>作业提交全过程详解</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>1</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>）作业提交</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>1</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Client</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>调用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>job.waitForCompletion</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>方法，向整个集群提交</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>MapReduce</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>作业。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>2</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Client</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>向</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>RM</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>申请一个作业</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>id</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>3</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>RM</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>给</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>Client</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>返回该</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>job</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>资源的提交路径和作业</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>id</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>4</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Client</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>提交</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>jar</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>包、切片信息和配置文件到指定的资源提交路径。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>5</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Client</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>提交完资源后，向</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>RM</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>申请运行</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>MrAppMaster</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>2</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>）作业初始化</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>6</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：当</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>RM</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>收到</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>Client</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>的请求后，将该</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>job</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>添加到容量调度器中。</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>7</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：某一个空闲的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>NM</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>领取到该</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>Job</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>8</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：该</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>NM</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>创建</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>Container</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>，</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>并产生</span><span
lang=EN-US style='color:black'>MRAppmaster</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>9</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：下载</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>Client</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>提交的资源到本地。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>3</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>）任务分配</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>10</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>MrAppMaster</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>向</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>RM</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>申请运行多个</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>MapTask</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>任务资源。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>11</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='color:black'>RM</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>将运行</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>MapTask</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>任务分配给另外两个</span><span
lang=EN-US style='color:black'>NodeManager</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>，另两个</span><span lang=EN-US style='color:black'>NodeManager</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>分别领取任务并创建容器。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>4</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>）任务运行</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>12</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='color:black'>MR</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>向两个接收到任务的</span><span
lang=EN-US style='color:black'>NodeManager</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>发送程序启动脚本，这两个</span><span lang=EN-US style='color:black'>NodeManager</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>分别启动</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>，</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>MapTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>对数据分区排序。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>13</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>MrAppMaster</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>等待所有</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>MapTask</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>运行完毕后，向</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>RM</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>申请容器，运行</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>ReduceTask</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>14</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>ReduceTask</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>向</span><span
lang=EN-US style='color:black'>MapTask</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>获取相应分区的数据。</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>第</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>15</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>步：</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>程序运行完毕后，</span><span lang=EN-US
style='color:black'>MR</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>会向</span><span
lang=EN-US style='color:black'>RM</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>申请注销自己。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>5</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>）进度和状态更新</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>YARN</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>中的任务将其进度和状态</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>(</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>包括</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'>counter)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>返回给应用管理器</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>, </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>客户端每秒</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>(</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>mapreduce.client.progressmonitor.pollinterval</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>设置</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>)</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>向应用管理器请求进度更新</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>, </span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black;background:white'>展示给用户。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>（</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>6</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>）作业完成</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>除了向应用管理器请求作业进度外</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>, </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>客户端每</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>5</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>秒都会通过调用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>waitForCompletion()</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>来检查作业是否完成。时间间隔可以通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;
background:white'>mapreduce.client.completion.pollinterval</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>来设置。作业完成之后</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'>, </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>应用管理器和</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%;color:black;background:white'>Container</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>会清理工作状态。作业的信息会被作业历史服务器存储以备之后用户核查。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;color:black;background:white'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．作业提交过程之</span><span
lang=EN-US>MapReduce</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>，如图</span><span lang=EN-US>4-26</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>所示</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><v:shape
 id="_x0000_i1109" type="#_x0000_t75" style='width:557.4pt;height:314.4pt'
 o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image339.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1109"
  DrawAspect="Content" ObjectID="_1629748294">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-26 </span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>作业提交过程之</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>MapReduce</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>5.5 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>资源调度器</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>目前，</span><span lang=EN-US style='color:black'>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>作业调度器主要有三种：</span><span lang=EN-US
style='color:black'>FIFO</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>、</span><span
lang=EN-US style='color:black'>Capacity Scheduler</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>（容量调度器）和</span><span lang=EN-US style='color:black'>Fair Scheduler</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>（公平调度器）。</span><span lang=EN-US
style='color:black'>Hadoop2.7.2</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>默认的资源调度器是</span><span
lang=EN-US style='color:black'>Capacity Scheduler</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:black'>。</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";color:black'>具体设置详见：</span><span lang=EN-US style='color:
black'>yarn-default.xml</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black'>文件</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;line-height:
16.5pt'><span lang=EN-US style='font-size:10.5pt'>&lt;property&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;line-height:
16.5pt'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-spacerun:yes'>    </span>&lt;description&gt;The class to use as the
resource scheduler.&lt;/description&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;line-height:
16.5pt'><span lang=EN-US style='font-size:10.5pt'><span
style='mso-spacerun:yes'>   
</span>&lt;name&gt;yarn.resourcemanager.scheduler.class&lt;/name&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;line-height:
16.5pt'><span lang=EN-US style='font-size:10.5pt'>&lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler&lt;/value&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd;line-height:
16.5pt'><span lang=EN-US style='font-size:10.5pt'>&lt;/property&gt;<o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．先进先出调度器（</span><span
lang=EN-US>FIFO</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>），如图</span><span lang=EN-US>4-27</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>所示</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
lang=EN-US style='color:black'><v:shape id="_x0000_i1110" type="#_x0000_t75"
 style='width:463.8pt;height:261.6pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image340.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1110"
  DrawAspect="Content" ObjectID="_1629748295">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-27 FIFO</span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>调度器</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．容量调度器（</span><span
lang=EN-US>Capacity Scheduler</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>），如图</span><span lang=EN-US>4-28</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>所示</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
lang=EN-US style='color:black'><v:shape id="_x0000_i1111" type="#_x0000_t75"
 style='width:466.8pt;height:264pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image341.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1111"
  DrawAspect="Content" ObjectID="_1629748296">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-28</span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>容量调度器</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_277"
 o:spid="_x0000_i1151" type="#_x0000_t75" style='width:433.8pt;height:191.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image342.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US
style='background:white'>3</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial;background:white'>．公平调度器（</span><span
lang=EN-US style='background:white'>Fair Scheduler</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial;
background:white'>），如图</span><span lang=EN-US style='background:white'>4-29</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial;
background:white'>所示</span><span lang=EN-US style='background:white'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:black;background:white'><v:shape id="_x0000_i1112"
 type="#_x0000_t75" style='width:480pt;height:270.6pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image343.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1112"
  DrawAspect="Content" ObjectID="_1629748297">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-29</span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>公平调度器</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_278"
 o:spid="_x0000_i1150" type="#_x0000_t75" style='width:403.2pt;height:203.4pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image344.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_279"
 o:spid="_x0000_i1149" type="#_x0000_t75" style='width:400.8pt;height:189.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image345.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>5.6 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>任务的推测执行</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．作业完成时间取决于最慢的任务完成时间</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>一个作业由若干个</span><span lang=EN-US>Map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>任务和</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>任务构成。因硬件老化、软件</span><span lang=EN-US>Bug</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>等，某些任务可能运行非常慢。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>思考：系统中有</span><span lang=EN-US>99%</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span><span lang=EN-US>Map</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>任务都完成了，只有少数几个</span><span
lang=EN-US>Map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>老是进度很慢，完不成，怎么办？</span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．推测执行机制</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>发现拖后腿的任务，比如某个任务运行速度远慢于任务平均速度。为拖后腿任务启动一个备份任务，同时运行。谁先运行完，则采用谁的结果。</span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．执行推测任务的前提条件</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）每个</span><span
lang=EN-US>Task</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>只能有一个备份任务</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）当前</span><span
lang=EN-US>Job</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>已完成的</span><span lang=EN-US>Task</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>必须不小于</span><span lang=EN-US>0.05</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>5%</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-size:10.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";color:black;
background:white'>（</span><span lang=EN-US style='font-size:10.0pt;line-height:
150%;color:black;background:white'>3</span><span style='font-size:10.0pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";color:black;background:white'>）</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>开启推测执行参数设置。</span><span lang=EN-US>mapred-site.xml</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件中默认是打开的。</span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'>&lt;property&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>  </span>&lt;name&gt;mapreduce.map.speculative&lt;/name&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>  </span>&lt;value&gt;true&lt;/value&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>  </span>&lt;description&gt;If true, then multiple
instances of some map tasks may be executed in parallel.&lt;/description&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'>&lt;/property&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'>&lt;property&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>  </span>&lt;name&gt;mapreduce.reduce.speculative&lt;/name&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>  </span>&lt;value&gt;true&lt;/value&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>  </span>&lt;description&gt;If true, then multiple
instances of some reduce tasks may be executed in parallel.&lt;/description&gt;<o:p></o:p></span></p>

<p class=a style='margin-left:21.0pt;mso-para-margin-left:2.0gd'><span
lang=EN-US style='font-size:10.5pt'>&lt;/property&gt;<o:p></o:p></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．不能启用推测执行机制情况</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-spacerun:yes'>   </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）任务间存在严重的负载倾斜；</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><span
style='mso-spacerun:yes'>   </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>）特殊任务，比如任务向数据库中写数据。</span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>5</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．算法原理，如图</span><span
lang=EN-US>4-20</span><span style='font-family:黑体;mso-ascii-font-family:Arial;
mso-hansi-font-family:Arial'>所示</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1113"
 type="#_x0000_t75" style='width:537pt;height:303pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image346.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1113"
  DrawAspect="Content" ObjectID="_1629748298">
  <o:WordFieldCodes>\* MERGEFORMAT</o:WordFieldCodes>
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'>4-30 </span><span
style='font-size:9.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>推测执行算法原理</span><span
lang=EN-US style='font-size:9.0pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_282"
 o:spid="_x0000_i1148" type="#_x0000_t75" style='width:566.4pt;height:321pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image347.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>6</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> <span lang=EN-US>Hadoop</span></span><span style='font-size:
15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>企业优化</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>6.1 MapReduce </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>跑的慢的原因</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1114"
 type="#_x0000_t75" style='width:407.4pt;height:230.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image348.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1114"
  DrawAspect="Content" ObjectID="_1629748299">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>分析</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_283" o:spid="_x0000_i1147" type="#_x0000_t75"
 style='width:286.8pt;height:43.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image349.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:150%'><span lang=EN-US
style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'>6.2
MapReduce</span><span style='font-size:14.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>优化方法</span><span
lang=EN-US style='font-size:14.0pt;line-height:150%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>MapReduce</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>优化方法主要从六个方面考虑：数据输入、</span><span
lang=EN-US>Map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>阶段、</span><span lang=EN-US>Reduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>阶段、</span><span lang=EN-US>IO</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>传输、数据倾斜问题和常用的调优参数。</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.2.1 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据输入</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1115"
 type="#_x0000_t75" style='width:411pt;height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image350.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1115"
  DrawAspect="Content" ObjectID="_1629748300">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.2.2 Map</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>阶段</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US><v:shape id="_x0000_i1116" type="#_x0000_t75" style='width:411pt;
 height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image351.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1116"
  DrawAspect="Content" ObjectID="_1629748301">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></b></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分析</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_284" o:spid="_x0000_i1146" type="#_x0000_t75"
 style='width:396pt;height:68.4pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image352.png" o:title=""/>
</v:shape></span><b style='mso-bidi-font-weight:normal'><span lang=EN-US><o:p></o:p></span></b></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US><o:p>&nbsp;</o:p></span></b></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.2.3 Reduce</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>阶段</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US><v:shape id="_x0000_i1117" type="#_x0000_t75" style='width:411pt;
 height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image353.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1117"
  DrawAspect="Content" ObjectID="_1629748302">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></b></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分析</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><v:shape id="图片_x0020_285" o:spid="_x0000_i1145" type="#_x0000_t75"
 style='width:421.8pt;height:88.8pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image354.png" o:title=""/>
</v:shape></span><b style='mso-bidi-font-weight:normal'><span lang=EN-US><o:p></o:p></span></b></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US><v:shape id="_x0000_i1118"
 type="#_x0000_t75" style='width:408.6pt;height:231pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image355.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1118"
  DrawAspect="Content" ObjectID="_1629748303">
 </o:OLEObject>
</xml><![endif]--></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.2.4 I/O</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>传输</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal align=left style='text-align:left;mso-pagination:widow-orphan;
background:white'><b style='mso-bidi-font-weight:normal'><span lang=EN-US><v:shape
 id="_x0000_i1119" type="#_x0000_t75" style='width:407.4pt;height:230.4pt'
 o:ole="">
 <img src="Hadoop_03MapReduce.files/image356.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1119"
  DrawAspect="Content" ObjectID="_1629748304">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></b></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.2.5 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>数据倾斜问题</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US><v:shape id="_x0000_i1120" type="#_x0000_t75"
 style='width:405pt;height:229.2pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image357.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1120"
  DrawAspect="Content" ObjectID="_1629748305">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal><span lang=EN-US><v:shape id="_x0000_i1121" type="#_x0000_t75"
 style='width:403.8pt;height:229.2pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image358.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1121"
  DrawAspect="Content" ObjectID="_1629748306">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>分析</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_286"
 o:spid="_x0000_i1144" type="#_x0000_t75" style='width:385.2pt;height:57.6pt;
 visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image359.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.2.6 </span><span style='font-size:14.0pt;line-height:
172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>常用的调优参数</span><span lang=EN-US style='font-size:14.0pt;
line-height:172%'><o:p></o:p></span></h3>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．资源相关参数</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）以下参数是在用户自己的</span><span
lang=EN-US>MR</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>应用程序中配置就可以生效（</span><span lang=EN-US>mapred-default.xml</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt;
line-height:150%'><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>表</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'>4-12<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;mso-border-insideh:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=341 valign=top style='width:204.3pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>配置参数</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=584 valign=top style='width:350.25pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>参数说明</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=341 valign=top style='width:204.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.map.memory.mb<o:p></o:p></span></p>
  </td>
  <td width=584 valign=top style='width:350.25pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>一个</span><span lang=EN-US
  style='font-size:10.5pt'>MapTask</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>可使用的资源上限（单位</span><span
  lang=EN-US style='font-size:10.5pt'>:MB</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>），默认为</span><span
  lang=EN-US style='font-size:10.5pt'>1024</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>。如果</span><span
  lang=EN-US style='font-size:10.5pt'>MapTask</span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>实际使用的资源量超过该值，则会被强制杀死。</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=341 valign=top style='width:204.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.reduce.memory.mb<o:p></o:p></span></p>
  </td>
  <td width=584 valign=top style='width:350.25pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>一个</span><span lang=EN-US
  style='font-size:10.5pt'>ReduceTask</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>可使用的资源上限（单位</span><span
  lang=EN-US style='font-size:10.5pt'>:MB</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>），默认为</span><span
  lang=EN-US style='font-size:10.5pt'>1024</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>。如果</span><span
  lang=EN-US style='font-size:10.5pt'>ReduceTask</span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>实际使用的资源量超过该值，则会被强制杀死。</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=341 valign=top style='width:204.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.map.cpu.vcores<o:p></o:p></span></p>
  </td>
  <td width=584 valign=top style='width:350.25pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>每个</span><span lang=EN-US
  style='font-size:10.5pt'>MapTask</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>可使用的最多</span><span
  lang=EN-US style='font-size:10.5pt'>cpu core</span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>数目，默认值</span><span lang=EN-US style='font-size:10.5pt'>: 1<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=341 valign=top style='width:204.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.reduce.cpu.vcores<o:p></o:p></span></p>
  </td>
  <td width=584 valign=top style='width:350.25pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>每个</span><span lang=EN-US
  style='font-size:10.5pt'>ReduceTask</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>可使用的最多</span><span
  lang=EN-US style='font-size:10.5pt'>cpu core</span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>数目，默认值</span><span lang=EN-US style='font-size:10.5pt'>: 1<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=341 valign=top style='width:204.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.reduce.shuffle.parallelcopies<o:p></o:p></span></p>
  </td>
  <td width=584 valign=top style='width:350.25pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>每个</span><span lang=EN-US
  style='font-size:10.5pt'>Reduce</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>去</span><span
  lang=EN-US style='font-size:10.5pt'>Map</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>中取数据的并行数。默认值是</span><span
  lang=EN-US style='font-size:10.5pt'>5<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=341 valign=top style='width:204.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.reduce.shuffle.merge.percent<o:p></o:p></span></p>
  </td>
  <td width=584 valign=top style='width:350.25pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>Buffer</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>中的数据达到多少比例开始写入磁盘。默认值</span><span lang=EN-US
  style='font-size:10.5pt'>0.66<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=341 valign=top style='width:204.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.reduce.shuffle.input.buffer.percent<o:p></o:p></span></p>
  </td>
  <td width=584 valign=top style='width:350.25pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>Buffer</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>大小占</span><span lang=EN-US style='font-size:
  10.5pt'>Reduce</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>可用内存的比例。默认值</span><span lang=EN-US
  style='font-size:10.5pt'>0.7<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;mso-yfti-lastrow:yes'>
  <td width=341 valign=top style='width:204.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.reduce.input.buffer.percent<o:p></o:p></span></p>
  </td>
  <td width=584 valign=top style='width:350.25pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>指定多少比例的内存用来存放</span><span lang=EN-US
  style='font-size:10.5pt'>Buffer</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>中的数据，默认值是</span><span
  lang=EN-US style='font-size:10.5pt'>0.0<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）应该在</span><span
lang=EN-US>YARN</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>启动之前就配置在服务器的配置文件中才能生效（</span><span
lang=EN-US>yarn-default.xml</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt;
line-height:150%'><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>表</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'>4-13<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=924
 style='width:554.55pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=345 valign=top style='width:207.25pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>配置参数</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=579 valign=top style='width:347.3pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>参数说明</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>yarn.scheduler.minimum-allocation-mb<span
  style='mso-tab-count:1'>       </span><span style='mso-spacerun:yes'> 
  </span><o:p></o:p></span></p>
  </td>
  <td width=579 valign=top style='width:347.3pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>给应用程序</span><span lang=EN-US
  style='font-size:10.5pt'>Container</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>分配的最小内存，默认值：</span><span
  lang=EN-US style='font-size:10.5pt'>1024<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>yarn.scheduler.maximum-allocation-mb<span
  style='mso-tab-count:1'>      </span><span style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>
  </td>
  <td width=579 valign=top style='width:347.3pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>给应用程序</span><span lang=EN-US
  style='font-size:10.5pt'>Container</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>分配的最大内存，默认值：</span><span
  lang=EN-US style='font-size:10.5pt'>8192<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>yarn.scheduler.minimum-allocation-vcores<span
  style='mso-tab-count:1'> </span><o:p></o:p></span></p>
  </td>
  <td width=579 valign=top style='width:347.3pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>每个</span><span lang=EN-US
  style='font-size:10.5pt'>Container</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>申请的最小</span><span
  lang=EN-US style='font-size:10.5pt'>CPU</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>核数，默认值：</span><span
  lang=EN-US style='font-size:10.5pt'>1<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;height:4.5pt'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:4.5pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>yarn.scheduler.maximum-allocation-vcores<span
  style='mso-tab-count:1'>         </span><o:p></o:p></span></p>
  </td>
  <td width=579 valign=top style='width:347.3pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt;
  height:4.5pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>每个</span><span lang=EN-US
  style='font-size:10.5pt'>Container</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>申请的最大</span><span
  lang=EN-US style='font-size:10.5pt'>CPU</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>核数，默认值：</span><span
  lang=EN-US style='font-size:10.5pt'>32<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>yarn.nodemanager.resource.memory-mb<span
  style='mso-spacerun:yes'>   </span><o:p></o:p></span></p>
  </td>
  <td width=579 valign=top style='width:347.3pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>给</span><span lang=EN-US
  style='font-size:10.5pt'>Containers</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>分配的最大物理内存，默认值：</span><span
  lang=EN-US style='font-size:10.5pt'>8192<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US>Shuffle</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>性能优化的关键参数，应在</span><span
lang=EN-US>YARN</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>启动之前就配置好（</span><span lang=EN-US>mapred-default.xml</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span></p>

<p class=MsoNormal align=center style='margin-left:21.0pt;text-align:center;
line-height:150%'><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:
Arial'>表</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
line-height:150%;font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;
mso-bidi-font-family:"Times New Roman"'>4-14</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=924
 style='width:554.55pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=345 valign=top style='width:207.25pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>配置参数</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=579 valign=top style='width:347.3pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>参数说明</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.task.io.sort.mb<span
  style='mso-spacerun:yes'>   </span><o:p></o:p></span></p>
  </td>
  <td width=579 valign=top style='width:347.3pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>Shuffle</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>的环形缓冲区大小，默认</span><span lang=EN-US
  style='font-size:10.5pt'>100m<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes'>
  <td width=345 valign=top style='width:207.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.map.sort.spill.percent<span
  style='mso-spacerun:yes'>   </span><o:p></o:p></span></p>
  </td>
  <td width=579 valign=top style='width:347.3pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>环形缓冲区溢出的阈值，默认</span><span lang=EN-US
  style='font-size:10.5pt'>80%<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．容错相关参数</span><span
lang=EN-US>(MapReduce</span><span style='font-family:黑体;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial'>性能优化</span><span lang=EN-US>)</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>表</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;
font-family:"Arial","sans-serif";mso-fareast-font-family:黑体;mso-bidi-font-family:
"Times New Roman"'>4-15</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=263 valign=top style='width:157.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-top-alt:solid windowtext .5pt;mso-border-bottom-alt:
  solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>配置参数</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
  <td width=673 valign=top style='width:403.95pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>参数说明</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=263 valign=top style='width:157.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.map.maxattempts<o:p></o:p></span></p>
  </td>
  <td width=673 valign=top style='width:403.95pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>每个</span><span lang=EN-US
  style='font-size:10.5pt'>Map Task</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>最大重试次数，一旦重试参数超过该值，则认为</span><span
  lang=EN-US style='font-size:10.5pt'>Map Task</span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>运行失败，默认值：</span><span lang=EN-US style='font-size:10.5pt'>4</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>。</span><span lang=EN-US style='font-size:
  10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=263 valign=top style='width:157.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.reduce.maxattempts<o:p></o:p></span></p>
  </td>
  <td width=673 valign=top style='width:403.95pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  Calibri;mso-hansi-font-family:Calibri'>每个</span><span lang=EN-US
  style='font-size:10.5pt'>Reduce Task</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>最大重试次数，一旦重试参数超过该值，则认为</span><span
  lang=EN-US style='font-size:10.5pt'>Map Task</span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:
  Calibri'>运行失败，默认值：</span><span lang=EN-US style='font-size:10.5pt'>4</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>。</span><span lang=EN-US style='font-size:
  10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=263 valign=top style='width:157.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;mso-border-right-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>mapreduce.task.timeout<o:p></o:p></span></p>
  </td>
  <td width=673 valign=top style='width:403.95pt;border:none;border-bottom:
  solid windowtext 1.0pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:
  solid windowtext .5pt;mso-border-bottom-alt:solid windowtext .5pt;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=a0><span lang=EN-US style='font-size:10.5pt'>Task</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>超时时间，经常需要设置的一个参数，该参数表达的意思为：如果一个</span><span
  lang=EN-US style='font-size:10.5pt'>Task</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>在一定时间内没有任何进入，即不会读取新的数据，也没有输出数据，则认为该</span><span
  lang=EN-US style='font-size:10.5pt'>Task</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>处于</span><span
  lang=EN-US style='font-size:10.5pt'>Block</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>状态，可能是卡住了，也许永远会卡住，为了防止因为用户程序永远</span><span
  lang=EN-US style='font-size:10.5pt'>Block</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>住不退出，则强制设置了一个该超时时间（单位毫秒），默认是</span><span
  lang=EN-US style='font-size:10.5pt'>600000</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>。如果你的程序对每条输入数据的处理时间过长（比如会访问数据库，通过网络拉取数据等），建议将该参数调大，该参数过小常出现的错误提示是“</span><span
  lang=EN-US style='font-size:10.5pt'>AttemptID:attempt_14267829456721_123456_m_000224_0
  Timed out after 300 secsContainer killed by the ApplicationMaster.</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:Calibri;
  mso-hansi-font-family:Calibri'>”。</span><span lang=EN-US style='font-size:
  10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>6.3 HDFS</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>小文件优化方法</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.3.1 HDFS</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>小文件弊端</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>上每个文件都要在</span><span lang=EN-US>NameNode</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上建立一个索引，这个索引的大小约为</span><span lang=EN-US>150byte</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，这样当小文件比较多的时候，就会产生很多的索引文件，<span style='color:red'>一方面会大量占用</span></span><span
lang=EN-US style='color:red'>NameNode</span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
color:red'>的内存空间</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，<span style='color:red'>另一方面就是索引文件过大使得索引速度变慢。</span></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%'>6.3.2 HDFS</span><span style='font-size:14.0pt;
line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>小文件解决方案</span><span lang=EN-US
style='font-size:14.0pt;line-height:172%'><o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>小文件的优化无非以下几种方式：</span></p>

<p class=1 style='mso-char-indent-count:0;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在数据采集的时候，就将小文件或小批数据合成大文件再上传</span><span lang=EN-US
style='font-family:"Times New Roman","serif"'>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span><span lang=EN-US style='font-family:"Times New Roman","serif"'><o:p></o:p></span></p>

<p class=1 style='mso-char-indent-count:0;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在业务处理之前，在</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>HDFS</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>上使用</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>程序对小文件进行合并。</span><span lang=EN-US style='font-family:"Times New Roman","serif"'><o:p></o:p></span></p>

<p class=1 style='mso-char-indent-count:0;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>MapReduce</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>处理时，可采用</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>CombineTextInputFormat</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>提高效率。</span><span lang=EN-US style='font-family:"Times New Roman","serif"'><o:p></o:p></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='font-family:"Times New Roman","serif"'><v:shape id="_x0000_i1122"
 type="#_x0000_t75" style='width:414pt;height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image360.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1122"
  DrawAspect="Content" ObjectID="_1629748307">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='font-family:"Times New Roman","serif"'><v:shape id="_x0000_i1123"
 type="#_x0000_t75" style='width:414pt;height:233.4pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image361.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1123"
  DrawAspect="Content" ObjectID="_1629748308">
 </o:OLEObject>
</xml><![endif]--><o:p></o:p></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='font-family:"Times New Roman","serif"'><o:p>&nbsp;</o:p></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>需要注意的是，有可能</span><span lang=EN-US style='font-family:"Times New Roman","serif"'>JVM</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>开启、关闭的时间都比执行任务的时间要长。</span><span lang=EN-US
style='font-family:"Times New Roman","serif"'><o:p></o:p></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_287" o:spid="_x0000_i1143"
 type="#_x0000_t75" style='width:423pt;height:54pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image362.png" o:title=""/>
</v:shape></span><span lang=EN-US style='font-family:"Times New Roman","serif"'><o:p></o:p></span></p>

<p class=1 style='text-indent:0cm;mso-char-indent-count:0;line-height:150%'><span
lang=EN-US style='font-family:"Times New Roman","serif"'><o:p>&nbsp;</o:p></span></p>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>7</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> <span lang=EN-US>MapReduce</span></span><span
style='font-size:15.0pt;line-height:240%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>扩展案例</span><span
lang=EN-US style='font-size:15.0pt;line-height:240%'><o:p></o:p></span></h1>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:normal'><span
lang=EN-US style='font-size:14.0pt;font-family:"Times New Roman","serif"'>7.1 </span><span
style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>倒排索引案例（多</span><span lang=EN-US
style='font-size:14.0pt;font-family:"Times New Roman","serif"'>job</span><span
style='font-size:14.0pt;font-family:黑体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>串联）</span><span lang=EN-US
style='font-size:14.0pt;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>有大量的文本（文档、网页），需要建立搜索索引，如图</span><span lang=EN-US>4-31</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>所示。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）数据输入</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US><v:shape id="_x0000_i1124" type="#_x0000_t75" style='width:25.2pt;
 height:36pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image363.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1124"
  DrawAspect="Content" ObjectID="_1629748309">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'>  </span><v:shape id="_x0000_i1125"
 type="#_x0000_t75" style='width:25.2pt;height:37.8pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image364.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1125"
  DrawAspect="Content" ObjectID="_1629748310">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'>  </span><v:shape id="_x0000_i1126"
 type="#_x0000_t75" style='width:25.2pt;height:37.8pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image365.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1126"
  DrawAspect="Content" ObjectID="_1629748311">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_288" o:spid="_x0000_i1142"
 type="#_x0000_t75" style='width:470.4pt;height:148.2pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image366.png" o:title=""/>
</v:shape></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）期望输出数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US>atguigu<span style='mso-tab-count:1'>   </span>c.txt--&gt;2<span
style='mso-tab-count:1'> </span>b.txt--&gt;2<span style='mso-tab-count:1'> </span>a.txt--&gt;3<span
style='mso-tab-count:1'> </span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US>pingping<span style='mso-tab-count:1'> </span>c.txt--&gt;1<span
style='mso-tab-count:1'> </span>b.txt--&gt;3<span style='mso-tab-count:1'> </span>a.txt--&gt;1<span
style='mso-tab-count:1'> </span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US>ss<span style='mso-tab-count:1'>    </span>c.txt--&gt;1<span
style='mso-tab-count:1'> </span>b.txt--&gt;1<span style='mso-tab-count:1'> </span>a.txt--&gt;2<span
style='mso-tab-count:1'> </span></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal><span lang=EN-US><v:shape id="_x0000_i1127" type="#_x0000_t75"
 style='width:510pt;height:286.8pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image367.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1127"
  DrawAspect="Content" ObjectID="_1629748312">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．第一次处理</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）第一次处理，编写</span><span
lang=EN-US>OneIndexMapper</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.index;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.IntWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileSplit;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class OneIndexMapper extends Mapper&lt;LongWritable, Text, Text,
  IntWritable&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>String name;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>Text k = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>IntWritable v = new IntWritable();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void setup(Context context)throws
  IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>获取文件名称</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileSplit split = (FileSplit)
  context.getInputSplit();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>name = split.getPath().getName();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void map(LongWritable key, Text
  value, Context context)<span style='mso-tab-count:1'>  </span>throws
  IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>// atguigu pingping<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>获取</span><span lang=EN-US style='font-size:10.5pt'>1</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>行</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>String line = value.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>切割</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>String[] fields = line.split(&quot;
  &quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>for (String word : fields) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>// 3 </span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>拼接</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>k.set(word+&quot;--&quot;+name);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>v.set(1);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>// 4 </span><span style='font-size:
  10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>写出</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>context.write(k, v);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）第一次处理，编写</span><span
lang=EN-US>OneIndexReducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.index;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.IntWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class OneIndexReducer extends Reducer&lt;Text, IntWritable, Text,
  IntWritable&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  15.75pt;mso-char-indent-count:1.5;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US style='font-size:10.5pt'>IntWritable v = new
  IntWritable();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void reduce(Text key,
  Iterable&lt;IntWritable&gt; values,Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>int sum = 0;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>累加求和</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>for(IntWritable value: values){<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>         </span>sum +=value.get();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span>v.set(sum);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>写出</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>context.write(key, v);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）第一次处理，编写</span><span
lang=EN-US>OneIndexDriver</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.index;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.IntWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class OneIndexDriver {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public static void main(String[] args)
  throws Exception {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-spacerun:yes'>       </span>// </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>输入输出路径需要根据自己电脑上实际的输入输出路径设置</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>args = new String[] {
  &quot;e:/input/inputoneindex&quot;, &quot;e:/output5&quot; };<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Configuration conf = new
  Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>Job job = Job.getInstance(conf);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setJarByClass(OneIndexDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapperClass(OneIndexMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setReducerClass(OneIndexReducer.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(IntWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>job.setOutputValueClass(IntWritable.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job, new
  Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job, new
  Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><span style='mso-tab-count:1'>   </span>job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）查看第一次输出结果</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>atguigu--a.txt<span
  style='mso-tab-count:1'> </span>3<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>atguigu--b.txt<span
  style='mso-tab-count:1'> </span>2<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>atguigu--c.txt<span
  style='mso-tab-count:1'> </span>2<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>pingping--a.txt<span
  style='mso-tab-count:1'> </span>1<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>pingping--b.txt<span
  style='mso-tab-count:1'> </span>3<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>pingping--c.txt<span
  style='mso-tab-count:1'> </span>1<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>ss--a.txt<span
  style='mso-tab-count:1'>   </span>2<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>ss--b.txt<span
  style='mso-tab-count:1'>   </span>1<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>ss--c.txt<span
  style='mso-tab-count:1'>   </span>1</span><span lang=EN-US style='font-family:
  "Times New Roman","serif";mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>4</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．第二次处理</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）第二次处理，编写</span><span
lang=EN-US style='mso-bidi-font-weight:bold'>TwoIndexMapper</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-weight:bold'>类</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mapreduce.index;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class TwoIndexMapper extends Mapper&lt;LongWritable, Text, Text, Text&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>Text k = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>Text v = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void map(LongWritable key, Text
  value, Context context) throws IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>// atguigu--a.txt 3<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>// atguigu--b.txt 2<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>// atguigu--c.txt 2<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>获取</span><span lang=EN-US style='font-size:10.5pt'>1</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>行数据</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>String line = value.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 2</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>用“</span><span lang=EN-US style='font-size:10.5pt'>--</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>”切割</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>String[] fields =
  line.split(&quot;--&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>k.set(fields[0]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>v.set(fields[1]);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>// 3 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>输出数据</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>context.write(k, v);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-family:"Times New Roman","serif";mso-bidi-font-family:
  Arial;mso-bidi-font-weight:bold'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）第二次处理，编写</span><span
lang=EN-US>TwoIndexReducer</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.index;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class TwoIndexReducer extends
  Reducer&lt;Text, Text, Text, Text&gt; {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  15.75pt;mso-char-indent-count:1.5'><span lang=EN-US style='font-size:10.5pt'>Text
  v = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void reduce(Text key, Iterable&lt;Text&gt; values, Context context) throws
  IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><span style='mso-tab-count:2'>      </span>// atguigu
  a.txt 3<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><span style='mso-tab-count:2'>      </span>// atguigu
  b.txt 2<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><span style='mso-tab-count:2'>      </span>// atguigu
  c.txt 2<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><span style='mso-tab-count:2'>      </span>// atguigu
  c.txt--&gt;2 b.txt--&gt;2 a.txt--&gt;3<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>StringBuilder
  sb = new StringBuilder();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>       
  </span>// 1 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>拼接</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>for
  (Text value : values) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>         </span>sb.append(value.toString().replace(&quot;\t&quot;,
  &quot;--&gt;&quot;) + &quot;\t&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5'><span lang=EN-US style='font-size:10.5pt'>v.set(sb.toString());<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>//
  2 </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>写出</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>context.write(key,
  v);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='font-family:"Times New Roman","serif";mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）第二次处理，编写</span><span
lang=EN-US>TwoIndexDriver</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;border:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.index;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>public class TwoIndexDriver {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  static void main(String[] args) throws Exception {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-spacerun:yes'>      
  </span>// </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>输入输出路径需要根据自己电脑上实际的输入输出路径设置</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>args = new String[] {
  &quot;e:/input/inputtwoindex&quot;, &quot;e:/output6&quot; };<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Configuration
  config = new Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>Job
  job = Job.getInstance(config);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5'><span lang=EN-US style='font-size:10.5pt'>job.setJarByClass(TwoIndexDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapperClass(TwoIndexMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setReducerClass(TwoIndexReducer.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setMapOutputValueClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>job.setOutputValueClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>      </span>boolean
  result = job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;text-indent:
  36.75pt;mso-char-indent-count:3.5'><span lang=EN-US style='font-size:10.5pt'>System.exit(result?0:1);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  lang=EN-US style='font-size:10.5pt'>}</span><span lang=EN-US
  style='font-family:"Times New Roman","serif";mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）第二次查看最终结果，想查找哪个文件有需要查找的单词，就能很快定位到文件了</span></p>

<p class=a style='margin-left:36.75pt;mso-para-margin-left:3.5gd'><span
lang=EN-US style='font-size:10.5pt'>atguigu<span style='mso-tab-count:1'> </span>c.txt--&gt;2<span
style='mso-tab-count:1'> </span>b.txt--&gt;2<span style='mso-tab-count:1'> </span>a.txt--&gt;3<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=a style='margin-left:36.75pt;mso-para-margin-left:3.5gd'><span
lang=EN-US style='font-size:10.5pt'>pingping<span style='mso-tab-count:1'>  </span>c.txt--&gt;1<span
style='mso-tab-count:1'> </span>b.txt--&gt;3<span style='mso-tab-count:1'> </span>a.txt--&gt;1<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=a style='margin-left:36.75pt;mso-para-margin-left:3.5gd'><span
lang=EN-US style='font-size:10.5pt'>ss<span style='mso-tab-count:1'>  </span>c.txt--&gt;1<span
style='mso-tab-count:1'> </span>b.txt--&gt;1<span style='mso-tab-count:1'> </span>a.txt--&gt;2<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>7.2 TopN</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>对需求</span><span lang=EN-US>2.3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>输出结果进行加工，输出流量使用量在前</span><span
lang=EN-US>10</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>的用户信息</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）输入数据</span><span
lang=EN-US><span style='mso-tab-count:3'>                   </span></span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）输出数据</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US><v:shape id="_x0000_i1128" type="#_x0000_t75" style='width:75pt;
 height:42pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image368.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1128"
  DrawAspect="Content" ObjectID="_1629748314">
 </o:OLEObject>
</xml><![endif]--><span style='mso-tab-count:3'>                 </span><v:shape
 id="_x0000_i1129" type="#_x0000_t75" style='width:86.4pt;height:42pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image369.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1129"
  DrawAspect="Content" ObjectID="_1629748315">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_289" o:spid="_x0000_i1141"
 type="#_x0000_t75" style='width:214.2pt;height:258pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image370.png" o:title=""/>
</v:shape><v:shape id="图片_x0020_290" o:spid="_x0000_i1140" type="#_x0000_t75"
 style='width:246.6pt;height:174pt;visibility:visible;mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image371.png" o:title=""/>
</v:shape></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US><v:shape id="_x0000_i1130" type="#_x0000_t75" style='width:474.6pt;
 height:268.2pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image372.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.12" ShapeID="_x0000_i1130"
  DrawAspect="Content" ObjectID="_1629748316">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>3</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．实现代码</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>FlowBean</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=945
 style='width:20.0cm;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=945 valign=top style='width:20.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mr.top;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.DataInput;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.DataOutput;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.WritableComparable;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class FlowBean implements WritableComparable&lt;FlowBean&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private long upFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private long downFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private long sumFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public FlowBean() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>super();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public FlowBean(long upFlow, long downFlow)
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>super();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.upFlow = upFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.downFlow = downFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void write(DataOutput out) throws
  IOException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>out.writeLong(upFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>out.writeLong(downFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>out.writeLong(sumFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void readFields(DataInput in) throws
  IOException {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>upFlow = in.readLong();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>downFlow = in.readLong();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>sumFlow = in.readLong();<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public long getUpFlow() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return upFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void setUpFlow(long upFlow) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.upFlow = upFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public long getDownFlow() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return downFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void setDownFlow(long downFlow) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><span style='mso-tab-count:1'>   </span>this.downFlow
  = downFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public long getSumFlow() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return sumFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void setSumFlow(long sumFlow) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>this.sumFlow = sumFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public String toString() {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return upFlow + &quot;\t&quot; +
  downFlow + &quot;\t&quot; + sumFlow;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public void set(long downFlow2, long
  upFlow2) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>downFlow = downFlow2;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>upFlow = upFlow2;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>sumFlow = downFlow2 + upFlow2;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public int compareTo(FlowBean bean) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>int result;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>      </span>if (this.sumFlow &gt; bean.getSumFlow())
  {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>         </span>result = -1;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>      </span>}else if (this.sumFlow
  &lt; bean.getSumFlow()) {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>         </span>result = 1;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>      </span>}else {<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>         </span>result = 0;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>      </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span><o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>      </span>return result;<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>2</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US>TopNMapper</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=945
 style='width:20.0cm;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=945 valign=top style='width:20.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mr.top;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.util.Iterator;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.util.TreeMap;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.LongWritable;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class TopNMapper extends Mapper&lt;LongWritable, Text, FlowBean, Text&gt;{<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:1'>  </span>// </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>定义一个</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>TreeMap</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>作为存储数据的容器（天然按</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>key</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>排序）</span><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:1'>  </span>private
  TreeMap&lt;FlowBean, Text&gt; flowMap = new TreeMap&lt;FlowBean, Text&gt;();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>private FlowBean kBean;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void map(LongWritable key, Text
  value, Context context)<span style='mso-tab-count:1'>  </span>throws
  IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>kBean = new FlowBean();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>Text v = new Text();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>获取一行</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>String line = value.toString();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 2 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>切割</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>String[] fields =
  line.split(&quot;\t&quot;);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 3 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>封装数据</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>String phoneNum = fields[0];<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>long upFlow = Long.parseLong(fields[1]);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>long downFlow =
  Long.parseLong(fields[2]);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>long sumFlow = Long.parseLong(fields[3]);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>kBean.setDownFlow(downFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>kBean.setUpFlow(upFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>kBean.setSumFlow(sumFlow);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>v.set(phoneNum);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>// 4 </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>向</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>TreeMap</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>中添加数据</span><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>flowMap.put(kBean, v);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>// 5 </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>限制</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>TreeMap</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>的数据量，超过</span><span lang=EN-US style='font-size:
  10.5pt;color:red'>10</span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>条就删除掉流量最小的一条数据</span><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>if (flowMap.size() &gt;
  10) {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'>//<span style='mso-tab-count:2'>      </span>flowMap.remove(flowMap.firstKey());<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span>flowMap.remove(flowMap.lastKey());<span
  style='mso-tab-count:2'>    </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;text-indent:
  31.5pt;mso-char-indent-count:3.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US style='font-size:10.5pt;color:red'>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void cleanup(Context context)
  throws IOException, InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>// 6 </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>遍历</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>treeMap</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>集合，输出数据</span><span lang=EN-US style='font-size:
  10.5pt;color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>Iterator&lt;FlowBean&gt;
  bean = flowMap.keySet().iterator();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>while (bean.hasNext()) {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span>FlowBean k =
  bean.next();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span>context.write(k,
  flowMap.get(k));<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}</span><span
  lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial;mso-bidi-font-weight:bold'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>3</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>TopNReducer</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>类</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=957
 style='width:574.1pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=957 valign=top style='width:574.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mr.top;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.io.IOException;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.util.Iterator;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  java.util.TreeMap;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class TopNReducer extends Reducer&lt;FlowBean, Text, Text, FlowBean&gt; {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:1'>  </span>// </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>定义一个</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>TreeMap</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>作为存储数据的容器（天然按</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>key</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>排序）</span><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:1'>  </span>TreeMap&lt;FlowBean,
  Text&gt; flowMap = new TreeMap&lt;FlowBean, Text&gt;();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void reduce(FlowBean key,
  Iterable&lt;Text&gt; values, Context context)throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>for (Text value : values) {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>        </span><span
  style='mso-spacerun:yes'> </span>FlowBean bean = new FlowBean();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:3'>        </span><span
  style='mso-spacerun:yes'> </span>bean.set(key.getDownFlow(),
  key.getUpFlow());<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span><span
  style='mso-spacerun:yes'> </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>向</span><span lang=EN-US style='font-size:10.5pt;
  color:red'>treeMap</span><span style='font-size:10.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:red'>集合中添加数据</span><span lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span>flowMap.put(bean, new
  Text(value));<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span>// 2 </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>限制</span><span lang=EN-US
  style='font-size:10.5pt;color:red'>TreeMap</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:red'>数据量，超过</span><span lang=EN-US style='font-size:10.5pt;
  color:red'>10</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:red'>条就删除掉流量最小的一条数据</span><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span>if (flowMap.size()
  &gt; 10) {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:4'>           </span>// flowMap.remove(flowMap.firstKey());<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;text-indent:
  73.5pt;mso-char-indent-count:7.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span lang=EN-US style='font-size:10.5pt;color:red'>flowMap.remove(flowMap.lastKey());<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>protected void cleanup(Reducer&lt;FlowBean,
  Text, Text, FlowBean&gt;.Context context) throws IOException,
  InterruptedException {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>// 3 </span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:red'>遍历集合，输出数据</span><span
  lang=EN-US style='font-size:10.5pt;color:red'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>Iterator&lt;FlowBean&gt;
  it = flowMap.keySet().iterator();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>while (it.hasNext()) {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span>FlowBean v =
  it.next();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:3'>        </span>context.write(new
  Text(flowMap.get(v)), v);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt;
  color:red'><span style='mso-tab-count:2'>     </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>（</span><span lang=EN-US>4</span><span style='font-family:
  宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）编写</span><span
  lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>TopNDriver</span><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>类</span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>package
  com.atguigu.mr.top;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.fs.Path;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.io.Text;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>public
  class TopNDriver {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>public static void main(String[] args)
  throws Exception {<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>args<span style='mso-spacerun:yes'> 
  </span>= new String[]{&quot;e:/output1&quot;,&quot;e:/output3&quot;};<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 1 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>获取配置信息，或者</span><span lang=EN-US style='font-size:10.5pt'>job</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>对象实例</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>Configuration configuration = new
  Configuration();<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>Job job = Job.getInstance(configuration);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 6 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>指定本程序的</span><span lang=EN-US style='font-size:10.5pt'>jar</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>包所在的本地路径</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>job.setJarByClass(TopNDriver.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 2 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>指定本业务</span><span lang=EN-US style='font-size:10.5pt'>job</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>要使用的</span><span lang=EN-US
  style='font-size:10.5pt'>mapper/Reducer</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>业务类</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>job.setMapperClass(TopNMapper.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>job.setReducerClass(TopNReducer.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 3 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>指定</span><span lang=EN-US style='font-size:10.5pt'>mapper</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>输出数据的</span><span lang=EN-US
  style='font-size:10.5pt'>kv</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>类型</span><span
  lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>job.setMapOutputKeyClass(FlowBean.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>job.setMapOutputValueClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 4 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>指定最终输出的数据的</span><span lang=EN-US style='font-size:10.5pt'>kv</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>类型</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>job.setOutputValueClass(FlowBean.class);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 5 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>指定</span><span lang=EN-US style='font-size:10.5pt'>job</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>的输入原始文件所在目录</span><span lang=EN-US
  style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>FileInputFormat.setInputPaths(job, new
  Path(args[0]));<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>FileOutputFormat.setOutputPath(job, new
  Path(args[1]));<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>// 7 </span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>将</span><span lang=EN-US style='font-size:10.5pt'>job</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>中配置的相关参数，以及</span><span lang=EN-US
  style='font-size:10.5pt'>job</span><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>所用的</span><span
  lang=EN-US style='font-size:10.5pt'>java</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>类所在的</span><span lang=EN-US style='font-size:10.5pt'>jar</span><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>包，</span><span style='font-size:10.5pt'>
  </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New"'>提交给</span><span
  lang=EN-US style='font-size:10.5pt'>yarn</span><span style='font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New"'>去运行</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>boolean result =
  job.waitForCompletion(true);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:2'>     </span>System.exit(result ? 0 : 1);<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'><span
  style='mso-tab-count:1'>  </span>}<o:p></o:p></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_291"
   o:spid="_x0000_i1139" type="#_x0000_t75" style='width:337.8pt;height:184.8pt;
   visibility:visible;mso-wrap-style:square'>
   <img src="Hadoop_03MapReduce.files/image373.png" o:title=""/>
  </v:shape></span></p>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
14.0pt;line-height:172%;font-family:"Times New Roman","serif"'>7.3 </span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>找博客共同好友案例</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman","serif"'><o:p></o:p></span></h2>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>1</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>以下是博客的好友列表数据，冒号前是一个用户，冒号后是该用户的所有好友（数据中的好友关系是<span
style='color:red'>单向</span>的）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>求出哪些人两两之间有共同好友，及他俩的共同好友都有谁？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>（</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）数据输入</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US><v:shape id="_x0000_i1131" type="#_x0000_t75" style='width:69.6pt;
 height:55.2pt' o:ole="">
 <v:fill o:detectmouseclick="t"/>
 <img src="Hadoop_03MapReduce.files/image374.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1131"
  DrawAspect="Content" ObjectID="_1629748317">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_292" o:spid="_x0000_i1138"
 type="#_x0000_t75" style='width:154.2pt;height:183pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image375.png" o:title=""/>
</v:shape></span></p>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span lang=EN-US>2</span><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．需求分析</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>先求出</span><span lang=EN-US>A</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>、</span><span
lang=EN-US>B</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>、</span><span lang=EN-US>C</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>、</span><span lang=EN-US>….</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>等是谁的好友</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>第一次输出结果</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><a
  name="_Hlk510263194"><span lang=EN-US style='font-size:10.5pt'>A<span
  style='mso-tab-count:1'> </span>I,K,C,B,G,F,H,O,D,<o:p></o:p></span></a></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B<span
  style='mso-tab-count:1'> </span>A,F,J,E,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C<span
  style='mso-tab-count:1'> </span>A,E,B,H,F,G,K,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D<span
  style='mso-tab-count:1'> </span>G,C,K,A,L,F,E,H,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>E<span
  style='mso-tab-count:1'> </span>G,M,L,H,A,F,B,D,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>F<span
  style='mso-tab-count:1'> </span>L,M,D,C,G,A,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>G<span
  style='mso-tab-count:1'> </span>M,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>H<span
  style='mso-tab-count:1'> </span>O,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>I<span
  style='mso-tab-count:1'> </span>O,C,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>J<span
  style='mso-tab-count:1'> </span>O,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>K<span
  style='mso-tab-count:1'> </span>B,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>L<span
  style='mso-tab-count:1'> </span>D,E,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>M<span
  style='mso-tab-count:1'> </span>E,F,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>O<span
  style='mso-tab-count:1'> </span>A,H,I,J,F,</span></span></p>
  </td>
  <span style='mso-bookmark:_Hlk510263194'></span>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0;
line-height:150%'><span style='mso-bookmark:_Hlk510263194'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>第二次输出结果</span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=685 valign=top style='width:411.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-B<span
  style='mso-tab-count:1'>   </span>E C <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-C<span
  style='mso-tab-count:1'>   </span>D F <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-D<span
  style='mso-tab-count:1'>   </span>E F <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-E<span
  style='mso-tab-count:1'>   </span>D B C <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-F<span
  style='mso-tab-count:1'>   </span>O B C D E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-G<span
  style='mso-tab-count:1'>   </span>F E C D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-H<span
  style='mso-tab-count:1'>   </span>E C D O <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-I<span
  style='mso-tab-count:1'>   </span>O <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-J<span
  style='mso-tab-count:1'>   </span>O B <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-K<span
  style='mso-tab-count:1'>   </span>D C <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-L<span
  style='mso-tab-count:1'>   </span>F E D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>A-M<span
  style='mso-tab-count:1'>   </span>E F <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-C<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-D<span
  style='mso-tab-count:1'>   </span>A E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-E<span
  style='mso-tab-count:1'>   </span>C <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-F<span
  style='mso-tab-count:1'>   </span>E A C <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-G<span
  style='mso-tab-count:1'>   </span>C E A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-H<span
  style='mso-tab-count:1'>   </span>A E C <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-I<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-K<span
  style='mso-tab-count:1'>   </span>C A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-L<span
  style='mso-tab-count:1'>   </span>E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-M<span
  style='mso-tab-count:1'>   </span>E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>B-O<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-D<span
  style='mso-tab-count:1'>   </span>A F <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-E<span
  style='mso-tab-count:1'>   </span>D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-F<span
  style='mso-tab-count:1'>   </span>D A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-G<span
  style='mso-tab-count:1'>   </span>D F A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-H<span
  style='mso-tab-count:1'>   </span>D A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-I<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-K<span
  style='mso-tab-count:1'>   </span>A D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-L<span
  style='mso-tab-count:1'>   </span>D F <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-M<span
  style='mso-tab-count:1'>   </span>F <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>C-O<span
  style='mso-tab-count:1'>   </span>I A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D-E<span
  style='mso-tab-count:1'>   </span>L <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D-F<span
  style='mso-tab-count:1'>   </span>A E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D-G<span
  style='mso-tab-count:1'>   </span>E A F <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D-H<span
  style='mso-tab-count:1'>   </span>A E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D-I<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D-K<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D-L<span
  style='mso-tab-count:1'>   </span>E F <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D-M<span
  style='mso-tab-count:1'>   </span>F E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>D-O<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>E-F<span
  style='mso-tab-count:1'>   </span>D M C B <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>E-G<span
  style='mso-tab-count:1'>   </span>C D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>E-H<span
  style='mso-tab-count:1'>   </span>C D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>E-J<span
  style='mso-tab-count:1'>   </span>B <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>E-K<span
  style='mso-tab-count:1'>   </span>C D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>E-L<span
  style='mso-tab-count:1'>   </span>D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>F-G<span
  style='mso-tab-count:1'>   </span>D C A E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>F-H<span
  style='mso-tab-count:1'>   </span>A D O E C <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>F-I<span
  style='mso-tab-count:1'>   </span>O A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>F-J<span
  style='mso-tab-count:1'>   </span>B O <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>F-K<span
  style='mso-tab-count:1'>   </span>D C A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>F-L<span
  style='mso-tab-count:1'>   </span>E D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>F-M<span
  style='mso-tab-count:1'>   </span>E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>F-O<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>G-H<span
  style='mso-tab-count:1'>   </span>D C E A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>G-I<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>G-K<span
  style='mso-tab-count:1'>   </span>D A C <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>G-L<span
  style='mso-tab-count:1'>   </span>D F E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>G-M<span
  style='mso-tab-count:1'>   </span>E F <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>G-O<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>H-I<span
  style='mso-tab-count:1'>   </span>O A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>H-J<span
  style='mso-tab-count:1'>   </span>O <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>H-K<span
  style='mso-tab-count:1'>   </span>A C D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>H-L<span
  style='mso-tab-count:1'>   </span>D E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>H-M<span
  style='mso-tab-count:1'>   </span>E <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>H-O<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>I-J<span
  style='mso-tab-count:1'>   </span>O <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>I-K<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>I-O<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>K-L<span
  style='mso-tab-count:1'>   </span>D <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>K-O<span
  style='mso-tab-count:1'>   </span>A <o:p></o:p></span></span></p>
  <p class=a style='margin-left:26.25pt;mso-para-margin-left:2.5gd'><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>L-M<span
  style='mso-tab-count:1'>   </span>E F</span></span></p>
  </td>
  <span style='mso-bookmark:_Hlk510263194'></span>
 </tr>
</table>

<p class=10 style='margin-top:6.2pt;text-indent:22.0pt'><span style='mso-bookmark:
_Hlk510263194'><span lang=EN-US>3</span></span><span style='mso-bookmark:_Hlk510263194'><span
style='font-family:黑体;mso-ascii-font-family:Arial;mso-hansi-font-family:Arial'>．代码实现</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>1</span></span><span style='mso-bookmark:_Hlk510263194'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）第一次</span><span lang=EN-US>Mapper</span></span><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.friends;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>public class OneShareFriendsMapper
  extends Mapper&lt;LongWritable, Text, Text, Text&gt;{<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void map(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text,
  Text&gt;.Context context)<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>        </span>throws
  IOException, InterruptedException {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  1 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取一行</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>
  A:B,C,D,F,E,O<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String
  line = value.toString();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  2 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>切割</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String[]
  fields = line.split(&quot;:&quot;);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  3 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>person</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>和好友</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String
  person = fields[0];<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String[]
  friends = fields[1].split(&quot;,&quot;);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  4</span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>写出去</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>for(String
  friend: friends){<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>        </span>//
  </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>输出</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'> &lt;</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>好友，人</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>&gt;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>        </span>context.write(new
  Text(friend), new Text(person));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Hlk510263194'></span>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>2</span></span><span style='mso-bookmark:_Hlk510263194'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）第一次</span><span lang=EN-US>Reducer</span></span><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=933 valign=top style='width:559.95pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.friends;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>public class OneShareFriendsReducer
  extends Reducer&lt;Text, Text, Text, Text&gt;{<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void reduce(Text key, Iterable&lt;Text&gt; values, Context context)throws
  IOException, InterruptedException {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>StringBuffer
  sb = new StringBuffer();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//1
  </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>拼接</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>for(Text
  person: values){<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>        </span>sb.append(person).append(&quot;,&quot;);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//2
  </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>写出</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>context.write(key,
  new Text(sb.toString()));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Hlk510263194'></span>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>3</span></span><span style='mso-bookmark:_Hlk510263194'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）第一次</span><span lang=EN-US>Driver</span></span><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=910 valign=top style='width:545.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.friends;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>public class OneShareFriendsDriver {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  static void main(String[] args) throws Exception {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;text-indent:
  31.5pt;mso-char-indent-count:3.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Hlk510263194'><span lang=EN-US
  style='font-size:10.5pt'>// 1 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>job</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>对象</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>Configuration
  configuration = new Configuration();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>Job
  job = Job.getInstance(configuration);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  2 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>jar</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包运行的路径</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setJarByClass(OneShareFriendsDriver.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  3 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>map/reduce</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>使用的类</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setMapperClass(OneShareFriendsMapper.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setReducerClass(OneShareFriendsReducer.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  4 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>map</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输出的数据类型</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setMapOutputValueClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  5 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定最终输出的数据类型</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setOutputValueClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  6 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>job</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>的输入原始所在目录</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  7 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>提交</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>boolean
  result = job.waitForCompletion(true);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>System.exit(result?0:1);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Hlk510263194'></span>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>4</span></span><span style='mso-bookmark:_Hlk510263194'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）第二次</span><span lang=EN-US>Mapper</span></span><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=945
 style='width:20.0cm;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=945 valign=top style='width:20.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.friends;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import java.util.Arrays;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.LongWritable;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Mapper;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>public class TwoShareFriendsMapper
  extends Mapper&lt;LongWritable, Text, Text, Text&gt;{<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void map(LongWritable key, Text value, Context context)<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>        </span>throws
  IOException, InterruptedException {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  A I,K,C,B,G,F,H,O,D,<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>友</span></span><span style='mso-bookmark:
  _Hlk510263194'><span style='font-size:10.5pt'> </span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>人，人，人</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String
  line = value.toString();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String[]
  friend_persons = line.split(&quot;\t&quot;);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String
  friend = friend_persons[0];<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>String[]
  persons = friend_persons[1].split(&quot;,&quot;);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>Arrays.sort(persons);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>for
  (int i = 0; i &lt; persons.length - 1; i++) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>        </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>        </span>for
  (int j = i + 1; j &lt; persons.length; j++) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>           </span>//
  </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>发出</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'> &lt;</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>人</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>-</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>人，好友</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>&gt;
  </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>，这样，相同的“人</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>-</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>人”对的所有好友就会到同</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>1</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>个</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>reduce</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>中去</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:4'>           </span>context.write(new
  Text(persons[i] + &quot;-&quot; + persons[j]), new Text(friend));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>        </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Hlk510263194'></span>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>5</span></span><span style='mso-bookmark:_Hlk510263194'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）第二次</span><span lang=EN-US>Reducer</span></span><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=936
 style='width:561.6pt;margin-left:5.4pt;border-collapse:collapse;mso-padding-alt:
 0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=936 valign=top style='width:561.6pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.friends;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import java.io.IOException;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.Reducer;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>public class TwoShareFriendsReducer
  extends Reducer&lt;Text, Text, Text, Text&gt;{<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>@Override<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>protected
  void reduce(Text key, Iterable&lt;Text&gt; values, Context context)<span
  style='mso-tab-count:1'>  </span>throws IOException, InterruptedException {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>StringBuffer
  sb = new StringBuffer();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>for
  (Text friend : values) {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:3'>        </span>sb.append(friend).append(&quot;
  &quot;);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>context.write(key,
  new Text(sb.toString()));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Hlk510263194'></span>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>（</span><span
lang=EN-US>6</span></span><span style='mso-bookmark:_Hlk510263194'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）第二次</span><span lang=EN-US>Driver</span></span><span
style='mso-bookmark:_Hlk510263194'><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>类</span></span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=969
 style='width:581.2pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=969 valign=top style='width:581.2pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>package com.atguigu.mapreduce.friends;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.conf.Configuration;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.fs.Path;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.io.Text;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import org.apache.hadoop.mapreduce.Job;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>import
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>public class TwoShareFriendsDriver {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>public
  static void main(String[] args) throws Exception {<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;text-indent:
  31.5pt;mso-char-indent-count:3.0;mso-layout-grid-align:none;punctuation-trim:
  leading'><span style='mso-bookmark:_Hlk510263194'><span lang=EN-US
  style='font-size:10.5pt'>// 1 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>获取</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>job</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>对象</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>Configuration
  configuration = new Configuration();<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>Job
  job = Job.getInstance(configuration);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  2 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>jar</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>包运行的路径</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setJarByClass(TwoShareFriendsDriver.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  3 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>map/reduce</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>使用的类</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setMapperClass(TwoShareFriendsMapper.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setReducerClass(TwoShareFriendsReducer.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  4 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>map</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>输出的数据类型</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setMapOutputKeyClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setMapOutputValueClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  5 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定最终输出的数据类型</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setOutputKeyClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>job.setOutputValueClass(Text.class);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  6 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>指定</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'>job</span></span><span
  style='mso-bookmark:_Hlk510263194'><span style='font-size:10.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New"'>的输入原始所在目录</span></span><span
  style='mso-bookmark:_Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>FileInputFormat.setInputPaths(job,
  new Path(args[0]));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>FileOutputFormat.setOutputPath(job,
  new Path(args[1]));<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>//
  7 </span></span><span style='mso-bookmark:_Hlk510263194'><span
  style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New"'>提交</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>boolean
  result = job.waitForCompletion(true);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:2'>     </span>System.exit(result?0:1);<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:1'>  </span>}<o:p></o:p></span></span></p>
  <p class=a style='margin-left:31.5pt;mso-para-margin-left:3.0gd;mso-layout-grid-align:
  none;punctuation-trim:leading'><span style='mso-bookmark:_Hlk510263194'><span
  lang=EN-US style='font-size:10.5pt'>}</span></span><span style='mso-bookmark:
  _Hlk510263194'><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-bidi-font-family:Arial'><o:p></o:p></span></span></p>
  </td>
  <span style='mso-bookmark:_Hlk510263194'></span>
 </tr>
</table>

</div>

<span style='mso-bookmark:_Hlk510263194'></span>

<h1 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>第</span><span lang=EN-US
style='font-size:15.0pt;line-height:240%'>8</span><span style='font-size:15.0pt;
line-height:240%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>章</span><span style='font-size:15.0pt;
line-height:240%'> </span><span style='font-size:15.0pt;line-height:240%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>常见错误及解决方案</span><span lang=EN-US style='font-size:15.0pt;
line-height:240%'><o:p></o:p></span></h1>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）导包容易出错。尤其</span><span lang=EN-US>Text</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><span lang=EN-US>CombineTextInputFormat</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>2</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>Mapper</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中第一个输入的参数必须是</span><span lang=EN-US>LongWritable</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>或者</span><span lang=EN-US>NullWritable</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，不可以是</span><span lang=EN-US>IntWritable.<span
style='mso-spacerun:yes'>  </span></span><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>报的错误是类型转换异常。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>3</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）</span><span lang=EN-US>java.lang.Exception:
java.io.IOException: Illegal partition for 13926435656 (4)</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，说明</span><span lang=EN-US>Partition</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>和</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个数没对上，调整</span><span lang=EN-US>ReduceTask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>个数。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>4</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）如果分区数不是</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，但是</span><span lang=EN-US style='color:black'>reducetask</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>为</span><span lang=EN-US>1</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，是否执行分区过程。答案是：不执行分区过程。因为在</span><span
lang=EN-US>MapTask</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的源码中，执行分区的前提是先判断</span><span
lang=EN-US>ReduceNum</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>个数是否大于</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>。不大于</span><span lang=EN-US>1</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>肯定不执行。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>5</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）在</span><span lang=EN-US>Windows</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>环境编译的</span><span lang=EN-US>jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>包导入到</span><span lang=EN-US>Linux</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>环境中运行，</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>hadoop jar wc.jar
com.atguigu.mapreduce.wordcount.WordCountDriver /user/atguigu/
/user/atguigu/output</span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>报如下错误：</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>Exception in
thread &quot;main&quot; java.lang.UnsupportedClassVersionError:
com/atguigu/mapreduce/wordcount/WordCountDriver : Unsupported major.minor
version 52.0</span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>原因是</span><span
lang=EN-US>Windows</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>环境用的</span><span
lang=EN-US>jdk1.7</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，</span><span lang=EN-US>Linux</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>环境用的</span><span lang=EN-US>jdk1.8</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。</span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>解决方案：统一</span><span
lang=EN-US>jdk</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>版本。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>6</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）缓存</span><span lang=EN-US>pd.txt</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>小文件案例中，报找不到</span><span lang=EN-US>pd.txt</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件</span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>原因：大部分为路径书写错误。还有就是要检查</span><span
lang=EN-US>pd.txt.txt</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的问题。还有个别电脑写相对路径找不到</span><span
lang=EN-US>pd.txt</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>，可以修改为绝对路径。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>7</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）报类型转换异常。</span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>通常都是在驱动函数中设置</span><span
lang=EN-US>Map</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>输出和最终输出时编写错误。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>Map</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>输出的</span><span lang=EN-US>key</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>如果没有排序，也会报类型转换异常。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>8</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）集群中运行</span><span lang=EN-US>wc.jar</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时出现了无法获得输入文件。</span></p>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>原因：</span><span
lang=EN-US>WordCount</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>案例的输入文件不能放用</span><span
lang=EN-US>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>集群的根目录。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>9</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）出现了如下相关异常</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
10.0pt;mso-bidi-font-size:10.5pt;line-height:150%;color:red'>Exception in
thread &quot;main&quot; java.lang.UnsatisfiedLinkError:
org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Ljava/lang/String;I)Z<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
10.0pt;mso-bidi-font-size:10.5pt;line-height:150%'><span style='mso-tab-count:
1'>         </span>at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native
Method)<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
10.0pt;mso-bidi-font-size:10.5pt;line-height:150%'><span style='mso-tab-count:
1'>         </span>at
org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:609)<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
10.0pt;mso-bidi-font-size:10.5pt;line-height:150%'><span style='mso-tab-count:
1'>         </span>at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:977)<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
10.0pt;mso-bidi-font-size:10.5pt;line-height:150%;color:red'>java.io.IOException:
Could not locate executable null\bin\winutils.exe in the Hadoop binaries.<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
10.0pt;mso-bidi-font-size:10.5pt;line-height:150%'><span style='mso-tab-count:
1'>         </span>at
org.apache.hadoop.util.Shell.getQualifiedBinPath(Shell.java:356)<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
10.0pt;mso-bidi-font-size:10.5pt;line-height:150%'><span style='mso-tab-count:
1'>         </span>at
org.apache.hadoop.util.Shell.getWinUtilsPath(Shell.java:371)<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
10.0pt;mso-bidi-font-size:10.5pt;line-height:150%'><span style='mso-tab-count:
1'>         </span>at
org.apache.hadoop.util.Shell.&lt;clinit&gt;(Shell.java:364)<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
10.0pt;mso-bidi-font-size:10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>解决方案：拷贝</span><span lang=EN-US>hadoop.dll</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>文件到</span><span lang=EN-US>Windows</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>目录</span><span lang=EN-US>C:\Windows\System32</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>。个别同学电脑还需要修改</span><span lang=EN-US>Hadoop</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>源码。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>方案二：创建如下包名，并将</span><span lang=EN-US>NativeIO.java</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>拷贝到该包名下</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-no-proof:yes'><v:shape id="图片_x0020_15" o:spid="_x0000_i1137"
 type="#_x0000_t75" style='width:205.2pt;height:114.6pt;visibility:visible;
 mso-wrap-style:square'>
 <img src="Hadoop_03MapReduce.files/image376.png" o:title="1212195040"/>
</v:shape></span><span lang=EN-US><span style='mso-spacerun:yes'> </span><v:shape
 id="_x0000_i1132" type="#_x0000_t75" style='width:76.8pt;height:54pt' o:ole="">
 <img src="Hadoop_03MapReduce.files/image377.png" o:title=""/>
</v:shape><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Package" ShapeID="_x0000_i1132"
  DrawAspect="Icon" ObjectID="_1629748318">
 </o:OLEObject>
</xml><![endif]--></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>10</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）自定义</span><span lang=EN-US>Outputformat</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>时，注意在</span><span lang=EN-US>RecordWirter</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中的</span><span lang=EN-US>close</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>方法必须关闭流资源。否则输出的文件内容中数据为空。</span></p>

<p class=a><span lang=EN-US style='font-size:10.5pt'>@Override<o:p></o:p></span></p>

<p class=a><span lang=EN-US style='font-size:10.5pt'>public void
close(TaskAttemptContext context) throws IOException, InterruptedException {<o:p></o:p></span></p>

<p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
2'>      </span>if (atguigufos != null) {<o:p></o:p></span></p>

<p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
3'>          </span>atguigufos.close();<o:p></o:p></span></p>

<p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
2'>      </span>}<o:p></o:p></span></p>

<p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
2'>      </span>if (otherfos != null) {<o:p></o:p></span></p>

<p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
3'>          </span>otherfos.close();<o:p></o:p></span></p>

<p class=a><span lang=EN-US style='font-size:10.5pt'><span style='mso-tab-count:
2'>      </span>}<o:p></o:p></span></p>

<p class=a><span lang=EN-US style='font-size:10.5pt'>}<o:p></o:p></span></p>

</div>

</body>

</html>
