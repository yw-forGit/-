<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="08_Spark.files/filelist.xml">
<link rel=Edit-Time-Data href="08_Spark.files/editdata.mso">
<link rel=themeData href="08_Spark.files/themedata.thmx">
<link rel=colorSchemeMapping href="08_Spark.files/colorschememapping.xml">

<link href="./css/treemenu.css" rel="stylesheet" type="text/css">
<!-- GitHub Pages只认./js/xxx这种相对定位，不认js/xxx这种 -->
<script src="./js/jquery-3.4.1.min.js"></script>
<script src="./js/test.js"></script>
<script src="./js/treemenu.js"></script>
</head>

<body lang=ZH-CN link=blue vlink="#954F72" style='tab-interval:21.0pt;
text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<div id="noScroll" class="divcss5-right">
	<ul id="menuId" class="tree">
	</ul>
	<div style="font-size: 10px; color: #161FB0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 （Ctrl+滚动鼠标可缩放页面）</div>
</div> 

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:22.0pt;line-height:125%;font-family:
宋体'>Spark<o:p></o:p></span></b></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>参考：尚硅谷</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>
<!--
<p class=MsoNormal align=right style='text-align:right;word-break:break-all'><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>制作日期：</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>2019-07-11 - 2019-08-01<o:p></o:p></span></p> -->

<p class=MsoNormal align=right style='text-align:right'><span style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>制作人：小</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>邹</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>[yw_forgit@163.com]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US style='mso-no-proof:yes'>Spark</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;mso-no-proof:yes'>体系</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:22.0pt;line-height:240%;mso-fareast-font-family:宋体'><o:p></o:p></span></h1>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="图片_x0020_1" o:spid="_x0000_i1346" type="#_x0000_t75"
 style='width:252.75pt;height:368.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image001.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=337 height=491
src="08_Spark.files/image001.png" v:shapes="图片_x0020_1"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2" o:spid="_x0000_i1345" type="#_x0000_t75" style='width:315.75pt;
 height:377.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image003.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=421 height=503
src="08_Spark.files/image003.png" v:shapes="图片_x0020_2"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_3" o:spid="_x0000_i1344" type="#_x0000_t75" style='width:284.25pt;
 height:297.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image005.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=379 height=397
src="08_Spark.files/image005.png" v:shapes="图片_x0020_3"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>Spark</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>基础</span></h1>

<h2><span lang=EN-US>Spark</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>产生的背景</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_4" o:spid="_x0000_i1343" type="#_x0000_t75" style='width:508.5pt;
 height:114.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image007.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=678 height=153
src="08_Spark.files/image007.png" v:shapes="图片_x0020_4"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果有</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>10</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>个</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>jar</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>包，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>spark</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>只需要部署一个就够了，故迭代式计算比</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>MapReduce</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>快。</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_5" o:spid="_x0000_i1342" type="#_x0000_t75" style='width:566.25pt;
 height:160.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image009.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=755 height=214
src="08_Spark.files/image009.png" v:shapes="图片_x0020_5"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Spark</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>是什么</span></h2>

<p class=MsoNormal><span lang=EN-US><a href="http://spark.apache.org/">http://spark.apache.org/</a></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_6" o:spid="_x0000_i1341" type="#_x0000_t75" style='width:354.75pt;
 height:111.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image011.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=473 height=149
src="08_Spark.files/image011.png" v:shapes="图片_x0020_6"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果每个框架都用自己的调度器，而他们之间又没有通信，那么他们都会为自己的框架抢夺资源，对于一台机器上有多个调度器，就会有问题，故把资源调度器单独拿出来做成框架，就是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Yarn</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>、</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Mesos</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>等，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Yarn</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Hadoop</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>独有的，而是独立的。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_7" o:spid="_x0000_i1340" type="#_x0000_t75" style='width:332.25pt;
 height:180.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image013.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=443 height=241
src="08_Spark.files/image013.png" v:shapes="图片_x0020_7"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-size:10.5pt;line-height:125%;
font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>大一统的软件栈，各个组件关系密切并且可以相互调用，这种设计有几个好处：</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:125%'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、软件栈中所有的程序库和高级组件</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>都可以从下层的改进中获益。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、运行整个软件栈的代价变小了。不需要运</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>行</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'> 5 </span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'> 10 </span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>套独立的软件系统了，一个机构只需要运行一套软件系统即可。系统的部署、维护、测试、支持等大大缩减。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>3</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、能够构建出无缝整合不同处理模型的应用。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Spark</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的角色</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'>Standalone</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;mso-no-proof:yes'>模式</span><span lang=EN-US style='mso-no-proof:
yes'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_11" o:spid="_x0000_i1339" type="#_x0000_t75" style='width:468pt;
 height:283.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image015.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=624 height=378
src="08_Spark.files/image015.png" v:shapes="图片_x0020_11"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Driver</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>、</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Executor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_9" o:spid="_x0000_i1338" type="#_x0000_t75" style='width:379.5pt;
 height:178.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image017.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=506 height=238
src="08_Spark.files/image017.png" v:shapes="图片_x0020_9"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Spark</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>有三种运行模式，公司一般用</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Yarn</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>模式</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_10" o:spid="_x0000_i1337" type="#_x0000_t75" style='width:435pt;
 height:243pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image019.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=580 height=324
src="08_Spark.files/image019.png" v:shapes="图片_x0020_10"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>Spark</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>集群安装</span></h2>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>下载安装包</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Spark</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>读</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Hadoop</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件都是要读</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Hadoop</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的库的，所以</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Spark2.x</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是对应</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Hadoop2.7</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>或者更高版本的，版本要对应。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_17" o:spid="_x0000_i1336" type="#_x0000_t75" style='width:4in;
 height:481.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image021.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=384 height=642
src="08_Spark.files/image021.png" v:shapes="图片_x0020_17"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>安装</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>四台上传，然后解压，改名为</span><span
lang=EN-US>spark2.1.1</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_8" o:spid="_x0000_i1335" type="#_x0000_t75" style='width:567pt;
 height:205.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image023.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=274
src="08_Spark.files/image023.png" v:shapes="图片_x0020_8"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进入</span><span
lang=EN-US>spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>目录</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_12" o:spid="_x0000_i1334" type="#_x0000_t75" style='width:246pt;
 height:166.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image025.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=328 height=222
src="08_Spark.files/image025.png" v:shapes="图片_x0020_12"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>conf</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>目录</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_13" o:spid="_x0000_i1333" type="#_x0000_t75" style='width:380.25pt;
 height:120pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image027.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=507 height=160
src="08_Spark.files/image027.png" v:shapes="图片_x0020_13"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>bin</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>目录（删除了</span><span
lang=EN-US>.cmd</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的文件，这是</span><span
lang=EN-US>windows</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>下的）</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_14" o:spid="_x0000_i1332" type="#_x0000_t75" style='width:359.25pt;
 height:157.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image028.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=479 height=210
src="08_Spark.files/image028.png" v:shapes="图片_x0020_14"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>修改三个配置文件的配置</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_15" o:spid="_x0000_i1331" type="#_x0000_t75" style='width:567pt;
 height:334.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image029.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=446
src="08_Spark.files/image029.png" v:shapes="图片_x0020_15"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>编辑</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>slaves</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>文件</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_18" o:spid="_x0000_i1330" type="#_x0000_t75" style='width:171.75pt;
 height:15.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image031.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=229 height=21
src="08_Spark.files/image031.png" v:shapes="图片_x0020_18"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_16" o:spid="_x0000_i1329" type="#_x0000_t75" style='width:567pt;
 height:339pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image032.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=452
src="08_Spark.files/image032.png" v:shapes="图片_x0020_16"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>Standalone</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>模式</span></h3>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>配置</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:14.0pt;line-height:156%;
mso-fareast-font-family:宋体'>spark-env.sh</span></h4>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>编辑</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark-env.sh</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，配置</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Master</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>host</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>port<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_19" o:spid="_x0000_i1328" type="#_x0000_t75" style='width:434.25pt;
 height:247.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image034.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=579 height=330
src="08_Spark.files/image034.png" v:shapes="图片_x0020_19"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_20" o:spid="_x0000_i1327" type="#_x0000_t75" style='width:506.25pt;
 height:343.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image036.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=675 height=458
src="08_Spark.files/image036.png" v:shapes="图片_x0020_20"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>启动集群</span></h4>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动集群（仅在</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Master</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>上执行）</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_21" o:spid="_x0000_i1326" type="#_x0000_t75" style='width:361.5pt;
 height:105pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image038.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=482 height=140
src="08_Spark.files/image038.png" v:shapes="图片_x0020_21"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就可以看到</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Master</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>、</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Worker</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>了</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_22" o:spid="_x0000_i1325" type="#_x0000_t75" style='width:567pt;
 height:291pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image039.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=388
src="08_Spark.files/image039.png" v:shapes="图片_x0020_22"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span lang=EN-US>Web</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>界面</span></h4>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>打开浏览器看一下</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_23" o:spid="_x0000_i1324" type="#_x0000_t75" style='width:567pt;
 height:304.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image041.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=406
src="08_Spark.files/image041.png" v:shapes="图片_x0020_23"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>提交任务</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>执行官方案例</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_24" o:spid="_x0000_i1323" type="#_x0000_t75" style='width:567pt;
 height:24pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image043.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=32
src="08_Spark.files/image043.png" v:shapes="图片_x0020_24"><![endif]></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";background:white;mso-highlight:
  white;mso-font-kerning:0pt'>bin<b>/</b><a name="_Hlk14103184">spark<b>-</b>submit</a>
  <b><span style='color:red'>--</span></b><span style='color:red'>class</span>
  org<b>.</b>apache<b>.</b>spark<b>.</b>examples<b>.</b>SparkPi <b><span
  style='color:red'>--</span></b><span style='color:red'>master</span> <u>spark://master:7077</u>
  <span style='color:red'>--executor-memory</span> 1G <span style='color:red'>--total-executor-cores</span>
  2 ./examples/jars/spark-examples_2.11-2.1.1.jar 100</span><span lang=EN-US
  style='font-size:9.0pt;mso-fareast-font-family:宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体;color:red'>--class</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'> </span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>是执行哪个类</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体;color:red'>--master</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'> </span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>提交给哪个集群</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体;color:red'>--executor-memory</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'> </span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>指定执行器的内存</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体;color:red'>--total-executor-cores</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'> </span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>指定执行器的核数</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>./examples/jars/spark-examples_2.11-2.1.1.jar
</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:
125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>SparkPi</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>在哪个</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>jar</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>包，叫</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体;color:red'>application-jar</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>参数</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>100 </span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>是</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>SparkPi</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的参数，叫</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体;color:red'>application-arguments</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>参数</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>算出来的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Pi</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>的结果，准确度不高</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_25" o:spid="_x0000_i1322" type="#_x0000_t75" style='width:567pt;
 height:150.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image045.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=201
src="08_Spark.files/image045.png" v:shapes="图片_x0020_25"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>交互式</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不指定</span><span
lang=EN-US>--master</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，则默认使用</span><span
lang=EN-US>local</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>模式</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_26" o:spid="_x0000_i1321" type="#_x0000_t75" style='width:381pt;
 height:19.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image047.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=508 height=26
src="08_Spark.files/image047.png" v:shapes="图片_x0020_26"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_27" o:spid="_x0000_i1320" type="#_x0000_t75" style='width:567pt;
 height:147pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image048.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=196
src="08_Spark.files/image048.png" v:shapes="图片_x0020_27"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>创建一个测试文件，注意，该测试文件</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Master</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>、</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Worker</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>都要持有，否则可能会找不到该文件</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_29" o:spid="_x0000_i1319" type="#_x0000_t75" style='width:234pt;
 height:64.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image050.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=312 height=86
src="08_Spark.files/image050.png" v:shapes="图片_x0020_29"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>计算单词出现的次数。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark-shell</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>在哪个目录启动，相对路径就默认是当前的目录</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_30" o:spid="_x0000_i1318" type="#_x0000_t75" style='width:508.5pt;
 height:34.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image051.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=678 height=46
src="08_Spark.files/image051.png" v:shapes="图片_x0020_30"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;font-family:"Courier New";color:black;background:
  white;mso-highlight:white;mso-font-kerning:0pt'>sc.textFile(&quot;./word.txt&quot;).flatMap(_.split(&quot;
  &quot;)).map((_,1)).reduceByKey(_+_).collect</span><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span lang=EN-US>spark-submit</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的参数</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_36" o:spid="_x0000_i1317" type="#_x0000_t75" style='width:252.75pt;
 height:150pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image052.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=337 height=200
src="08_Spark.files/image052.png" v:shapes="图片_x0020_36"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>--master</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的参数</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_35" o:spid="_x0000_i1316" type="#_x0000_t75" style='width:408pt;
 height:147pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image054.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=544 height=196
src="08_Spark.files/image054.png" v:shapes="图片_x0020_35"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Yarn</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>模式，两个参数结合用</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_37" o:spid="_x0000_i1315" type="#_x0000_t75" style='width:375.75pt;
 height:56.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image056.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=501 height=75
src="08_Spark.files/image056.png" v:shapes="图片_x0020_37"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>yarn-client</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>与</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>yarn-cluster</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的区别在于</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Driver</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>运行在哪里，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Driver</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行在当前提交的节点上就是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>client</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Driver</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>随机运行在一个节点，按资源来分配就是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>cluster<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_38" o:spid="_x0000_i1314" type="#_x0000_t75" style='width:362.25pt;
 height:48.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image058.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=483 height=65
src="08_Spark.files/image058.png" v:shapes="图片_x0020_38"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;mso-no-proof:
yes'>不带</span><span lang=EN-US style='mso-no-proof:yes'>--master</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;mso-no-proof:yes'>，可以看到是</span><span lang=EN-US style='mso-no-proof:
yes'>local[*]</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;mso-no-proof:
yes'>模式</span><span lang=EN-US style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_40" o:spid="_x0000_i1313" type="#_x0000_t75" style='width:567pt;
 height:167.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image060.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=223
src="08_Spark.files/image060.png" v:shapes="图片_x0020_40"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span lang=EN-US>HA</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>配置</span></h4>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='letter-spacing:.5pt;mso-no-proof:
yes'><!--[if gte vml 1]><v:shape id="Picture_x0020_19" o:spid="_x0000_i1312"
 type="#_x0000_t75" alt="../../../../../../Desktop/261550259381739." style='width:349.5pt;
 height:155.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image062.png" o:title="261550259381739"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=466 height=207
src="08_Spark.files/image062.png"
alt="../../../../../../Desktop/261550259381739." v:shapes="Picture_x0020_19"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动</span><span
lang=EN-US>Zookeeper</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_63" o:spid="_x0000_i1311" type="#_x0000_t75" style='width:473.25pt;
 height:204.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image064.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=631 height=273
src="08_Spark.files/image064.png" v:shapes="图片_x0020_63"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>编辑</span><span
lang=EN-US>spark-env.sh</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_64" o:spid="_x0000_i1310" type="#_x0000_t75" style='width:260.25pt;
 height:23.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image066.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=347 height=31
src="08_Spark.files/image066.png" v:shapes="图片_x0020_64"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就是这个配置</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_65" o:spid="_x0000_i1309" type="#_x0000_t75" style='width:473.25pt;
 height:190.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image067.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=631 height=254
src="08_Spark.files/image067.png" v:shapes="图片_x0020_65"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>都添加，</span><span
lang=EN-US>zk</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群不指定端口也行，</span><span
lang=EN-US>dir</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是</span><span
lang=EN-US>zk</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>存放</span><span
lang=EN-US>spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_70" o:spid="_x0000_i1308" type="#_x0000_t75" style='width:566.25pt;
 height:276pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image069.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=368
src="08_Spark.files/image069.png" v:shapes="图片_x0020_70"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>既然是高可用，那就把单机去掉</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_67" o:spid="_x0000_i1307" type="#_x0000_t75" style='width:567pt;
 height:272.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image071.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=363
src="08_Spark.files/image071.png" v:shapes="图片_x0020_67"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>重启</span><span
lang=EN-US>spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群，在</span><span
lang=EN-US>master</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主机启动</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_68" o:spid="_x0000_i1306" type="#_x0000_t75" style='width:285pt;
 height:158.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image073.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=380 height=211
src="08_Spark.files/image073.png" v:shapes="图片_x0020_68"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>然后在任意一台</span><span
lang=EN-US>slave</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>单起一个</span><span
lang=EN-US>master</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_69" o:spid="_x0000_i1305" type="#_x0000_t75" style='width:567pt;
 height:256.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image075.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=342
src="08_Spark.files/image075.png" v:shapes="图片_x0020_69"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>访问</span><span
lang=EN-US>master:8080</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，可以看到</span><span
lang=EN-US>master</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是活跃的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_71" o:spid="_x0000_i1304" type="#_x0000_t75" style='width:567pt;
 height:308.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image077.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=411
src="08_Spark.files/image077.png" v:shapes="图片_x0020_71"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>访问</span><span
lang=EN-US>slave1:8080</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US>slave1</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是</span><span
lang=EN-US>standby</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_72" o:spid="_x0000_i1303" type="#_x0000_t75" style='width:567pt;
 height:264pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image079.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=352
src="08_Spark.files/image079.png" v:shapes="图片_x0020_72"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>spark-shell</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>指定</span><span
lang=EN-US>master</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的参数可以两个</span><span
lang=EN-US>master</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>一起指定</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_74" o:spid="_x0000_i1302" type="#_x0000_t75" style='width:567pt;
 height:180pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image081.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=240
src="08_Spark.files/image081.png" v:shapes="图片_x0020_74"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>指行前面的例子，都是正常的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_75" o:spid="_x0000_i1301" type="#_x0000_t75" style='width:507pt;
 height:31.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image083.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=676 height=42
src="08_Spark.files/image083.png" v:shapes="图片_x0020_75"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>杀掉活跃的</span><span
lang=EN-US>Master</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_76" o:spid="_x0000_i1300" type="#_x0000_t75" style='width:197.25pt;
 height:143.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image084.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=263 height=191
src="08_Spark.files/image084.png" v:shapes="图片_x0020_76"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_77" o:spid="_x0000_i1299" type="#_x0000_t75" style='width:567pt;
 height:63.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image086.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=85
src="08_Spark.files/image086.png" v:shapes="图片_x0020_77"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>还是能执行</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_78" o:spid="_x0000_i1298" type="#_x0000_t75" style='width:566.25pt;
 height:69.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image088.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=93
src="08_Spark.files/image088.png" v:shapes="图片_x0020_78"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>访问</span><span
lang=EN-US>web</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>页面</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_79" o:spid="_x0000_i1297" type="#_x0000_t75" style='width:479.25pt;
 height:267.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image090.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=639 height=357
src="08_Spark.files/image090.png" v:shapes="图片_x0020_79"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>master</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主机上重新启动</span><span
lang=EN-US>Master</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_80" o:spid="_x0000_i1296" type="#_x0000_t75" style='width:383.25pt;
 height:85.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image092.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=511 height=114
src="08_Spark.files/image092.png" v:shapes="图片_x0020_80"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>变回了</span><span
lang=EN-US>standby</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>了</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_81" o:spid="_x0000_i1295" type="#_x0000_t75" style='width:446.25pt;
 height:187.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image094.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=595 height=250
src="08_Spark.files/image094.png" v:shapes="图片_x0020_81"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>看一眼</span><span
lang=EN-US>zk</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群的数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_82" o:spid="_x0000_i1294" type="#_x0000_t75" style='width:567pt;
 height:54.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image096.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=73
src="08_Spark.files/image096.png" v:shapes="图片_x0020_82"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>JobHistoryServer</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>配置</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进入</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark-shell</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>会有一个</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>WebUI</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的入口可以查看</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_41" o:spid="_x0000_i1293" type="#_x0000_t75" style='width:566.25pt;
 height:203.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image098.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=271
src="08_Spark.files/image098.png" v:shapes="图片_x0020_41"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>访问</span><span
lang=EN-US><a href="http://192.168.56.100:4040/">http://192.168.56.100:4040</a>
</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>发现是空的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_42" o:spid="_x0000_i1292" type="#_x0000_t75" style='width:345pt;
 height:225pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image100.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=460 height=300
src="08_Spark.files/image100.png" v:shapes="图片_x0020_42"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>执行上面的官方案例，要停掉</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark-shell</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>（</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>spark-shell</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>与</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>spark-submit</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不要同时运行，否则</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>webUI</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的端口会变）</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_43" o:spid="_x0000_i1291" type="#_x0000_t75" style='width:566.25pt;
 height:6.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image101.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=9
src="08_Spark.files/image101.png" v:shapes="图片_x0020_43"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>快速访问页面，不断就能看到任务，任务执行完就无法看到了</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_44" o:spid="_x0000_i1290" type="#_x0000_t75" style='width:567pt;
 height:306pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image103.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=408
src="08_Spark.files/image103.png" v:shapes="图片_x0020_44"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><a href="http://192.168.56.100:4040"><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>http://192.168.56.100:4040</span></a></span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'> </span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:
125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就是历史服务，但是任务执行完就没有了，下面配置永久保存历史。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>编辑</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark-defaults.conf<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_47" o:spid="_x0000_i1289" type="#_x0000_t75" style='width:296.25pt;
 height:18pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image105.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=395 height=24
src="08_Spark.files/image105.png" v:shapes="图片_x0020_47"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_45" o:spid="_x0000_i1288" type="#_x0000_t75" style='width:396pt;
 height:271.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image106.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=528 height=362
src="08_Spark.files/image106.png" v:shapes="图片_x0020_45"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_54" o:spid="_x0000_i1287" type="#_x0000_t75" style='width:566.25pt;
 height:354pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image108.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=472
src="08_Spark.files/image108.png" v:shapes="图片_x0020_54"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>master</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>主机启动</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>HDFS</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>集群</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_49" o:spid="_x0000_i1286" type="#_x0000_t75" style='width:209.25pt;
 height:18.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image110.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=279 height=25
src="08_Spark.files/image110.png" v:shapes="图片_x0020_49"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>创建历史存放的目录</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_50" o:spid="_x0000_i1285" type="#_x0000_t75" style='width:288.75pt;
 height:18pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image111.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=385 height=24
src="08_Spark.files/image111.png" v:shapes="图片_x0020_50"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>编辑</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark-env.sh<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_51" o:spid="_x0000_i1284" type="#_x0000_t75" style='width:259.5pt;
 height:18pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image112.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=346 height=24
src="08_Spark.files/image112.png" v:shapes="图片_x0020_51"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_58" o:spid="_x0000_i1283" type="#_x0000_t75" style='width:567pt;
 height:285pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image113.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=380
src="08_Spark.files/image113.png" v:shapes="图片_x0020_58"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>然后执行前面的例子</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_53" o:spid="_x0000_i1282" type="#_x0000_t75" style='width:566.25pt;
 height:9.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image115.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=13
src="08_Spark.files/image115.png" v:shapes="图片_x0020_53"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>等待执行结束</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_55" o:spid="_x0000_i1281" type="#_x0000_t75" style='width:567pt;
 height:148.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image117.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=198
src="08_Spark.files/image117.png" v:shapes="图片_x0020_55"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>访问历史服务的时候，发现是访问不了的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_56" o:spid="_x0000_i1280" type="#_x0000_t75" style='width:323.25pt;
 height:198pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image119.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=431 height=264
src="08_Spark.files/image119.png" v:shapes="图片_x0020_56"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>配置完历史服务之后，跑完程序之后才开历史服务，看看任务是否保存下来了没有，即使不开历史服务</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_57" o:spid="_x0000_i1279" type="#_x0000_t75" style='width:297.75pt;
 height:20.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image121.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=397 height=27
src="08_Spark.files/image121.png" v:shapes="图片_x0020_57"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>访问</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_59" o:spid="_x0000_i1278" type="#_x0000_t75" style='width:567pt;
 height:188.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image122.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=251
src="08_Spark.files/image122.png" v:shapes="图片_x0020_59"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_60" o:spid="_x0000_i1277" type="#_x0000_t75" style='width:567pt;
 height:201pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image124.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=268
src="08_Spark.files/image124.png" v:shapes="图片_x0020_60"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_61" o:spid="_x0000_i1276" type="#_x0000_t75" style='width:567pt;
 height:188.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image126.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=251
src="08_Spark.files/image126.png" v:shapes="图片_x0020_61"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这可以看出来，启动历史服务是为了在</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Web</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>查看的，不启动也不影响把历史保存起来。</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>Yarn</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>模式</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Yarn</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>模式要做</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>HA</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就要做</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Yarn</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>HA</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>编辑</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>/usr/local/<span style='color:red'>hadoop/etc/hadoop/yarn-site.xml</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_83" o:spid="_x0000_i1275" type="#_x0000_t75" style='width:566.25pt;
 height:300pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image128.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=400
src="08_Spark.files/image128.png" v:shapes="图片_x0020_83"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>&lt;!-- </span><span style='font-size:11.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
  mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>检查内存的方式不对，所以直接关闭了，就不会导致任务被杀掉</span><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'> --&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>&lt;!-- </span><span style='font-size:11.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
  mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配至，则直接将其杀掉，默认是</span><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>true --&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>&lt;property&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'><span style='mso-spacerun:yes'>   
  </span>&lt;name&gt;yarn.nodemanager.pmem-check-enabled&lt;/name&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'><span style='mso-spacerun:yes'>   
  </span>&lt;value&gt;false&lt;/value&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>&lt;/property&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>&lt;!-- </span><span style='font-size:11.0pt;mso-bidi-font-size:10.5pt;
  font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
  mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是</span><span
  lang=EN-US style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>true --&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>&lt;property&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'><span style='mso-spacerun:yes'>   
  </span>&lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'><span style='mso-spacerun:yes'>   
  </span>&lt;value&gt;false&lt;/value&gt;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-bidi-font-size:10.5pt;mso-fareast-font-family:
  宋体'>&lt;/property&gt;</span><span lang=EN-US style='font-size:12.0pt;
  mso-bidi-font-size:11.0pt;mso-fareast-font-family:宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>yarn</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>集群</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_84" o:spid="_x0000_i1274" type="#_x0000_t75" style='width:324.75pt;
 height:70.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image130.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=433 height=94
src="08_Spark.files/image130.png" v:shapes="图片_x0020_84"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>编辑</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark-env.sh<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_85" o:spid="_x0000_i1273" type="#_x0000_t75" style='width:259.5pt;
 height:22.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image132.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=346 height=30
src="08_Spark.files/image132.png" v:shapes="图片_x0020_85"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>配置</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Yarn</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>conf</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>目录，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Hadoop</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>conf</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>目录可以不配置的，只是一个默认路径而已，后面说。而且</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>YARN_CONF_DIR</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的配置不需要四台服务器都配上，只在一台机器上配置也行，这是用来给提交</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>程序给</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>yarn</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_86" o:spid="_x0000_i1272" type="#_x0000_t75" style='width:567pt;
 height:321.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image133.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=429
src="08_Spark.files/image133.png" v:shapes="图片_x0020_86"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>执行一下例子</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_87" o:spid="_x0000_i1271" type="#_x0000_t75" style='width:567pt;
 height:12pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image135.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=16
src="08_Spark.files/image135.png" v:shapes="图片_x0020_87"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;mso-bidi-font-size:8.0pt;mso-fareast-font-family:宋体'>bin/spark-submit
  --class org.apache.spark.examples.SparkPi <span style='color:red'>--master</span>
  <span style='color:#70AD47;mso-themecolor:accent6'>yarn </span><span
  style='color:red'>--deploy-mode</span> <span style='color:#70AD47;mso-themecolor:
  accent6'>client </span>./examples/jars/spark-examples_2.11-2.1.1.jar 100</span><span
  lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>可以看到执行结果</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_88" o:spid="_x0000_i1270" type="#_x0000_t75" style='width:474.75pt;
 height:313.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image137.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=633 height=418
src="08_Spark.files/image137.png" v:shapes="图片_x0020_88"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Standalone</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>、</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Yarn</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>等模式可以同时运行，执行的时候指定给谁执行就谁执行。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行模式只是集群的管理者不同。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_93" o:spid="_x0000_i1269" type="#_x0000_t75" style='width:246pt;
 height:127.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image139.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=328 height=170
src="08_Spark.files/image139.png" v:shapes="图片_x0020_93"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>HADOOP_CONF_DIR</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的作用：</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>默认路径就变成了</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>HDFS</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的了，要指定本地的文件就要用</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>file:///usr/local/spark...<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_94" o:spid="_x0000_i1268" type="#_x0000_t75" style='width:461.25pt;
 height:212.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image141.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=615 height=283
src="08_Spark.files/image141.png" v:shapes="图片_x0020_94"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>运行模式</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Client</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>就是</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>spark-submit</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>，总有人要执行这个命令，执行个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark-submit</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的就是</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Client</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>submit</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>（提交）的就是代码。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_100" o:spid="_x0000_i1267" type="#_x0000_t75" style='width:402.75pt;
 height:239.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image143.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=537 height=319
src="08_Spark.files/image143.png" v:shapes="图片_x0020_100"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就是这个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark-submit<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_95" o:spid="_x0000_i1266" type="#_x0000_t75" style='width:306.75pt;
 height:96pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image145.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=409 height=128
src="08_Spark.files/image145.png" v:shapes="图片_x0020_95"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_99" o:spid="_x0000_i1265" type="#_x0000_t75" style='width:429pt;
 height:252pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image147.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=572 height=336
src="08_Spark.files/image147.png" v:shapes="图片_x0020_99"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_101" o:spid="_x0000_i1264" type="#_x0000_t75" style='width:431.25pt;
 height:251.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image149.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=575 height=335
src="08_Spark.files/image149.png" v:shapes="图片_x0020_101"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_103" o:spid="_x0000_i1263" type="#_x0000_t75" style='width:567pt;
 height:330.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image151.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=441
src="08_Spark.files/image151.png" v:shapes="图片_x0020_103"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>IDEA</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>环境应用</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_104" o:spid="_x0000_i1262" type="#_x0000_t75" style='width:381pt;
 height:62.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image153.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=508 height=83
src="08_Spark.files/image153.png" v:shapes="图片_x0020_104"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<h3><span lang=EN-US>Scala</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>环境</span></h3>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>新建</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>scala</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>目录，要设置为对应的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Sources Root</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Resources Root<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_111" o:spid="_x0000_i1261" type="#_x0000_t75" style='width:255.75pt;
 height:174pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image155.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=341 height=232
src="08_Spark.files/image155.png" v:shapes="图片_x0020_111"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>搜索插件</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_112" o:spid="_x0000_i1260" type="#_x0000_t75" style='width:405.75pt;
 height:230.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image157.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=541 height=307
src="08_Spark.files/image157.png" v:shapes="图片_x0020_112"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_113" o:spid="_x0000_i1259" type="#_x0000_t75" style='width:340.5pt;
 height:287.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image159.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=454 height=383
src="08_Spark.files/image159.png" v:shapes="图片_x0020_113"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>下不了去官网下载</span><span
lang=EN-US><a href="https://plugins.jetbrains.com/plugin/1347-scala/versions">https://plugins.jetbrains.com/plugin/1347-scala/versions</a></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>然后手动从磁盘安装插件</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_114" o:spid="_x0000_i1258" type="#_x0000_t75" style='width:431.25pt;
 height:243.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image161.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=575 height=325
src="08_Spark.files/image161.png" v:shapes="图片_x0020_114"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_116" o:spid="_x0000_i1257" type="#_x0000_t75" style='width:209.25pt;
 height:255pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image163.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=279 height=340
src="08_Spark.files/image163.png" v:shapes="图片_x0020_116"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>重启</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_115" o:spid="_x0000_i1256" type="#_x0000_t75" style='width:504.75pt;
 height:285.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image165.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=673 height=381
src="08_Spark.files/image165.png" v:shapes="图片_x0020_115"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>重启之后等待更新</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_117" o:spid="_x0000_i1255" type="#_x0000_t75" style='width:199.5pt;
 height:77.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image167.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=266 height=103
src="08_Spark.files/image167.png" v:shapes="图片_x0020_117"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>选择</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Scala SDK<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_118" o:spid="_x0000_i1254" type="#_x0000_t75" style='width:429pt;
 height:243pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image168.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=572 height=324
src="08_Spark.files/image168.png" v:shapes="图片_x0020_118"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>下载</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_119" o:spid="_x0000_i1253" type="#_x0000_t75" style='width:191.25pt;
 height:202.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image170.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=255 height=270
src="08_Spark.files/image170.png" v:shapes="图片_x0020_119"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>下载完成</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_120" o:spid="_x0000_i1252" type="#_x0000_t75" style='width:444pt;
 height:250.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image172.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=592 height=334
src="08_Spark.files/image172.png" v:shapes="图片_x0020_120"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>然后就可以新建</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Scala</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>文件了，如果提示</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>SDK</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>没有，按照提示走就行。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>代码</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>两个</span><span
lang=EN-US>jar</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>包，一个带依赖、一个不带</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2054" o:spid="_x0000_i1251" type="#_x0000_t75" style='width:225pt;
 height:235.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image174.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=300 height=314
src="08_Spark.files/image174.png" v:shapes="图片_x0020_2054"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Spark</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>pom.xml<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><i><span lang=EN-US style='font-size:10.0pt;
  color:black'>&lt;?</span></i><b><span lang=EN-US style='font-size:10.0pt;
  color:blue;background:#EFEFEF'>xml version</span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;1.0&quot; </span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:blue;background:#EFEFEF'>encoding</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;UTF-8&quot;</span></b><i><span
  lang=EN-US style='font-size:10.0pt;color:black'>?&gt;<br>
  </span></i><span lang=EN-US style='font-size:10.0pt;color:black;background:
  #EFEFEF'>&lt;</span><b><span lang=EN-US style='font-size:10.0pt;color:navy;
  background:#EFEFEF'>project </span></b><b><span lang=EN-US style='font-size:
  10.0pt;color:blue;background:#EFEFEF'>xmlns</span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://maven.apache.org/POM/4.0.0&quot;<br>
<span style='mso-spacerun:yes'>         </span></span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:blue;background:#EFEFEF'>xmlns:</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:#660E7A;background:#EFEFEF'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br>
<span style='mso-spacerun:yes'>         </span></span></b><b><span lang=EN-US
  style='font-size:10.0pt;color:#660E7A;background:#EFEFEF'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:blue;background:#EFEFEF'>:schemaLocation</span></b><b><span
  lang=EN-US style='font-size:10.0pt;color:green;background:#EFEFEF'>=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>parent</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>spark<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>artifactId</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>com.ywforwhat<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>1.0-SNAPSHOT<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>parent</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>4.0.0<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>modelVersion</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>sparkCore<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.0pt;color:gray'>&lt;!-- Scala</span></i><i><span
  style='font-size:10.0pt;color:gray'>的插件、打包插件、主类<span lang=EN-US> --&gt;<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>build</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>plugins</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>plugin</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>groupId</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>net.alchim31.maven<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>artifactId</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>scala-maven-plugin<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>3.2.2<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>executions</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                    </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>execution</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                        </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>goals</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                            </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>goal</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>compile<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>goal</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                            </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>goal</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>testCompile<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>goal</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                        </span><span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>goals</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                    </span><span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>execution</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>executions</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>plugin</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>plugin</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>groupId</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>org.apache.maven.plugins<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>artifactId</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>maven-assembly-plugin<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>3.0.0<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>configuration</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                    </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>archive</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                        </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>manifest</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                            </span></span><i><span
  lang=EN-US style='font-size:10.0pt;color:gray'>&lt;!-- </span></i><i><span
  style='font-size:10.0pt;color:gray'>这个名字要对应全类名<span lang=EN-US> --&gt;<br>
<span style='mso-spacerun:yes'>                            </span></span></span></i><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>mainClass</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>WordCount<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>mainClass</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                        </span><span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>manifest</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                    </span><span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>archive</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                    </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>descriptorRefs</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                        </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>descriptorRef</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>jar-with-dependencies<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>descriptorRef</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                    </span><span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>descriptorRefs</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>configuration</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>executions</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                    </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>execution</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                        </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>id</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>make-assembly<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>id</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                        </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>phase</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>package<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>phase</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                        </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>goals</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                            </span><span
  style='background:#EFEFEF'>&lt;</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>goal</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>single<span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>goal</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                        </span><span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>goals</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                    </span><span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>execution</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>                </span><span style='background:
  #EFEFEF'>&lt;/</span></span><b><span lang=EN-US style='font-size:10.0pt;
  color:navy;background:#EFEFEF'>executions</span></b><span lang=EN-US
  style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>            </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>plugin</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>plugins</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;color:navy;background:#EFEFEF'>build</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><br>
  <span style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;color:navy;background:#EFEFEF'>project</span></b><span
  lang=EN-US style='font-size:10.0pt;color:black;background:#EFEFEF'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;color:black'><o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  background:white'><span lang=EN-US style='font-size:10.0pt;mso-fareast-font-family:
  宋体'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>sparkCore</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>pom.xml<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  background:white'><i><span lang=EN-US style='font-size:10.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>&lt;?</span></i><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>xml version</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;1.0&quot; </span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>encoding</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;UTF-8&quot;</span></b><i><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>?&gt;<br>
  </span></i><span lang=EN-US style='font-size:10.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;background:#EFEFEF;mso-font-kerning:0pt'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>project </span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>xmlns</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;http://maven.apache.org/POM/4.0.0&quot;<br>
  <span style='mso-spacerun:yes'>         </span></span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>xmlns:</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;background:#EFEFEF;mso-font-kerning:0pt'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br>
  <span style='mso-spacerun:yes'>         </span></span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;background:#EFEFEF;mso-font-kerning:0pt'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>:schemaLocation</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;http://maven.apache.org/POM/4.0.0
  http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>4.0.0<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>com.ywforwhat<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>spark<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>packaging</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>pom<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>packaging</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>1.0-SNAPSHOT<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>modules</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>module</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>sparkCore<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>module</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>modules</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>org.apache.spark<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>artifactId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>spark-core_2.11<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>version</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>2.1.1<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>&lt;!-- </span></i><i><span style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>编译期间有效，打包的时候不打包他，因为集群肯定有这个依赖<span
  lang=EN-US> --&gt;<br>
  <span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>scope</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>provided<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>scope</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>project</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>WordCount.scala<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:11.0pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'>org.apache.spark.{SparkConf, SparkContext}<br>
  <br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>WordCount {<br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>main(args: Array[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// &gt;&gt; </span></i><i><span
  style='font-size:11.0pt;color:gray'>写与<span lang=EN-US>Spark</span>交互程序的一般步骤<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span>// 1</span>、创建配置信息<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>conf = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;wc&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// 2</span></i><i><span style='font-size:
  11.0pt;color:gray'>、创建<span lang=EN-US>sparkcontext<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>sc = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>SparkContext(conf)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// 3</span></i><i><span style='font-size:
  11.0pt;color:gray'>、处理<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span>// </span>读取数据，参数外面传递进来<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>lines = sc.textFile(args(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>0</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// flatMap</span></i><i><span
  style='font-size:11.0pt;color:gray'>压平<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>words = lines.flatMap(_.split(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot; &quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// map(word, 1)<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>k2v = words.map((_, </span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// reduceByKey(word, x)<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>result = k2v.reduceByKey(_+_)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>输出为文件，参数外面传递进来<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>result.saveAsTextFile(args(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// 4</span></i><i><span style='font-size:
  11.0pt;color:gray'>、关闭连接<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>sc.stop()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>运行</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上传</span><span
lang=EN-US>jar</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>包</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_124" o:spid="_x0000_i1250" type="#_x0000_t75" style='width:567pt;
 height:15pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image176.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=20
src="08_Spark.files/image176.png" v:shapes="图片_x0020_124"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>本地执行试试</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_126" o:spid="_x0000_i1249" type="#_x0000_t75" style='width:566.25pt;
 height:12pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image178.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=16
src="08_Spark.files/image178.png" v:shapes="图片_x0020_126"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'>bin/spark-submit --class WordCount --master spark://master:7077
  ./sparkCore-1.0-SNAPSHOT.jar file:///usr/local/spark2.1.1/word.txt
  file:///usr/local/spark2.1.1/out<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>本地文件系统测试不行，看不到结果</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_127" o:spid="_x0000_i1248" type="#_x0000_t75" style='width:261pt;
 height:53.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image180.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=348 height=71
src="08_Spark.files/image180.png" v:shapes="图片_x0020_127"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>那就用</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>HDFS</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>put</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>测试文件上去</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2049" o:spid="_x0000_i1247" type="#_x0000_t75" style='width:282.75pt;
 height:18pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image181.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=377 height=24
src="08_Spark.files/image181.png" v:shapes="图片_x0020_2049"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>使用</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>HDFS</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的资源执行，注意输出结果的目录</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>out</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不能已经存在，否则报错</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2048" o:spid="_x0000_i1246" type="#_x0000_t75" style='width:567pt;
 height:11.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image183.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=15
src="08_Spark.files/image183.png" v:shapes="图片_x0020_2048"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'>bin/spark-submit --class WordCount --master spark://master:7077
  ./sparkCore-1.0-SNAPSHOT.jar hdfs://master:9000/word.txt
  hdfs://master:9000/out<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>看一眼</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>word.txt<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2053" o:spid="_x0000_i1245" type="#_x0000_t75" style='width:219pt;
 height:56.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image185.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=292 height=75
src="08_Spark.files/image185.png" v:shapes="图片_x0020_2053"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>结果</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2052" o:spid="_x0000_i1244" type="#_x0000_t75" style='width:441.75pt;
 height:114pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image186.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=589 height=152
src="08_Spark.files/image186.png" v:shapes="图片_x0020_2052"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>结果内容</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2051" o:spid="_x0000_i1243" type="#_x0000_t75" style='width:291pt;
 height:174pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image188.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=388 height=232
src="08_Spark.files/image188.png" v:shapes="图片_x0020_2051"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>报错问题</span></h3>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>1</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>）执行程序的时候的报错：</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>java.lang.IllegalArgumentException:
requirement failed: Can only call getServletHandlers on a running MetricsSystem<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这是因为之前高可用了，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>slave1</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>主机现在作为了</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>alive</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>状态的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Master</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，而</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>master</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>主机也有</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Master</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>但是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>standby</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>状态，连接集群</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>--master</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>又是连接</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>master</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>主机，就有了这种错误。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>kill</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>掉</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>slave1</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>主机上的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Master</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>即可。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>2</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>）中途报错（但是这个报错并不影响结果的输出）：</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'>19/07/17 15:09:57 ERROR server.TransportRequestHandler:
Error while invoking RpcHandler#receive() for one-way message.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'>org.apache.spark.SparkException:
Could not find AppClient.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
org.apache.spark.rpc.netty.Dispatcher.postMessage(Dispatcher.scala:154)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at org.apache.spark.rpc.netty.Dispatcher.postOneWayMessage(Dispatcher.scala:134)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
org.apache.spark.rpc.netty.NettyRpcHandler.receive(NettyRpcEnv.scala:570)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
org.apache.spark.network.server.TransportRequestHandler.processOneWayMessage(TransportRequestHandler.java:180)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at org.apache.spark.network.server.TransportRequestHandler.handle(TransportRequestHandler.java:109)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
org.apache.spark.network.server.TransportChannelHandler.channelRead(TransportChannelHandler.java:118)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:367)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:353)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:346)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:266)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:367)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:353)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:346)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:367)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:353)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:346)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
org.apache.spark.network.util.TransportFrameDecoder.channelRead(TransportFrameDecoder.java:85)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:367)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:353)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:346)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1294)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:367)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:353)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:911)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:131)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:652)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:575)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:489)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:451)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at
io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:140)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:144)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
7.5pt;line-height:125%;mso-fareast-font-family:宋体'><span style='mso-tab-count:
1'>         </span>at java.lang.Thread.run(Thread.java:745)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>出现这个问题是因为资源问题，指定分配更多的内存、</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>cores</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>即可</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2055" o:spid="_x0000_i1242" type="#_x0000_t75" style='width:567pt;
 height:8.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image190.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=11
src="08_Spark.files/image190.png" v:shapes="图片_x0020_2055"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'>bin/spark-submit --class WordCount --master spark://master:7077 <span
  style='color:red'>--executor-memory 1G --total-executor-cores 2</span>
  ./sparkCore-1.0-SNAPSHOT.jar hdfs://master:9000/word.txt
  hdfs://master:9000/out2<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>本地调试</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>其他不变，就多一个文件</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2056" o:spid="_x0000_i1241" type="#_x0000_t75" style='width:240.75pt;
 height:284.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image192.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=321 height=379
src="08_Spark.files/image192.png" v:shapes="图片_x0020_2056"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>依赖范围要去掉</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2057" o:spid="_x0000_i1240" type="#_x0000_t75" style='width:324.75pt;
 height:239.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image194.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=433 height=319
src="08_Spark.files/image194.png" v:shapes="图片_x0020_2057"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>代码</span></p>

<p class=MsoNormal><span lang=EN-US>LocalWordCount.scala</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:11.0pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'>org.apache.spark.{SparkConf, SparkContext}<br>
  <br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>LocalWordCount {<br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>main(args: Array[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// &gt;&gt; </span></i><i><span
  style='font-size:11.0pt;color:gray'>写与<span lang=EN-US>Spark</span>交互程序的一般步骤<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span>// 1</span>、创建配置信息。<span lang=EN-US>local[*]</span>表示按照机器的线程来，如果是<span
  lang=EN-US>local</span>表示是单线程，<span lang=EN-US>local[x]</span>表示<span
  lang=EN-US>x</span>个线程<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>conf = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;wc&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>).</span><b><span lang=EN-US
  style='font-size:14.0pt;color:black'>setMaster(</span></b><b><span
  lang=EN-US style='font-size:14.0pt;color:green'>&quot;local[*]&quot;</span></b><b><span
  lang=EN-US style='font-size:14.0pt;color:black'>)</span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// 2</span></i><i><span style='font-size:
  11.0pt;color:gray'>、创建<span lang=EN-US>sparkcontext<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>sc = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>SparkContext(conf)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// 3</span></i><i><span style='font-size:
  11.0pt;color:gray'>、处理<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span>// </span>读取数据，<span lang=EN-US>windows</span>的系统文件<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>lines = </span><b><span
  lang=EN-US style='font-size:16.0pt;color:black'>sc.textFile(</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:green'>&quot;C:</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:green'>Users</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:green'>WIN</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:green'>Desktop</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:green'>word.txt&quot;</span></b><b><span
  lang=EN-US style='font-size:16.0pt;color:black'>)</span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// flatMap</span></i><i><span
  style='font-size:11.0pt;color:gray'>压平<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>words = lines.flatMap(_.split(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot; &quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// map(word, 1)<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>k2v = words.map((_, </span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// reduceByKey(word, x)<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>result = k2v.reduceByKey(_+_)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>输出。循环打印<span lang=EN-US><br>
<span style='mso-spacerun:yes'>   </span></span></span></i><b><i><span
  lang=EN-US style='font-size:14.0pt;color:gray'><span style='mso-spacerun:yes'> </span></span></i></b><b><span
  lang=EN-US style='font-size:14.0pt;color:black'>result.foreach(<i>println</i>)</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// 4</span></i><i><span style='font-size:
  11.0pt;color:gray'>、关闭连接<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>sc.stop()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行完，中间就会打印结果</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2058" o:spid="_x0000_i1239" type="#_x0000_t75" style='width:567pt;
 height:206.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image196.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=275
src="08_Spark.files/image196.png" v:shapes="图片_x0020_2058"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>debug</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的话，断点、</span><span
lang=EN-US>debug</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行，点击下图的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2059" o:spid="_x0000_i1238" type="#_x0000_t75" style='width:406.5pt;
 height:307.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image198.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=542 height=410
src="08_Spark.files/image198.png" v:shapes="图片_x0020_2059"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>出来一个框</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2060" o:spid="_x0000_i1237" type="#_x0000_t75" style='width:237pt;
 height:231.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image200.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=316 height=309
src="08_Spark.files/image200.png" v:shapes="图片_x0020_2060"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这样子就能看到结果啦，这种就是</span><span
lang=EN-US>REPL</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的交互式</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2061" o:spid="_x0000_i1236" type="#_x0000_t75" style='width:261.75pt;
 height:257.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image202.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=349 height=343
src="08_Spark.files/image202.png" v:shapes="图片_x0020_2061"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>远程调试</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>改一下就行，记得要</span><span
lang=EN-US>setJars</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，然后输入输出的路径改为</span><span
lang=EN-US>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>即可，一般都不会这样操作。一般都是打</span><span
lang=EN-US>jar</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>包扔上去执行</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2062" o:spid="_x0000_i1235" type="#_x0000_t75" style='width:464.25pt;
 height:1in;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image204.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=619 height=96
src="08_Spark.files/image204.png" v:shapes="图片_x0020_2062"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>Spark Core</span></h1>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>概述</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2064" o:spid="_x0000_i1234" type="#_x0000_t75" style='width:132pt;
 height:186pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image206.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=176 height=248
src="08_Spark.files/image206.png" v:shapes="图片_x0020_2064"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2065" o:spid="_x0000_i1233" type="#_x0000_t75" style='width:296.25pt;
 height:186pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image208.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=395 height=248
src="08_Spark.files/image208.png" v:shapes="图片_x0020_2065"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>是什么</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2066" o:spid="_x0000_i1232" type="#_x0000_t75" style='width:567pt;
 height:336pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image210.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=448
src="08_Spark.files/image210.png" v:shapes="图片_x0020_2066"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不可变：</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>经过算子</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>textFile</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>（</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>textFile</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>、</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>flatMap</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>map</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>方法就是算子），生成的</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>lines</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>就是不可变的，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Scala</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>val</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>就是不可变的，</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>var</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>才是可变的，经过算子之后，生成新的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>RDD</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>，而不是对原有的</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>RDD</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>进行改变。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2067" o:spid="_x0000_i1231" type="#_x0000_t75" style='width:165.75pt;
 height:32.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image212.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=221 height=43
src="08_Spark.files/image212.png" v:shapes="图片_x0020_2067"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的弹性表现</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2073" o:spid="_x0000_i1230" type="#_x0000_t75" style='width:300.75pt;
 height:142.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image214.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=401 height=190
src="08_Spark.files/image214.png" v:shapes="图片_x0020_2073"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>血统</span></h2>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>下图就描述了</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的血统，哪一块丢失了就从血统的上一个开始执行，都丢失了就从开头读文件开始，这是因为</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>是基于内存计算了，不适合做副本。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2071" o:spid="_x0000_i1229" type="#_x0000_t75" style='width:447pt;
 height:167.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image216.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=596 height=223
src="08_Spark.files/image216.png" v:shapes="图片_x0020_2071"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>管这个血统叫</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>DAG</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>（即有向无环图）</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上图是之前的代码</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2072" o:spid="_x0000_i1228" type="#_x0000_t75" style='width:180pt;
 height:155.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image218.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=240 height=207
src="08_Spark.files/image218.png" v:shapes="图片_x0020_2072"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>都做了什么</span></h2>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>RDD</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>为用户提供了一组方便的数据转换与求值方法，即如何处理数据，经过算子之前的数据是怎么样的，经过算子之后变成了什么样的。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2078" o:spid="_x0000_i1227" type="#_x0000_t75" style='width:511.5pt;
 height:263.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image220.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=682 height=351
src="08_Spark.files/image220.png" v:shapes="图片_x0020_2078"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的创建</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2079" o:spid="_x0000_i1226" type="#_x0000_t75" style='width:342pt;
 height:223.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image222.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=456 height=298
src="08_Spark.files/image222.png" v:shapes="图片_x0020_2079"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>makeRDD</span></h3>

<p class=MsoNormal><span lang=EN-US>SparkContext.scala</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>的源码</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2083" o:spid="_x0000_i1225" type="#_x0000_t75" style='width:341.25pt;
 height:89.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image224.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=455 height=119
src="08_Spark.files/image224.png" v:shapes="图片_x0020_2083"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这就创建了一个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>RDD<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2081" o:spid="_x0000_i1224" type="#_x0000_t75" style='width:492pt;
 height:82.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image226.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=656 height=110
src="08_Spark.files/image226.png" v:shapes="图片_x0020_2081"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>parallelize</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:16.0pt;line-height:173%;mso-fareast-font-family:宋体'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US>SparkContext.scala</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>的源码</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2082" o:spid="_x0000_i1223" type="#_x0000_t75" style='width:359.25pt;
 height:84pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image227.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=479 height=112
src="08_Spark.files/image227.png" v:shapes="图片_x0020_2082"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>跟</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>makeRDD</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>一样</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2084" o:spid="_x0000_i1222" type="#_x0000_t75" style='width:513.75pt;
 height:82.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image229.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=685 height=110
src="08_Spark.files/image229.png" v:shapes="图片_x0020_2084"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>可以指定分片</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2085" o:spid="_x0000_i1221" type="#_x0000_t75" style='width:426.75pt;
 height:99pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image230.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=569 height=132
src="08_Spark.files/image230.png" v:shapes="图片_x0020_2085"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分片默认用核数</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2089" o:spid="_x0000_i1220" type="#_x0000_t75" style='width:434.25pt;
 height:144.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image232.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=579 height=193
src="08_Spark.files/image232.png" v:shapes="图片_x0020_2089"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>指定分片</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2088" o:spid="_x0000_i1219" type="#_x0000_t75" style='width:426.75pt;
 height:114.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image234.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=569 height=153
src="08_Spark.files/image234.png" v:shapes="图片_x0020_2088"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的转换</span></h2>

<h3><span lang=EN-US>map(func)</span></h3>

<p class=MsoNormal><span lang=EN-US>RDD.scala</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>源码</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2090" o:spid="_x0000_i1218" type="#_x0000_t75" style='width:426.75pt;
 height:69.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image236.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=569 height=93
src="08_Spark.files/image236.png" v:shapes="图片_x0020_2090"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>map</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>应用于每个数据</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2091" o:spid="_x0000_i1217" type="#_x0000_t75" style='width:501.75pt;
 height:71.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image238.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=669 height=95
src="08_Spark.files/image238.png" v:shapes="图片_x0020_2091"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>mapPartitions(func)</span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类似于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>map</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，但独立地在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的每一个分片上运行，因此在类型为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>T</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上运行时，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>func</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的函数类型必须是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Iterator[T] =&gt;
Iterator[U]</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>。假设有</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>N</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>个元素，有</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>M</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>个分区，那么</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>map</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>的函数的将被调用</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>N</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>次</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>,</span><span style='mso-bidi-font-size:10.5pt;line-height:
150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>而</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:150%'>mapPartitions</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>被调用</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>M</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>次</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>,</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>一个函数一次处理所有分区。尽量使用</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>mapPartitions</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>一个分区的情况</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2092" o:spid="_x0000_i1216" type="#_x0000_t75" style='width:517.5pt;
 height:152.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image239.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=690 height=203
src="08_Spark.files/image239.png" v:shapes="图片_x0020_2092"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>两个分区的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2094" o:spid="_x0000_i1215" type="#_x0000_t75" style='width:485.25pt;
 height:33pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image240.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=647 height=44
src="08_Spark.files/image240.png" v:shapes="图片_x0020_2094"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2093" o:spid="_x0000_i1214" type="#_x0000_t75" style='width:414pt;
 height:42.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image242.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=552 height=57
src="08_Spark.files/image242.png" v:shapes="图片_x0020_2093"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span lang=EN-US>Scala</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的省略问题：</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2095" o:spid="_x0000_i1213" type="#_x0000_t75" style='width:343.5pt;
 height:151.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image244.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=458 height=202
src="08_Spark.files/image244.png" v:shapes="图片_x0020_2095"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2096" o:spid="_x0000_i1212" type="#_x0000_t75" style='width:288.75pt;
 height:226.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image246.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=385 height=302
src="08_Spark.files/image246.png" v:shapes="图片_x0020_2096"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2097" o:spid="_x0000_i1211" type="#_x0000_t75" style='width:231.75pt;
 height:225pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image248.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=309 height=300
src="08_Spark.files/image248.png" v:shapes="图片_x0020_2097"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span lang=EN-US>Driver</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>与</span><span
lang=EN-US>Executor</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2098" o:spid="_x0000_i1210" type="#_x0000_t75" style='width:359.25pt;
 height:240.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image250.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=479 height=321
src="08_Spark.files/image250.png" v:shapes="图片_x0020_2098"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>glom</span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>将每一个分区形成一个数组，形成新的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类型时</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD[Array[T]]<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>scala&gt; val rdd = sc.parallelize(1 to 16,4)</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>rdd: org.apache.spark.rdd.RDD[Int] =
ParallelCollectionRDD[65] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>scala&gt; rdd.glom().collect()</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>res25: Array[Array[Int]] = Array(Array(1, 2, 3, 4), Array(5,
6, 7, 8), Array(9, 10, 11, 12), Array(13, 14, 15, 16))</span><span lang=EN-US
style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>flatMap(func) <span
style='mso-spacerun:yes'> </span>-- map</span><span style='mso-bidi-font-size:
14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>后再扁平化</span><span
lang=EN-US style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2100" o:spid="_x0000_i1209" type="#_x0000_t75" style='width:366pt;
 height:61.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image252.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=488 height=82
src="08_Spark.files/image252.png" v:shapes="图片_x0020_2100"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类似于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>map</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，但是每一个输入元素可以被映射为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>0</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>或多个输出元素（所以</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>func</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>应该返回一个序列，而不是单一元素）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; var rdd = sc.makeRDD(Array(1,2,3,4,5))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[7] at
makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.map(_+1).collect </span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res12: Array[Int] = Array(2, 3, 4, 5, 6)</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.flatMap(x =&gt; Array(x + 1)).collect </span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res13: Array[Int] = Array(2, 3, 4, 5, 6)</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<h3><span lang=EN-US>filter(func)</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2101" o:spid="_x0000_i1208" type="#_x0000_t75" style='width:247.5pt;
 height:99.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image254.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=330 height=133
src="08_Spark.files/image254.png" v:shapes="图片_x0020_2101"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>返回一个新的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，该</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>由经过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>func</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数计算后返回值为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>true</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的输入元素组成</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; var sourceFilter =
sc.parallelize(Array(&quot;xiaoming&quot;,&quot;xiaojiang&quot;,&quot;xiaohe&quot;,&quot;dazhi&quot;))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>sourceFilter: org.apache.spark.rdd.RDD[String] =
ParallelCollectionRDD[10] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val filter = sourceFilter.filter(_.contains(&quot;</span><span
lang=EN-US style='font-size:9.0pt;color:red'>xiao</span><span lang=EN-US
style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>&quot;))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>filter: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[11] at
filter at &lt;console&gt;:26</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; sourceFilter.collect()</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res9: Array[String] = Array(xiaoming, xiaojiang, xiaohe, </span><span
lang=EN-US style='font-size:9.0pt;color:red'>dazhi</span><span lang=EN-US
style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; filter.collect()</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res10: Array[String] = Array(xiaoming, xiaojiang, xiaohe)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>mapPartitionsWithIndex(func)<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2102" o:spid="_x0000_i1207" type="#_x0000_t75" style='width:373.5pt;
 height:125.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image256.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=498 height=167
src="08_Spark.files/image256.png" v:shapes="图片_x0020_2102"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类似于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>mapPartitions</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，但</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>func</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>带有一个整数参数表示分片的索引值，因此在类型为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>T</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上运行时，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>func</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的函数类型必须是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(Int,
Interator[T]) =&gt; Iterator[U]<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; var rdd =
  sc.makeRDD(Array(1,2,3,4,5),<span style='color:red'>2</span>)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>rdd: org.apache.spark.rdd.RDD[Int] =
  ParallelCollectionRDD[14] at makeRDD at &lt;console&gt;:24<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; rdd.partitions.size <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res20: Int = <span style='color:red'>2</span><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:11.0pt;line-height:150%;font-family:"Courier New";
  color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>// </span><span
  style='font-size:11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:"Courier New";color:green;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>拿出分区号，</span><span lang=EN-US
  style='font-size:11.0pt;line-height:150%;font-family:"Courier New";
  color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>x</span><span
  style='font-size:11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:"Courier New";color:green;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>是分区号。</span><span lang=EN-US
  style='font-size:11.0pt;line-height:150%;font-family:"Courier New";
  color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>0:</span><span
  style='font-size:11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:"Courier New";color:green;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>、</span><span lang=EN-US
  style='font-size:11.0pt;line-height:150%;font-family:"Courier New";
  color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>1:</span><span
  style='font-size:11.0pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:"Courier New";color:green;background:white;
  mso-highlight:white;mso-font-kerning:0pt'>是分区号</span><span lang=EN-US
  style='font-size:6.5pt;line-height:150%;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; rdd.mapPartitionsWithIndex((x,y)
  =&gt; Iterator(x+&quot;:&quot;+y.mkString(&quot;|&quot;))).collect <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:7.5pt;line-height:150%;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res21: Array[String] = Array(0:1|2, 1:3|4|5)</span><span
  lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt;
  sc.makeRDD(Array(1,2,3,4),5).mapPartitionsWithIndex((x,y) =&gt;
  Iterator(x+&quot;:&quot;+y.mkString(&quot;|&quot;))).collect </span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res19: Array[String] = Array(0:, 1:1, 2:2, 3:3,
  4:4)</span><span lang=EN-US style='mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>sample(withReplacement, fraction, seed)<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2106" o:spid="_x0000_i1206" type="#_x0000_t75" style='width:407.25pt;
 height:193.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image258.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=543 height=258
src="08_Spark.files/image258.png" v:shapes="图片_x0020_2106"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>以指定的随机种子随机抽样出数量为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>fraction</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的数据，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>withReplacement</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>表示是抽出的数据是否放回，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>true</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>为有放回的抽样，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>false</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>为无放回的抽样，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>seed</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>用于指定随机数生成器种子。例如从</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中随机且有放回的抽出</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>50%</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的数据，随机种子值为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>3</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>（即可能以</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>1 2 3</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的其中一个为起始值）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(1 to 10)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[20] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.collect()</span><span lang=EN-US style='font-size:
10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res15: Array[Int] = Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-family:"Courier New";
color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>// </span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>大概抽</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-family:"Courier New";
color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>40%</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>，不是准确的</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; var sample1 = rdd.sample(true,0.4,2)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>sample1: org.apache.spark.rdd.RDD[Int] =
PartitionwiseSampledRDD[21] at sample at &lt;console&gt;:26</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-family:"Courier New";
color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>// </span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'>有放回即有重复的</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-family:"Courier New";
color:green;background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; sample1.collect()</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res16: Array[Int] = Array(1, 2, 2, 7, 7, 8, 9)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; var sample2 = rdd.sample(false,0.2,3)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>sample2: org.apache.spark.rdd.RDD[Int] =
PartitionwiseSampledRDD[22] at sample at &lt;console&gt;:26</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; sample2.collect()</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res17: Array[Int] = Array(1, 9)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>distinct([numTasks]))<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2107" o:spid="_x0000_i1205" type="#_x0000_t75" style='width:397.5pt;
 height:39.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image260.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=530 height=53
src="08_Spark.files/image260.png" v:shapes="图片_x0020_2107"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对源</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行去重后返回一个新的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD. </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>默认情况下，只有</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>8</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个并行任务来操作，但是可以传入一个可选的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>numTasks</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数改变它。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(Array(1,1,2))</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[16] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.distinct.collect </span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res22: Array[Int] = Array(1, 2)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;color:red'>coalesce</span><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>(numPartitions) <o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>每个分区就是一个并行度，如果一个分区太大而处理的数据太少，即每个并行度处理的数据太少，效率就不高，故可以缩减分区，把单个分区的数据增加，并行处理的数据就会多一些。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数</span><span
lang=EN-US>Boolean</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>：</span><span
lang=EN-US>false</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>只在</span><span
lang=EN-US>Executor</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>内部缩减，</span><span
lang=EN-US>true</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>发送数据到其他</span><span
lang=EN-US>Executor</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行缩减，即</span><span
lang=EN-US>true</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的时候会触发</span><span
lang=EN-US>Shuffle</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2115" o:spid="_x0000_i1204" type="#_x0000_t75" style='width:380.25pt;
 height:154.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image262.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=507 height=206
src="08_Spark.files/image262.png" v:shapes="图片_x0020_2115"><![endif]></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>与</span><span
lang=EN-US>repartition</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的区别</span><span
lang=EN-US>:</span><a name="_Hlk11574048"><span lang=EN-US style='font-size:
9.0pt;line-height:125%;font-family:"Courier New";color:blue'> </span><span
lang=EN-US>repartition(numPartitions:Int):RDD[T]</span></a><span
style='mso-bookmark:_Hlk11574048'><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和</span><span
lang=EN-US>coalesce(numPartitions:Int</span></span><span style='mso-bookmark:
_Hlk11574048'><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US>shuffle:Boolean=false):RDD[T] repartition</span></span><span
style='mso-bookmark:_Hlk11574048'><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>只是</span><span
lang=EN-US>coalesce</span></span><span style='mso-bookmark:_Hlk11574048'><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>接口中</span><span lang=EN-US>shuffle</span></span><span
style='mso-bookmark:_Hlk11574048'><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>为</span><span
lang=EN-US>true</span></span><span style='mso-bookmark:_Hlk11574048'><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>的实现</span><span lang=EN-US>.</span></span></p>

<span style='mso-bookmark:_Hlk11574048'></span>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>缩减分区数，用于大数据集过滤后，提高小数据集的执行效率。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(1 to 16,4)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[54] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.partitions.size</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res20: Int = 4</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val coalesceRDD = rdd.coalesce(3)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>coalesceRDD: org.apache.spark.rdd.RDD[Int] = CoalescedRDD[55] at
coalesce at &lt;console&gt;:26</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; coalesceRDD.partitions.size</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res21: Int = 3</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>重分区：</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:red'>1</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>、由多变少（变的不多），使用</span><span lang=EN-US style='color:red'>coalesce</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>，默认不进行</span><span lang=EN-US style='color:red'>Shuffle</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>。但是由很多变成很少的时候，建议开启</span><span lang=EN-US
style='color:red'>Shuffle</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>，可以提高性能；</span><span
lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:red'>2</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>、由少变多，必须开启</span><span lang=EN-US style='color:red'>Shuffle</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>，如果使用</span><span lang=EN-US style='color:red'>coalesce</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>的默认情况，则本次分区无效。</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>repartition(numPartitions) <o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>重分区触发</span><span
lang=EN-US>Shuffle</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，是</span><span
lang=EN-US>coalesce</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的一种特例。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2117" o:spid="_x0000_i1203" type="#_x0000_t75" style='width:393pt;
 height:57pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image264.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=524 height=76
src="08_Spark.files/image264.png" v:shapes="图片_x0020_2117"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>根据分区数，从新通过网络随机洗牌所有数据。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(1 to 16,4)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[56] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.partitions.size</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res22: Int = 4</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rerdd = rdd.repartition(2)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rerdd: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[60] at
repartition at &lt;console&gt;:26</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rerdd.partitions.size</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res23: Int = 2</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rerdd = rdd.repartition(4)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rerdd: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[64] at
repartition at &lt;console&gt;:26</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rerdd.partitions.size</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res24: Int = 4</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>repartitionAndSortWithinPartitions(partitioner) <o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>repartitionAndSortWithinPartitions</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>repartition</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数的变种，与</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>repartition</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数不同的是，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>repartitionAndSortWithinPartitions</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在给定的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>partitioner</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>内部（分区内排序）进行排序，性能比</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>repartition</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>要高。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&nbsp;<o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>sortBy(func,[ascending], [numTasks])<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2119" o:spid="_x0000_i1202" type="#_x0000_t75" style='width:390pt;
 height:141.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image266.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=520 height=189
src="08_Spark.files/image266.png" v:shapes="图片_x0020_2119"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>func</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>先对数据进行处理，按照处理后的数据比较结果排序。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.makeRDD(Array(1,1,2))</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[23] at
makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.sortBy(_*2).collect </span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>res24: Array[Int] = Array(1, 1, 2)</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.sortBy(_*2,false).collect </span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>res25: Array[Int] = Array(2, 1, 1)</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>union(otherDataset)<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2120" o:spid="_x0000_i1201" type="#_x0000_t75" style='width:249pt;
 height:46.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image268.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=332 height=62
src="08_Spark.files/image268.png" v:shapes="图片_x0020_2120"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>对源</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>和参数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>求并集后返回一个新的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>RDD<span
style='mso-spacerun:yes'>  </span></span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin;color:red;background:yellow;mso-highlight:
yellow'>不去重</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:
150%;color:red'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd1 = sc.parallelize(1 to 5)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd1: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[23] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd2 = sc.parallelize(5 to 10)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd2: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[24] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd3 = rdd1.union(rdd2)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd3: org.apache.spark.rdd.RDD[Int] = UnionRDD[25] at union at
&lt;console&gt;:28</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd3.collect()</span><span lang=EN-US style='font-size:
10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res18: Array[Int] = Array(1, 2, 3, 4,</span><span lang=EN-US
style='font-size:10.0pt;color:#538135;mso-themecolor:accent6;mso-themeshade:
191'> </span><span lang=EN-US style='font-size:10.0pt;color:red'>5, 5</span><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>, 6,
7, 8, 9, 10)</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>subtract (otherDataset)<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>计算差</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的一种函数，去除两个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中相同的元素，不同的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>将保留下来</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&nbsp;<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(3 to 8)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[70] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd1 = sc.parallelize(1 to 5)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd1: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[71] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:#538135;mso-themecolor:
accent6;mso-themeshade:191'>// </span><span style='font-size:10.0pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>从</span><span
lang=EN-US style='font-size:10.0pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'>rdd</span><span style='font-size:10.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>从去除</span><span
lang=EN-US style='font-size:10.0pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'>rdd</span><span style='font-size:10.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>与</span><span
lang=EN-US style='font-size:10.0pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'>rdd1</span><span style='font-size:10.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>共有的数据，如果反过来结果将不一样</span><span
lang=EN-US style='font-size:10.0pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.subtract(rdd1).collect()</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res27: Array[Int] = Array(8, 6, 7)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>intersection(otherDataset)<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对源</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和参数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>求交集后返回一个新的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd1 = sc.parallelize(1 to 7)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd1: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[26] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd2 = sc.parallelize(5 to 10)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd2: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[27] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd3 = rdd1.intersection(rdd2)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd3: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[33] at
intersection at &lt;console&gt;:28</span><span lang=EN-US style='font-size:
10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd3.collect()</span><span lang=EN-US style='font-size:
10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res19: Array[Int] = Array(5, 6, 7)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>cartesian(otherDataset)<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2121" o:spid="_x0000_i1200" type="#_x0000_t75" style='width:305.25pt;
 height:42pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image270.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=407 height=56
src="08_Spark.files/image270.png" v:shapes="图片_x0020_2121"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>笛卡尔积，生产环境少用，因为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>k</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>很多</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>scala&gt; val rdd1 = sc.parallelize(1 to 3)</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>rdd1: org.apache.spark.rdd.RDD[Int] =
ParallelCollectionRDD[47] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>scala&gt; val rdd2 = sc.parallelize(2 to 5)</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>rdd2: org.apache.spark.rdd.RDD[Int] =
ParallelCollectionRDD[48] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>scala&gt; rdd1.cartesian(rdd2).collect()</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
mso-color-alt:windowtext'>res17: Array[(Int, Int)] = Array((1,2), (1,3), (1,4),
(1,5), (2,2), (2,3), (2,4), (2,5), (3,2), (3,3), (3,4), (3,5))</span><span
lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>pipe(command, [envVars])<o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>调用一个脚本</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2122" o:spid="_x0000_i1199" type="#_x0000_t75" style='width:395.25pt;
 height:76.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image272.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=527 height=102
src="08_Spark.files/image272.png" v:shapes="图片_x0020_2122"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>管道，<span
style='color:red'>对于每个分区</span>，都执行一个</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>perl</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>或者</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>shell</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>脚本，返回输出的</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>shell</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动的当前目录下新建一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>pipe.sh</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>脚本。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&quot;&gt;&gt;&gt;&quot;${LINE}</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是对于每一条传递来的数据前面添加“</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&gt;&gt;&gt;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>”</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
  windowtext'>#!/bin/sh</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
  windowtext'>echo &quot;AA&quot;</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
  windowtext'>while read LINE; do</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
  windowtext'><span style='mso-spacerun:yes'>   </span>echo
  &quot;&gt;&gt;&gt;&quot;${LINE}</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
  windowtext'>done</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果没有权限，则：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>chmod 777 pipe.sh<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(List(&quot;hi&quot;,&quot;Hello&quot;,&quot;how&quot;,&quot;are&quot;,&quot;you&quot;),</span><span
lang=EN-US style='font-size:10.0pt;color:red'>1</span><span lang=EN-US
style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[50]
at parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:
10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.pipe(&quot;/usr/local/spark2.1.1/pipe.sh&quot;).collect()</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res18: Array[String] = Array(</span><span lang=EN-US
style='font-size:10.0pt;color:red'>AA</span><span lang=EN-US style='font-size:
10.0pt;color:black;mso-color-alt:windowtext'>, &gt;&gt;&gt;hi, &gt;&gt;&gt;Hello,
&gt;&gt;&gt;how, &gt;&gt;&gt;are, &gt;&gt;&gt;you)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd =
sc.parallelize(List(&quot;hi&quot;,&quot;Hello&quot;,&quot;how&quot;,&quot;are&quot;,&quot;you&quot;),</span><span
lang=EN-US style='font-size:10.0pt;color:red'>2</span><span lang=EN-US
style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>)</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[52]
at parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:
10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:#538135;mso-themecolor:
accent6;mso-themeshade:191'>// </span><span style='font-size:10.0pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>两个分区就打印两个</span><span
lang=EN-US style='font-size:10.0pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'>AA<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.pipe(&quot;/usr/local/spark2.1.1/pipe.sh&quot;).collect()</span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res19: Array[String] = Array(</span><span lang=EN-US
style='font-size:10.0pt;color:red'>AA</span><span lang=EN-US style='font-size:
10.0pt;color:black;mso-color-alt:windowtext'>, &gt;&gt;&gt;hi,
&gt;&gt;&gt;Hello, </span><span lang=EN-US style='font-size:10.0pt;color:red'>AA</span><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>,
&gt;&gt;&gt;how, &gt;&gt;&gt;are, &gt;&gt;&gt;you)</span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman"'>两种类型的</span><span lang=EN-US style='mso-bidi-font-size:14.0pt;
line-height:172%;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体'>RDD<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2112" o:spid="_x0000_i1198" type="#_x0000_t75" style='width:336.75pt;
 height:210.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image274.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=449 height=281
src="08_Spark.files/image274.png" v:shapes="图片_x0020_2112"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>前面的都是数值</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>（例如：</span><span
lang=EN-US>RDD[Int]</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>），后面的都是键值对</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>（例如：</span><span
lang=EN-US>RDD[K,V]</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>）</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>键值对（</span><span
lang=EN-US>K</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>V</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类型）</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>可以用下面的这些方法，也可以用前面的数值</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的方法，因为键值对</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>也是数值</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的一种，只是一个二元组而已，但是数值</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不能用键值对</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的算子。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2113" o:spid="_x0000_i1197" type="#_x0000_t75" style='width:210.75pt;
 height:272.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image276.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=281 height=363
src="08_Spark.files/image276.png" v:shapes="图片_x0020_2113"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>partitionBy<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2108" o:spid="_x0000_i1196" type="#_x0000_t75" style='width:432.75pt;
 height:162.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image278.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=577 height=217
src="08_Spark.files/image278.png" v:shapes="图片_x0020_2108"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Partitioner</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>抽象类有两个参数</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2109" o:spid="_x0000_i1195" type="#_x0000_t75" style='width:308.25pt;
 height:1in;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image280.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=411 height=96
src="08_Spark.files/image280.png" v:shapes="图片_x0020_2109"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>HashPartitioner</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>是实现类</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2110" o:spid="_x0000_i1194" type="#_x0000_t75" style='width:219.75pt;
 height:97.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image282.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=293 height=130
src="08_Spark.files/image282.png" v:shapes="图片_x0020_2110"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>构造方法可以传递一个</span><span
lang=EN-US>Int</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2111" o:spid="_x0000_i1193" type="#_x0000_t75" style='width:426.75pt;
 height:129pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image284.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=569 height=172
src="08_Spark.files/image284.png" v:shapes="图片_x0020_2111"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行分区操作，如果原有的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>partionRDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和现有的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>partionRDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是一致的话就不进行分区，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>否则会生成</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>ShuffleRDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(Array(1,2,3,4,5)) </span><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[20] at
parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:#538135;mso-themecolor:
accent6;mso-themeshade:191'>// map((_,1))</span><span style='font-size:10.0pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>是为了转成二元组</span><span
lang=EN-US style='font-size:10.0pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.map((_,1)).partitionBy(new
org.apache.spark.HashPartitioner(4)).partitions.size </span><span lang=EN-US
style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>res23: Int = 4</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>join(otherDataset, [numTasks])<o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>相同的</span><span
lang=EN-US>key</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行内连接。</span></p>

<p class=MsoNormal><span lang=EN-US>PairRDDFunctions.scala</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>源码</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2123" o:spid="_x0000_i1192" type="#_x0000_t75" style='width:440.25pt;
 height:96.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image286.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=587 height=129
src="08_Spark.files/image286.png" v:shapes="图片_x0020_2123"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在类型为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,V)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,W)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上调用，返回一个相同</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对应的所有元素对在一起的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,(V,W))</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(Array((1,&quot;a&quot;),(2,&quot;b&quot;),(3,&quot;c&quot;)))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[(Int, String)] =
ParallelCollectionRDD[32] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd1 = sc.parallelize(Array((1,4),(2,5),(3,6)))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd1: org.apache.spark.rdd.RDD[(Int, Int)] = ParallelCollectionRDD[33]
at parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
accent6;mso-themeshade:191'>// </span><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>相同的</span><span
lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'>k</span><span style='font-size:9.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>，值放一起</span><span
lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.join(rdd1).collect()</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res13: Array[(Int, (String, Int))] = Array((1,(a,4)), (2,(b,5)),
(3,(c,6)))</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>cogroup(otherDataset, [numTasks])<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2124" o:spid="_x0000_i1191" type="#_x0000_t75" style='width:386.25pt;
 height:147.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image288.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=515 height=197
src="08_Spark.files/image288.png" v:shapes="图片_x0020_2124"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在类型为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,V)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,W)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上调用，返回一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,(Iterable&lt;V&gt;,Iterable&lt;W&gt;))</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类型的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd =
sc.parallelize(Array((1,&quot;a&quot;),(2,&quot;b&quot;),(3,&quot;c&quot;)))</span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[(Int, String)] =
ParallelCollectionRDD[37] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd1 = sc.parallelize(Array((1,4),(2,5),(3,6)))</span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>rdd1: org.apache.spark.rdd.RDD[(Int, Int)] =
ParallelCollectionRDD[38] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:
accent6;mso-themeshade:191'>// value</span><span style='font-size:7.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>用</span><span
lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'>CompactBuffer</span><span style='font-size:7.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>包装</span><span
lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.cogroup(rdd1).collect()</span><span lang=EN-US
style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>res14: Array[(Int, (Iterable[String], Iterable[Int]))] = Array((1,(CompactBuffer(a),CompactBuffer(4))),
(2,(CompactBuffer(b),CompactBuffer(5))),
(3,(CompactBuffer(c),CompactBuffer(6))))</span><span lang=EN-US
style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd2 = sc.parallelize(Array((4,4),(2,5),(3,6)))</span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>rdd2: org.apache.spark.rdd.RDD[(Int, Int)] = ParallelCollectionRDD[41]
at parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:
7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.cogroup(rdd2).collect()</span><span lang=EN-US
style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>res15: Array[(Int, (Iterable[String], Iterable[Int]))] =
Array((4,(CompactBuffer(),CompactBuffer(4))),
(1,(CompactBuffer(a),CompactBuffer())),
(2,(CompactBuffer(b),CompactBuffer(5))), (3,(CompactBuffer(c),CompactBuffer(6))))</span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd3 =
sc.parallelize(Array((1,&quot;a&quot;),(1,&quot;d&quot;),(2,&quot;b&quot;),(3,&quot;c&quot;)))</span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>rdd3: org.apache.spark.rdd.RDD[(Int, String)] =
ParallelCollectionRDD[44] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:
accent6;mso-themeshade:191'>// </span><span style='font-size:7.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>没有值就为空</span><span
lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'>CompactBuffer()<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd3.cogroup(rdd2).collect()</span><span lang=EN-US
style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>res16: Array[(Int, (Iterable[String], Iterable[Int]))] =
Array((4,(CompactBuffer(),CompactBuffer(4))), (1,(CompactBuffer(d,
a),CompactBuffer())), (2,(CompactBuffer(b),CompactBuffer(5))),
(3,(CompactBuffer(c),CompactBuffer(6))))</span><span lang=EN-US
style='font-size:7.5pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>reduceByKey(func, [numTasks]) <o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US>reduceByKey</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>会先预聚合（没有预聚合就是没有在内部把相同的</span><span
lang=EN-US>key</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>先合并），然后再</span><span
lang=EN-US>Shuffle</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，而</span><span
lang=EN-US>groupByKey</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>直接就</span><span
lang=EN-US>Shuffle</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>了，预聚合之后再进行</span><span
lang=EN-US>Shuffle</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>（重新洗牌，需要在多个节点之间传输），可以减少数据的传输。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2125" o:spid="_x0000_i1190" type="#_x0000_t75" style='width:335.25pt;
 height:52.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image290.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=447 height=70
src="08_Spark.files/image290.png" v:shapes="图片_x0020_2125"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,V)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上调用，返回一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,V)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，使用指定的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数，将相同</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的值聚合到一起，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>任务的个数可以通过第二个可选的参数来设置。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(List((&quot;female&quot;,1),(&quot;male&quot;,5),(&quot;female&quot;,5),(&quot;male&quot;,2)))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[(String, Int)] =
ParallelCollectionRDD[46] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val reduce = rdd.reduceByKey((x,y) =&gt; x+y)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>reduce: org.apache.spark.rdd.RDD[(String, Int)] = ShuffledRDD[47]
at reduceByKey at &lt;console&gt;:26</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; reduce.collect()</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res29: Array[(String, Int)] = Array((female,6), (male,7))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>groupByKey<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2126" o:spid="_x0000_i1189" type="#_x0000_t75" style='width:425.25pt;
 height:162.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image292.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=567 height=217
src="08_Spark.files/image292.png" v:shapes="图片_x0020_2126"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>groupByKey</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>也是对每个</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行操作，但只生成一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>sequence</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><!--[if gte vml 1]><v:shape id="图片_x0020_2127" o:spid="_x0000_i1188"
 type="#_x0000_t75" style='width:479.25pt;height:55.5pt;visibility:visible;
 mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image294.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=639 height=74
src="08_Spark.files/image294.png" v:shapes="图片_x0020_2127"><![endif]></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>combineByKey[C]<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2128" o:spid="_x0000_i1187" type="#_x0000_t75" style='width:402pt;
 height:102pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image296.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=536 height=136
src="08_Spark.files/image296.png" v:shapes="图片_x0020_2128"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>(&nbsp;&nbsp;createCombiner:&nbsp;V&nbsp;=&gt;&nbsp;C,&nbsp;&nbsp;mergeValue:&nbsp;(C,&nbsp;V)&nbsp;=&gt;&nbsp;C,&nbsp;&nbsp;mergeCombiners:&nbsp;(C,&nbsp;C)&nbsp;=&gt;&nbsp;C)
<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对相同</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>K</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，把</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>V</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>合并成一个集合。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>createCombiner</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>（分区内使用，第一次遇到某</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>时）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>:</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> combineByKey() </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>会遍历分区中的所有元素，因此每个元素的键要么还没有遇到过，要么就</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和之前的某个元素的键相同。如果这是一个新的元素</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,combineByKey() </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>会使用一个叫作</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> createCombiner()
</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的函数来创建</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&nbsp;<br>
</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>那个键对应的累加器的初始值</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>mergeValue</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>（分区内使用，非第一次遇到某</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>时）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>:</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果这是一个在处理当前分区之前已经遇到的键，</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>它会使用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> mergeValue() </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法将该键的累加器对应的当前值与这个新的值进行合并</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%;color:red'>mergeCombiners</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>（将多个分区的结果进行合并）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>:</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&nbsp;</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>由于每个分区都是独立处理的，</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>因此对于同一个键可以有多个累加器。如果有两个或者更多的分区都有对应同一个键的累加器，</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就需要使用用户提供的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> mergeCombiners()
</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法将各个分区的结果进行合并。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>一张图解析清楚：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><!--[if gte vml 1]><v:shape id="图片_x0020_2129" o:spid="_x0000_i1186"
 type="#_x0000_t75" style='width:566.25pt;height:201pt;visibility:visible;
 mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image298.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=268
src="08_Spark.files/image298.png" v:shapes="图片_x0020_2129"><![endif]></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; val scores =
sc.parallelize(Array((&quot;a&quot;,30),(&quot;a&quot;,40),(&quot;b&quot;,15),(&quot;a&quot;,20),(&quot;b&quot;,20),(&quot;b&quot;,30),(&quot;c&quot;,50),(&quot;b&quot;,20),(&quot;c&quot;,50)),3)
</span><span lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>scores: org.apache.spark.rdd.RDD[(String, Int)] =
ParallelCollectionRDD[30] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>// </span><span lang=EN-US style='font-size:6.5pt;color:#ED7D31;
mso-themecolor:accent2'>x =&gt; (x,1)</span><span style='font-size:6.5pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#ED7D31;mso-themecolor:accent2'>创建，名称在前分数在后；</span><span lang=EN-US
style='font-size:6.5pt;color:#4472C4;mso-themecolor:accent5'>j+i._1</span><span
style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:#4472C4;mso-themecolor:accent5'>这是分数（第一次出现的取第二位与已经出现过的取第一位相加），</span><span
lang=EN-US style='font-size:6.5pt;color:#4472C4;mso-themecolor:accent5'>i._2+1</span><span
style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:#4472C4;mso-themecolor:accent5'>是次数；</span><span
lang=EN-US style='font-size:6.5pt;color:#385623;mso-themecolor:accent6;
mso-themeshade:128'>x._1+y._1</span><span style='font-size:6.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#385623;mso-themecolor:accent6;mso-themeshade:128'>分数相加，</span><span
lang=EN-US style='font-size:6.5pt;color:#385623;mso-themecolor:accent6;
mso-themeshade:128'>x._2+y._2</span><span style='font-size:6.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#385623;mso-themecolor:accent6;mso-themeshade:128'>次数相加</span><span
lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; scores.combineByKey(</span><span lang=EN-US
style='font-size:6.5pt;color:#ED7D31;mso-themecolor:accent2'>x =&gt; (x,1)</span><span
lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:windowtext'>,</span><span
lang=EN-US style='font-size:6.5pt;color:#4472C4;mso-themecolor:accent5'>(i:(Int,Int),j)
=&gt; (j+i._1,i._2+1)</span><span lang=EN-US style='font-size:6.5pt;color:black;
mso-color-alt:windowtext'>,</span><span lang=EN-US style='font-size:6.5pt;
color:#385623;mso-themecolor:accent6;mso-themeshade:128'>(x:(Int,Int),y:(Int,Int))
=&gt; (x._1+y._1,x._2+y._2)</span><span lang=EN-US style='font-size:6.5pt;
color:black;mso-color-alt:windowtext'>).collect </span><span lang=EN-US
style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>res26: Array[(String, (Int, Int))] = Array((c,(100,2)), (a,(90,3)),
(b,(85,4)))</span><span lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>aggregateByKey<o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数比较特殊，有</span><span
lang=EN-US>zeroValue-U</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>Partitioner</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>(U,V)</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>(U,U)</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2134" o:spid="_x0000_i1185" type="#_x0000_t75" style='width:383.25pt;
 height:138.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image300.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=511 height=185
src="08_Spark.files/image300.png" v:shapes="图片_x0020_2134"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>(zeroValue:U,[partitioner:&nbsp;Partitioner]) (seqOp:
(U, V) =&gt; U,combOp: (U, U) =&gt; U) <o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>kv</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中，，按</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>value</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行分组合并，合并时，将每个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>value</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和初始值作为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>seq</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数的参数，进行计算，返回的结果作为一个新的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>kv</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对，然后再将结果按照</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行合并，最后将每个分组的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>value</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>传递给</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>combine</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数进行计算（先将前两个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>value</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行计算，将返回结果和下一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>value</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>传给</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>combine</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数，以此类推），将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>与计算结果作为一个新的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>kv</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对输出。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>seqOp</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>函数用于在每一个分区中用初始值逐步迭代</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>value</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>combOp</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数用于合并每个分区中的结果。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; val scores =
sc.parallelize(Array((&quot;a&quot;,30),(&quot;a&quot;,40),(&quot;b&quot;,15),(&quot;a&quot;,20),(&quot;b&quot;,20),(&quot;b&quot;,30),(&quot;c&quot;,50),(&quot;b&quot;,20),(&quot;c&quot;,50)),3)
</span><span lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scores: org.apache.spark.rdd.RDD[(String, Int)] =
ParallelCollectionRDD[30] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; scores.aggregateByKey((0,0))((u,v) =&gt;
(u._1+v,u._2+1),(u1,u2) =&gt; (u1._1+u2._1,u1._2+u2._2)).collect </span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>res27: Array[(String, (Int, Int))] = Array((c,(100,2)), (a,(90,3)),
(b,(85,4)))</span><span lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:#385623;mso-themecolor:
accent6;mso-themeshade:128'>// </span><span style='font-size:7.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#385623;mso-themecolor:accent6;mso-themeshade:128'>改变</span><span
lang=EN-US style='font-size:7.5pt;color:#385623;mso-themecolor:accent6;
mso-themeshade:128'>zeroValue</span><span style='font-size:7.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#385623;mso-themecolor:accent6;mso-themeshade:128'>的值、分区的值</span><span
lang=EN-US style='font-size:7.5pt;color:#385623;mso-themecolor:accent6;
mso-themeshade:128'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; scores.aggregateByKey((1,0))((u,v) =&gt;
(u._1+v,u._2+1),(u1,u2) =&gt; (u1._1+u2._1,u1._2+u2._2)).collect </span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>res28: Array[(String, (Int, Int))] = Array((c,(101,2)), (a,(92,3)),
(b,(88,4)))</span><span lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; scores.aggregateByKey((1,3))((u,v) =&gt;
(u._1+v,u._2+1),(u1,u2) =&gt; (u1._1+u2._1,u1._2+u2._2)).collect </span><span
lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
windowtext'>res29: Array[(String, (Int, Int))] = Array((c,(101,5)), (a,(92,9)),
(b,(88,13)))</span><span lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>foldByKey<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2135" o:spid="_x0000_i1184" type="#_x0000_t75" style='width:384pt;
 height:109.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image302.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=512 height=146
src="08_Spark.files/image302.png" v:shapes="图片_x0020_2135"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>其实是调用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>aggregateByKey</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2136" o:spid="_x0000_i1183" type="#_x0000_t75" style='width:360.75pt;
 height:75.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image304.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=481 height=101
src="08_Spark.files/image304.png" v:shapes="图片_x0020_2136"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>(zeroValue: V)(func: (V, V) =&gt; V): RDD[(K, V)] <o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>aggregateByKey</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的简化操作，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>seqop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>combop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>相同</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.parallelize(List((1,3),(1,2),(1,4),(2,3),(3,6),(3,8)),3)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[(Int, Int)] =
ParallelCollectionRDD[91] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val agg = rdd.foldByKey(0)(_+_)</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>agg: org.apache.spark.rdd.RDD[(Int, Int)] = ShuffledRDD[92] at
foldByKey at &lt;console&gt;:26</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; agg.collect()</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res61: Array[(Int, Int)] = Array((3,14), (1,9), (2,3))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>sortByKey([ascending], [numTasks]) <o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2137" o:spid="_x0000_i1182" type="#_x0000_t75" style='width:435pt;
 height:105.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image306.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=580 height=141
src="08_Spark.files/image306.png" v:shapes="图片_x0020_2137"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,V)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上调用，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>K</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>必须实现</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Ordered</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>接口，返回一个按照</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行排序的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,V)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd =
sc.parallelize(Array((3,&quot;aa&quot;),(6,&quot;cc&quot;),(2,&quot;bb&quot;),(1,&quot;dd&quot;)))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[(Int, String)] =
ParallelCollectionRDD[14] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.sortByKey(true).collect()</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res9: Array[(Int, String)] = Array((1,dd), (2,bb), (3,aa), (6,cc))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.sortByKey(false).collect()</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res10: Array[(Int, String)] = Array((6,cc), (3,aa), (2,bb), (1,dd))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>mapValues<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2138" o:spid="_x0000_i1181" type="#_x0000_t75" style='width:366pt;
 height:93pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image308.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=488 height=124
src="08_Spark.files/image308.png" v:shapes="图片_x0020_2138"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>针对于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(K,V)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>形式的类型只对</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>V</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行操作</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&nbsp;<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd3 =
sc.parallelize(Array((1,&quot;a&quot;),(1,&quot;d&quot;),(2,&quot;b&quot;),(3,&quot;c&quot;)))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd3: org.apache.spark.rdd.RDD[(Int, String)] = ParallelCollectionRDD[67]
at parallelize at &lt;console&gt;:24</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd3.mapValues(_+&quot;|||&quot;).collect()</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res26: Array[(Int, String)] = Array((1,a|||), (1,d|||), (2,b|||),
(3,c|||))</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2139" o:spid="_x0000_i1180" type="#_x0000_t75" style='width:328.5pt;
 height:32.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image310.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=438 height=43
src="08_Spark.files/image310.png" v:shapes="图片_x0020_2139"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:major-bidi'>RDD</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>的行动（</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:major-bidi'>Action</span><span
style='font-size:14.0pt;line-height:172%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）</span><span
lang=EN-US style='font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:major-bidi'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>行动操作最后是结果，不再是</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>reduce(func)<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2140" o:spid="_x0000_i1179" type="#_x0000_t75" style='width:279.75pt;
 height:140.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image312.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=373 height=187
src="08_Spark.files/image312.png" v:shapes="图片_x0020_2140"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>func</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数聚集</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中的所有元素，这个功能必须是可交换且可并联的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd1 = sc.makeRDD(1 to 10,2)</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd1: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[85] at
makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd1.reduce(_+_)</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res50: Int = 55</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd2 = sc.makeRDD(Array((&quot;a&quot;,1),(&quot;a&quot;,3),(&quot;c&quot;,3),(&quot;d&quot;,5)))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd2: org.apache.spark.rdd.RDD[(String, Int)] =
ParallelCollectionRDD[86] at makeRDD at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd2.reduce((x,y)=&gt;(x._1 + y._1,x._2 + y._2))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res51: (String, Int) = (adca,12)</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>collect()<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2141" o:spid="_x0000_i1178" type="#_x0000_t75" style='width:326.25pt;
 height:61.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image314.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=435 height=82
src="08_Spark.files/image314.png" v:shapes="图片_x0020_2141"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在驱动程序中，以数组的形式返回数据集的所有元素</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-no-proof:
yes'><!--[if gte vml 1]><v:shape id="图片_x0020_2142" o:spid="_x0000_i1177"
 type="#_x0000_t75" style='width:345pt;height:229.5pt;visibility:visible;
 mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image316.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=460 height=306
src="08_Spark.files/image316.png" v:shapes="图片_x0020_2142"><![endif]></span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>count()<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>返回</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的元素个数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; val rdd = sc.makeRDD(Array(1,1,2))</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[23] at
  makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; rdd.count </span><span lang=EN-US style='font-size:
  9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>res30: Long = 3</span><span lang=EN-US style='mso-bidi-font-size:
  10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>first()<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>返回</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的第一个元素（类似于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>take(1)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; val rdd = sc.makeRDD(Array(1,1,2))</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[23] at
  makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; rdd.first </span><span lang=EN-US style='font-size:
  9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>res31: Int = 1</span><span lang=EN-US style='mso-bidi-font-size:
  10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>take(n)<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>返回一个由数据集的前</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>n</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个元素组成的数组</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; val rdd = sc.makeRDD(Array(1,1,2))</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[23] at
  makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#385623;mso-themecolor:
  accent6;mso-themeshade:128'>// </span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#385623;mso-themecolor:accent6;mso-themeshade:128'>获取几个数据</span><span
  lang=EN-US style='font-size:9.0pt;color:#385623;mso-themecolor:accent6;
  mso-themeshade:128'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; rdd.take(2)</span><span lang=EN-US style='font-size:
  9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>res32: Array[Int] = Array(1, 1)</span><span lang=EN-US
  style='mso-bidi-font-size:10.5pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>takeSample(withReplacement,num, [seed])<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>返回一个数组，该数组由从数据集中随机采样的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>num</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个元素组成，可以选择是否用随机数替换不足的部分，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>seed</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>用于指定随机数生成器种子</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>takeOrdered(n)<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>返回前几个的排序</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>等价于这个</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2143" o:spid="_x0000_i1176" type="#_x0000_t75" style='width:182.25pt;
 height:15pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image318.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=243 height=20
src="08_Spark.files/image318.png" v:shapes="图片_x0020_2143"><![endif]></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>aggregate <o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>(zeroValue: U)(seqOp: (U, T) </span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:"Cambria Math",serif;
mso-bidi-font-family:"Cambria Math"'>⇒</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'> U, combOp: (U, U) </span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:"Cambria Math",serif;
mso-bidi-font-family:"Cambria Math"'>⇒</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'> U)<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>aggregate</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>函数将每个分区里面的元素通过</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>seqOp</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和初始值进行聚合，然后用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>combine</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数将每个分区的结果和初始值</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(zeroValue)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>combine</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>操作。这个函数最终返回的类型不需要和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中元素类型一致。（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>|</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是交互式的换行）</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; var rdd1 = sc.makeRDD(1 to 10,2)</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd1: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[88] at
makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd1.aggregate(1)(</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>     </span>| {(x : Int,y : Int)
=&gt; x + y},</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>     </span>| {(a : Int,b : Int)
=&gt; a + b}</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>     </span>| )</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res56: Int = 58</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd1.aggregate(1)(</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>     </span>| {(x : Int,y : Int)
=&gt; x * y},</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>     </span>| {(a : Int,b : Int)
=&gt; a + b}</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>     </span>| )</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res57: Int = 30361</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>fold(num)(func)<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>折叠操作，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>aggregate</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的简化操作，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>seqop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>combop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>一样。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; var rdd1 = sc.makeRDD(1 to 4,2)</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>rdd1: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[90] at
makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd1.aggregate(1)(</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>     </span>| {(x : Int,y : Int)
=&gt; x + y},</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>     </span>| {(a : Int,b : Int)
=&gt; a + b}</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>     </span>| )</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>res59: Int = 13</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd1.fold(1)(_+_)</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>res60: Int = 13</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>saveAsTextFile(path)<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>将数据集的元素以</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>textfile</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的形式保存到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>HDFS</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件系统或者其他支持的文件系统，对于每个元素，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>将会调用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>toString</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法，将它装换为文件中的文本</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>saveAsSequenceFile(path)&nbsp;<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>将数据集中的元素以</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop
sequencefile</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;
font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>的格式保存到指定的目录下，可以使</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>HDFS</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>或者其他</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>Hadoop</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>支持的文件系统。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>saveAsObjectFile(path)&nbsp;<o:p></o:p></span></h3>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>用于将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中的元素序列化成对象，存储到文件中。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>countByKey()<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2144" o:spid="_x0000_i1175" type="#_x0000_t75" style='width:282.75pt;
 height:48pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image320.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=377 height=64
src="08_Spark.files/image320.png" v:shapes="图片_x0020_2144"><![endif]></span></p>

<p class=MsoNormal><span style='mso-bidi-font-size:10.5pt;line-height:125%;
font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>针对</span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:125%'>(K,V)</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>类型的</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:125%'>RDD</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，返回一个</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:125%'>(K,Int)</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>map</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，表示每一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>key</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对应的元素个数。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd =
sc.parallelize(List((1,3),(1,2),(1,4),(2,3),(3,6),(3,8)),3)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[(Int, Int)] =
ParallelCollectionRDD[95] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:#385623;mso-themecolor:
accent6;mso-themeshade:128'>// key</span><span style='font-size:9.0pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#385623;mso-themecolor:accent6;mso-themeshade:128'>有几个</span><span
lang=EN-US style='font-size:9.0pt;color:#385623;mso-themecolor:accent6;
mso-themeshade:128'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.countByKey()</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res63: scala.collection.Map[Int,Long] = Map(3 -&gt; 2, 1 -&gt; 3, 2
-&gt; 1)</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:#385623;mso-themecolor:
accent6;mso-themeshade:128'>// </span><span style='font-size:9.0pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#385623;mso-themecolor:accent6;mso-themeshade:128'>或者</span><span
lang=EN-US style='font-size:9.0pt;color:#385623;mso-themecolor:accent6;
mso-themeshade:128'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt;
sc.parallelize(Array(1,1,2,3,3,3)).map((_,1)).countByKey() </span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res33: scala.collection.Map[Int,Long] = Map(1 -&gt; 2, 3 -&gt; 3, 2
-&gt; 1)</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>一般操作，都是抽样出来（生产环境</span><span
lang=EN-US>Key</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>太多），然后用</span><span
lang=EN-US>countByKey</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>看一下</span><span
lang=EN-US>key</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的分布情况，然后进行优化。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3 style='margin:0cm;margin-bottom:.0001pt;line-height:172%'><span lang=EN-US
style='mso-bidi-font-size:14.0pt;line-height:172%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>foreach(func)<o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2145" o:spid="_x0000_i1174" type="#_x0000_t75" style='width:294pt;
 height:56.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image322.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=392 height=75
src="08_Spark.files/image322.png" v:shapes="图片_x0020_2145"><![endif]></span></p>

<p class=MsoNormal><span style='mso-bidi-font-size:10.5pt;line-height:125%;
font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>在数据集的每一个元素上，运行函数</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:125%'>func</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>进行更新。</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:125%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val rdd = sc.makeRDD(Array(1,1,2))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[23] at
makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; rdd.foreach(println) </span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>1</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>1</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>2</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的数值统计操作</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2146" o:spid="_x0000_i1173" type="#_x0000_t75" style='width:241.5pt;
 height:184.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image324.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=322 height=246
src="08_Spark.files/image324.png" v:shapes="图片_x0020_2146"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的运行</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2147" o:spid="_x0000_i1172" type="#_x0000_t75" style='width:183.75pt;
 height:149.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image326.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=245 height=199
src="08_Spark.files/image326.png" v:shapes="图片_x0020_2147"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的依赖关系</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>宽依赖会触发</span><span
lang=EN-US>Shuffle</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2149" o:spid="_x0000_i1171" type="#_x0000_t75" style='width:424.5pt;
 height:230.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image328.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=566 height=307
src="08_Spark.files/image328.png" v:shapes="图片_x0020_2149"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>任务切分</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>每个</span><span
lang=EN-US>Task</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>会分发到具体的</span><span
lang=EN-US>Executor</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>去执行。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2151" o:spid="_x0000_i1170" type="#_x0000_t75" style='width:499.5pt;
 height:216.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image330.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=666 height=289
src="08_Spark.files/image330.png" v:shapes="图片_x0020_2151"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的运行规划图</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2156" o:spid="_x0000_i1169" type="#_x0000_t75" style='width:566.25pt;
 height:320.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image332.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=427
src="08_Spark.files/image332.png" v:shapes="图片_x0020_2156"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin;
mso-no-proof:yes'>练习？</span><span lang=EN-US style='mso-no-proof:yes'><o:p></o:p></span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>先搞清楚数据的变化，再填充算子</span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>广告统计</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2158" o:spid="_x0000_i1168" type="#_x0000_t75" style='width:285.75pt;
 height:49.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image334.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=381 height=66
src="08_Spark.files/image334.png" v:shapes="图片_x0020_2158"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:12.0pt;font-family:
"Courier New";color:#FF8000;background:white;mso-highlight:white;mso-font-kerning:
0pt'>1</span><span style='font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:#FF8000;background:white;mso-highlight:
white;mso-font-kerning:0pt'>、统计每一个省份点击</span><span lang=EN-US style='font-size:
12.0pt;font-family:"Courier New";color:#FF8000;background:white;mso-highlight:
white;mso-font-kerning:0pt'>TOP3</span><span style='font-size:12.0pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:#FF8000;background:white;mso-highlight:white;mso-font-kerning:0pt'>的广告</span><span
lang=EN-US style='font-size:12.0pt;font-family:"Courier New";color:black;
background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:125%;
font-family:"Courier New";color:#FF8000;background:white;mso-highlight:white;
mso-font-kerning:0pt'>2</span><span style='font-size:12.0pt;line-height:125%;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:#FF8000;background:white;mso-highlight:white;mso-font-kerning:0pt'>、统计每一个省份每一个小时的</span><span
lang=EN-US style='font-size:12.0pt;line-height:125%;font-family:"Courier New";
color:#FF8000;background:white;mso-highlight:white;mso-font-kerning:0pt'>TOP3</span><span
style='font-size:12.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:#FF8000;background:white;mso-highlight:
white;mso-font-kerning:0pt'>的广告</span><span lang=EN-US style='font-size:12.0pt;
line-height:125%;font-family:"Courier New";color:#FF8000;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2160" o:spid="_x0000_i1167" type="#_x0000_t75" style='width:341.25pt;
 height:127.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image336.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=455 height=170
src="08_Spark.files/image336.png" v:shapes="图片_x0020_2160"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2161" o:spid="_x0000_i1166" type="#_x0000_t75" style='width:257.25pt;
 height:140.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image338.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=343 height=187
src="08_Spark.files/image338.png" v:shapes="图片_x0020_2161"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2162" o:spid="_x0000_i1165" type="#_x0000_t75" style='width:459pt;
 height:57pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image340.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=612 height=76
src="08_Spark.files/image340.png" v:shapes="图片_x0020_2162"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2163" o:spid="_x0000_i1164" type="#_x0000_t75" style='width:567pt;
 height:91.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image342.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=122
src="08_Spark.files/image342.png" v:shapes="图片_x0020_2163"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2164" o:spid="_x0000_i1163" type="#_x0000_t75" style='width:264.75pt;
 height:222.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image344.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=353 height=297
src="08_Spark.files/image344.png" v:shapes="图片_x0020_2164"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2165" o:spid="_x0000_i1162" type="#_x0000_t75" style='width:370.5pt;
 height:169.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image346.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=494 height=226
src="08_Spark.files/image346.png" v:shapes="图片_x0020_2165"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2166" o:spid="_x0000_i1161" type="#_x0000_t75" style='width:354.75pt;
 height:87pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image348.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=473 height=116
src="08_Spark.files/image348.png" v:shapes="图片_x0020_2166"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2167" o:spid="_x0000_i1160" type="#_x0000_t75" style='width:312.75pt;
 height:218.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image349.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=417 height=291
src="08_Spark.files/image349.png" v:shapes="图片_x0020_2167"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2168" o:spid="_x0000_i1159" type="#_x0000_t75" style='width:326.25pt;
 height:143.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image351.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=435 height=191
src="08_Spark.files/image351.png" v:shapes="图片_x0020_2168"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2169" o:spid="_x0000_i1158" type="#_x0000_t75" style='width:290.25pt;
 height:158.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image353.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=387 height=211
src="08_Spark.files/image353.png" v:shapes="图片_x0020_2169"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>访问统计</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2159" o:spid="_x0000_i1157" type="#_x0000_t75" style='width:567pt;
 height:18pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image355.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=24
src="08_Spark.files/image355.png" v:shapes="图片_x0020_2159"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:12.0pt;font-family:
"Courier New";color:#FF8000;background:white;mso-highlight:white;mso-font-kerning:
0pt'>1</span><span style='font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:#FF8000;background:white;mso-highlight:
white;mso-font-kerning:0pt'>、计算每一个</span><span lang=EN-US style='font-size:
12.0pt;font-family:"Courier New";color:#FF8000;background:white;mso-highlight:
white;mso-font-kerning:0pt'>IP</span><span style='font-size:12.0pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:#FF8000;background:white;mso-highlight:white;mso-font-kerning:0pt'>的访问次数</span><span
lang=EN-US style='font-size:12.0pt;font-family:"Courier New";color:black;
background:white;mso-highlight:white;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:normal;mso-pagination:none;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:12.0pt;font-family:
"Courier New";color:#FF8000;background:white;mso-highlight:white;mso-font-kerning:
0pt'>2</span><span style='font-size:12.0pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:#FF8000;background:white;mso-highlight:
white;mso-font-kerning:0pt'>、计算每一个视频访问的</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Courier New";color:#FF8000;background:
white;mso-highlight:white;mso-font-kerning:0pt'>IP</span><span
style='font-size:12.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:#FF8000;background:white;mso-highlight:
white;mso-font-kerning:0pt'>数</span><span lang=EN-US style='font-size:12.0pt;
font-family:"Courier New";color:black;background:white;mso-highlight:white;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:125%;
font-family:"Courier New";color:#FF8000;background:white;mso-highlight:white;
mso-font-kerning:0pt'>3</span><span style='font-size:12.0pt;line-height:125%;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:#FF8000;background:white;mso-highlight:white;mso-font-kerning:0pt'>、计算每小时</span><span
lang=EN-US style='font-size:12.0pt;line-height:125%;font-family:"Courier New";
color:#FF8000;background:white;mso-highlight:white;mso-font-kerning:0pt'>CDN</span><span
style='font-size:12.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:#FF8000;background:white;mso-highlight:
white;mso-font-kerning:0pt'>的流量</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的持久化</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2170" o:spid="_x0000_i1156" type="#_x0000_t75" style='width:234pt;
 height:156.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image357.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=312 height=209
src="08_Spark.files/image357.png" v:shapes="图片_x0020_2170"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>cache</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法其实就是</span><span
lang=EN-US>persist</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法，默认只持久化到内存</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2172" o:spid="_x0000_i1155" type="#_x0000_t75" style='width:424.5pt;
 height:139.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image359.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=566 height=186
src="08_Spark.files/image359.png" v:shapes="图片_x0020_2172"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>缓存的参数，注意，</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在存储级别的末尾加上</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>“_2”</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>来把持久化数据存为两份</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2173" o:spid="_x0000_i1154" type="#_x0000_t75" style='width:567pt;
 height:310.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image361.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=414
src="08_Spark.files/image361.png" v:shapes="图片_x0020_2173"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>缓存的东西容易丢失，丢失之后从血统恢复计算。缓存也是用</span><span
lang=EN-US>LRU</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>算法，满了就删除旧的缓存。</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>例子</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; val rdd = sc.makeRDD(1 to 5) </span><span lang=EN-US
  style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[42] at
  makeRDD at &lt;console&gt;:24</span><span lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; val </span><span lang=EN-US style='font-size:7.5pt;
  color:red'>nocache </span><span lang=EN-US style='font-size:7.5pt;color:black;
  mso-color-alt:windowtext'>= rdd.map(_.toString + &quot;[&quot; +
  System.currentTimeMillis + &quot;]&quot;) </span><span lang=EN-US
  style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>nocache: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[43]
  at map at &lt;console&gt;:26</span><span lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; val </span><span lang=EN-US style='font-size:7.5pt;
  color:#4472C4;mso-themecolor:accent5'>cache </span><span lang=EN-US
  style='font-size:7.5pt;color:black;mso-color-alt:windowtext'>=
  rdd.map(_.toString + &quot;[&quot; + System.currentTimeMillis +
  &quot;]&quot;)</span><span lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>cache: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[44] at
  map at &lt;console&gt;:26</span><span lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:7.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>只对</span><span
  lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>cache</span><span style='font-size:7.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>做缓存</span><span
  lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; </span><span lang=EN-US style='font-size:7.5pt;
  color:#4472C4;mso-themecolor:accent5'>cache</span><span lang=EN-US
  style='font-size:7.5pt;color:black;mso-color-alt:windowtext'>.cache</span><span
  lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>res43: cache.type = MapPartitionsRDD[44] at map at &lt;console&gt;:26</span><span
  lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:7.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>不做缓存的，每次的值都不一样</span><span
  lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; </span><span lang=EN-US style='font-size:7.5pt;
  color:red'>nocache</span><span lang=EN-US style='font-size:7.5pt;color:black;
  mso-color-alt:windowtext'>.collect</span><span lang=EN-US style='font-size:
  7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>res44: Array[String] = Array(1[1563691286182], 2[1563691286182],
  3[1563691286182], 4[1563691286182], 5[1563691286182])</span><span lang=EN-US
  style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; </span><span lang=EN-US style='font-size:7.5pt;
  color:red'>nocache</span><span lang=EN-US style='font-size:7.5pt;color:black;
  mso-color-alt:windowtext'>.collect</span><span lang=EN-US style='font-size:
  7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>res45: Array[String] = Array(1[1563691288320], 2[1563691288320],
  3[1563691288320], 4[1563691288320], 5[1563691288320])</span><span lang=EN-US
  style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; </span><span lang=EN-US style='font-size:7.5pt;
  color:red'>nocache</span><span lang=EN-US style='font-size:7.5pt;color:black;
  mso-color-alt:windowtext'>.collect</span><span lang=EN-US style='font-size:
  7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>res46: Array[String] = Array(1[1563691290109], 2[1563691290109],
  3[1563691290109], 4[1563691290109], 5[1563691290109])</span><span lang=EN-US
  style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:7.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>做缓存的每次的时间戳都是一样的</span><span
  lang=EN-US style='font-size:7.5pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; </span><span lang=EN-US style='font-size:7.5pt;
  color:#4472C4;mso-themecolor:accent5'>cache</span><span lang=EN-US
  style='font-size:7.5pt;color:black;mso-color-alt:windowtext'>.collect</span><span
  lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>res47: Array[String] = Array(1[1563691298443], 2[1563691298443],
  3[1563691298443], 4[1563691298443], 5[1563691298443])</span><span lang=EN-US
  style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; </span><span lang=EN-US style='font-size:7.5pt;
  color:#4472C4;mso-themecolor:accent5'>cache</span><span lang=EN-US
  style='font-size:7.5pt;color:black;mso-color-alt:windowtext'>.collect</span><span
  lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>res48: Array[String] = Array(1[1563691298443], 2[1563691298443], 3[1563691298443],
  4[1563691298443], 5[1563691298443])</span><span lang=EN-US style='font-size:
  7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>scala&gt; </span><span lang=EN-US style='font-size:7.5pt;
  color:#4472C4;mso-themecolor:accent5'>cache</span><span lang=EN-US
  style='font-size:7.5pt;color:black;mso-color-alt:windowtext'>.collect</span><span
  lang=EN-US style='font-size:7.5pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:7.5pt;color:black;mso-color-alt:
  windowtext'>res49: Array[String] = Array(1[1563691298443], 2[1563691298443],
  3[1563691298443], 4[1563691298443], 5[1563691298443])</span><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>的检查点机制</span></h2>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这是把数据存入</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>HDFS</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的，所以会把血统干掉，删掉存入</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>HDFS</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的数据，就会报错。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2174" o:spid="_x0000_i1153" type="#_x0000_t75" style='width:438.75pt;
 height:255.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image363.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=585 height=341
src="08_Spark.files/image363.png" v:shapes="图片_x0020_2174"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>HDFS</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>集群</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>start-dfs.sh<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>HDFS</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>创建一个目录</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2175" o:spid="_x0000_i1152" type="#_x0000_t75" style='width:294.75pt;
 height:16.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image365.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=393 height=22
src="08_Spark.files/image365.png" v:shapes="图片_x0020_2175"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt;
  sc.setCheckpointDir(&quot;hdfs&quot;//master:9000/checkpoint&quot;) <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>     </span>| <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>     </span>|
  )<span style='mso-spacerun:yes'>   </span><span style='color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span></span><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>不知道为什么要多敲一个括号</span><span
  lang=EN-US style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; val ch1 = sc.parallelize(1 to 2) <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>ch1: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[45]
  at parallelize at &lt;console&gt;:24<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span
  style='mso-spacerun:yes'>                                                  
  </span>^<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; val ch2 = ch1.map(_.toString +
  &quot;[&quot; + System.currentTimeMillis + &quot;]&quot;)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>ch2: org.apache.spark.rdd.RDD[String] =
  MapPartitionsRDD[46] at map at &lt;console&gt;:26<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; val ch3 = ch1.map(_.toString +
  &quot;[&quot; + System.currentTimeMillis + &quot;]&quot;)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>ch3: org.apache.spark.rdd.RDD[String] =
  MapPartitionsRDD[47] at map at &lt;console&gt;:26<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; ch3.checkpoint<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:9.0pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>不错检查点的，每次都不同</span><span lang=EN-US style='font-size:9.0pt;font-family:
  "Courier New";mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; ch2.collect <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res54: Array[String] = Array(1[1563694507999],
  2[1563694507999])<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; ch2.collect <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res55: Array[String] = Array(1[1563694511912],
  2[1563694511912])<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; ch2.collect <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res56: Array[String] = Array(1[1563694514370],
  2[1563694514370])<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:9.0pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>做检查点之后，第一次与第二次不同，后面就都跟第二次一样了</span><span lang=EN-US style='font-size:
  9.0pt;font-family:"Courier New";mso-fareast-font-family:宋体;mso-bidi-font-family:
  Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; ch3.collect <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res57: Array[String] = Array(1[1563694521535],
  2[1563694521535])<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; ch3.collect <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res58: Array[String] = Array(1[1563694522483],
  2[1563694522483])<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; ch3.collect <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res59: Array[String] = Array(1[1563694522483],
  2[1563694522483])</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
  11.0pt;mso-fareast-font-family:宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这是为了流式计算用的，流式计算中，每来一条数据就计算，计算的结果保存到</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>HDFS</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>上，这样下次启动直接从检查点开始，这样子前面计算的数据就不会丢失。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>缓存只是一种优化策略。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>键值对</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>数据分区</span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2176" o:spid="_x0000_i1151" type="#_x0000_t75" style='width:409.5pt;
 height:242.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image366.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=546 height=323
src="08_Spark.files/image366.png" v:shapes="图片_x0020_2176"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>自定义分区继承</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Partitioner</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，要实现这俩方法</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2177" o:spid="_x0000_i1150" type="#_x0000_t75" style='width:279.75pt;
 height:62.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image368.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=373 height=83
src="08_Spark.files/image368.png" v:shapes="图片_x0020_2177"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2178" o:spid="_x0000_i1149" type="#_x0000_t75" style='width:505.5pt;
 height:177.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image370.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=674 height=237
src="08_Spark.files/image370.png" v:shapes="图片_x0020_2178"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>自定义分区代码</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>之前的项目，新加一个</span><span
lang=EN-US>Scala</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US>class</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2184" o:spid="_x0000_i1148" type="#_x0000_t75" style='width:242.25pt;
 height:219pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image372.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=323 height=292
src="08_Spark.files/image372.png" v:shapes="图片_x0020_2184"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>CustomerPartitioner.scala</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:7.5pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:7.5pt;
  color:black'>org.apache.spark.{Partitioner, SparkConf, SparkContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:7.5pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* (numPar: Int)</span></i><i><span
  style='font-size:7.5pt;color:gray'>这括号是构造方法，参数是分区号<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:7.5pt;color:navy'>class </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>CustomerPartitioner(numPar: Int) </span><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>extends </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>Partitioner{<br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:7.5pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:7.5pt;color:black'>numPartitions: Int = numPar<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:7.5pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:7.5pt;color:black'>getPartition(key: Any): Int = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>随便定义一样<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:7.5pt;color:black'>key.toString.hashCode % numPar<br>
<span style='mso-spacerun:yes'>  </span>}<br>
}<br>
  <br>
  </span><b><span lang=EN-US style='font-size:7.5pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>App {<br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:7.5pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:7.5pt;color:black'>main(args: Array[</span><span lang=EN-US
  style='font-size:7.5pt;color:#20999D'>String</span><span lang=EN-US
  style='font-size:7.5pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>创建<span lang=EN-US>sparkConf</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>conf = </span><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;partitioner&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;local[*]&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>创阿金<span lang=EN-US>sparkContext</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>sc = </span><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>SparkContext(conf)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>创建<span lang=EN-US>RDD<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>rdd = sc.makeRDD(<i>Array</i>(</span><span
  lang=EN-US style='font-size:7.5pt;color:blue'>1</span><span lang=EN-US
  style='font-size:7.5pt;color:black'>, </span><span lang=EN-US
  style='font-size:7.5pt;color:blue'>2</span><span lang=EN-US style='font-size:
  7.5pt;color:black'>, </span><span lang=EN-US style='font-size:7.5pt;
  color:blue'>3</span><span lang=EN-US style='font-size:7.5pt;color:black'>, </span><span
  lang=EN-US style='font-size:7.5pt;color:blue'>4</span><span lang=EN-US
  style='font-size:7.5pt;color:black'>, </span><span lang=EN-US
  style='font-size:7.5pt;color:blue'>5</span><span lang=EN-US style='font-size:
  7.5pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>查看原始分区存放的方式<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:7.5pt;color:black'>rdd.mapPartitionsWithIndex((x, y) =&gt; </span><i><span
  lang=EN-US style='font-size:7.5pt;color:#660E7A'>Iterator</span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>(x + </span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;:&quot; </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>+ y.mkString(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;|&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>))).foreach(<i>println</i>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;color:gray'>// </span></i><i><span style='font-size:
  7.5pt;color:gray'>查看自定义分区存放方式。<span lang=EN-US> partitionBy</span>传入一个自定义分区<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:7.5pt;color:black'>rdd.map((_, </span><span lang=EN-US
  style='font-size:7.5pt;color:blue'>1</span><span lang=EN-US style='font-size:
  7.5pt;color:black'>)).partitionBy(</span><b><span lang=EN-US
  style='font-size:7.5pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:7.5pt;color:black'>CustomerPartitioner(</span><span
  lang=EN-US style='font-size:7.5pt;color:blue'>5</span><span lang=EN-US
  style='font-size:7.5pt;color:black'>)).mapPartitionsWithIndex((x, y) =&gt; </span><i><span
  lang=EN-US style='font-size:7.5pt;color:#660E7A'>Iterator</span></i><span
  lang=EN-US style='font-size:7.5pt;color:black'>(x + </span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;:&quot; </span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>+ y.mkString(</span><b><span
  lang=EN-US style='font-size:7.5pt;color:green'>&quot;|&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;color:black'>))).foreach(<i>println</i>)<br>
  <br>
<span style='mso-spacerun:yes'>    </span>sc.stop()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:7.5pt;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>测试</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行</span><span
lang=EN-US>main</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2180" o:spid="_x0000_i1147" type="#_x0000_t75" style='width:270.75pt;
 height:80.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image374.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=361 height=107
src="08_Spark.files/image374.png" v:shapes="图片_x0020_2180"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>找日志，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>CPU</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>是</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>4</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>核，所以默认</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>4</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:
125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分区</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2181" o:spid="_x0000_i1146" type="#_x0000_t75" style='width:164.25pt;
 height:1in;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image376.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=219 height=96
src="08_Spark.files/image376.png" v:shapes="图片_x0020_2181"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>自定义分区之后，是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>5</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>个分区，注意有时候打印中间会有其他日志隔断</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2183" o:spid="_x0000_i1145" type="#_x0000_t75" style='width:213.75pt;
 height:254.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image378.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=285 height=339
src="08_Spark.files/image378.png" v:shapes="图片_x0020_2183"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>数据读取与保存</span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>一般的，输入在</span><span
lang=EN-US>sc</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>调用，输出在</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>调用。</span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>文本文件</span></h3>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>当我们将一个文本文件读取为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> RDD </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>时，输入的每一行</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>都会成为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的一个元素。也可以将多个完整的文本文件一次性读取为一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>pair RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>其中键是文件名，值是文件内容。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>val
input = sc.textFile(&quot;./README.md&quot;) <o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果传递目录，则将目录下的所有文件读取作为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件路径支持通配符。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>wholeTextFiles()</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对于大量的小文件读取效率比较高，大文件效果没有那么高。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>saveAsTextFile() </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行文本文件的输出，该方法接收一个路径，并将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> RDD </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中的内容都输入到路径对应的文件中。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>将传入的路径作为目录对待，会在那个</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>目录下输出多个文件。这样，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就可以从多个节点上并行输出了。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:7.0pt;text-indent:21.0pt'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;color:red'>result.saveAsTextFile(outputFile)<o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; sc.textFile(&quot;./README.md&quot;)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res6: org.apache.spark.rdd.RDD[String] = ./README.md MapPartitionsRDD[7]
at textFile at &lt;console&gt;:25</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val readme = sc.textFile(&quot;./README.md&quot;)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>readme: org.apache.spark.rdd.RDD[String] = ./README.md
MapPartitionsRDD[9] at textFile at &lt;console&gt;:24</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; readme.collect()</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res7: Array[String] = Array(# Apache Spark, &quot;&quot;, Spark is
a fast and general cluster...</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt;
readme.saveAsTextFile(&quot;hdfs://master01:9000/test&quot;)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>调用</span><span
lang=EN-US>Hadoop</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>底层的，就是对</span><span
lang=EN-US>Hadoop</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的封装</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2193" o:spid="_x0000_i1144" type="#_x0000_t75" style='width:357pt;
 height:95.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image380.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=476 height=127
src="08_Spark.files/image380.png" v:shapes="图片_x0020_2193"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US>hadoopFile</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2194" o:spid="_x0000_i1143" type="#_x0000_t75" style='width:380.25pt;
 height:116.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image382.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=507 height=155
src="08_Spark.files/image382.png" v:shapes="图片_x0020_2194"><![endif]></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>实现</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的转换有如下方法</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2195" o:spid="_x0000_i1142" type="#_x0000_t75" style='width:231.75pt;
 height:180pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image384.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=309 height=240
src="08_Spark.files/image384.png" v:shapes="图片_x0020_2195"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2189" o:spid="_x0000_i1141" type="#_x0000_t75" style='width:315.75pt;
 height:27pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image386.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=421 height=36
src="08_Spark.files/image386.png" v:shapes="图片_x0020_2189"><![endif]></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>其实就调用了</span><span
lang=EN-US>Hadoop </span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的底层</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2190" o:spid="_x0000_i1140" type="#_x0000_t75" style='width:356.25pt;
 height:42pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image388.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=475 height=56
src="08_Spark.files/image388.png" v:shapes="图片_x0020_2190"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US>saveAsHadoopFile</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2191" o:spid="_x0000_i1139" type="#_x0000_t75" style='width:392.25pt;
 height:132pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image390.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=523 height=176
src="08_Spark.files/image390.png" v:shapes="图片_x0020_2191"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'>JSON</span><span
style='font-size:14.0pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件</span><span
lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>一般用</span><span
lang=EN-US>SparkSQL</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>处理，因为它自带处理库。</span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>JSON</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件中每一行就是一个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>JSON</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>记录，那么可以通过将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>JSON</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件当做文本文件来读取，然后利用相关的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>JSON</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>库对每一条数据进行</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>JSON</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>解析。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; import org.json4s._<span style='mso-spacerun:yes'> 
</span></span><span lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>import org.json4s._</span><span lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; import org.json4s.jackson.JsonMethods._<span
style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='font-size:
6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>import org.json4s.jackson.JsonMethods._</span><span lang=EN-US
style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; import org.json4s.jackson.Serialization<span
style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='font-size:
6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>import org.json4s.jackson.Serialization</span><span lang=EN-US
style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; var result =
sc.textFile(&quot;examples/src/main/resources/people.json&quot;)</span><span
lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>result: org.apache.spark.rdd.RDD[String] =
examples/src/main/resources/people.json MapPartitionsRDD[7] at textFile at
&lt;console&gt;:47</span><span lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; implicit val formats =
Serialization.formats(ShortTypeHints(List())) </span><span lang=EN-US
style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>formats: org.json4s.Formats{val dateFormat: org.json4s.DateFormat;
val typeHints: org.json4s.TypeHints} =
org.json4s.Serialization$$anon$1@61f2c1da</span><span lang=EN-US
style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; result.collect().foreach(x =&gt; {var c =
parse(x).extract[Person];println(c.name + &quot;,&quot; + c.age)})<span
style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='font-size:
6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>Michael,30</span><span lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>Andy,30</span><span lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:6.5pt;color:black;mso-color-alt:
windowtext'>Justin,19</span><span lang=EN-US style='font-size:6.5pt'><o:p></o:p></span></p>

<h3><span lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'>CSV</span><span
style='font-size:14.0pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件</span><span
lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>读取</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> CSV/TSV </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>数据和读取</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> JSON </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>数据相似，都需要先把文件当作普通文本文件来读取数据，然后通过将每一行进行解析实现对</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>CSV</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的读取。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>CSV/TSV</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>数据的输出也是需要将结构化</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>通过相关的库转换成字符串</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，然后使用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> Spark </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的文本文件</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> API </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>写出去。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h3><span lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'>Sequence</span><span
style='font-size:14.0pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件</span><span
lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2186" o:spid="_x0000_i1138" type="#_x0000_t75" style='width:314.25pt;
 height:118.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image392.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=419 height=158
src="08_Spark.files/image392.png" v:shapes="图片_x0020_2186"><![endif]></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>&nbsp;SequenceFile</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>文件是</span><span
lang=EN-US><a href="http://lib.csdn.net/base/hadoop" target="_blank"
title=Hadoop知识库><span style='mso-bidi-font-size:10.5pt;line-height:150%;
color:windowtext;text-decoration:none;text-underline:none'>Hadoop</span></a></span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>用来存储<span
style='color:red'>二进制</span>形式的</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>key-value</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>对而设计的一种平面文件</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>(Flat File)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><span
style='mso-spacerun:yes'> </span>Spark </span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>有专门用来读取</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> SequenceFile </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的接口。在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> SparkContext </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中，可以调用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> sequenceFile[
keyClass, valueClass](path)</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>。</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:12.0pt;line-height:15.0pt;mso-pagination:
none;mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:"Times",serif;color:black;mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_247" o:spid="_x0000_i1137" type="#_x0000_t75" style='width:354.75pt;
 height:243.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image394.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=473 height=325
src="08_Spark.files/image395.png" v:shapes="Picture_x0020_247"><![endif]></span><span
lang=EN-US style='font-family:"Times",serif;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:12.0pt;line-height:15.0pt;mso-pagination:
none;mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape id="图片_x0020_2185" o:spid="_x0000_i1136"
 type="#_x0000_t75" alt="http://pic002.cnblogs.com/images/2012/163575/2012110112470118.png"
 style='width:439.5pt;height:245.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image396.png" o:title="2012110112470118"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=586 height=327
src="08_Spark.files/image397.png"
alt="http://pic002.cnblogs.com/images/2012/163575/2012110112470118.png" v:shapes="图片_x0020_2185"><![endif]></span><span
lang=EN-US style='font-family:"Times",serif;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:12.0pt;line-height:15.0pt;mso-pagination:
none;mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:"Times",serif;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:12.0pt;line-height:15.0pt;mso-pagination:
none;mso-layout-grid-align:none;text-autospace:none'><span style='font-family:
宋体;mso-ascii-font-family:Times;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Times;mso-bidi-font-family:Times;color:black'>读取</span><span lang=EN-US
style='font-family:"Times",serif;color:black'>Sequence</span><span
style='font-family:宋体;mso-ascii-font-family:Times;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Times;mso-bidi-font-family:Times;color:black'>文件也要指定类型，但不需要括号。</span><span
lang=EN-US style='font-family:"Times",serif;color:black'><o:p></o:p></span></p>

<h3><span style='font-size:14.0pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对象文件</span><span
lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2187" o:spid="_x0000_i1135" type="#_x0000_t75" style='width:356.25pt;
 height:75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image398.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=475 height=100
src="08_Spark.files/image398.png" v:shapes="图片_x0020_2187"><![endif]></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对象文件是将对象序列化后保存的文件，采用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Java</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的序列化机制。可以通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>objectFile[k,v](path)
</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数接收一个路径，读取对象文件，返回对应的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，也可以通过调用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>saveAsObjectFile()
</span><span style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>实现对对象文件的输出。因为是序列化所以要指定类型。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val data=sc.parallelize(List((2,&quot;aa&quot;),(3,&quot;bb&quot;),(4,&quot;cc&quot;),(5,&quot;dd&quot;),(6,&quot;ee&quot;)))</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>data: org.apache.spark.rdd.RDD[(Int, String)] =
ParallelCollectionRDD[20] at parallelize at &lt;console&gt;:24</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; data.saveAsObjectFile(&quot;hdfs://master01:9000/objfile&quot;)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; import org.apache.spark.rdd.RDD</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>import org.apache.spark.rdd.RDD</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val objrdd:RDD[(Int,String)] =
sc.objectFile[(Int,String)](&quot;hdfs://master01:9000/objfile/p*&quot;)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>objrdd: org.apache.spark.rdd.RDD[(Int, String)] =
MapPartitionsRDD[28] at objectFile at &lt;console&gt;:25</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; objrdd.collect()</span><span lang=EN-US style='font-size:
9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>res20: Array[(Int, String)] = Array((2,aa), (3,bb), (4,cc), (5,dd),
(6,ee))</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>读取为对象，要指定对象类型，对象要用括号</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2188" o:spid="_x0000_i1134" type="#_x0000_t75" style='width:457.5pt;
 height:24pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image400.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=610 height=32
src="08_Spark.files/image400.png" v:shapes="图片_x0020_2188"><![endif]></span></p>

<h3><span lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'>HDFS<o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的整个生态系统与</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是完全兼容的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所以对于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所支持的文件类型或者数据库类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>也同样支持</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>.</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>另外</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>由于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>API</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>有新旧两个版本</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所以</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>为了能够兼容</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所有的版本</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>也提供了两套创建操作接口</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>.</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对于外部存储创建操作而言</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,hadoopRDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>newHadoopRDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是最为抽象的两个函数接口</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主要包含以下四个参数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>.<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>1</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>）输入格式</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(InputFormat): </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>制定数据输入的类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>TextInputFormat</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>等</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>新旧两个版本所引用的版本分别是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>org.apache.hadoop.mapred.InputFormat</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>org.apache.hadoop.mapreduce.InputFormat(NewInputFormat)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>）键类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>: </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>指定</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>[K,V]</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>键值对中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>K</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>3</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>）值类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>: </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>指定</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>[K,V]</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>键值对中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>V</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>4</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>）分区值</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>: </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>指定由外部存储生成的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>partition</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>数量的最小值</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果没有指定</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>系统会使用默认值</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>defaultMinSplits<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:28.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>其他创建操作的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>API</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>接口都是为了方便最终的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>程序开发者而设置的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是这两个接口的高效实现版本</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>.</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>例如</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>textFile</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>而言</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>只有</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>path</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这个指定文件路径的参数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>其他参数在系统内部指定了默认值</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><b><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;
letter-spacing:.5pt'>兼容旧版本</span><span lang=EN-US style='letter-spacing:.5pt'>HadoopAPI</span></b><b><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;letter-spacing:.5pt'>的创建操作</span></b><span lang=EN-US
style='letter-spacing:.5pt'><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width="99%"
 style='width:99.36%;mso-cellspacing:0cm;margin-left:3.15pt;mso-yfti-tbllook:
 1184;mso-padding-alt:2.0pt 2.0pt 2.0pt 2.0pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width="29%" valign=top style='width:29.74%;padding:2.0pt 2.0pt 2.0pt 2.0pt'></td>
  <td width="13%" valign=top style='width:13.34%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><strong><span style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;font-family:"MS Mincho";mso-bidi-font-family:"MS Mincho"'>文件路径</span></strong><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:11.0pt;line-height:
  125%;mso-fareast-font-family:"Times New Roman"'><o:p></o:p></span></p>
  </td>
  <td width="21%" valign=top style='width:21.14%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><strong><span style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;font-family:宋体;mso-fareast-theme-font:minor-fareast;
  mso-bidi-font-family:宋体'>输入格</span></strong><strong><span style='font-size:
  10.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:"MS Mincho";
  mso-bidi-font-family:"MS Mincho"'>式</span></strong><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
  mso-fareast-font-family:"Times New Roman"'><o:p></o:p></span></p>
  </td>
  <td width="14%" valign=top style='width:14.62%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><strong><span style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;font-family:宋体;mso-fareast-theme-font:minor-fareast;
  mso-bidi-font-family:宋体'>键类</span></strong><strong><span style='font-size:
  10.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:"MS Mincho";
  mso-bidi-font-family:"MS Mincho"'>型</span></strong><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
  mso-fareast-font-family:"Times New Roman"'><o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.76%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><strong><span style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;font-family:宋体;mso-fareast-theme-font:minor-fareast;
  mso-bidi-font-family:宋体'>值类</span></strong><strong><span style='font-size:
  10.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:"MS Mincho";
  mso-bidi-font-family:"MS Mincho"'>型</span></strong><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
  mso-fareast-font-family:"Times New Roman"'><o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.4%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><strong><span style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;font-family:"MS Mincho";mso-bidi-font-family:"MS Mincho"'>分区</span></strong><strong><span
  style='font-size:10.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
  font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-bidi-font-family:
  宋体'>值</span></strong><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width="29%" valign=top style='width:29.74%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>textFile(path:
  String, minPartitions: Int = defaultMinPartitions)<o:p></o:p></span></p>
  </td>
  <td width="13%" valign=top style='width:13.34%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>path<o:p></o:p></span></p>
  </td>
  <td width="21%" valign=top style='width:21.14%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>TextInputFormat<o:p></o:p></span></p>
  </td>
  <td width="14%" valign=top style='width:14.62%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>LongWritable<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.76%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>Text<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.4%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>minSplits<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width="29%" valign=top style='width:29.74%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>hadoopFile[K,
  V, F &lt;: InputFormat[K, V]](path: String, minPartitions: Int)<br>
  (implicit km: ClassTag[K], vm: ClassTag[V], fm: ClassTag[F]): RDD[(K, V)]<o:p></o:p></span></p>
  </td>
  <td width="13%" valign=top style='width:13.34%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>path<o:p></o:p></span></p>
  </td>
  <td width="21%" valign=top style='width:21.14%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>F<o:p></o:p></span></p>
  </td>
  <td width="14%" valign=top style='width:14.62%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>K<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.76%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>V<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.4%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>minSplits<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width="29%" valign=top style='width:29.74%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>hadoopFile[K,
  V, F &lt;: <span style='mso-tab-count:1'>        </span><span
  style='mso-tab-count:1'>         </span>[K, V]](path: String)<br>
  (implicit km: ClassTag[K], vm: ClassTag[V], fm: ClassTag[F]): RDD[(K, V)]<o:p></o:p></span></p>
  </td>
  <td width="13%" valign=top style='width:13.34%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>path<o:p></o:p></span></p>
  </td>
  <td width="21%" valign=top style='width:21.14%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>F<o:p></o:p></span></p>
  </td>
  <td width="14%" valign=top style='width:14.62%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>K<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.76%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>V<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.4%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>DefaultMinSplits<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width="29%" valign=top style='width:29.74%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>hadoopFile[K,
  V](path: String, inputFormatClass: Class[_ &lt;: InputFormat[K, V]],
  keyClass: Class[K], valueClass: Class[V], minPartitions: Int =
  defaultMinPartitions): RDD[(K, V)]<o:p></o:p></span></p>
  </td>
  <td width="13%" valign=top style='width:13.34%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>path<o:p></o:p></span></p>
  </td>
  <td width="21%" valign=top style='width:21.14%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>inputFormatClass<o:p></o:p></span></p>
  </td>
  <td width="14%" valign=top style='width:14.62%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>keyClass<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.76%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>valueClass<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.4%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>defaultMinPartitions<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width="29%" valign=top style='width:29.74%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>hadoopRDD[K,
  V](conf: JobConf, inputFormatClass: Class[_ &lt;: InputFormat[K, V]],
  keyClass: Class[K], valueClass: Class[V], minPartitions: Int =
  defaultMinPartitions): RDD[(K, V)]<o:p></o:p></span></p>
  </td>
  <td width="13%" valign=top style='width:13.34%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>n/a<o:p></o:p></span></p>
  </td>
  <td width="21%" valign=top style='width:21.14%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>inputFormatClass<o:p></o:p></span></p>
  </td>
  <td width="14%" valign=top style='width:14.62%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>keyClass<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.76%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>valueClass<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.4%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>defaultMinPartitions<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width="29%" valign=top style='width:29.74%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>sequenceFile[K,
  V](path: String, minPartitions: Int = defaultMinPartitions)<br>
  (implicit km: ClassTag[K], vm: ClassTag[V], kcf: () </span><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
  font-family:"MS Mincho";mso-bidi-font-family:"MS Mincho"'>⇒</span><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:11.0pt;line-height:
  125%;mso-fareast-font-family:"Times New Roman"'> WritableConverter[K], vcf:
  () </span><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
  line-height:125%;font-family:"MS Mincho";mso-bidi-font-family:"MS Mincho"'>⇒</span><span
  lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:11.0pt;line-height:
  125%;mso-fareast-font-family:"Times New Roman"'> WritableConverter[V]):
  RDD[(K, V)]<o:p></o:p></span></p>
  </td>
  <td width="13%" valign=top style='width:13.34%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>path<o:p></o:p></span></p>
  </td>
  <td width="21%" valign=top style='width:21.14%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>SequenceFileInputFormat[K,V]<o:p></o:p></span></p>
  </td>
  <td width="14%" valign=top style='width:14.62%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>K<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.76%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>V<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.4%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>defaultMinPartitions<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td width="29%" valign=top style='width:29.74%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>objectFile[T](path:
  String, minPartitions: Int = defaultMinPartitions)(implicit arg0:
  ClassTag[T]): RDD[T]<o:p></o:p></span></p>
  </td>
  <td width="13%" valign=top style='width:13.34%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>path<o:p></o:p></span></p>
  </td>
  <td width="21%" valign=top style='width:21.14%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>SequenceFileInputFormat[NullWritable,BytesWritable]<o:p></o:p></span></p>
  </td>
  <td width="14%" valign=top style='width:14.62%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>NullWritable<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.76%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>BytesWritable<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.4%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;mso-bidi-font-size:
  11.0pt;line-height:125%;mso-fareast-font-family:"Times New Roman"'>minSplits<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><b><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;
color:white;mso-color-alt:windowtext;letter-spacing:.5pt'>兼容新版本</span><span
lang=EN-US style='letter-spacing:.5pt'>HadoopAPI</span></b><b><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;letter-spacing:.5pt'>的创建操作</span><span lang=EN-US style='letter-spacing:
.5pt'><o:p></o:p></span></b></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:0cm;mso-yfti-tbllook:1184;mso-padding-alt:
 2.0pt 2.0pt 2.0pt 2.0pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width="43%" valign=top style='width:43.48%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width="12%" valign=top style='width:12.96%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span style='font-family:"MS Mincho";mso-bidi-font-family:
  "MS Mincho"'>文件路径</span><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'><o:p></o:p></span></p>
  </td>
  <td width="12%" valign=top style='width:12.92%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-fareast-theme-font:minor-fareast;
  mso-bidi-font-family:宋体'>输入格</span><span style='font-family:"MS Mincho";
  mso-bidi-font-family:"MS Mincho"'>式</span><span lang=EN-US style='mso-fareast-font-family:
  "Times New Roman"'><o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.7%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-fareast-theme-font:minor-fareast;
  mso-bidi-font-family:宋体'>键类</span><span style='font-family:"MS Mincho";
  mso-bidi-font-family:"MS Mincho"'>型</span><span lang=EN-US style='mso-fareast-font-family:
  "Times New Roman"'><o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.7%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-fareast-theme-font:minor-fareast;
  mso-bidi-font-family:宋体'>值类</span><span style='font-family:"MS Mincho";
  mso-bidi-font-family:"MS Mincho"'>型</span><span lang=EN-US style='mso-fareast-font-family:
  "Times New Roman"'><o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.24%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span style='font-family:"MS Mincho";mso-bidi-font-family:
  "MS Mincho"'>分区</span><span style='font-family:宋体;mso-fareast-theme-font:
  minor-fareast;mso-bidi-font-family:宋体'>值</span><span lang=EN-US
  style='mso-fareast-font-family:"Times New Roman"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width="43%" valign=top style='width:43.48%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>newAPIHadoopFile[K,
  V, F &lt;: InputFormat[K, V]](path: String, fClass: Class[F], kClass:
  Class[K], vClass: Class[V], conf: Configuration = hadoopConfiguration):
  RDD[(K, V)]<o:p></o:p></span></p>
  </td>
  <td width="12%" valign=top style='width:12.96%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>path<o:p></o:p></span></p>
  </td>
  <td width="12%" valign=top style='width:12.92%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>F<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.7%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>K<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.7%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>V<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.24%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>n/a<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width="43%" valign=top style='width:43.48%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>newAPIHadoopFile[K,
  V, F &lt;: InputFormat[K, V]](path: String)(implicit km: ClassTag[K], vm:
  ClassTag[V], fm: ClassTag[F]): RDD[(K, V)]<o:p></o:p></span></p>
  </td>
  <td width="12%" valign=top style='width:12.96%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>path<o:p></o:p></span></p>
  </td>
  <td width="12%" valign=top style='width:12.92%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>F<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.7%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>K<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.7%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>V<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.24%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>n/a<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width="43%" valign=top style='width:43.48%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>newAPIHadoopRDD[K,
  V, F &lt;: InputFormat[K, V]](conf: Configuration = hadoopConfiguration,
  fClass: Class[F], kClass: Class[K], vClass: Class[V]): RDD[(K, V)]<o:p></o:p></span></p>
  </td>
  <td width="12%" valign=top style='width:12.96%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>n/a<o:p></o:p></span></p>
  </td>
  <td width="12%" valign=top style='width:12.92%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>F<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.7%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>K<o:p></o:p></span></p>
  </td>
  <td width="9%" valign=top style='width:9.7%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>V<o:p></o:p></span></p>
  </td>
  <td width="11%" valign=top style='width:11.24%;padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>n/a<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin;color:red;letter-spacing:.5pt'>注意</span><span
lang=EN-US style='color:red;letter-spacing:.5pt'>:<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>1.</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中以压缩形式存储的数据</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不需要指定解压方式就能够进行读取</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>因为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>本身有一个解压器会根据压缩文件的后缀推断解压算法进行解压</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>.<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>2.</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>从</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中读取某种类型的数据不知道怎么读取的时候</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>上网查找一个使用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>map-reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的时候是怎么读取这种这种数据的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>然后再将对应的读取方式改写成上面的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>hadoopRDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>newAPIHadoopRDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>两个类就行了</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin;letter-spacing:.5pt'>写出示例：</span><span
lang=EN-US style='letter-spacing:.5pt'><o:p></o:p></span></b></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; val data = sc.parallelize(Array((30,&quot;hadoop&quot;),
(71,&quot;hive&quot;), (11,&quot;cat&quot;)))</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>data: org.apache.spark.rdd.RDD[(Int, String)] =
ParallelCollectionRDD[47] at parallelize at &lt;console&gt;:35</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>scala&gt; data.saveAsNewAPIHadoopFile(&quot;hdfs://hadoop102:9000/output4/&quot;,classOf[LongWritable]
,classOf[Text]
,classOf[org.apache.hadoop.mapreduce.lib.output.TextOutputFormat[LongWritable,
Text]])</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>最后的归宿除了返回为集合和标量</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>也可以将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>存储到外部文件系统或者数据库中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>系统与</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是完全兼容的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所以</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>MapReduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所支持的读写文件或者数据库类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>也同样支持</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>.</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>另外</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>由于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>API</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>有新旧两个版本</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所以</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>为了能够兼容</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所有的版本</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>也提供了两套</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>API</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>保存到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>HDFS</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中在通常情况下需要关注或者设置五个参数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>即文件保存的路径</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,key</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>值的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>class</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,Value</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>值的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>class</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的输出格式</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(OutputFormat,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>TextOutputFormat/SequenceFileOutputFormat),</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>以及最后一个相关的参数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>codec(</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这个参数表示压缩存储的压缩形式</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>DefaultCodec,Gzip,Codec</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>等等</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>)<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin;letter-spacing:.5pt'>兼容旧版</span><span
lang=EN-US style='letter-spacing:.5pt'>API<o:p></o:p></span></b></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:0cm;mso-yfti-tbllook:1184;mso-padding-alt:
 2.0pt 2.0pt 2.0pt 2.0pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsObjectFile(path:
  String): Unit<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsTextFile(path:
  String, codec: Class[_ &lt;: CompressionCodec]): Unit<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsTextFile(path:
  String): Unit<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsHadoopFile[F
  &lt;: OutputFormat[K, V]](path: String)(implicit fm: ClassTag[F]): Unit<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsHadoopFile[F
  &lt;: OutputFormat[K, V]](path: String, codec: Class[_ &lt;:
  CompressionCodec])(implicit fm: ClassTag[F]): Unit<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsHadoopFile(path:
  String, keyClass: Class[_], valueClass: Class[_], outputFormatClass: Class[_
  &lt;: OutputFormat[_, _]], codec: Class[_ &lt;: CompressionCodec]): Unit<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsHadoopDataset(conf:
  JobConf): Unit<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这里列出的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>API,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>前面</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>6</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个都是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>saveAsHadoopDataset</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的简易实现版本</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>仅仅支持将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>存储到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>HDFS</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>而</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>saveAsHadoopDataset</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的参数类型是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>JobConf,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所以其不仅能够将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>存储到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>HDFS</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>也可以将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>存储到其他数据库中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hbase,MangoDB,Cassandra</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>等。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><b style='mso-bidi-font-weight:
normal'><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin;letter-spacing:.5pt'>兼容新版</span><span
lang=EN-US style='letter-spacing:.5pt'>API<span style='mso-bidi-font-weight:
bold'><o:p></o:p></span></span></b></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:0cm;mso-yfti-tbllook:1184;mso-padding-alt:
 2.0pt 2.0pt 2.0pt 2.0pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsNewAPIHadoopFile(path:
  String, keyClass: Class[_], valueClass: Class[_], outputFormatClass: Class[_
  &lt;: OutputFormat[_, _]], conf: Configuration =
  self.context.hadoopConfiguration): Unit<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsNewAPIHadoopFile[F
  &lt;: OutputFormat[K, V]](path: String)(implicit fm: ClassTag[F]): Unit<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes'>
  <td valign=top style='padding:2.0pt 2.0pt 2.0pt 2.0pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Times New Roman"'>saveAsNewAPIHadoopDataset(conf:
  Configuration): Unit<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>同样的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>前</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>API</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>saveAsNewAPIHadoopDataset</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的简易实现</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>只能将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>存到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>HDFS</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>而</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>saveAsNewAPIHadoopDataset</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>比较灵活</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>.</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>新版的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>API</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>没有</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>codec</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的参数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所以要压缩存储文件到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>HDFS</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中每需要使用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>hadoopConfiguration</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>设置对应</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>mapreduce.map.output.compress.codec</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>mapreduce.map.output.compress</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>.<o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>注意</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%;color:red'>:</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果不知道怎么将</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>RDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>存储到</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>生态的系统中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主要上网搜索一下对应的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>map-reduce</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是怎么将数据存储进去的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>,</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>然后改写成对应的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>saveAsHadoopDataset</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>或</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>saveAsNewAPIHadoopDataset</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就可以了。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h3><span style='font-size:14.0pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>文件系统</span><span
lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:125%'>Spark </span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>支持读写很多种文件系统，</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>像本地文件系统、</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>Amazon S3</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>HDFS</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>等。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'><o:p></o:p></span></p>

<h3><span style='font-size:14.0pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>数据库</span><span
lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'><o:p></o:p></span></h3>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>关系型数据库连接</span><span
lang=EN-US style='font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体'><o:p></o:p></span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2196" o:spid="_x0000_i1133" type="#_x0000_t75" style='width:447.75pt;
 height:219pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image402.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=597 height=292
src="08_Spark.files/image402.png" v:shapes="图片_x0020_2196"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>SQL</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>写法要有两个问号</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2197" o:spid="_x0000_i1132" type="#_x0000_t75" style='width:294.75pt;
 height:15.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image404.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=393 height=21
src="08_Spark.files/image404.png" v:shapes="图片_x0020_2197"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这里两个值就拼接到</span><span
lang=EN-US>SQL</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的两个问号</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2198" o:spid="_x0000_i1131" type="#_x0000_t75" style='width:310.5pt;
 height:133.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image406.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=414 height=178
src="08_Spark.files/image406.png" v:shapes="图片_x0020_2198"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h5><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>在</span><span lang=EN-US>spark-shell</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>执行例子</span></h5>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>导入</span><span
lang=EN-US>MySQL</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>驱动包，然后重新进入</span><span
lang=EN-US>spark-shell</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2199" o:spid="_x0000_i1130" type="#_x0000_t75" style='width:484.5pt;
 height:23.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image408.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=646 height=31
src="08_Spark.files/image408.png" v:shapes="图片_x0020_2199"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>数据库上的数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2200" o:spid="_x0000_i1129" type="#_x0000_t75" style='width:247.5pt;
 height:90.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image410.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=330 height=121
src="08_Spark.files/image410.png" v:shapes="图片_x0020_2200"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>执行</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2201" o:spid="_x0000_i1128" type="#_x0000_t75" style='width:457.5pt;
 height:126.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image412.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=610 height=169
src="08_Spark.files/image412.png" v:shapes="图片_x0020_2201"><![endif]></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;color:red'>val rdd = new org.apache.spark.rdd.JdbcRDD
  (<br>
  <span style='mso-spacerun:yes'>    </span>sc,<br>
  <span style='mso-spacerun:yes'>    </span>() =&gt; {<br>
  <span style='mso-spacerun:yes'>      </span>Class.forName
  (&quot;com.mysql.jdbc.Driver&quot;).newInstance()<br>
  <span style='mso-spacerun:yes'>     
  </span>java.sql.DriverManager.getConnection
  (&quot;jdbc:mysql://master:3306/rdd&quot;, &quot;root&quot;, &quot;password&quot;)<br>
  <span style='mso-spacerun:yes'>    </span>},<br>
  <span style='mso-spacerun:yes'>    </span>&quot;select * from rddtable where
  id &gt;= ? and id &lt;= ?;&quot;,<br>
  <span style='mso-spacerun:yes'>    </span>1,<br>
  <span style='mso-spacerun:yes'>    </span>10,<br>
  <span style='mso-spacerun:yes'>    </span>1,<br>
  <span style='mso-spacerun:yes'>    </span>r =&gt; (r.getInt(1),
  r.getString(2)))</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>打印结果，这种方法从</span><span
lang=EN-US>MySQL</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>读取数据然后转成</span><span
lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的方法，太麻烦了，后面</span><span
lang=EN-US>SparkSQL</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就方便了。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2202" o:spid="_x0000_i1127" type="#_x0000_t75" style='width:240.75pt;
 height:54pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image414.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=321 height=72
src="08_Spark.files/image414.png" v:shapes="图片_x0020_2202"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h5><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>写代码实现</span></h5>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>后面使用</span><span
lang=EN-US>SparkSQL.</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>支持通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>Java JDBC</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>访问关系型数据库。需要通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>JdbcRDD</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进行，示例如下</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>:<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:125%'>Mysql</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>读取：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>def main (args: Array[String] ) {</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>  </span>val sparkConf = new
SparkConf ().setMaster (&quot;local[2]&quot;).setAppName (&quot;JdbcApp&quot;)</span><span
lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'><span style='mso-spacerun:yes'>  </span>val sc = new SparkContext
(sparkConf)</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2 style='text-indent:9.0pt;mso-char-indent-count:1.0;mso-layout-grid-align:
none;punctuation-trim:leading'><span lang=EN-US style='font-size:9.0pt;
color:red'>val rdd = new org.apache.spark.rdd.JdbcRDD (<br>
<span style='mso-spacerun:yes'>    </span>sc,<br>
<span style='mso-spacerun:yes'>    </span>() =&gt; {<br>
<span style='mso-spacerun:yes'>      </span>Class.forName
(&quot;com.mysql.jdbc.Driver&quot;).newInstance()<br>
<span style='mso-spacerun:yes'>      </span>java.sql.DriverManager.getConnection
(&quot;jdbc:mysql://master:3306/rdd&quot;, &quot;root&quot;, &quot;password&quot;)<br>
<span style='mso-spacerun:yes'>    </span>},<br>
<span style='mso-spacerun:yes'>    </span>&quot;select * from rddtable where id
&gt;= ? and id &lt;= ?;&quot;,<br>
<span style='mso-spacerun:yes'>    </span>1,<br>
<span style='mso-spacerun:yes'>    </span>10,<br>
<span style='mso-spacerun:yes'>    </span>1,<br>
<span style='mso-spacerun:yes'>    </span>r =&gt; (r.getInt(1),
r.getString(2)))</span><span lang=EN-US style='font-size:9.0pt;color:black;
mso-color-alt:windowtext'><br>
<br>
<span style='mso-spacerun:yes'>  </span>println (rdd.count () )<br>
<span style='mso-spacerun:yes'>  </span>rdd.foreach (println (_) )<br>
<span style='mso-spacerun:yes'>  </span>sc.stop ()<br>
}</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%'>Mysql</span><span style='font-size:
9.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>写入：（没有提供写出，要写类似于</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%'>Java</span><span style='font-size:
9.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的代码）</span><span lang=EN-US style='font-size:
9.0pt;line-height:125%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>def main(args: Array[String]) {<br>
<span style='mso-spacerun:yes'>  </span>val sparkConf = new
SparkConf().setMaster(&quot;local[2]&quot;).setAppName(&quot;HBaseApp&quot;)<br>
<span style='mso-spacerun:yes'>  </span>val sc = new SparkContext(sparkConf)<br>
<span style='mso-spacerun:yes'>  </span>val data =
sc.parallelize(List(&quot;Female&quot;, &quot;Male&quot;,&quot;Female&quot;))<br>
<br>
<span style='mso-spacerun:yes'>  </span>data.foreachPartition(insertData)<br>
}<br>
<br>
def insertData(iterator: Iterator[String]): Unit = {</span><span lang=EN-US
style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>Class.forName (&quot;com.mysql.jdbc.Driver&quot;).newInstance()<br>
<span style='mso-spacerun:yes'>  </span>val conn =
java.sql.DriverManager.getConnection(&quot;jdbc:mysql://master01:3306/rdd&quot;,
&quot;root&quot;, &quot;hive&quot;)<br>
<span style='mso-spacerun:yes'>  </span>iterator.foreach(data =&gt; {<br>
<span style='mso-spacerun:yes'>    </span>val ps =
conn.prepareStatement(&quot;insert into rddtable(name) values (?)&quot;)<br>
<span style='mso-spacerun:yes'>    </span>ps.setString(1, data) <br>
<span style='mso-spacerun:yes'>    </span>ps.executeUpdate()<br>
<span style='mso-spacerun:yes'>  </span>})<br>
}</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>JdbcRDD </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>接收这样几个参数。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>• </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>首先，要提供一个用于对数据库创建连接的函数。这个函数让每个节点在连接必要的配</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>置后创建自己读取数据的连接。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>• </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>接下来，要提供一个可以读取一定范围内数据的查询，以及查询参数中</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>lowerBound</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> upperBound </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的值。这些参数可以让</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> Spark </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在不同机器上查询不同范围的数据，这样就不</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>会因尝试在一个节点上读取所有数据而遭遇性能瓶颈。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>• </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这个函数的最后一个参数是一个可以将输出结果从转为对操作数据有用的格式的函数。如果这个参数空缺，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>会自动将每行结果转为一个对象数组。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'>Cassandra</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>数据库和</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>ElasticSearch</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集成：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:12.0pt;line-height:15.0pt;mso-pagination:
none;mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:"Times",serif;color:black;mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_249" o:spid="_x0000_i1126" type="#_x0000_t75" style='width:438.75pt;
 height:182.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image416.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=585 height=243
src="08_Spark.files/image417.png" v:shapes="Picture_x0020_249"><![endif]></span><span
lang=EN-US style='font-family:"Times",serif;color:black'><o:p></o:p></span></p>

<h4><span lang=EN-US style='font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体'>HBase</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>数据库</span><span
lang=EN-US style='font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体'><o:p></o:p></span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就是控制</span><span
lang=EN-US>HadoopFile</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的读写</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>由于</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>
org.apache.hadoop.hbase.mapreduce.<span style='color:red'>TableInputFormat </span></span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类的实现，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>可以通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Hadoop</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>输入格式访问</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>HBase</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。这个输入格式会返回键值对数据，其中键的类型为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>org.
apache.hadoop.hbase.io.ImmutableBytesWritable</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，而值的类型为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>org.apache.hadoop.hbase.client.Result</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
line-height:150%;mso-pagination:none'><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>HBase</span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>读取：</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>def main(args: Array[String]) {<br>
<span style='mso-spacerun:yes'>  </span>val sparkConf = new
SparkConf().setMaster(&quot;local[2]&quot;).setAppName(&quot;HBaseApp&quot;)<br>
<span style='mso-spacerun:yes'>  </span>val sc = new SparkContext(sparkConf)<br>
<br>
<span style='mso-spacerun:yes'>  </span>val conf = HBaseConfiguration.create()<br>
<span style='mso-spacerun:yes'>  </span>//HBase</span><span style='font-size:
9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
"Courier New";color:black;mso-color-alt:windowtext'>中的表名</span><span
lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:windowtext'><br>
<span style='mso-spacerun:yes'>  </span>conf.set(TableInputFormat.INPUT_TABLE,
&quot;fruit&quot;)<br>
<br>
<span style='mso-spacerun:yes'>  </span>val hBaseRDD = sc.newAPIHadoopRDD(conf,
classOf[TableInputFormat],<br>
<span style='mso-spacerun:yes'>   
</span>classOf[org.apache.hadoop.hbase.io.ImmutableBytesWritable],<br>
<span style='mso-spacerun:yes'>   
</span>classOf[org.apache.hadoop.hbase.client.Result])<br>
<br>
<span style='mso-spacerun:yes'>  </span>val count = hBaseRDD.count()<br>
<span style='mso-spacerun:yes'>  </span>println(&quot;hBaseRDD RDD
Count:&quot;+ count)<br>
<span style='mso-spacerun:yes'>  </span>hBaseRDD.cache()<br>
<span style='mso-spacerun:yes'>  </span>hBaseRDD.foreach {<br>
<span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>  </span>case (_, result) =&gt;<br>
<span style='mso-spacerun:yes'>      </span>val key =
Bytes.toString(result.getRow)<br>
<span style='mso-spacerun:yes'>      </span>val name =
Bytes.toString(result.getValue(&quot;info&quot;.getBytes,
&quot;name&quot;.getBytes))<br>
<span style='mso-spacerun:yes'>      </span>val color =
Bytes.toString(result.getValue(&quot;info&quot;.getBytes,
&quot;color&quot;.getBytes))<br>
<span style='mso-spacerun:yes'>      </span>println(&quot;Row key:&quot; + key
+ &quot; Name:&quot; + name + &quot; Color:&quot; + color)<br>
<span style='mso-spacerun:yes'>  </span>}<br>
<span style='mso-spacerun:yes'>  </span>sc.stop()<br>
}</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;letter-spacing:.5pt'>HBase</span><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;line-height:150%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;
letter-spacing:.5pt'>写入：</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;line-height:150%;letter-spacing:.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
windowtext'>def main(args: Array[String]) {<br>
<span style='mso-spacerun:yes'>  </span>val sparkConf = new
SparkConf().setMaster(&quot;local[2]&quot;).setAppName(&quot;HBaseApp&quot;)<br>
<span style='mso-spacerun:yes'>  </span>val sc = new SparkContext(sparkConf)<br>
<br>
<span style='mso-spacerun:yes'>  </span>val conf = HBaseConfiguration.create()<br>
<span style='mso-spacerun:yes'>  </span>val jobConf = new JobConf(conf)<br>
<span style='mso-spacerun:yes'> 
</span>jobConf.setOutputFormat(classOf[TableOutputFormat])<br>
<span style='mso-spacerun:yes'>  </span>jobConf.set(TableOutputFormat.OUTPUT_TABLE,
&quot;fruit_spark&quot;)<br>
<br>
<span style='mso-spacerun:yes'>  </span>val fruitTable =
TableName.valueOf(&quot;fruit_spark&quot;)<br>
<span style='mso-spacerun:yes'>  </span>val tableDescr = new
HTableDescriptor(fruitTable)<br>
<span style='mso-spacerun:yes'>  </span>tableDescr.addFamily(new
HColumnDescriptor(&quot;info&quot;.getBytes))<br>
<br>
<span style='mso-spacerun:yes'>  </span>val admin = new HBaseAdmin(conf)<br>
<span style='mso-spacerun:yes'>  </span>if (admin.tableExists(fruitTable)) {<br>
<span style='mso-spacerun:yes'>    </span>admin.disableTable(fruitTable)<br>
<span style='mso-spacerun:yes'>    </span>admin.deleteTable(fruitTable)<br>
<span style='mso-spacerun:yes'>  </span>}<br>
<span style='mso-spacerun:yes'>  </span>admin.createTable(tableDescr)<br>
<br>
<span style='mso-spacerun:yes'>  </span>def convert(triple: (Int, String, Int))
= {<br>
<span style='mso-spacerun:yes'>    </span>val put = new
Put(Bytes.toBytes(triple._1))<br>
<span style='mso-spacerun:yes'>    </span>put.addImmutable(Bytes.toBytes(&quot;info&quot;),
Bytes.toBytes(&quot;name&quot;), Bytes.toBytes(triple._2))<br>
<span style='mso-spacerun:yes'>   
</span>put.addImmutable(Bytes.toBytes(&quot;info&quot;),
Bytes.toBytes(&quot;price&quot;), Bytes.toBytes(triple._3))<br>
<span style='mso-spacerun:yes'>    </span>(new ImmutableBytesWritable, put)<br>
<span style='mso-spacerun:yes'>  </span>}<br>
<span style='mso-spacerun:yes'>  </span>val initialRDD =
sc.parallelize(List((1,&quot;apple&quot;,11), (2,&quot;banana&quot;,12),
(3,&quot;pear&quot;,13)))<br>
<span style='mso-spacerun:yes'>  </span>val localData = initialRDD.map(convert)<br>
<br>
<span style='mso-spacerun:yes'>  </span>localData.saveAsHadoopDataset(jobConf)<br>
}</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US style='font-size:15.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;mso-bidi-theme-font:major-bidi;mso-font-kerning:
22.0pt'>RDD</span><span style='font-size:15.0pt;line-height:173%;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-font-kerning:22.0pt'>编程进阶</span><span lang=EN-US style='font-size:15.0pt;
line-height:173%;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;mso-bidi-theme-font:major-bidi;mso-font-kerning:22.0pt'><o:p></o:p></span></h2>

<h3><span style='font-size:14.0pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>累加器</span><span
lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'><o:p></o:p></span></h3>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>累加器用来对信息进行聚合，通常在向</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> Spark </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>传递函数时，比如使用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> map() </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>函数或者用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> filter() </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>传条件时，可以使用驱</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>动器程序中定义的变量，但是集群中运行的每个任务都会得到这些变量的一份新的副本，</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>更新这些副本的值也不会影响驱动器中的对应变量。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果我们想实现所有分片处理时更新共享变量的功能，那么累加器可以实现我们想要的效果。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>用变量累加的问题</span></h4>

<h5><span lang=EN-US>for</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>循环模拟加法</span></h5>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这种方式累加是没有问题的，但是不经过</span><span
lang=EN-US>Spark</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><i><span lang=EN-US style='font-size:11.0pt;
  color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* </span></i><i><span style='font-size:
  11.0pt;color:gray'>模拟累加器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:11.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>SimulateAccumulator {<br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>main(args: Array[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>创建<span lang=EN-US>SparkConf</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>conf = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;SimulateAccumulator&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;local[*]&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>创建<span lang=EN-US>SparkContext</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>sc = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>SparkContext(conf)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>arr = <i>Array</i>(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>2</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>3</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>4</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>5</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>var </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>sum = </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>0<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>把数组的值累加到<span lang=EN-US>sum<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>for</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>(i &lt;- arr) sum += i<br>
<span style='mso-spacerun:yes'>    </span><i>println</i>(sum)<br>
  <br>
<span style='mso-spacerun:yes'>    </span>sc.stop()<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>运行之后结果是：<span lang=EN-US>15<br>
<span style='mso-spacerun:yes'>  </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>}<br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h5><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>在算子里面做累加</span></h5>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这就有问题了，因为执行结果为</span><span
lang=EN-US>0</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:11.0pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'>org.apache.spark.{SparkConf, SparkContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:11.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* </span></i><i><span style='font-size:
  11.0pt;color:gray'>有问题的累加器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:11.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>IssueAccumulator {<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>main(args: Array[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>创建<span lang=EN-US>SparkConf</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>conf = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;IssueAccumulator&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;local[*]&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>创建<span lang=EN-US>SparkContext</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>sc = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>SparkContext(conf)<br>
  <br>
<span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>var </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>sum = </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>0<br>
<span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>arr = <i>Array</i>(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>2</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>3</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>4</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>5</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>rdd = sc.makeRDD(arr)<br>
<span style='mso-spacerun:yes'>    </span><span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:11.0pt;color:gray'>// </span></i><i><span
  style='font-size:11.0pt;color:gray'>累加<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>rdd.map{x =&gt;<br>
<span style='mso-spacerun:yes'>        </span>sum += x<br>
<span style='mso-spacerun:yes'>        </span>x<br>
<span style='mso-spacerun:yes'>      </span>}.collect()<br>
<span style='mso-spacerun:yes'>      </span><i>println</i>(sum)<br>
  <br>
<span style='mso-spacerun:yes'>      </span>sc.stop()<br>
  <br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>运行之后结果是：<span lang=EN-US>0<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分析一下问题</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2203" o:spid="_x0000_i1125" type="#_x0000_t75" style='width:491.25pt;
 height:200.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image418.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=655 height=267
src="08_Spark.files/image418.png" v:shapes="图片_x0020_2203"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>所以要用系统累加器或者自定义累加器。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>系统累加器</span><span
lang=EN-US style='font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体'><o:p></o:p></span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这就能实现了累加</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:10.5pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:10.5pt;
  color:black'>org.apache.spark.{SparkConf, SparkContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:10.5pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* </span></i><i><span style='font-size:
  10.5pt;color:gray'>系统累加器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:10.5pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>SystemAccumulator {<br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>main(args: Array[</span><span
  lang=EN-US style='font-size:10.5pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:10.5pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>创建<span lang=EN-US>SparkConf</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>conf = </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:10.5pt;color:green'>&quot;SystemAccumulator&quot;</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:10.5pt;color:green'>&quot;local[*]&quot;</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>创建<span lang=EN-US>SparkContext</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>sc = </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>SparkContext(conf)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>初始化系统累加器为<span lang=EN-US>0</span>，赋值给<span lang=EN-US>sum<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>var </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>sum = sc.accumulator(</span><span
  lang=EN-US style='font-size:10.5pt;color:blue'>0</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>arr = <i>Array</i>(</span><span
  lang=EN-US style='font-size:10.5pt;color:blue'>1</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>, </span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>2</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>, </span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>3</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>, </span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>4</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>, </span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>5</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>rdd = sc.makeRDD(arr)<br>
<span style='mso-spacerun:yes'>    </span>rdd.map { x =&gt;<br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>累加器在行动算子累加，不在中间的算子<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><span lang=EN-US
  style='font-size:10.5pt;color:black'>sum += x<br>
<span style='mso-spacerun:yes'>      </span>x<br>
<span style='mso-spacerun:yes'>    </span>}.collect()<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:10.5pt;color:gray'>// </span></i><i><span
  style='font-size:10.5pt;color:gray'>记得要用行动算子触发计算<span lang=EN-US><br>
  <br>
<span style='mso-spacerun:yes'>    </span>// sum.value</span>就是获取累加器的值<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><i><span
  lang=EN-US style='font-size:10.5pt;color:black'>println</span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>(sum.value)<br>
  <br>
<span style='mso-spacerun:yes'>    </span>sc.stop()<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>运行之后结果是：<span lang=EN-US>15<br>
<span style='mso-spacerun:yes'>  </span></span></span></i><span lang=EN-US
  style='font-size:10.5pt;color:black'>}<br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分析</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2204" o:spid="_x0000_i1124" type="#_x0000_t75" style='width:294.75pt;
 height:165.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image420.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=393 height=221
src="08_Spark.files/image420.png" v:shapes="图片_x0020_2204"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>注意点：累加器不要写到转换算子里面，要写在行动算子里面。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2205" o:spid="_x0000_i1123" type="#_x0000_t75" style='width:348pt;
 height:246pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image422.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=464 height=328
src="08_Spark.files/image422.png" v:shapes="图片_x0020_2205"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>累加器的用法如下所示。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>通过在驱动器中调用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>SparkContext.accumulator(initialValue)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法，创建出存有初始值的累加器。返回值为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>
org.apache.spark.Accumulator[T] </span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>对象，其中</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'> T </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是初始值</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> initialValue </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的类型。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>闭包里的执行器代码可以使用累加器的</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <b><span lang=EN-US
style='color:red'>+=</span></b><span lang=EN-US> </span></span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Java</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> add)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>增加累加器的值。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>驱动器程序可以调用累加器的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>value</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>属性</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Java</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中使用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>value()</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>或</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>setValue())</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>来访问累加器的值。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
line-height:150%;mso-pagination:none'><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin;color:red'>注意：</span><span style='mso-bidi-font-size:
10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>工作节点上的任务不能访问累加器的值。从这些任务的角度来看，累加器是一个只写变量。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对于要在行动操作中使用的累加器，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>只会把每个任务对各累加器的修改应用一次。因此，如果想要一个无论在失败还是重复计</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>算时都绝对可靠的累加器，我们必须把它放在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> foreach() </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这样的行动操作中。转化操作中累加器可</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>能会发生不止一次更新</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>自定义累加器</span><span
lang=EN-US style='font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体'><o:p></o:p></span></h4>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:150%;mso-pagination:none'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>自定义累加器类型的功能在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>1.X</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>版本中就已经提供了，但是使用起来比较麻烦，在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>2.0</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>版本后，累加器的易用性有了较大的改进，而且官方还提供了一个新的抽象类：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>AccumulatorV2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>来提供更加友好的自定义类型累加器的实现方式。实现自定义类型累加器需要继承</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>AccumulatorV2</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>并至少覆写下例中出现的方法，下面这个累加器可以用于在程序运行过程中收集一些文本类信息，最终以</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Set[String]</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的形式返回。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:8.0pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:8.0pt;
  color:black'>java.util<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.spark.util.AccumulatorV2<br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.spark.{SparkConf, SparkContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:8.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* </span></i><i><span style='font-size:
  8.0pt;color:gray'>自定义累加器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:8.0pt;color:navy'>class </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>CustomerAccu </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>extends </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>AccumulatorV2[</span><span
  lang=EN-US style='font-size:8.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:8.0pt;color:black'>, java.util.Set[</span><span
  lang=EN-US style='font-size:8.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:8.0pt;color:black'>]] {<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>var </span></b><i><span lang=EN-US
  style='font-size:8.0pt;color:#660E7A'>logStr </span></i><span lang=EN-US
  style='font-size:8.0pt;color:black'>= </span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>util.HashSet[</span><span lang=EN-US
  style='font-size:8.0pt;color:#20999D'>String</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>]()<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>是否为空<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>isZero: Boolean = </span><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>logStr</span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>.isEmpty<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>复制对象（合并的过程需要复制数据）<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>copy(): AccumulatorV2[</span><span
  lang=EN-US style='font-size:8.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:8.0pt;color:black'>, util.Set[</span><span
  lang=EN-US style='font-size:8.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:8.0pt;color:black'>]] = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// new</span></i><i><span
  style='font-size:8.0pt;color:gray'>一个新的累加器，把当前累加器的值都<span lang=EN-US>add</span>进去，然后返回新的累加器<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>accu = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>CustomerAccu<br>
<span style='mso-spacerun:yes'>    </span>accu.</span><i><span lang=EN-US
  style='font-size:8.0pt;color:#660E7A'>logStr</span></i><span lang=EN-US
  style='font-size:8.0pt;color:black'>.addAll(</span><i><span lang=EN-US
  style='font-size:8.0pt;color:#660E7A'>logStr</span></i><span lang=EN-US
  style='font-size:8.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span>accu<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>重置<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>reset(): Unit = </span><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>logStr</span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>.clear()<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>分区内添加数据<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>add(v: </span><span lang=EN-US
  style='font-size:8.0pt;color:#20999D'>String</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>): Unit = </span><i><span lang=EN-US
  style='font-size:8.0pt;color:#660E7A'>logStr</span></i><span lang=EN-US
  style='font-size:8.0pt;color:black'>.add(v)<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>传进来的是<span lang=EN-US>k</span>、<span
  lang=EN-US>v</span>，只添加<span lang=EN-US>v<br>
  <br>
<span style='mso-spacerun:yes'>  </span>// </span>分区间合并<span lang=EN-US>(</span>所有分区都算完了，调用这个合并<span
  lang=EN-US>)</span>。 这里要判断是不是自己写的那个类，防止别人调用你的累加器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>merge(other: AccumulatorV2[</span><span
  lang=EN-US style='font-size:8.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:8.0pt;color:black'>, util.Set[</span><span
  lang=EN-US style='font-size:8.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:8.0pt;color:black'>]]): Unit = </span><i><span
  lang=EN-US style='font-size:8.0pt;color:#660E7A'>logStr</span></i><span
  lang=EN-US style='font-size:8.0pt;color:black'>.addAll(other.value)<span style='mso-spacerun:yes'>  </span></span><i><span
  lang=EN-US style='font-size:8.0pt;color:gray'>// </span></i><i><span
  style='font-size:8.0pt;color:gray'>把传递过来的数据全部添加<span lang=EN-US><br>
  <br>
<span style='mso-spacerun:yes'>  </span>// </span>最终返回的累加值<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>value: util.Set[</span><span lang=EN-US
  style='font-size:8.0pt;color:#20999D'>String</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>] = </span><i><span lang=EN-US
  style='font-size:8.0pt;color:#660E7A'>logStr<br>
  </span></i><span lang=EN-US style='font-size:8.0pt;color:black'>}<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>CustomerAccumulator {<br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>main(args: Array[</span><span lang=EN-US
  style='font-size:8.0pt;color:#20999D'>String</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>创建<span lang=EN-US>SparkConf</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>conf = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;CustomerAccumulator&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;local[*]&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>创建<span lang=EN-US>SparkContext</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>sc = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>SparkContext(conf)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>rdd = sc.makeRDD(<i>Array</i>(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;a&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;b&quot;</span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:8.0pt;color:green'>&quot;c&quot;</span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>accu = </span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>CustomerAccu<br>
<span style='mso-spacerun:yes'>    </span>sc.register(accu, </span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;CumstomerAccu&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>)<br>
  <br>
<span style='mso-spacerun:yes'>    </span>rdd.map { x =&gt;<br>
<span style='mso-spacerun:yes'>      </span>accu.add(x)<br>
<span style='mso-spacerun:yes'>      </span>x<br>
<span style='mso-spacerun:yes'>    </span>}.collect()<br>
  <br>
<span style='mso-spacerun:yes'>    </span><i>println</i>(accu.value)<br>
<span style='mso-spacerun:yes'>    </span>sc.stop()<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>运行之后结果是：<span lang=EN-US>[a, b, c]<br>
<span style='mso-spacerun:yes'>  </span></span></span></i><span lang=EN-US
  style='font-size:8.0pt;color:black'>}<br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-size:14.0pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>广播变量</span><span
lang=EN-US style='font-size:14.0pt;line-height:173%;font-family:"Times New Roman",serif;
mso-fareast-font-family:黑体;mso-bidi-theme-font:minor-bidi'><o:p></o:p></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>广播优化的时候特别好用</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2209" o:spid="_x0000_i1122" type="#_x0000_t75" style='width:412.5pt;
 height:205.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image424.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=550 height=274
src="08_Spark.files/image424.png" v:shapes="图片_x0020_2209"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>广播变量用来高效分发较大的对象。向所有工作节点发送一个较大的<span
style='color:red'>只读值</span>，以供一个或多个</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:150%'>Spark </span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>操作使用。比如，如果你的应用需要向所有节点发送一个较大的只读查询表，甚至是机器学习算法中的一个很大的特征向量，广播变量用起来都很顺手。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>传统方式下，</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>Spark </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>会自动把闭包中所有引用到的变量发送到工作节点上。虽然这很方便，但也很低效。原因有二</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>:</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>首先，默认的任务发射机制是专门为小任务进行优化的；其次，事实上你可能会在多个并行操作中使用同一个变量，但是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> Spark</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>会为每个任务分别发送。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:
accent6;mso-themeshade:191'>// </span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>直接调用</span><span
lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'>broadcast</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>就广播出去了</span><span
lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; val broadcastVar = sc.broadcast(Array(1, 2, 3))</span><span
lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>broadcastVar: org.apache.spark.broadcast.Broadcast[Array[Int]] =
Broadcast(35)</span><span lang=EN-US style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:
accent6;mso-themeshade:191'>// </span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:#538135;mso-themecolor:accent6;mso-themeshade:191'>获取值</span><span
lang=EN-US style='font-size:10.5pt;color:#538135;mso-themecolor:accent6;
mso-themeshade:191'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>scala&gt; broadcastVar.value</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.5pt;color:black;mso-color-alt:
windowtext'>res33: Array[Int] = Array(1, 2, 3)</span><span lang=EN-US
style='font-size:10.5pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>使用广播变量的过程如下：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(1) </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>通过对一个类型</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> T </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的对象调用</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>
SparkContext.broadcast </span><span style='mso-bidi-font-size:10.5pt;
line-height:150%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>创建出一个</span><span lang=EN-US
style='mso-bidi-font-size:10.5pt;line-height:150%'> Broadcast[T] </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对象。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>任何可序列化的类型都可以这么实现。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(2) </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>通过</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> value </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>属性访问该对象的值</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> Java </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'> value() </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>方法</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(3) </span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>变量只会被发到各个节点一次，应作为只读值处理</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>(</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>修改这个值不会影响到别的节点</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'>)</span><span
style='mso-bidi-font-size:10.5pt;line-height:150%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:150%'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>Spark SQL</span></h1>

<h2><span lang=EN-US>Spark SQL</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>概述</span></h2>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2210" o:spid="_x0000_i1121" type="#_x0000_t75" style='width:111pt;
 height:144.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image426.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=148 height=193
src="08_Spark.files/image426.png" v:shapes="图片_x0020_2210"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>SparkSQL</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是什么</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Spark</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>与</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Hive</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的底层不一样</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2211" o:spid="_x0000_i1120" type="#_x0000_t75" style='width:342pt;
 height:249.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image428.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=456 height=333
src="08_Spark.files/image428.png" v:shapes="图片_x0020_2211"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2213" o:spid="_x0000_i1119" type="#_x0000_t75" style='width:398.25pt;
 height:287.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image430.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=531 height=383
src="08_Spark.files/image430.png" v:shapes="图片_x0020_2213"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>SparkCore</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的数据抽象是</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>RDD</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>SparkSQL</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的数据抽象是</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>DataFrame</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>DataSet</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>。这三者可以相互转换，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>RDD</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不想写了，可以写</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>SQL</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>，学完了这三者的转换就学完了</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>SparkSQL</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2214" o:spid="_x0000_i1118" type="#_x0000_t75" style='width:391.5pt;
 height:276.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image432.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=522 height=369
src="08_Spark.files/image432.png" v:shapes="图片_x0020_2214"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>DataFrame</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>DataSet</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>RDD</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>只关心一行行的数据，具体一行有什么列，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>RDD</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>是不知道的，</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>DataFrame</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>还知道你有什么列，列名是什么，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>DataSet</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>还知道你这个列是什么类型的。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2217" o:spid="_x0000_i1117" type="#_x0000_t75" style='width:457.5pt;
 height:148.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image434.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=610 height=198
src="08_Spark.files/image434.png" v:shapes="图片_x0020_2217"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>DataSet</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>有</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>RDD</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的所有方法，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>3.0</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>版本之后，</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>DataSet</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>有一统江湖的趋势。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2216" o:spid="_x0000_i1116" type="#_x0000_t75" style='width:317.25pt;
 height:219pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image436.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=423 height=292
src="08_Spark.files/image436.png" v:shapes="图片_x0020_2216"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2215" o:spid="_x0000_i1115" type="#_x0000_t75" style='width:340.5pt;
 height:26.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image438.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=454 height=35
src="08_Spark.files/image438.png" v:shapes="图片_x0020_2215"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2218" o:spid="_x0000_i1114" type="#_x0000_t75" style='width:480pt;
 height:284.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image210.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=640 height=379
src="08_Spark.files/image439.png" v:shapes="图片_x0020_2218"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2220" o:spid="_x0000_i1113" type="#_x0000_t75" style='width:534pt;
 height:195.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image441.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=712 height=261
src="08_Spark.files/image441.png" v:shapes="图片_x0020_2220"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>性能上比</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>RDD</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>要高：</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2222" o:spid="_x0000_i1112" type="#_x0000_t75" style='width:363.75pt;
 height:189.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image443.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=485 height=253
src="08_Spark.files/image443.png" v:shapes="图片_x0020_2222"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2224" o:spid="_x0000_i1111" type="#_x0000_t75" style='width:357.75pt;
 height:188.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image445.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=477 height=251
src="08_Spark.files/image445.png" v:shapes="图片_x0020_2224"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>DataFrame</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>因为没有类型，所以可以随便写，编译不报错，但是运行的时候类型不对会报错。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Dataframe</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的劣势在于在编译期缺少类型安全检查，运行期检查。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2225" o:spid="_x0000_i1110" type="#_x0000_t75" style='width:414pt;
 height:240pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image447.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=552 height=320
src="08_Spark.files/image447.png" v:shapes="图片_x0020_2225"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_52" o:spid="_x0000_i1109" type="#_x0000_t75" style='width:386.25pt;
 height:266.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image449.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=515 height=355
src="08_Spark.files/image449.png" v:shapes="图片_x0020_52"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>SparkSQL</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>查询</span></h2>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>命令行操作</span></h3>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>小插曲</span></h4>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>HDFS</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>每次启动都一直都是进入安全模式，页面首页有下面这种提示，每次都要手动离开安全模式，故把数据都删除了，重启就自动离开安全模式了。据说是断电之后，有部分块数据损坏了，导致阈值问题。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Safe mode is ON. The
reported blocks 18 needs additional 289 blocks to reach the threshold 0.9990 of
total blocks 307. The number of live datanodes 3 has reached the minimum number
0.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>读</span><span
lang=EN-US>json</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>前面提到过运行</span><span
lang=EN-US>spark-shell</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的时候，可以看到</span><span
lang=EN-US>SparkSession</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，简写为</span><span
lang=EN-US>spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，这个就是</span><span
lang=EN-US>SparkSQL</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2229" o:spid="_x0000_i1108" type="#_x0000_t75" style='width:384.75pt;
 height:126pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image451.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=513 height=168
src="08_Spark.files/image451.png" v:shapes="图片_x0020_2229"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>官网上的测试数据，注意</span><span
lang=EN-US>json</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>数据的大括号要在一行上。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2226" o:spid="_x0000_i1107" type="#_x0000_t75" style='width:279pt;
 height:79.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image453.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=372 height=106
src="08_Spark.files/image453.png" v:shapes="图片_x0020_2226"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>{&quot;name&quot;:&quot;Michael&quot;}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>{&quot;name&quot;:&quot;Andy&quot;,
  &quot;age&quot;:30}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>{&quot;name&quot;:&quot;Justin&quot;,
  &quot;age&quot;:19}</span><span lang=EN-US style='font-size:12.0pt;
  mso-bidi-font-size:11.0pt;mso-fareast-font-family:宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2227" o:spid="_x0000_i1106" type="#_x0000_t75" style='width:280.5pt;
 height:106.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image455.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=374 height=142
src="08_Spark.files/image455.png" v:shapes="图片_x0020_2227"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>使用</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>read.json</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>读一个</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>json</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>，可以看到转成了</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>DataFrame</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，有字段</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>age</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>、</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>name<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt;
  spark.read.json(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.json&quot;)
  </span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:red'>res0</span><span
  lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>:
  org.apache.spark.sql.</span><span lang=EN-US style='font-size:9.0pt;
  color:red'>DataFrame </span><span lang=EN-US style='font-size:9.0pt;
  color:black;mso-color-alt:windowtext'>= [age: bigint, name: string]</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>表结构</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; res0.show </span><span lang=EN-US style='font-size:
  9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| age|<span style='mso-spacerun:yes'>   </span>name|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|null|Michael|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>30| <span
  style='mso-spacerun:yes'>  </span>Andy|</span><span lang=EN-US
  style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>19| Justin|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:12.0pt;
  mso-bidi-font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>获取值可以用</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>DSL</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>、</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>SQL</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>两种风格</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<h4><span lang=EN-US>DSL</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这种</span><span
lang=EN-US>DSL</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>风格比较少用</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt;
  spark.read.json(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.json&quot;)
  </span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:red'>res0</span><span
  lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>:
  org.apache.spark.sql.</span><span lang=EN-US style='font-size:9.0pt;
  color:black;mso-themecolor:text1'>DataFrame </span><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>= [age: bigint,
  name: string]</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>也是懒执行，所以要用</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>show<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; </span><span lang=EN-US style='font-size:9.0pt;
  color:red'>res0</span><span lang=EN-US style='font-size:9.0pt;color:black;
  mso-color-alt:windowtext'>.select(&quot;name&quot;).show</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>   </span>name|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|Michael|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>   </span>Andy|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| Justin|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>要加减乘除等操作字段，要在前面加</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>$</span><span style='font-size:9.0pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>，否则报错</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; res0.select($&quot;age&quot; + 1).show</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|(age + 1)|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>     </span>null|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>       </span>31|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>       </span>20|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>只要有一个字段有操作行为，其他字段都要加</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>$</span><span style='font-size:9.0pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>，否则报错</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; res0.select($&quot;age&quot; + 1,
  $&quot;name&quot;).show</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---------+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|(age + 1)|<span style='mso-spacerun:yes'>   </span>name|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---------+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>     </span>null|Michael|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>       </span>31|<span
  style='mso-spacerun:yes'>   </span>Andy|</span><span lang=EN-US
  style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>       </span>20| Justin|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---------+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>不操作字段，加</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>$</span><span style='font-size:9.0pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>也不会报错</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; res0.select($&quot;name&quot;).show</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>   </span>name|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|Michael|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>   </span>Andy|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| Justin|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; res0.first</span><span lang=EN-US style='font-size:
  9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>res5: org.apache.spark.sql.Row = [null,Michael]</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>过滤器</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; res0.filter($&quot;age&quot; &gt; 20).show </span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---+----+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|age|name|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---+----+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| 30|Andy|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---+----+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// res0. + </span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>回车</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'> + Tab</span><span style='font-size:9.0pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>键，就可以看到很多方法</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; res0.</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'><span style='mso-spacerun:yes'>     </span>| </span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>agg<span
  style='mso-spacerun:yes'>                       </span>createTempView<span
  style='mso-spacerun:yes'>   </span>foreach<span
  style='mso-spacerun:yes'>            </span>mapPartitions<span
  style='mso-spacerun:yes'>       </span>schema<span
  style='mso-spacerun:yes'>                 </span>toJavaRDD<span
  style='mso-spacerun:yes'>           </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>alias<span
  style='mso-spacerun:yes'>                     </span>crossJoin<span
  style='mso-spacerun:yes'>        </span>foreachPartition<span
  style='mso-spacerun:yes'>   </span>na<span
  style='mso-spacerun:yes'>                  </span>select<span
  style='mso-spacerun:yes'>                 </span>toLocalIterator<span
  style='mso-spacerun:yes'>     </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>apply<span
  style='mso-spacerun:yes'>                     </span>cube<span
  style='mso-spacerun:yes'>             </span>groupBy<span
  style='mso-spacerun:yes'>            </span>orderBy<span
  style='mso-spacerun:yes'>             </span>selectExpr<span
  style='mso-spacerun:yes'>             </span>toString<span
  style='mso-spacerun:yes'>            </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>as<span
  style='mso-spacerun:yes'>                        </span>describe<span
  style='mso-spacerun:yes'>         </span>groupByKey<span
  style='mso-spacerun:yes'>         </span>persist<span
  style='mso-spacerun:yes'>             </span>show<span
  style='mso-spacerun:yes'>                   </span>transform<span
  style='mso-spacerun:yes'>      </span><span
  style='mso-spacerun:yes'>     </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>cache<span
  style='mso-spacerun:yes'>                     </span>distinct<span
  style='mso-spacerun:yes'>         </span>head<span
  style='mso-spacerun:yes'>               </span>printSchema<span
  style='mso-spacerun:yes'>         </span>sort<span
  style='mso-spacerun:yes'>                   </span>union<span
  style='mso-spacerun:yes'>               </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>checkpoint<span
  style='mso-spacerun:yes'>                </span>drop<span
  style='mso-spacerun:yes'>             </span>inputFiles<span
  style='mso-spacerun:yes'>         </span>queryExecution<span
  style='mso-spacerun:yes'>      </span>sortWithinPartitions<span
  style='mso-spacerun:yes'>   </span>unionAll<span
  style='mso-spacerun:yes'>           </span><span
  style='mso-spacerun:yes'> </span></span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>coalesce<span
  style='mso-spacerun:yes'>                  </span>dropDuplicates<span
  style='mso-spacerun:yes'>   </span>intersect<span
  style='mso-spacerun:yes'>          </span>randomSplit<span
  style='mso-spacerun:yes'>         </span>sparkSession<span
  style='mso-spacerun:yes'>           </span>unpersist<span
  style='mso-spacerun:yes'>           </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>col<span
  style='mso-spacerun:yes'>                       </span>dtypes<span
  style='mso-spacerun:yes'>           </span>isLocal<span
  style='mso-spacerun:yes'>            </span>randomSplitAsList<span
  style='mso-spacerun:yes'>   </span>sqlContext<span
  style='mso-spacerun:yes'>             </span>where<span
  style='mso-spacerun:yes'>               </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>collect<span
  style='mso-spacerun:yes'>                   </span>except<span
  style='mso-spacerun:yes'>           </span>isStreaming<span
  style='mso-spacerun:yes'>        </span>rdd<span
  style='mso-spacerun:yes'>                 </span>stat<span
  style='mso-spacerun:yes'>                   </span>withColumn<span
  style='mso-spacerun:yes'>          </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>collectAsList<span
  style='mso-spacerun:yes'>             </span>explain<span
  style='mso-spacerun:yes'>          </span>javaRDD<span
  style='mso-spacerun:yes'>            </span>reduce<span
  style='mso-spacerun:yes'>              </span>storageLevel<span
  style='mso-spacerun:yes'>           </span>withColumnRenamed<span
  style='mso-spacerun:yes'>   </span></span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>columns<span
  style='mso-spacerun:yes'>                   </span>explode<span
  style='mso-spacerun:yes'>          </span>join<span
  style='mso-spacerun:yes'>               </span>registerTempTable<span
  style='mso-spacerun:yes'>   </span>take<span
  style='mso-spacerun:yes'>                   </span>withWatermark<span
  style='mso-spacerun:yes'>       </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>count<span
  style='mso-spacerun:yes'>                     </span>filter<span
  style='mso-spacerun:yes'>           </span>joinWith<span
  style='mso-spacerun:yes'>           </span>repartition<span
  style='mso-spacerun:yes'>         </span>takeAsList<span
  style='mso-spacerun:yes'>             </span>write<span
  style='mso-spacerun:yes'>               </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>createGlobalTempView<span
  style='mso-spacerun:yes'>      </span>first<span
  style='mso-spacerun:yes'>            </span>limit<span
  style='mso-spacerun:yes'>              </span>rollup<span
  style='mso-spacerun:yes'>              </span>toDF<span
  style='mso-spacerun:yes'>                   </span>writeStream<span
  style='mso-spacerun:yes'>         </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>createOrReplaceTempView<span
  style='mso-spacerun:yes'>   </span>flatMap<span
  style='mso-spacerun:yes'>          </span>map<span
  style='mso-spacerun:yes'>                </span>sample<span
  style='mso-spacerun:yes'>              </span>toJSON<span
  style='mso-spacerun:yes'>     </span></span><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'><span
  style='mso-spacerun:yes'>                                </span></span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'><span style='mso-spacerun:yes'>     </span>| show<span
  style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='font-size:
  9.0pt;color:#538135;mso-themecolor:accent6;mso-themeshade:191'>// </span><span
  style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>最后随便输入一个方法，即可退出就行</span><span lang=EN-US
  style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| age|<span style='mso-spacerun:yes'>   </span>name|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|null|Michael|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>30|<span
  style='mso-spacerun:yes'>   </span>Andy|</span><span lang=EN-US
  style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>19| Justin|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span lang=EN-US>SQL</span></h4>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>外部读取文件之后，获取值的方式比较多用</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>SQL</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>风格。</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt;
  spark.read.json(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.json&quot;)
  </span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:red'>res0</span><span
  lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>:
  org.apache.spark.sql.</span><span lang=EN-US style='font-size:9.0pt;
  color:black;mso-themecolor:text1'>DataFrame </span><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>= [age: bigint,
  name: string]</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>// </span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>创建一个表，表名为</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>people<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; res0.createTempView(&quot;</span><span lang=EN-US
  style='font-size:9.0pt;color:red'>people</span><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>&quot;) </span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>spark.sql</span><span style='font-size:9.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>里面就是</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>SQL</span><span style='font-size:9.0pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>语句了</span><span
  lang=EN-US style='font-size:9.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; spark.sql(&quot;select * from </span><span lang=EN-US
  style='font-size:9.0pt;color:red'>people</span><span lang=EN-US
  style='font-size:9.0pt;color:black;mso-color-alt:windowtext'>&quot;).show</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| age|<span style='mso-spacerun:yes'>   </span>name|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|null|Michael|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>30|<span
  style='mso-spacerun:yes'>   </span>Andy|</span><span lang=EN-US
  style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>19| Justin|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>scala&gt; spark.sql(&quot;select * from people where age &gt;
  20&quot;).show</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---+----+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|age|name|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---+----+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| 30|Andy|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+---+----+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>IDEA</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>创建</span><span
lang=EN-US>SparkSQL</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>程序</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在原来</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>项目新建一个</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>module</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，注意目录要选择</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>下新建</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>sparkSQL</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>目录</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_34" o:spid="_x0000_i1105" type="#_x0000_t75" style='width:311.25pt;
 height:101.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image457.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=415 height=135
src="08_Spark.files/image457.png" v:shapes="图片_x0020_34"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>加依赖，我在最外面的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>pom.xml</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>加</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_31" o:spid="_x0000_i1104" type="#_x0000_t75" style='width:363.75pt;
 height:279pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image459.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=485 height=372
src="08_Spark.files/image459.png" v:shapes="图片_x0020_31"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就之前的测试数据</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>people.json<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_32" o:spid="_x0000_i1103" type="#_x0000_t75" style='width:202.5pt;
 height:105.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image461.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=270 height=141
src="08_Spark.files/image461.png" v:shapes="图片_x0020_32"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>代码</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  background:white'><b><span lang=EN-US style='font-size:11.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>org.apache.spark.sql.SparkSession<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.spark.{SparkConf, SparkContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:gray;mso-font-kerning:0pt'>/**<br>
  <span style='mso-spacerun:yes'>  </span>* Created by yw_forWork on 2019/7/23.<br>
  <span style='mso-spacerun:yes'>  </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:11.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>object </span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>HelloWorld {<br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>def </span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>main(args:
  Array[</span><span lang=EN-US style='font-size:11.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>]): Unit = {<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:11.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>创建<span
  lang=EN-US>SparkConf</span>对象<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>conf = </span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:
  0pt'>new </span></b><span lang=EN-US style='font-size:11.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;mso-font-kerning:0pt'>&quot;HelloWorld&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>).setMaster(</span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;local[*]&quot;</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>)<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:11.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>创建<span
  lang=EN-US>SparkContext</span>对象<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span>//val sc = new SparkContext(conf)<br>
  <br>
  <span style='mso-spacerun:yes'>    </span>// SparkSessiond</span>的构造方法私有化了。<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>spark = SparkSession.<i>builder</i>().config(conf).getOrCreate()<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:11.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>生成<span
  lang=EN-US>DataFrame<br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>df = spark.read.json(</span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;E:</span></b><b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>\\</span></b><b><span lang=EN-US style='font-size:11.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>Code</span></b><b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>\\</span></b><b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>IDEA</span></b><b><span lang=EN-US style='font-size:
  11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:
  0pt'>\\</span></b><b><span lang=EN-US style='font-size:11.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>BigData</span></b><b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>\\</span></b><b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>Spark</span></b><b><span lang=EN-US style='font-size:
  11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:
  0pt'>\\</span></b><b><span lang=EN-US style='font-size:11.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>sparkSQL</span></b><b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>\\</span></b><b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>src</span></b><b><span lang=EN-US style='font-size:
  11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:
  0pt'>\\</span></b><b><span lang=EN-US style='font-size:11.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>file</span></b><b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>\\</span></b><b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>people.json&quot;</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>)<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:11.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>显示所有数据<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>df.show()<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// DSL<br>
  <span style='mso-spacerun:yes'>    </span></span></i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>df.select(</span><b><span lang=EN-US style='font-size:
  11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;mso-font-kerning:
  0pt'>&quot;name&quot;</span></b><span lang=EN-US style='font-size:11.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>).show()<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// SQL<br>
  <span style='mso-spacerun:yes'>    </span></span></i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>df.createTempView(</span><b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;people&quot;</span></b><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>)<br>
  <span style='mso-spacerun:yes'>    </span>spark.sql(</span><b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;mso-font-kerning:0pt'>&quot;select * from people&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>).show()<br>
  <br>
  <span style='mso-spacerun:yes'>    </span>spark.close()<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>//sc.stop()<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span></i><span lang=EN-US
  style='font-size:11.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>}<br>
  <br>
  }<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行之后打印日志，会掺杂很多调试日志</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| age|<span style='mso-spacerun:yes'>   </span>name|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|null|Michael|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>30|<span
  style='mso-spacerun:yes'>   </span>Andy|</span><span lang=EN-US
  style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>19| Justin|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>   </span>name|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|Michael|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>   </span>Andy|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| Justin|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>| age|<span style='mso-spacerun:yes'>   </span>name|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|null|Michael|</span><span lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>30|<span
  style='mso-spacerun:yes'>   </span>Andy|</span><span lang=EN-US
  style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>|<span style='mso-spacerun:yes'>  </span>19| Justin|</span><span
  lang=EN-US style='font-size:9.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:9.0pt;color:black;mso-color-alt:
  windowtext'>+----+-------+</span><span lang=EN-US style='font-size:12.0pt;
  mso-bidi-font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>不想打印那么多调试日志就整个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>log4j.properties</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>过来放</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>resources</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>，修改一下</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_48" o:spid="_x0000_i1102" type="#_x0000_t75" style='width:337.5pt;
 height:234.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image463.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=450 height=313
src="08_Spark.files/image463.png" v:shapes="图片_x0020_48"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>、</span><span
lang=EN-US>DataFrame</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>、</span><span
lang=EN-US>DataSet</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>转换</span></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>从复杂的数据转简单的很方便，但从简单的数据转复杂的就要补充缺失的内容。</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>准备官网给的测试数据</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>people.txt<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_66" o:spid="_x0000_i1101" type="#_x0000_t75" style='width:239.25pt;
 height:164.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image465.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=319 height=219
src="08_Spark.files/image465.png" v:shapes="图片_x0020_66"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>Michael, 29<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>Andy, 30<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>Justin, 19</span><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>转</span><span
lang=EN-US>DataFrame</span></h3>

<h4><span lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>、补充字段</span></h4>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>从文件读取数据</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val rdd =
  sc.textFile(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.txt&quot;)<span
  style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>rdd: org.apache.spark.rdd.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>RDD</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[String]
  = file:///.../people.txt MapPartitionsRDD[32] at textFile at
  &lt;console&gt;:24</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>字符串的</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>RDD<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res12: Array[String] = Array(Michael, 29, Andy, 30,
  Justin, 19)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>这是</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>kv</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>对了，即转成了二元组。</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>trim</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>是去空格</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val kvRdd = rdd.map{x =&gt; val pa =
  x.split(&quot;,&quot;);(pa(0).trim, pa(1).trim)}</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>kvRdd: org.apache.spark.rdd.RDD[(String, String)] =
  MapPartitionsRDD[42] at map at &lt;console&gt;:26</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>看一下</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; kvRdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res19: Array[(String, String)] =
  Array((Michael,29), (Andy,30), (Justin,19))</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>转成二元组就可以</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>toDF</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>，转成了</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>DataFrame</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>，可以通过按</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>tab</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>键查看可选的方法</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; kvRdd.</span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>toDF(&quot;name&quot;,
  &quot;age&quot;)</span></b><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res14: org.apache.spark.sql.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>DataFrame </span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>=
  [name: string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; res14.show</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|<span style='mso-spacerun:yes'>   </span>name|age|</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|Michael| 29|</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|<span style='mso-spacerun:yes'>   </span>Andy| 30|</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>| Justin| 19|</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>、样例类的反射方式</span></h4>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>从文件读取数据</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val rdd =
  sc.textFile(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.txt&quot;)<span
  style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>rdd: org.apache.spark.rdd.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>RDD</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[String]
  = file:///.../people.txt MapPartitionsRDD[32] at textFile at
  &lt;console&gt;:24</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>字符串的</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>RDD<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res12: Array[String] = Array(Michael, 29, Andy, 30,
  Justin, 19)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>声明一个样例类</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>case class People(name:String,
  age:String)</span></b><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>defined class People</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.map{x =&gt; val pa =
  x.split(&quot;,&quot;);People(pa(0).trim, pa(1).trim)}.collect </span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res27: Array[People] = Array(People(Michael,29),
  People(Andy,30), People(Justin,19))</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>有了样例类就不用写字段了，可直接转</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.map{x =&gt; val pa =
  x.split(&quot;,&quot;);</span><b><span lang=EN-US style='mso-bidi-font-size:
  8.0pt;color:red'>People</span></b><span lang=EN-US style='mso-bidi-font-size:
  8.0pt;color:black;mso-color-alt:windowtext'>(pa(0).trim, pa(1).trim)}.</span><b><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>toDF</span></b><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res23: org.apache.spark.sql.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>DataFrame </span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>=
  [name: string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; res23.show</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|<span style='mso-spacerun:yes'>   </span>name|age|</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|Michael| 29|</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|<span style='mso-spacerun:yes'>   </span>Andy| 30|</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>| Justin| 19|</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果不用样例类就会默认转成这种</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:8.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; kvRdd.toDF<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:8.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res21: org.apache.spark.sql.DataFrame = [_1:
  string, _2: string]</span><span lang=EN-US style='font-size:12.0pt;
  mso-bidi-font-size:11.0pt;mso-fareast-font-family:宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>、编程动态引入</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这种方法比较复杂，看完其他的再回头看。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>本来是编程用的，这里用</span><span
lang=EN-US>shell</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>模拟一下。</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>case</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>类不能够提前定义，可以通过下面三个步骤定义一个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>DataFrame</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>：</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>创建一个多行结构的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>RDD;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>创建用</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>StructType</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>来表示的行结构信息；</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>通过</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>SparkSession</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>提供的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>createDataFrame</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>方法来应用</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Schema </span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>读取文件转成</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>rdd<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; val rdd =
  sc.textFile(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.txt&quot;)<span
  style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>rdd: org.apache.spark.rdd.RDD[String] =
  file:///...s/people.txt MapPartitionsRDD[68] at textFile at
  &lt;console&gt;:24<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>这本来要从</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>MySQL</span><span
  style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>数据获取字段的数据的，而且字段名也不需要写死了，仅仅简单模拟，这就是</span><span
  lang=EN-US style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>case</span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>类不能提前定义的意思</span><span lang=EN-US style='font-size:6.5pt;font-family:
  "Courier New";mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; val schemaString = &quot;name
  age&quot;<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>schemaString: String = name age<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; rdd.map{x=&gt; val
  pa=x.split(&quot;,&quot;);org.apache.spark.sql.Row(pa(0).trim,pa(1).trim)}.collect<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res46: Array[org.apache.spark.sql.Row] =
  Array([Michael,29], [Andy,30], [Justin,19])<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// kv</span><span style='font-size:6.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>对</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; val row = rdd.map{x=&gt; val
  pa=x.split(&quot;,&quot;);org.apache.spark.sql.Row(pa(0).trim,pa(1).trim)}<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>row:
  org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[71] at
  map at &lt;console&gt;:26<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>导入，后面</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>nullable</span><span
  style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>用到</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; import org.apache.spark.sql.types._<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>import org.apache.spark.sql.types._<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// fieldName</span><span style='font-size:6.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>属性名</span><span lang=EN-US style='font-size:6.5pt;
  font-family:"Courier New";mso-fareast-font-family:宋体;mso-bidi-font-family:
  Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; val fields =
  schemaString.split(&quot; &quot;).map(fieldName =&gt; StructField(fieldName,
  StringType, nullable = true))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>fields: Array[org.apache.spark.sql.types.StructField]
  = Array(StructField(name,StringType,true), StructField(age,StringType,true))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>映射成</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>StructType<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; val schema = StructType(fields)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>schema: org.apache.spark.sql.types.StructType
  = StructType(StructField(name,StringType,true),
  StructField(age,StringType,true))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; spark.createDataFrame(row, schema)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res47: org.apache.spark.sql.DataFrame = [name:
  string, age: string]<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; res47.show<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+-------+---+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|<span style='mso-spacerun:yes'>  
  </span>name|age|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+-------+---+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|Michael| 29|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|<span style='mso-spacerun:yes'>  
  </span>Andy| 30|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>| Justin| 19|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+-------+---+</span><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>RDD</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>转</span><span
lang=EN-US>DataSet</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>从文件读取数据</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val rdd =
  sc.textFile(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.txt&quot;)<span
  style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>rdd: org.apache.spark.rdd.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>RDD</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[String]
  = file:///.../people.txt MapPartitionsRDD[32] at textFile at
  &lt;console&gt;:24</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>字符串的</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>RDD<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res12: Array[String] = Array(Michael, 29, Andy, 30,
  Justin, 19)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>声明一个样例类</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>case class People(name:String,
  age:String)</span></b><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>defined class People</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.map{x =&gt; val pa =
  x.split(&quot;,&quot;);People(pa(0).trim, pa(1).trim)}.collect </span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res27: Array[People] = Array(People(Michael,29),
  People(Andy,30), People(Justin,19))</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>直接就能转</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>DS<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.map{x =&gt; val pa =
  x.split(&quot;,&quot;);</span><b><span lang=EN-US style='mso-bidi-font-size:
  8.0pt;color:red'>People</span></b><span lang=EN-US style='mso-bidi-font-size:
  8.0pt;color:black;mso-color-alt:windowtext'>(pa(0).trim, pa(1).trim)}.</span><b><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>toDS</span></b><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res25: org.apache.spark.sql.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>Dataset</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[People]
  = [name: string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; res25.show</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|<span style='mso-spacerun:yes'>   </span>name|age|</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|Michael| 29|</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|<span style='mso-spacerun:yes'>   </span>Andy| 30|</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>| Justin| 19|</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果不用样例类就会默认转成这种</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:8.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; rdd.map{x =&gt; val pa =
  x.split(&quot;,&quot;);(pa(0).trim, pa(1).trim)}.toDS<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:8.0pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res17: org.apache.spark.sql.Dataset[(String,
  String)] = [_1: string, _2: string]</span><span lang=EN-US style='font-size:
  12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>DataFrame</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>转</span><span
lang=EN-US>RDD</span></h3>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>从文件读取数据</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val rdd =
  sc.textFile(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.txt&quot;)<span
  style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>rdd: org.apache.spark.rdd.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-themecolor:text1'>RDD</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[String]
  = file:///.../people.txt MapPartitionsRDD[32] at textFile at
  &lt;console&gt;:24</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>字符串的</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>RDD<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res12: Array[String] = Array(Michael, 29, Andy, 30,
  Justin, 19)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>这是</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>kv</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>对了，即转成了二元组。</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>trim</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>是去空格</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val kvRdd = rdd.map{x =&gt; val pa =
  x.split(&quot;,&quot;);(pa(0).trim, pa(1).trim)}</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>kvRdd: org.apache.spark.rdd.RDD[(String, String)] =
  MapPartitionsRDD[42] at map at &lt;console&gt;:26</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>看一下</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; kvRdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res19: Array[(String, String)] =
  Array((Michael,29), (Andy,30), (Justin,19))</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>转成二元组就可以</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>toDF</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>，转成了</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>DataFrame</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>，可以通过按</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>tab</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>键查看可选的方法</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>df</span></b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'> </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>=
  kvRdd.toDF(&quot;name&quot;, &quot;age&quot;)</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>df: org.apache.spark.sql.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>DataFrame </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>=
  [name: string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>直接转</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>df.rdd</span></b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res29: org.apache.spark.rdd.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>RDD</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[org.apache.spark.sql.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>Row</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>]
  = MapPartitionsRDD[55] at rdd at &lt;console&gt;:31</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; res29.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res30: Array[org.apache.spark.sql.Row] =
  Array([Michael,29], [Andy,30], [Justin,19])</span><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:9.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_108" o:spid="_x0000_i1100" type="#_x0000_t75" style='width:202.5pt;
 height:21pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image467.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=270 height=28
src="08_Spark.files/image467.png" v:shapes="图片_x0020_108"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'>Row</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;mso-no-proof:yes'>类似于</span><span lang=EN-US style='mso-no-proof:
yes'>MySQL</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;mso-no-proof:
yes'>的</span><span lang=EN-US style='mso-no-proof:yes'>ResultSet</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_90" o:spid="_x0000_i1099" type="#_x0000_t75" style='width:150pt;
 height:245.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image469.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=200 height=327
src="08_Spark.files/image469.png" v:shapes="图片_x0020_90"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// df</span><span
  style='mso-bidi-font-size:8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>转</span><span lang=EN-US style='mso-bidi-font-size:8.0pt;
  color:#538135;mso-themecolor:accent6;mso-themeshade:191'>rdd</span><span
  style='mso-bidi-font-size:8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>之后，怎么获取值</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt;color:#538135;mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>df.rdd</span></b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res29: org.apache.spark.rdd.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>RDD</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[org.apache.spark.sql.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>Row</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>]
  = MapPartitionsRDD[55] at rdd at &lt;console&gt;:31</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; res29.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res30: Array[org.apache.spark.sql.Row] =
  Array([Michael,29], [Andy,30], [Justin,19])</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>获取第一列的</span><span lang=EN-US style='color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='color:black;mso-color-alt:windowtext'>scala&gt;
  res29.map(_.</span><span lang=EN-US style='color:red'>getString(0)</span><span
  lang=EN-US style='color:black;mso-color-alt:windowtext'>).collect </span></p>
  <p class=a2><span lang=EN-US style='color:black;mso-color-alt:windowtext'>res37:
  Array[String] = Array(Michael, Andy, Justin)</span></p>
  <p class=a2><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='color:black;mso-color-alt:windowtext'>scala&gt;
  res29.map(_.getString(1)).collect </span></p>
  <p class=a2><span lang=EN-US style='color:black;mso-color-alt:windowtext'>res38:
  Array[String] = Array(29, 30, 19)</span></p>
  <p class=a2><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>另一个获取值的方式</span><span lang=EN-US
  style='color:#538135;mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='color:black;mso-color-alt:windowtext'>scala&gt;
  res29.map(_.</span><span lang=EN-US style='color:red'>getAs[String](0)</span><span
  lang=EN-US style='color:black;mso-color-alt:windowtext'>).collect </span></p>
  <p class=a2><span lang=EN-US style='color:black;mso-color-alt:windowtext'>res39:
  Array[String] = Array(Michael, Andy, Justin)</span></p>
  <p class=a2><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-family:宋体;mso-ascii-font-family:
  "Courier New";mso-hansi-font-family:"Courier New";color:#538135;mso-themecolor:
  accent6;mso-themeshade:191'>获取值，类型不对的话，编译期间不会报错，运行时报错</span><span lang=EN-US
  style='color:#538135;mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='color:black;mso-color-alt:windowtext'>scala&gt;
  res29.map(_.getAs[Int](0)).collect </span></p>
  <p class=a2><span style='font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";color:black;mso-color-alt:windowtext'>报错：</span><span
  lang=EN-US style='color:black;mso-color-alt:windowtext'>java.lang.ClassCastException:
  java.lang.String cannot be cast to java.lang.Integer</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>DataFrame</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>转</span><span
lang=EN-US>DataSet</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
16.0pt;line-height:173%;mso-fareast-font-family:宋体'><o:p></o:p></span></h3>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>从文件读取数据</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val rdd =
  sc.textFile(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.txt&quot;)<span
  style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>rdd: org.apache.spark.rdd.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>RDD</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[String]
  = file:///.../people.txt MapPartitionsRDD[32] at textFile at
  &lt;console&gt;:24</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>字符串的</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>RDD<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res12: Array[String] = Array(Michael, 29, Andy, 30,
  Justin, 19)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>这是</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>kv</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>对了，即转成了二元组。</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>trim</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>是去空格</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val kvRdd = rdd.map{x =&gt; val pa = x.split(&quot;,&quot;);(pa(0).trim,
  pa(1).trim)}</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>kvRdd: org.apache.spark.rdd.RDD[(String, String)] =
  MapPartitionsRDD[42] at map at &lt;console&gt;:26</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>看一下</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; kvRdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res19: Array[(String, String)] =
  Array((Michael,29), (Andy,30), (Justin,19))</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>转成二元组就可以</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>toDF</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>，转成了</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>DataFrame</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>，可以通过按</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>tab</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>键查看可选的方法</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; kvRdd.toDF(&quot;name&quot;,
  &quot;age&quot;)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res14: org.apache.spark.sql.DataFrame = [name:
  string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>df</span></b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'> =
  kvRdd.toDF(&quot;name&quot;, &quot;age&quot;)</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>df: org.apache.spark.sql.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>DataFrame </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>=
  [name: string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>声明一个样例类</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>case class People(name:String,
  age:String)</span></b><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>defined class People</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>注意，样例类的列名与</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>df</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>的要一样，否则转会报错</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>df.as[People]</span></b><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res41: org.apache.spark.sql.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>Dataset</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[People]
  = [name: string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; res41.show</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|<span style='mso-spacerun:yes'>   </span>name|age|</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|Michael| 29|</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>|<span style='mso-spacerun:yes'>   </span>Andy| 30|</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>| Justin| 19|</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>+-------+---+</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>DataSet</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>转</span><span
lang=EN-US>RDD</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>从文件读取数据</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val rdd =
  sc.textFile(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.txt&quot;)<span
  style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>rdd: org.apache.spark.rdd.RDD[String] = file:///.../people.txt
  MapPartitionsRDD[32] at textFile at &lt;console&gt;:24</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>字符串的</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>RDD<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res12: Array[String] = Array(Michael, 29, Andy, 30,
  Justin, 19)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>声明一个样例类</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; case class People(name:String,
  age:String)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>defined class People</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>转</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>DS<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>ds</span></b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'> </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>=
  rdd.map{x =&gt; val pa = x.split(&quot;,&quot;);People(pa(0).trim,
  pa(1).trim)}.toDS</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>ds: org.apache.spark.sql.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>Dataset[People]</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>
  = [name: string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>直接转</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>ds.rdd</span></b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res31: org.apache.spark.rdd.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>RDD[People]</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>
  = MapPartitionsRDD[58] at rdd at &lt;console&gt;:31</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; res31.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res32: Array[People] = Array(People(Michael,29),
  People(Andy,30), People(Justin,19)) </span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>点的时候按</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>tab</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>键就可以看到很多，其中就有</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>age</span><span style='mso-bidi-font-size:8.0pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>、</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>name<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; res31.map(_.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>age<span
  style='mso-spacerun:yes'>        </span></span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>copy<span
  style='mso-spacerun:yes'>     </span>hashCode<span
  style='mso-spacerun:yes'>   </span>productArity<span
  style='mso-spacerun:yes'>     </span>productIterator<span
  style='mso-spacerun:yes'>   </span>toString<span style='mso-spacerun:yes'>  
  </span></span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>canEqual<span style='mso-spacerun:yes'>  
  </span>equals<span style='mso-spacerun:yes'>   </span></span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>name</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'><span
  style='mso-spacerun:yes'>       </span>productElement<span
  style='mso-spacerun:yes'>   </span>productPrefix</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>获取值，类型不对的话，编译期间就会报错</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; res31.map(_.name).collect </span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res33: Array[String] = Array(Michael, Andy, Justin)</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>DataSet</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>转</span><span
lang=EN-US>DataFrame</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>从文件读取数据</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val rdd =
  sc.textFile(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.txt&quot;)<span
  style='mso-spacerun:yes'>  </span></span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>rdd: org.apache.spark.rdd.RDD[String] = file:///.../people.txt
  MapPartitionsRDD[32] at textFile at &lt;console&gt;:24</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; rdd.collect </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>字符串的</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>RDD<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res12: Array[String] = Array(Michael, 29, Andy, 30,
  Justin, 19)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>声明一个样例类</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; case class People(name:String,
  age:String)</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>defined class People</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>// </span><span style='mso-bidi-font-size:
  8.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";color:#538135;mso-themecolor:accent6;mso-themeshade:191'>转</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>DS<o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; val </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>ds</span></b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'> </span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>=
  rdd.map{x =&gt; val pa = x.split(&quot;,&quot;);People(pa(0).trim,
  pa(1).trim)}.toDS</span><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>ds: org.apache.spark.sql.</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>Dataset</span><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>[People]
  = [name: string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>scala&gt; </span><b><span lang=EN-US
  style='mso-bidi-font-size:8.0pt;color:red'>ds.toDF</span></b><span
  lang=EN-US style='mso-bidi-font-size:8.0pt'><o:p></o:p></span></p>
  <p class=a2><span lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;
  mso-color-alt:windowtext'>res34: org.apache.spark.sql.</span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:red'>DataFrame </span><span
  lang=EN-US style='mso-bidi-font-size:8.0pt;color:black;mso-color-alt:windowtext'>=
  [name: string, age: string]</span><span lang=EN-US style='mso-bidi-font-size:
  8.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>用户自定义函数</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:16.0pt;line-height:173%;
mso-fareast-font-family:宋体'><o:p></o:p></span></h2>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>自定义</span><span lang=EN-US>UDF</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>函数</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>读之前的</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>json</span><span style='font-size:
  6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>，得到</span><span lang=EN-US style='font-size:6.5pt;
  font-family:"Courier New";mso-fareast-font-family:宋体;mso-bidi-font-family:
  Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:191'>DF<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; val df =
  spark.read.json(&quot;file:///usr/local/spark2.1.1/examples/src/main/resources/people.json&quot;)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>df: org.apache.spark.sql.DataFrame = [age:
  bigint, name: string]<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>创建表</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt;
  df.createTempView(&quot;df_people&quot;)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>看一下</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; spark.sql(&quot;select * from
  df_people&quot;).show<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+----+-------+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>| age|<span style='mso-spacerun:yes'>  
  </span>name|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+----+-------+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|null|Michael|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|<span style='mso-spacerun:yes'> 
  </span>30|<span style='mso-spacerun:yes'>   </span>Andy|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|<span style='mso-spacerun:yes'>  </span>19|
  Justin|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+----+-------+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>注册一个函数。</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>addName</span><span
  style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>是函数名；</span><i><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>(x:String) =&gt; &quot;name:&quot; + x</span></i><span
  style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>是一个函数，即在数据前面加上“</span><span
  lang=EN-US style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>name:</span><span style='font-size:6.5pt;font-family:
  宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>”</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt;
  spark.udf.register(&quot;addName&quot;, (x:String) =&gt; &quot;name:&quot; +
  x) <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res52:
  org.apache.spark.sql.expressions.UserDefinedFunction =
  UserDefinedFunction(&lt;function1&gt;,StringType,Some(List(StringType)))<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'>// </span><span style='font-size:6.5pt;font-family:宋体;
  mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
  mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;mso-themeshade:
  191'>使用</span><span lang=EN-US style='font-size:6.5pt;font-family:"Courier New";
  mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>addName</span><span
  style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial;color:#538135;
  mso-themecolor:accent6;mso-themeshade:191'>函数</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial;color:#538135;mso-themecolor:accent6;
  mso-themeshade:191'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; spark.sql(&quot;select <span
  style='color:red'>addName(name)</span> as name from df_people&quot;).show<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+------------+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|<span style='mso-spacerun:yes'>       
  </span>name|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+------------+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|<span style='color:red'>name:</span>Michael|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|<span style='mso-spacerun:yes'>   </span><span
  style='color:red'>name:</span>Andy|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>| <span style='color:red'>name:</span>Justin|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+------------+</span><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>自定义</span><span lang=EN-US>UDAF</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>函数（聚合函数）</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>强类型的</span><span
lang=EN-US>Dataset</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>和弱类型的</span><span
lang=EN-US>DataFrame</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>都提供了相关的聚合函数，</span>
<span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>如</span><span lang=EN-US> count()</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>，</span><span lang=EN-US>countDistinct()</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>，</span><span lang=EN-US>avg()</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US>max()</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，</span><span
lang=EN-US>min()</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。除此之外，用户可以设定自己的自定义聚合函数。</span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>弱类型</span><span
lang=EN-US>DataFrame</span></h4>

<p class=MsoNormalIndent><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>弱类型</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>(DataFrame)</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>用户自定义聚合函数：通过继承</span><span lang=EN-US style='font-size:
10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;
letter-spacing:0pt'>UserDefinedAggregateFunction</span><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>来实现用户自定义聚合函数。下面展示一个求平均工资的自定义聚合函数。</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>准备数据</span> </p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_192" o:spid="_x0000_i1098" type="#_x0000_t75" style='width:206.25pt;
 height:97.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image471.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=275 height=130
src="08_Spark.files/image471.png" v:shapes="图片_x0020_192"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>代码</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:9.0pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:9.0pt;
  color:black'>org.apache.spark.SparkConf<br>
  </span><b><span lang=EN-US style='font-size:9.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>org.apache.spark.sql.{Row, SparkSession}<br>
  </span><b><span lang=EN-US style='font-size:9.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>org.apache.spark.sql.expressions.{MutableAggregationBuffer, UserDefinedAggregateFunction}<br>
  </span><b><span lang=EN-US style='font-size:9.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>org.apache.spark.sql.types._<br>
  <br>
  </span><i><span lang=EN-US style='font-size:9.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* </span></i><i><span style='font-size:
  9.0pt;color:gray'>自定义<span lang=EN-US>UDF</span>，求平均工资<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:9.0pt;color:navy'>class </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>CustomerUDF </span><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>extends </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>UserDefinedAggregateFunction{<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>输入的类型。<span lang=EN-US>StructField(&quot;salary&quot;, LongType)</span>是单个值，<span
  lang=EN-US> :: Nil</span>是单个值变成一个集合<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>inputSchema: StructType = <i>StructType</i>(<i>StructField</i>(</span><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>&quot;salary&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>, LongType) :: </span><i><span
  lang=EN-US style='font-size:9.0pt;color:#660E7A'>Nil</span></i><span
  lang=EN-US style='font-size:9.0pt;color:black'>)<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>缓存数据的类型。数据没有读完时，要缓存什么，缓存<span lang=EN-US>sum</span>、<span
  lang=EN-US>count</span>，有这两个就可以求平均数了。<span lang=EN-US> ::</span>是拼接<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>bufferSchema: StructType = <i>StructType</i>(<i>StructField</i>(</span><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>&quot;sum&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>, LongType) :: <i>StructField</i>(</span><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>&quot;count&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>, LongType) :: </span><i><span
  lang=EN-US style='font-size:9.0pt;color:#660E7A'>Nil</span></i><span
  lang=EN-US style='font-size:9.0pt;color:black'>)<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>返回值类型<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>dataType: DataType = DoubleType<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>幂等性。<span lang=EN-US>true</span>就是对于同一份数据集每次结果都一样，<span
  lang=EN-US>false</span>就每次都不一样。<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>deterministic: Boolean = </span><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>true<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span></b><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>初始化。初始化的是<span lang=EN-US>buffer</span>，即<span lang=EN-US>sum=0</span>，<span
  lang=EN-US>count=0<br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>initialize(buffer: MutableAggregationBuffer): Unit = {<br>
<span style='mso-spacerun:yes'>    </span>buffer(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) = </span><span lang=EN-US style='font-size:9.0pt;
  color:blue'>0L<br>
<span style='mso-spacerun:yes'>    </span></span><span lang=EN-US
  style='font-size:9.0pt;color:black'>buffer(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>1</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) = </span><span lang=EN-US style='font-size:9.0pt;
  color:blue'>0L<br>
<span style='mso-spacerun:yes'>  </span></span><span lang=EN-US
  style='font-size:9.0pt;color:black'>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>更新，相同<span lang=EN-US>Execute</span>间的数据合并。分片内，读入值之后更新<span
  lang=EN-US>sum</span>的值等<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>update(buffer: MutableAggregationBuffer, input: Row): Unit = {<br>
<span style='mso-spacerun:yes'>    </span>buffer(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) = buffer.getLong(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) + input.getLong(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span>buffer(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>1</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) = buffer.getLong(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>1</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) + </span><span lang=EN-US style='font-size:9.0pt;
  color:blue'>1L<br>
<span style='mso-spacerun:yes'>  </span></span><span lang=EN-US
  style='font-size:9.0pt;color:black'>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>合并，不同<span lang=EN-US>Execute</span>间的数据合并 。不同分区合并<span
  lang=EN-US>sum<br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = {<br>
<span style='mso-spacerun:yes'>    </span>buffer1(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) = buffer1.getLong(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) + buffer2.getLong(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>0</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span>buffer1(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>1</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) = buffer1.getLong(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>1</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>) + buffer2.getLong(</span><span lang=EN-US
  style='font-size:9.0pt;color:blue'>1</span><span lang=EN-US style='font-size:
  9.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>最终执行的方法。<span lang=EN-US>sum</span>、<span lang=EN-US>count</span>都算完了，来到这里算平均数：总<span
  lang=EN-US>sum / </span>总<span lang=EN-US>count<br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>evaluate(buffer: Row): Double = {<br>
<span style='mso-spacerun:yes'>    </span>buffer.getLong(</span><span
  lang=EN-US style='font-size:9.0pt;color:blue'>0</span><span lang=EN-US
  style='font-size:9.0pt;color:black'>) / buffer.getLong(</span><span
  lang=EN-US style='font-size:9.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:9.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
}<br>
  <br>
  </span><b><span lang=EN-US style='font-size:9.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>udf {<br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>main(args: Array[</span><span lang=EN-US
  style='font-size:9.0pt;color:#20999D'>String</span><span lang=EN-US
  style='font-size:9.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>创建<span lang=EN-US>SparkConf</span>对象<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>conf = </span><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>&quot;MyAverage&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>&quot;local[*]&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// SparkSessiond</span></i><i><span
  style='font-size:9.0pt;color:gray'>的构造方法私有化了。<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>spark = SparkSession.<i>builder</i>().config(conf).getOrCreate()<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>生成<span lang=EN-US>DataFrame<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>df = spark.read.json(</span><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>&quot;E:</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>Code</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>IDEA</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>BigData</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>Spark</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>sparkSQL</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>src</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>file</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:navy'>\\</span></b><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>people_udaf.json&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>注册函数<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:9.0pt;color:black'>spark.udf.register(</span><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>&quot;MyAverage&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>, </span><b><span lang=EN-US
  style='font-size:9.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>CustomerUDF)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// SQL<br>
<span style='mso-spacerun:yes'>    </span></span></i><span lang=EN-US
  style='font-size:9.0pt;color:black'>df.createTempView(</span><b><span
  lang=EN-US style='font-size:9.0pt;color:green'>&quot;people&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;color:gray'>// </span></i><i><span style='font-size:
  9.0pt;color:gray'>传入工资，就算平均工资<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:9.0pt;color:black'>spark.sql(</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>&quot;select MyAverage(salary) avg_salary from people&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>).show()<br>
  <br>
<span style='mso-spacerun:yes'>    </span>spark.stop()<br>
  <br>
<span style='mso-spacerun:yes'>  </span>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:9.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>输出结果，得出所有人的平均工资</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_193" o:spid="_x0000_i1097" type="#_x0000_t75" style='width:104.25pt;
 height:74.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image473.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=139 height=99
src="08_Spark.files/image473.png" v:shapes="图片_x0020_193"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对比下数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_194" o:spid="_x0000_i1096" type="#_x0000_t75" style='width:231pt;
 height:71.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image475.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=308 height=95
src="08_Spark.files/image475.png" v:shapes="图片_x0020_194"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>强类型</span><span
lang=EN-US>Dataset</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>直接复制的，没有试过。</span></p>

<p class=MsoNormalIndent><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>强类型</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>(Dataset)</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>用户自定义聚合函数：通过继承</span><span lang=EN-US style='font-size:
10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;
letter-spacing:0pt'>Aggregator</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>来实现强类型自定义聚合函数，同样是求平均工资</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>import org.apache.spark.sql.expressions.Aggregator<br>
import org.apache.spark.sql.Encoder<br>
<a name="OLE_LINK33"></a><a name="OLE_LINK32"><span style='mso-bookmark:OLE_LINK33'>import
org.apache.spark.sql.Encoders<br>
import org.apache.spark.sql.SparkSession<br>
// </span></a></span><span style='mso-bookmark:OLE_LINK32'><span
style='mso-bookmark:OLE_LINK33'><span style='font-size:10.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:black;mso-color-alt:windowtext'>既然是强类型，可能有</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>case</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
style='font-size:10.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:black;mso-color-alt:windowtext'>类</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'><br>
case class Employee(name: String, salary: Long)<br>
case class Average(var sum: Long, var count: Long)<br>
<br>
object MyAverage extends <a name="OLE_LINK28"></a><a name="OLE_LINK27"><span
style='mso-bookmark:OLE_LINK28'>Aggregator</span></a>[Employee, Average,
Double] {<br>
// </span></span></span><span style='mso-bookmark:OLE_LINK32'><span
style='mso-bookmark:OLE_LINK33'><span style='font-size:10.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:black;mso-color-alt:windowtext'>定义一个数据结构，保存工资总数和工资总个数，初始都为</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>0<br>
def zero: Average = Average(0L, 0L)<br>
// Combine two values to produce a new value. For performance, the function may
modify `buffer`<br>
// and return it instead of constructing a new object<br>
def reduce(buffer: Average, employee: Employee): Average = {<br>
buffer.sum += employee.salary<br>
buffer.count += 1<br>
buffer<br>
}<br>
// </span></span></span><span style='mso-bookmark:OLE_LINK32'><span
style='mso-bookmark:OLE_LINK33'><span style='font-size:10.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:black;mso-color-alt:windowtext'>聚合不同</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>execute</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
style='font-size:10.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:black;mso-color-alt:windowtext'>的结果</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'><br>
def merge(b1: Average, b2: Average): Average = {<br>
b1.sum += b2.sum<br>
b1.count += b2.count<br>
b1<br>
}<br>
// </span></span></span><span style='mso-bookmark:OLE_LINK32'><span
style='mso-bookmark:OLE_LINK33'><span style='font-size:10.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:black;mso-color-alt:windowtext'>计算输出</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'><br>
def finish(reduction: Average): Double = reduction.sum.toDouble /
reduction.count<br>
// </span></span></span><span style='mso-bookmark:OLE_LINK32'><span
style='mso-bookmark:OLE_LINK33'><span style='font-size:10.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:black;mso-color-alt:windowtext'>设定之间值类型的编码器，要转换成</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>case</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
style='font-size:10.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:black;mso-color-alt:windowtext'>类</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></span></span></p>

<p class=a2><span style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:
OLE_LINK33'><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>// Encoders.product</span></span></span><span style='mso-bookmark:
OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span style='font-size:10.0pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:black;mso-color-alt:windowtext'>是进行</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>scala</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
style='font-size:10.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:black;mso-color-alt:windowtext'>元组和</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'>case</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
style='font-size:10.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";color:black;mso-color-alt:windowtext'>类转换的编码器</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'> <br>
def bufferEncoder: Encoder[Average] = <a name="OLE_LINK30"></a><a
name="OLE_LINK29"><span style='mso-bookmark:OLE_LINK30'>Encoders.product</span></a><br>
// </span></span></span><span style='mso-bookmark:OLE_LINK32'><span
style='mso-bookmark:OLE_LINK33'><span style='font-size:10.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
color:black;mso-color-alt:windowtext'>设定最终输出值的编码器</span></span></span><span
style='mso-bookmark:OLE_LINK32'><span style='mso-bookmark:OLE_LINK33'><span
lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:windowtext'><br>
def outputEncoder: Encoder[Double] = Encoders.scalaDouble<br>
}</span></span></span><span lang=EN-US style='font-size:10.0pt;color:black;
mso-color-alt:windowtext'><br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]></span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'>import spark.implicits._</span><span lang=EN-US style='font-size:
10.0pt'><o:p></o:p></span></p>

<p class=a2><span lang=EN-US style='font-size:10.0pt;color:black;mso-color-alt:
windowtext'><br>
<a name="OLE_LINK35"></a><a name="OLE_LINK34"><span style='mso-bookmark:OLE_LINK35'>val
ds =
spark.read.json(&quot;examples/src/main/resources/employees.json&quot;).as[Employee]<br>
ds.show()<br>
</span></a>// +-------+------+<br>
// |<span style='mso-spacerun:yes'>   </span>name|salary|<br>
// +-------+------+<br>
// |Michael|<span style='mso-spacerun:yes'>  </span>3000|<br>
// |<span style='mso-spacerun:yes'>   </span>Andy|<span
style='mso-spacerun:yes'>  </span>4500|<br>
// | Justin|<span style='mso-spacerun:yes'>  </span>3500|<br>
// |<span style='mso-spacerun:yes'>  </span>Berta|<span
style='mso-spacerun:yes'>  </span>4000|<br>
// +-------+------+<br>
<br>
// Convert the function to a `TypedColumn` and give it a name<br>
val averageSalary = MyAverage.toColumn.name(&quot;average_salary&quot;)<br>
val result = ds.select(averageSalary)<br>
result.show()<br>
// +--------------+<br>
// |average_salary|<br>
// +--------------+<br>
// |<span style='mso-spacerun:yes'>        </span>3750.0|<br>
// +--------------+</span><span lang=EN-US style='font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc499563833"><span lang=EN-US>Hive</span></a><span
style='mso-bookmark:_Toc499563833'><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>数据库</span></span></h2>

<p class=MsoNormalIndent style='mso-char-indent-count:2.0'><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>Apache Hive</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>是</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>Hadoop</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>上的</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>SQL</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>引擎，</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>Spark SQL</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>编译时可以包含</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>Hive</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>支持，也可以不包含。包含</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>Hive</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>支持的</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>Spark SQL</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>可以支持</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>Hive</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>表访问、</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>UDF(</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>用户自定义函数</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>)</span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>以及</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'> Hive </span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>查询语言</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>(HiveQL/HQL)</span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>等。需要强调的</span><span
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'> </span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>一点是，如果要在</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>Spark SQL</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>中包含</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>Hive</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>的库，并不需要事先安装</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>Hive</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>。一般来说，最好还是在编译</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>Spark SQL</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>时引入</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>Hive</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>支持，这样就可以使用这些特性了。如果你下载的是二进制版本的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'> Spark</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>，它应该已经在编译时添加了</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'> Hive </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>支持。</span><span style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormalIndent style='mso-char-indent-count:2.0'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>若要把</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>Spark SQL</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>连接到一个部署好的</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>Hive</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>上，你必须把</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>hive-site.xml</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>复制到</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'> Spark</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>的配置文件目录中</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>($SPARK_HOME/conf)</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>。即使没有部署好</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>Hive</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>，</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>Spark SQL</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>也可以运行。</span><span style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'> </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>需要注意的是，如果你没有部署好</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>Hive</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>，</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>Spark SQL</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>会在当前的工作目录中创建出自己的</span><span lang=EN-US style='font-size:
10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;
letter-spacing:0pt'>Hive </span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>元数据仓库，叫作</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'> metastore_db</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>。此外，如果你尝试使用</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'> HiveQL </span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>中的</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'> CREATE TABLE (</span><span style='font-size:10.5pt;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>并非</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'> CREATE EXTERNAL TABLE)</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>语句来创建表，这些表会被放在你默认的文件系统中的</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'> /user/hive/warehouse </span><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>目录中</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>(</span><span style='font-size:
10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>如果你的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'> classpath </span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>中有配好的</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'> hdfs-site.xml</span><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>，默认的文件系统就是</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'> HDFS</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>，否则就是本地文件系统</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>)</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>。</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'><o:p></o:p></span></p>

<p class=MsoNormalIndent style='mso-char-indent-count:2.0'><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormalIndent style='mso-char-indent-count:2.0'><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>内嵌的</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:
0pt'>Hive</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>与外部的</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>Hive</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>只能二选一使用，否则会冲突。</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'><o:p></o:p></span></p>

<h3><a name="_Toc499563834"><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>内嵌</span><span
lang=EN-US>Hive</span></a><span style='mso-bookmark:_Toc499563834'><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>应用</span></span></h3>

<p class=MsoNormal style='text-indent:21.0pt'><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果要使用内嵌的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>Hive</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，什么都不用做，直接用就可以了。</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%'> </span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>（</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>bin/spark-shell</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>）</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="Picture_x0020_4" o:spid="_x0000_i1095" type="#_x0000_t75" style='width:439.5pt;
 height:297pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image476.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=586 height=396
src="08_Spark.files/image477.png" v:shapes="Picture_x0020_4"><![endif]></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><b style='mso-bidi-font-weight:
normal'><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin;color:red'>注意：</span></b><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>如果你使用的是内部的</span><span lang=EN-US style='color:red'>Hive</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>，在</span><span lang=EN-US style='color:red'>Spark2.0</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>之后，</span><span lang=EN-US style='color:red'>spark.sql.warehouse.dir</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>用于指定数据仓库的地址，如果你需要用</span><span lang=EN-US
style='color:red'>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>作为路径，那么需要将</span><span
lang=EN-US style='color:red'>core-site.xml</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;
color:red'>和</span><span lang=EN-US style='color:red'>hdfs-site.xml </span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>加入到</span><span lang=EN-US style='color:red'>Spark conf</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>目录，否则只会创建</span><span lang=EN-US style='color:red'>master</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>节点上的</span><span lang=EN-US style='color:red'>warehouse</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>目录，查询时可能会出现文件找不到的问题，要想使用</span><span lang=EN-US
style='color:red'>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>，则需要将</span><span
lang=EN-US style='color:red'>metastore</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;
color:red'>删除，重启集群。</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;color:red'>默认只在</span><span
lang=EN-US style='color:red'>master</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;
color:red'>节点上（之前操作过</span><span lang=EN-US style='color:red'>sparksql</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;color:red'>）</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_199" o:spid="_x0000_i1094" type="#_x0000_t75" style='width:567pt;
 height:372.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image478.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=497
src="08_Spark.files/image478.png" v:shapes="图片_x0020_199"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果</span><span
lang=EN-US>load</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的文件只在</span><span
lang=EN-US>master</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>有，那么可能会报错，所以一般使用</span><span
lang=EN-US>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的文件</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_198" o:spid="_x0000_i1093" type="#_x0000_t75" style='width:476.25pt;
 height:18pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image480.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=635 height=24
src="08_Spark.files/image480.png" v:shapes="图片_x0020_198"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>重点讲一下内置</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>用</span><span
lang=EN-US>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>作为存储路径：</span></p>

<p class=MsoNormal><span lang=EN-US>1</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、启动</span><span
lang=EN-US>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群</span></p>

<p class=MsoNormal><span lang=EN-US>start-dfs.sh</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>2</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、启动</span><span
lang=EN-US>spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群（不启动就用</span><span
lang=EN-US>local</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>模式）</span></p>

<p class=MsoNormal><span lang=EN-US>[root@master spark2.1.1]# sbin/start-all.sh</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>2</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、复制</span><span
lang=EN-US>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>配置文件到</span><span
lang=EN-US>spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US>conf</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>目录</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_201" o:spid="_x0000_i1092" type="#_x0000_t75" style='width:510pt;
 height:198.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image482.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=680 height=265
src="08_Spark.files/image482.png" v:shapes="图片_x0020_201"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>3</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、删除原来</span><span
lang=EN-US>master</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>产生的数据</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_202" o:spid="_x0000_i1091" type="#_x0000_t75" style='width:297.75pt;
 height:63.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image484.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=397 height=85
src="08_Spark.files/image484.png" v:shapes="图片_x0020_202"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>4</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、</span><span
lang=EN-US>spark-shell</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>指定</span><span
lang=EN-US>--conf</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>参数：</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%'>--conf </span><span
lang=EN-US style='color:red'>spark.sql.warehouse.dir=xxxx</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这样</span><span
lang=EN-US>spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群都可以访问</span><span
lang=EN-US>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>读取数据了，启动第一次要指定</span><span
lang=EN-US>--conf</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，以后就都不用了指定了</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:10.5pt'>[root@master spark2.1.1]#
  bin/spark-shell --master spark://master:7077 --conf spark.sql.warehouse.dir=hdfs://master:9000/spark<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span style='font-family:宋体;
  mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
  minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>或者本地</span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US>[root@master
  spark2.1.1]# bin/spark-shell --conf
  spark.sql.warehouse.dir=hdfs://master:9000/spark</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>官方测试数据准备</span><span
lang=EN-US> kv1.txt</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>[root@master resources]# pwd <o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>/usr/local/spark2.1.1/examples/src/main/resources<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>[root@master resources]# ll<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span style='font-size:6.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial'>总用量</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'> 36<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>-rw-r--r--. 1 500 500<span
  style='mso-spacerun:yes'>  </span>130 4</span><span style='font-size:6.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial'>月</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>  </span>26
  2017 employees.json<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>-rw-r--r--. 1 500 500<span
  style='mso-spacerun:yes'>  </span>240 4</span><span style='font-size:6.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial'>月</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>  </span>26
  2017 full_user.avsc<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>-rw-r--r--. 1 500 500 5812 4</span><span
  style='font-size:6.5pt;font-family:宋体;mso-ascii-font-family:"Courier New";
  mso-hansi-font-family:"Courier New";mso-bidi-font-family:Arial'>月</span><span
  lang=EN-US style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>  </span>26
  2017 kv1.txt<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>-rw-r--r--. 1 500 500<span
  style='mso-spacerun:yes'>   </span>73 4</span><span style='font-size:6.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial'>月</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>  </span>26
  2017 people.json<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>-rw-r--r--. 1 500 500<span
  style='mso-spacerun:yes'>   </span>32 4</span><span style='font-size:6.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial'>月</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>  </span>26
  2017 people.txt<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>-rw-r--r--. 1 500 500<span
  style='mso-spacerun:yes'>  </span>185 4</span><span style='font-size:6.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial'>月</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>  </span>26
  2017 user.avsc<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>-rw-r--r--. 1 500 500<span
  style='mso-spacerun:yes'>  </span>334 4</span><span style='font-size:6.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial'>月</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>  </span>26
  2017 users.avro<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>-rw-r--r--. 1 500 500<span
  style='mso-spacerun:yes'>  </span>615 4</span><span style='font-size:6.5pt;
  font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:
  "Courier New";mso-bidi-font-family:Arial'>月</span><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><span style='mso-spacerun:yes'>  </span>26
  2017 users.parquet<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>[root@master resources]# hadoop fs -put
  kv1.txt /</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这就是用</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US>SQL</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; import spark.implicits._<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>import spark.implicits._<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; spark.sql(&quot;create table kv(key
  Int, value String)&quot;)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>19/07/23 18:13:38 WARN
  metastore.HiveMetaStore: Location: hdfs://master:9000/spark/kv specified for
  non-external table:kv<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res0: org.apache.spark.sql.DataFrame = []<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; spark.sql(&quot;load data inpath
  '/kv1.txt' into table kv&quot;)<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>19/07/23 18:13:44 ERROR hdfs.KeyProviderCache:
  Could not find uri with key [dfs.encryption.key.provider.uri] to create a
  keyProvider !!<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>res1: org.apache.spark.sql.DataFrame = []<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'><o:p>&nbsp;</o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>scala&gt; spark.sql(&quot;select * from
  kv&quot;).show<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+---+-------+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|key|<span style='mso-spacerun:yes'> 
  </span>value|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+---+-------+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|238|val_238|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>| 86| val_86|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|311|val_311|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>| 27| val_27|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|165|val_165|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|409|val_409|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|255|val_255|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|278|val_278|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>| 98| val_98|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|484|val_484|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|265|val_265|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|193|val_193|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|401|val_401|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|150|val_150|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|273|val_273|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|224|val_224|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|369|val_369|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>| 66| val_66|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|128|val_128|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>|213|val_213|<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>+---+-------+<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:6.5pt;font-family:"Courier New";mso-fareast-font-family:
  宋体;mso-bidi-font-family:Arial'>only showing top 20 rows<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>访问</span><span
lang=EN-US>HDFS</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>页面：</span><span
lang=EN-US><a href="http://192.168.56.100:50070/explorer.html#/">http://192.168.56.100:50070/explorer.html#/</a>
</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，可以看到</span><span lang=EN-US>/spark</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>目录下有</span><span lang=EN-US>kv1.</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>（这个后来被我删除了，就不截图了）</span></p>

<h3><a name="_Toc499563835"><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>外部</span><span
lang=EN-US>Hive</span></a><span style='mso-bookmark:_Toc499563835'><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>应用</span></span></h3>

<p class=MsoNormal><span lang=EN-US>Spark</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>接管</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>1</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>、启动</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>hdfs</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>2</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>、</span><span style='font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>将</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>中的</span><span
lang=EN-US>hive-site.xml</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>拷贝或者软连接到</span><span
lang=EN-US>Spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>安装目录下的</span><span
lang=EN-US>conf</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>目录下。</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>只是一个客户端，我的集群也就只有</span><span
lang=EN-US>master</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主机有</span><span
lang=EN-US>Hive</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，其他没有，该配置文件不需要</span><span
lang=EN-US>spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群都有。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_206" o:spid="_x0000_i1090" type="#_x0000_t75" style='width:396pt;
 height:83.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image486.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=528 height=111
src="08_Spark.files/image486.png" v:shapes="图片_x0020_206"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>3</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>、启动</span><span
lang=EN-US>spark</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>集群</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>我的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>集群是</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>HA</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>模式</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_209" o:spid="_x0000_i1089" type="#_x0000_t75" style='width:260.25pt;
 height:79.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image487.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=347 height=106
src="08_Spark.files/image487.png" v:shapes="图片_x0020_209"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_215" o:spid="_x0000_i1088" type="#_x0000_t75" style='width:409.5pt;
 height:18pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image488.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=546 height=24
src="08_Spark.files/image488.png" v:shapes="图片_x0020_215"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_213" o:spid="_x0000_i1087" type="#_x0000_t75" style='width:567pt;
 height:235.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image489.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=314
src="08_Spark.files/image489.png" v:shapes="图片_x0020_213"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>此时只有一个目录</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_216" o:spid="_x0000_i1086" type="#_x0000_t75" style='width:567pt;
 height:171pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image491.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=228
src="08_Spark.files/image491.png" v:shapes="图片_x0020_216"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>我的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>用的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>HA</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>模式，所以连接两个</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>master<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_210" o:spid="_x0000_i1085" type="#_x0000_t75" style='width:453.75pt;
 height:36.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image493.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=605 height=49
src="08_Spark.files/image493.png" v:shapes="图片_x0020_210"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>创建一个表</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_218" o:spid="_x0000_i1084" type="#_x0000_t75" style='width:567pt;
 height:166.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image494.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=222
src="08_Spark.files/image494.png" v:shapes="图片_x0020_218"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就可以看到创建表的元数据就在这里了</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_223" o:spid="_x0000_i1083" type="#_x0000_t75" style='width:567pt;
 height:124.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image495.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=166
src="08_Spark.files/image495.png" v:shapes="图片_x0020_223"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>把</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>hive-site.xml</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>配置文件放到</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>spark</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>conf</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>目录下，用的就是外部的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Hive</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，此时就不能用内部的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Hive</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>了。外部</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Hive</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>与内部</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Hive</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的区分可以看数据的存放目录。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>如果</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Hive</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的元数据存放到</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>MySQL</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，则需要在</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>集群导入</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>MySQL</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>驱动包：</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>进入</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>jars</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>目录，上传</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>mysql</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>驱动包（因为真正执行的是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Executor</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>）</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_207" o:spid="_x0000_i1082" type="#_x0000_t75" style='width:566.25pt;
 height:273pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image497.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=364
src="08_Spark.files/image497.png" v:shapes="图片_x0020_207"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_208" o:spid="_x0000_i1081" type="#_x0000_t75" style='width:444pt;
 height:21.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image499.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=592 height=29
src="08_Spark.files/image499.png" v:shapes="图片_x0020_208"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Hive</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>底层走的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>MapReduce</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，而</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>底层走的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>RDD</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>，所以</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Spark</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>接管</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Hive</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>查询效率更高。但是</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Hive</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在数据仓库上</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>是暂时无法替代的。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>spark-sql</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这就很像</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>hive</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>了</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_224" o:spid="_x0000_i1080" type="#_x0000_t75" style='width:567pt;
 height:29.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image500.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=39
src="08_Spark.files/image500.png" v:shapes="图片_x0020_224"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>直接写</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>SQL</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>语句即可，而且还有提示</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_227" o:spid="_x0000_i1079" type="#_x0000_t75" style='width:567pt;
 height:214.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image502.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=286
src="08_Spark.files/image502.png" v:shapes="图片_x0020_227"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>但是有很多日志，在</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>conf</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>目录有个</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>log4j</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>模板</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_229" o:spid="_x0000_i1078" type="#_x0000_t75" style='width:567pt;
 height:170.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image504.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=227
src="08_Spark.files/image504.png" v:shapes="图片_x0020_229"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>由</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>info</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>改为</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>error</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>或者</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>warn<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_231" o:spid="_x0000_i1077" type="#_x0000_t75" style='width:489pt;
 height:138.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image506.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=652 height=185
src="08_Spark.files/image506.png" v:shapes="图片_x0020_231"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>重新运行</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_234" o:spid="_x0000_i1076" type="#_x0000_t75" style='width:302.25pt;
 height:16.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image508.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=403 height=22
src="08_Spark.files/image508.png" v:shapes="图片_x0020_234"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就可以看到没有其他日志了</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_239" o:spid="_x0000_i1075" type="#_x0000_t75" style='width:287.25pt;
 height:58.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image510.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=383 height=78
src="08_Spark.files/image510.png" v:shapes="图片_x0020_239"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>Spark Streaming</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:22.0pt;line-height:240%;mso-fareast-font-family:宋体'><o:p></o:p></span></h1>

<h2><span lang=EN-US>Spark Streaming</span><span style='font-family:宋体;
mso-ascii-font-family:"Calibri Light";mso-ascii-theme-font:major-latin;
mso-fareast-theme-font:major-fareast;mso-hansi-font-family:"Calibri Light";
mso-hansi-theme-font:major-latin'>概述</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:16.0pt;line-height:173%;mso-fareast-font-family:宋体'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_211" o:spid="_x0000_i1074" type="#_x0000_t75" style='width:142.5pt;
 height:146.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image512.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=190 height=195
src="08_Spark.files/image512.png" v:shapes="图片_x0020_211"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_212" o:spid="_x0000_i1073" type="#_x0000_t75" style='width:405.75pt;
 height:256.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image514.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=541 height=342
src="08_Spark.files/image514.png" v:shapes="图片_x0020_212"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_214" o:spid="_x0000_i1072" type="#_x0000_t75" style='width:422.25pt;
 height:162pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image516.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=563 height=216
src="08_Spark.files/image516.png" v:shapes="图片_x0020_214"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>小插曲：</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Impala</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>也是写</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>SQL</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的，在</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>HDFS</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>系统上搭建一个</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>MySQL</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，速度比</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Hive</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>MapReduce</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>快很多。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Storm</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>是实时处理，一条条数据的，但是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Storm</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>在走下坡路。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Kylin</span><span
lang=EN-US style='font-family:"Arial",sans-serif;color:#191919;background:white'>(</span><span
style='font-family:宋体;mso-ascii-font-family:Arial;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Arial;mso-bidi-font-family:Arial;color:#191919;
background:white'>麒麟</span><span lang=EN-US style='font-family:"Arial",sans-serif;
color:#191919;background:white'>)</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>是国内人开发的，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Apache</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>顶级项目之一。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_219" o:spid="_x0000_i1071" type="#_x0000_t75" style='width:398.25pt;
 height:281.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image518.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=531 height=375
src="08_Spark.files/image518.png" v:shapes="图片_x0020_219"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>一般用法，所以</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>到</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>SparkStreaming</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>很重要。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_217" o:spid="_x0000_i1070" type="#_x0000_t75" style='width:440.25pt;
 height:162pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image520.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=587 height=216
src="08_Spark.files/image520.png" v:shapes="图片_x0020_217"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>无状态就是上一次的结果不会对本次有影响，有状态就是上一次的结果会直接影响本次的结果。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_220" o:spid="_x0000_i1069" type="#_x0000_t75" style='width:345.75pt;
 height:138.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image522.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=461 height=185
src="08_Spark.files/image522.png" v:shapes="图片_x0020_220"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_221" o:spid="_x0000_i1068" type="#_x0000_t75" style='width:374.25pt;
 height:239.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image524.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=499 height=319
src="08_Spark.files/image524.png" v:shapes="图片_x0020_221"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_222" o:spid="_x0000_i1067" type="#_x0000_t75" style='width:324.75pt;
 height:318pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image526.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=433 height=424
src="08_Spark.files/image526.png" v:shapes="图片_x0020_222"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_225" o:spid="_x0000_i1066" type="#_x0000_t75" style='width:390pt;
 height:246.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image528.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=520 height=329
src="08_Spark.files/image528.png" v:shapes="图片_x0020_225"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_226" o:spid="_x0000_i1065" type="#_x0000_t75" style='width:379.5pt;
 height:239.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image530.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=506 height=319
src="08_Spark.files/image530.png" v:shapes="图片_x0020_226"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span lang=EN-US>IDEA</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>编写</span><span
lang=EN-US>SparkStreaming</span><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>程序</span></h2>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>流式数据进行单词统计</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_230" o:spid="_x0000_i1064" type="#_x0000_t75" style='width:379.5pt;
 height:189pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image532.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=506 height=252
src="08_Spark.files/image532.png" v:shapes="图片_x0020_230"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>新建模块</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_228" o:spid="_x0000_i1063" type="#_x0000_t75" style='width:303pt;
 height:100.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image534.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=404 height=134
src="08_Spark.files/image534.png" v:shapes="图片_x0020_228"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_233" o:spid="_x0000_i1062" type="#_x0000_t75" style='width:369.75pt;
 height:222.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image535.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=493 height=297
src="08_Spark.files/image535.png" v:shapes="图片_x0020_233"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这次要随便整一个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>log4j.properties</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>了，把日志级别改为</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>error</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，不然很多日志输出</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_236" o:spid="_x0000_i1061" type="#_x0000_t75" style='width:567pt;
 height:142.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image537.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=190
src="08_Spark.files/image537.png" v:shapes="图片_x0020_236"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:9.0pt;
  color:navy'>log4j.rootLogger</span></b><span lang=EN-US style='font-size:
  9.0pt;color:black'>=</span><b><span lang=EN-US style='font-size:9.0pt;
  color:green'>error, stdout<br>
  </span></b><b><span lang=EN-US style='font-size:9.0pt;color:navy'>log4j.appender.stdout</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>=</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>org.apache.log4j.ConsoleAppender<br>
  </span></b><b><span lang=EN-US style='font-size:9.0pt;color:navy;background:
  #E4E4FF'>log4j.appender.stdout.layout</span></b><span lang=EN-US
  style='font-size:9.0pt;color:black'>=</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>org.apache.log4j.PatternLayout<br>
  </span></b><b><span lang=EN-US style='font-size:9.0pt;color:navy'>log4j.appender.stdout.layout.ConversionPattern</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>=</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>%d{yyyy-MM-dd HH:mm:ss,SSS}<span style='mso-spacerun:yes'>  </span>%5p --- [%50t]<span style='mso-spacerun:yes'>  </span>%-80c(line:%5L)<span style='mso-spacerun:yes'>  </span>:<span style='mso-spacerun:yes'>  </span>%m%n<br>
  <br>
  </span></b><b><span lang=EN-US style='font-size:9.0pt;color:navy'>log4j.appender.R</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>=</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>org.apache.log4j.RollingFileAppender<br>
  </span></b><b><span lang=EN-US style='font-size:9.0pt;color:navy'>log4j.appender.R.File</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>=</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>../log/agent.log<br>
  </span></b><b><span lang=EN-US style='font-size:9.0pt;color:navy'>log4j.appender.R.MaxFileSize</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>=</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>1024KB<br>
  </span></b><b><span lang=EN-US style='font-size:9.0pt;color:navy'>log4j.appender.R.MaxBackupIndex</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>=</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>1<br>
  <br>
  </span></b><b><span lang=EN-US style='font-size:9.0pt;color:navy'>log4j.appender.R.layout</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>=</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>org.apache.log4j.PatternLayout<br>
  </span></b><b><span lang=EN-US style='font-size:9.0pt;color:navy'>log4j.appender.R.layout.ConversionPattern</span></b><span
  lang=EN-US style='font-size:9.0pt;color:black'>=</span><b><span lang=EN-US
  style='font-size:9.0pt;color:green'>%d{yyyy-MM-dd HH:mm:ss,SSS}<span style='mso-spacerun:yes'>  </span>%5p --- [%50t]<span style='mso-spacerun:yes'>  </span>%-80c(line:%6L)<span style='mso-spacerun:yes'>  </span>:<span style='mso-spacerun:yes'>  </span>%m%n</span></b><span
  lang=EN-US style='color:black'><o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>代码</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>WordCount.scala<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:11.0pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'>org.apache.spark.SparkConf<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.sql.catalyst.expressions.Second<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.streaming.{Seconds, StreamingContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:11.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* Created by yw_forWork on 2019/7/25.<br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:11.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>WordCount {<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>main(args: Array[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>conf = </span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;WordCount&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;local[*]&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// Seconds(5)</span></i><i><span
  style='font-size:11.0pt;color:gray'>表示每<span lang=EN-US>5</span>秒作为一块数据<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>streamingContext = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>StreamingContext(conf, <i>Seconds</i>(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>5</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// Netcat</span></i><i><span
  style='font-size:11.0pt;color:gray'>会在<span lang=EN-US>9999</span>端口架起了服务器，<span
  lang=EN-US>streaming</span>从<span lang=EN-US>9999</span>获取数据。<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>lineDStream = streamingContext.socketTextStream(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;192.168.56.100&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>9999</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// DStream[String]</span></i><i><span
  style='font-size:11.0pt;color:gray'>。空格切割扁平<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>wordDStream = lineDStream.flatMap(_.split(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot; &quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>/// DStream[(String, 1)]<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>kvDStream = wordDStream.map((_, </span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// DStream[(String, sum)]<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>result = kvDStream.reduceByKey(_ + _)<br>
  <br>
<span style='mso-spacerun:yes'>    </span>result.print()<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>启动接收器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>streamingContext.start()<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>线程异常，要等待完成后事，然后再抛出异常退出<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>streamingContext.awaitTermination()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;mso-no-proof:
yes'>安装</span><span lang=EN-US style='mso-no-proof:yes'>Netcat<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>[root@master spark2.1.1]#
yum install nc<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动</span><span
lang=EN-US style='mso-no-proof:yes'>Netcat</span><span style='font-family:宋体;
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;
mso-no-proof:yes'>（这台</span><span lang=EN-US style='mso-no-proof:yes'>master</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;mso-no-proof:yes'>就是</span><span lang=EN-US style='mso-no-proof:
yes'>192.168.56.100</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;mso-no-proof:
yes'>）</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_232" o:spid="_x0000_i1060" type="#_x0000_t75" style='width:210pt;
 height:61.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image539.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=280 height=82
src="08_Spark.files/image539.png" v:shapes="图片_x0020_232"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行程序，测试发送数据，默认是无状态转换，时间戳是自动打印的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_235" o:spid="_x0000_i1059" type="#_x0000_t75" style='width:341.25pt;
 height:181.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image540.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=455 height=242
src="08_Spark.files/image540.png" v:shapes="图片_x0020_235"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>自定义接收器</span></h2>

<pre style='background:white'><span style='color:black;mso-color-alt:windowtext'>所继承的<span
lang=EN-US style='background:#E4E4FF'>Receiver</span>的所有方法<span lang=EN-US><o:p></o:p></span></span></pre>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_237" o:spid="_x0000_i1058" type="#_x0000_t75" style='width:208.5pt;
 height:243.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image542.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=278 height=325
src="08_Spark.files/image542.png" v:shapes="图片_x0020_237"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>代码</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_241" o:spid="_x0000_i1057" type="#_x0000_t75" style='width:195pt;
 height:261.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image544.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=260 height=349
src="08_Spark.files/image544.png" v:shapes="图片_x0020_241"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>CustomerReceiver.scala</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:11.0pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'>java.io.{BufferedReader, InputStreamReader}<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>java.net.Socket<br>
  <br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.storage.StorageLevel<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.streaming.receiver.Receiver<br>
  <br>
  </span><i><span lang=EN-US style='font-size:11.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* </span></i><i><span style='font-size:
  11.0pt;color:gray'>自定义接收器。<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>* </span>继承<span lang=EN-US>Receiver</span>；仅</span><span
  style='color:gray'>使用</span></i><i><span style='font-size:11.0pt;color:gray'>内存<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:11.0pt;color:navy'>class </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>CustomerReceiver(host:</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>, port:Int) </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>extends </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>Receiver[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>](StorageLevel.</span><i><span
  lang=EN-US style='font-size:11.0pt;color:#660E7A'>MEMORY_ONLY</span></i><span
  lang=EN-US style='font-size:11.0pt;color:black'>){<br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>接收器启动的时候调用<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>onStart(): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>Thread(</span><b><span lang=EN-US
  style='font-size:11.0pt;color:green'>&quot;receiver&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>run(): Unit = {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>接收数据并提交给框架<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:11.0pt;color:black'>receive()<br>
<span style='mso-spacerun:yes'>      </span>}<br>
<span style='mso-spacerun:yes'>    </span>}.start()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>receive(): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// java.net.Socket<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>var </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>socket: Socket = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>null<br>
<span style='mso-spacerun:yes'>    </span>var </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>input: </span><span lang=EN-US
  style='font-size:11.0pt;color:#20999D'>String </span><span lang=EN-US
  style='font-size:11.0pt;color:black'>= </span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>null<br>
  <br>
<span style='mso-spacerun:yes'>    </span>try </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>{<br>
<span style='mso-spacerun:yes'>      </span>socket = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>Socket(host, port)<br>
  <br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>从<span lang=EN-US>socket</span>获取输入流<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>reader = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>BufferedReader(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>InputStreamReader(socket.getInputStream))<br>
  <br>
<span style='mso-spacerun:yes'>      </span>input = reader.readLine()<br>
<span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>while </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>(!isStopped() &amp;&amp; input != </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>null</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>直接就保存到了<span lang=EN-US>Executor<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:11.0pt;color:black'>store(input)<br>
<span style='mso-spacerun:yes'>        </span>input = reader.readLine()<br>
<span style='mso-spacerun:yes'>      </span>}<br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>没有数据就重启，不然下次就无法读取数据了，循环不满足会退出<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>restart(</span><b><span lang=EN-US
  style='font-size:11.0pt;color:green'>&quot;restart&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span>} </span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>catch </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>{<br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>异常也重启<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>case </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>e: java.net.ConnectException =&gt; restart(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;restart&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>case </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>t: </span><span lang=EN-US
  style='font-size:11.0pt;color:#20999D'>Throwable </span><span lang=EN-US
  style='font-size:11.0pt;color:black'>=&gt; restart(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;restart&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>接收器关闭的时候调用<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>onStop(): Unit = {<br>
  <br>
<span style='mso-spacerun:yes'>  </span>}<br>
}</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>WordCountForReceiver.scala</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:11.0pt;
  color:navy'>import </span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'>org.apache.spark.SparkConf<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.streaming.{Seconds, StreamingContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:11.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* </span></i><i><span style='font-size:
  11.0pt;color:gray'>自定义接收器从<span lang=EN-US>nc</span>的<span lang=EN-US>9999</span>端口接收数据<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:11.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>WordCountForReceiver {<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>main(args: Array[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>conf = </span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;WordCount&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;local[2]&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// Seconds(5)</span></i><i><span
  style='font-size:11.0pt;color:gray'>表示每<span lang=EN-US>5</span>秒作为一块数据<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>streamingContext = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>StreamingContext(conf, <i>Seconds</i>(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>5</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// Netcat</span></i><i><span
  style='font-size:11.0pt;color:gray'>会在<span lang=EN-US>9999</span>端口架起了服务器，<span
  lang=EN-US>streaming</span>从<span lang=EN-US>9999</span>获取数据。<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span>//val lineDStream = streamingContext.socketTextStream(&quot;192.168.56.100&quot;, 9999)<br>
  <b><span style='mso-spacerun:yes'>    </span>// </b></span><b>从自定义的接收器获取数据<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></b></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>lineDStream = streamingContext.receiverStream(</span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>CustomerReceiver(</span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;192.168.56.100&quot;</span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>, </span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:blue'>9999</span></b><b><span
  lang=EN-US style='font-size:11.0pt;color:black'>))</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'><o:p></o:p></span></pre><pre
  style='background:white'><span lang=EN-US style='font-size:11.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// DStream[String]</span></i><i><span
  style='font-size:11.0pt;color:gray'>。空格切割扁平<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>wordDStream = lineDStream.flatMap(_.split(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot; &quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>/// DStream[(String, 1)]<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>kvDStream = wordDStream.map((_, </span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// DStream[(String, sum)]<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>result = kvDStream.reduceByKey(_ + _)<br>
  <br>
<span style='mso-spacerun:yes'>    </span>result.print()<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>启动接收器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>streamingContext.start()<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>线程异常，要等待完成后事，然后再抛出异常退出<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>streamingContext.awaitTermination()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行程序，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>nc</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>发送数据，自定义的接收器从</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>nc</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>9999</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>端口接收数据，同样是无状态的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_238" o:spid="_x0000_i1056" type="#_x0000_t75" style='width:411pt;
 height:207pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image546.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=548 height=276
src="08_Spark.files/image546.png" v:shapes="图片_x0020_238"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>有状态转换</span></h2>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>有状态转换的，第一批数据过来会生成一个</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>checkpoint</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，第二批数据过来就会与上一次</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>checkpoint</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的结果合并，生成新的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>checkpoint</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>。</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>PairDStreamFunctions.scala</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>的源码的</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>updateStateByKey</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>方法的源码，</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Seq</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>就是新进来的数据，</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Option</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>是上一次保存的数据</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_240" o:spid="_x0000_i1055" type="#_x0000_t75" style='width:331.5pt;
 height:96.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image548.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=442 height=129
src="08_Spark.files/image548.png" v:shapes="图片_x0020_240"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>代码</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_243" o:spid="_x0000_i1054" type="#_x0000_t75" style='width:195.75pt;
 height:278.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image550.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=261 height=371
src="08_Spark.files/image550.png" v:shapes="图片_x0020_243"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>CustomerReceiver.scala</span><span lang=EN-US style='color:black;
mso-color-alt:windowtext'> </span><span style='color:black;mso-color-alt:windowtext'>与前一小节的一样</span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:11.0pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'>stateful<br>
  <br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>java.io.{BufferedReader, InputStreamReader}<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>java.net.Socket<br>
  <br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.storage.StorageLevel<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.streaming.receiver.Receiver<br>
  <br>
  </span><i><span lang=EN-US style='font-size:11.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* </span></i><i><span style='font-size:
  11.0pt;color:gray'>自定义接收器。<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>* </span>继承<span lang=EN-US>Receiver</span>；仅使用内存<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:11.0pt;color:navy'>class </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>CustomerReceiver(host:</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>, port:Int) </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>extends </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>Receiver[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>](StorageLevel.</span><i><span
  lang=EN-US style='font-size:11.0pt;color:#660E7A'>MEMORY_ONLY</span></i><span
  lang=EN-US style='font-size:11.0pt;color:black'>){<br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>接收器启动的时候调用<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>onStart(): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>Thread(</span><b><span lang=EN-US
  style='font-size:11.0pt;color:green'>&quot;receiver&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>run(): Unit = {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>接收数据并提交给框架<span lang=EN-US><br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:11.0pt;color:black'>receive()<br>
<span style='mso-spacerun:yes'>      </span>}<br>
<span style='mso-spacerun:yes'>    </span>}.start()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>receive(): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// java.net.Socket<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>var </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>socket: Socket = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>null<br>
<span style='mso-spacerun:yes'>    </span>var </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>input: </span><span lang=EN-US
  style='font-size:11.0pt;color:#20999D'>String </span><span lang=EN-US
  style='font-size:11.0pt;color:black'>= </span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>null<br>
  <br>
<span style='mso-spacerun:yes'>    </span>try </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>{<br>
<span style='mso-spacerun:yes'>      </span>socket = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>Socket(host, port)<br>
  <br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>从<span lang=EN-US>socket</span>获取输入流<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>reader = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>BufferedReader(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>InputStreamReader(socket.getInputStream))<br>
  <br>
<span style='mso-spacerun:yes'>      </span>input = reader.readLine()<br>
<span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>while </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>(!isStopped() &amp;&amp; input != </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>null</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>直接就保存到了<span lang=EN-US>Executor<br>
<span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:11.0pt;color:black'>store(input)<br>
<span style='mso-spacerun:yes'>        </span>input = reader.readLine()<br>
<span style='mso-spacerun:yes'>      </span>}<br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>没有数据就重启，不然下次就无法读取数据了，循环不满足会退出<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>restart(</span><b><span lang=EN-US
  style='font-size:11.0pt;color:green'>&quot;restart&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span>} </span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>catch </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>{<br>
<span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>异常也重启<span lang=EN-US><br>
<span style='mso-spacerun:yes'>      </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>case </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>e: java.net.ConnectException =&gt; restart(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;restart&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>case </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>t: </span><span lang=EN-US
  style='font-size:11.0pt;color:#20999D'>Throwable </span><span lang=EN-US
  style='font-size:11.0pt;color:black'>=&gt; restart(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;restart&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>接收器关闭的时候调用<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span></span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>override def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>onStop(): Unit = {<br>
  <br>
<span style='mso-spacerun:yes'>  </span>}<br>
}<o:p></o:p></span></pre></td>
 </tr>
</table>

<pre style='background:white'><span lang=EN-US style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
style='background:white'><span lang=EN-US style='color:black;background:#E4E4FF'>WordCountForReceiver</span><span
lang=EN-US style='color:black'>.scala<o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:11.0pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'>stateful<br>
  <br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.SparkConf<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.streaming.{Seconds, StreamingContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:11.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* </span></i><i><span style='font-size:
  11.0pt;color:gray'>自定义接收器从<span lang=EN-US>nc</span>的<span lang=EN-US>9999</span>端口接收数据<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:11.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>WordCountForReceiver {<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>main(args: Array[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>conf = </span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;WordCount&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;local[2]&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// Seconds(5)</span></i><i><span
  style='font-size:11.0pt;color:gray'>表示每<span lang=EN-US>5</span>秒作为一块数据<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>streamingContext = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>StreamingContext(conf, <i>Seconds</i>(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>5</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><i><span lang=EN-US
  style='color:gray'>// </span><span style='color:gray'>有状态转换必须要有<span
  lang=EN-US>checkpoint</span>信息，没有会报错<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='color:black'>streamingContext.checkpoint(</span><span lang=EN-US
  style='color:green'>&quot;./check&quot;</span><span lang=EN-US
  style='color:black'>)</span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'><br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// Netcat</span></i><i><span
  style='font-size:11.0pt;color:gray'>会在<span lang=EN-US>9999</span>端口架起了服务器，<span
  lang=EN-US>streaming</span>从<span lang=EN-US>9999</span>获取数据。<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span>//val lineDStream = streamingContext.socketTextStream(&quot;192.168.56.100&quot;, 9999)<br>
<span style='mso-spacerun:yes'>    </span>// </span>从自定义的接收器获取数据<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>lineDStream = streamingContext.receiverStream(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>CustomerReceiver(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;192.168.56.100&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>9999</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// DStream[String]</span></i><i><span
  style='font-size:11.0pt;color:gray'>。空格切割扁平<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>wordDStream = lineDStream.flatMap(_.split(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot; &quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>/// DStream[(String, 1)]<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>kvDStream = wordDStream.map((_, </span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// DStream[(String, sum)]<br>
<span style='mso-spacerun:yes'>   </span>// val result = kvDStream.reduceByKey(_ + _)<br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='color:gray'><span style='mso-spacerun:yes'> </span>// </span><span
  style='color:gray'>有状态转换<span lang=EN-US><br>
<span style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'> </span></span></span></b></i><b><span
  lang=EN-US style='color:navy'>val </span><span lang=EN-US style='color:black'>updateFunc = (v: </span><span
  lang=EN-US style='color:#20999D'>Seq</span><span lang=EN-US style='color:
  black'>[Int], state: Option[Int]) =&gt; {<br>
<span style='mso-spacerun:yes'>     </span></span><i><span lang=EN-US
  style='color:gray'>// </span><span style='color:gray'>获取上一次状态的值，没有获取（第一次就没有值）到就赋值为<span
  lang=EN-US>0<br>
<span style='mso-spacerun:yes'>     </span></span></span></i><span lang=EN-US
  style='color:navy'>val </span><span lang=EN-US style='color:black'>preStatus = state.getOrElse(</span><span
  lang=EN-US style='color:blue'>0</span><span lang=EN-US style='color:black'>)<br>
<span style='mso-spacerun:yes'>     </span></span><i><span lang=EN-US
  style='color:gray'>// updateFunc</span><span style='color:gray'>要求返回类型是<span
  lang=EN-US>Some</span>，这里把状态返回。<span lang=EN-US><br>
<span style='mso-spacerun:yes'>     </span></span></span><span lang=EN-US
  style='color:black'>Some</span></i><span lang=EN-US style='color:black'>(preStatus + v.sum)<br>
<span style='mso-spacerun:yes'>   </span>}<br>
<span style='mso-spacerun:yes'>    </span></span><span lang=EN-US
  style='color:navy'>val </span><span lang=EN-US style='color:black'>result = kvDStream.updateStateByKey(updateFunc)<br>
  </span></b><span lang=EN-US style='font-size:11.0pt;color:black'><br>
<span style='mso-spacerun:yes'>    </span>result.print()<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>启动接收器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>streamingContext.start()<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>线程异常，要等待完成后事，然后再抛出异常退出<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>streamingContext.awaitTermination()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
}<o:p></o:p></span></pre><pre><span lang=EN-US style='font-size:11.0pt;
  color:black'><o:p>&nbsp;</o:p></span></pre></td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行程序，</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>nc</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>发送数据，可以看到是有状态转换了</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_242" o:spid="_x0000_i1053" type="#_x0000_t75" style='width:381pt;
 height:236.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image552.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=508 height=315
src="08_Spark.files/image552.png" v:shapes="图片_x0020_242"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h2><a name="OLE_LINK26"><span lang=EN-US>Window Operations</span></a></h2>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>先理解一些概念。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_248" o:spid="_x0000_i1052" type="#_x0000_t75" style='width:373.5pt;
 height:179.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image554.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=498 height=239
src="08_Spark.files/image554.png" v:shapes="图片_x0020_248"><![endif]></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>一个小块是最小批次，假设</span><span
lang=EN-US>5</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>秒的数据作为一个小块（最小批次），而窗口大小为</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就是</span><span
lang=EN-US>5*3=15</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>秒，即</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个最小批次；步长为</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>就是经过了两个最小批次，即</span><span
lang=EN-US>5*2=10</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>秒。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>）窗口大小等于步长</span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>窗口大小等于步长等于</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的时候，每次计算都是计算新的数据。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_246" o:spid="_x0000_i1051" type="#_x0000_t75" style='width:371.25pt;
 height:102pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image556.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=495 height=136
src="08_Spark.files/image556.png" v:shapes="图片_x0020_246"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>应用场景：</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>比如每一分钟显示一分钟内有多少访问量。如果最小批次为</span><span
lang=EN-US>10</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>秒，那么窗口大小就可以为</span><span
lang=EN-US>10 * 6 = 60</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>秒，步长也是</span><span
lang=EN-US>60</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>秒。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h3><span lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>）窗口大小大于步长</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_250" o:spid="_x0000_i1050" type="#_x0000_t75" style='width:399.75pt;
 height:119.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image558.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=533 height=159
src="08_Spark.files/image558.png" v:shapes="图片_x0020_250"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>应用场景：</span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>比如每五分钟刷新一下一小时内有多少访问量。假设最小批次为</span><span
lang=EN-US>5</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分钟，那么窗口大小就是</span><span
lang=EN-US>5 * 12 = 60</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分钟，而步长为</span><span
lang=EN-US>5</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分钟，得到下图，这是中间的一个过程。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_251" o:spid="_x0000_i1049" type="#_x0000_t75" style='width:566.25pt;
 height:135.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image560.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=181
src="08_Spark.files/image560.png" v:shapes="图片_x0020_251"><![endif]></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>当然，一开始的时候，步长为</span><span
lang=EN-US>5</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分钟，但窗口大小为</span><span
lang=EN-US>60</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分钟，当步长触发计算的时候，肯定无法满足窗口大小为</span><span
lang=EN-US>60</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>分钟的，窗口大小是可以小于设定的窗口大小。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这是官网图，后面的描述是复制教程的。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_28" o:spid="_x0000_i1048" type="#_x0000_t75" alt="streaming-dstream-window"
 style='width:415.5pt;height:161.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image562.png" o:title="streaming-dstream-window"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=554 height=215
src="08_Spark.files/image563.png" alt=streaming-dstream-window v:shapes="图片_x0020_28"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormalIndent><span lang=EN-US style='font-size:10.5pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:宋体;letter-spacing:0pt'>Window
Operations</span><span style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";letter-spacing:0pt'>有点类似于</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>Storm</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>中的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'>State</span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>，可以设置窗口的大小和滑动窗口的间隔来动态的获取当前</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'>Steaming</span><span style='font-size:10.5pt;font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>的允许状态。</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'><o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='font-size:10.5pt;font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";letter-spacing:0pt'>基于窗口的操作会在一个比</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体;letter-spacing:0pt'> StreamingContext </span><span
style='font-size:10.5pt;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
letter-spacing:0pt'>的批次间隔更长的时间范围内，通过整合多个批次的结果，计算出整个窗口的结果。</span><span
style='font-size:10.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体;letter-spacing:0pt'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0'><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman"'>所有基于窗口的操作都需要两个参数，分别为窗口时长以及滑动步长，两者都必须是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> StreamContext </span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>的批次间隔的整数倍（就是不能</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>2.5</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>个最小批次作为一个窗口大小，因为最小批次已经是设置为最小批了，有需要就改小最小批次的大小）。窗口时长控制每次计算最近的多少个批次的数据，其实就是最近的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> windowDuration/batchInterval </span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman"'>个批次。如果有一个以</span><span lang=EN-US style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:"Times New Roman",serif;mso-fareast-font-family:
宋体'> 10 </span><span style='mso-bidi-font-size:10.5pt;line-height:125%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman"'>秒为批次间隔的源</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> DStream</span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>，要创建一个最近</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> 30 </span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>秒的时间窗口</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>(</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>即最近</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> 3 </span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>个批次</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>)</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>，就应当把</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> windowDuration </span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>设为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> 30 </span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>秒。而滑动步长的默认值与批次间隔相等，用来控制对新的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> DStream </span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>进行计算的间隔。</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>代码</span></h3>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>窗口大小等于步长</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2050" o:spid="_x0000_i1047" type="#_x0000_t75" style='width:183.75pt;
 height:268.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image564.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=245 height=358
src="08_Spark.files/image564.png" v:shapes="图片_x0020_2050"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>WordCount.scala</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:11.0pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:11.0pt;
  color:black'>window<br>
  <br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.SparkConf<br>
  </span><b><span lang=EN-US style='font-size:11.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>org.apache.spark.streaming.{Seconds, StreamingContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:11.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* Created by yw_forWork on 2019/7/25.<br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:11.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>WordCount {<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>main(args: Array[</span><span
  lang=EN-US style='font-size:11.0pt;color:#20999D'>String</span><span
  lang=EN-US style='font-size:11.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>conf = </span><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;WordCount&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;local[*]&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// Seconds(5)</span></i><i><span
  style='font-size:11.0pt;color:gray'>表示每<span lang=EN-US>5</span>秒作为一块数据<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>streamingContext = </span><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>StreamingContext(conf, <i>Seconds</i>(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>5</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// Netcat</span></i><i><span
  style='font-size:11.0pt;color:gray'>会在<span lang=EN-US>9999</span>端口架起了服务器，<span
  lang=EN-US>streaming</span>从<span lang=EN-US>9999</span>获取数据。<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>lineDStream = streamingContext.socketTextStream(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot;192.168.56.100&quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:11.0pt;color:blue'>9999</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// DStream[String]</span></i><i><span
  style='font-size:11.0pt;color:gray'>。空格切割扁平<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>wordDStream = lineDStream.flatMap(_.split(</span><b><span
  lang=EN-US style='font-size:11.0pt;color:green'>&quot; &quot;</span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>/// DStream[(String, 1)]<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:11.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:11.0pt;color:black'>kvDStream = wordDStream.map((_, </span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// DStream[(String, sum)]<br>
<span style='mso-spacerun:yes'>    </span>//val result = kvDStream.reduceByKey(_ + _)<br>
<span style='mso-spacerun:yes'>    </span>// </span></i><i><span
  style='font-size:11.0pt;color:gray'>前面最小批次是<span lang=EN-US>Seconds(5)</span>；<span
  lang=EN-US>Seconds(15)=</span>窗口大小为<span lang=EN-US>3</span>；<span
  lang=EN-US> Seconds(15)=</span>步长为<span lang=EN-US>3<br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:11.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:11.0pt;color:black'>result = kvDStream.reduceByKeyAndWindow((x: Int, y: Int) =&gt; x + y, <i>Seconds</i>(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>15</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>), <i>Seconds</i>(</span><span
  lang=EN-US style='font-size:11.0pt;color:blue'>15</span><span lang=EN-US
  style='font-size:11.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span>result.print()<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>启动接收器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>streamingContext.start()<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:11.0pt;color:gray'>// </span></i><i><span style='font-size:
  11.0pt;color:gray'>线程异常，要等待完成后事，然后再抛出异常退出<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:11.0pt;color:black'>streamingContext.awaitTermination()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:11.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行程序、</span><span
lang=EN-US>nc</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，有多少数据发送过来，打印就会有多少</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_253" o:spid="_x0000_i1046" type="#_x0000_t75" style='width:306pt;
 height:324pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image566.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=408 height=432
src="08_Spark.files/image566.png" v:shapes="图片_x0020_253"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>对比一下，把步长由原来的</span><span
lang=EN-US>3</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>改为</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，窗口大小还是</span><span
lang=EN-US>3</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_255" o:spid="_x0000_i1045" type="#_x0000_t75" style='width:348pt;
 height:266.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image568.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=464 height=355
src="08_Spark.files/image568.png" v:shapes="图片_x0020_255"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行程序，总共发了</span><span
lang=EN-US>9</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个</span><span
lang=EN-US>a</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，但是打印有</span><span
lang=EN-US>12</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>个，说明一部分是重复的。所以窗口大小大于步长的不能用这种直接叠加的方法</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_252" o:spid="_x0000_i1044" type="#_x0000_t75" style='width:360.75pt;
 height:198.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image570.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=481 height=265
src="08_Spark.files/image570.png" v:shapes="图片_x0020_252"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>窗口大小大于步长</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2069" o:spid="_x0000_i1043" type="#_x0000_t75" style='width:204.75pt;
 height:324pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image572.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=273 height=432
src="08_Spark.files/image572.png" v:shapes="图片_x0020_2069"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>写了个定时发送数据的服务器，不适用</span><span
lang=EN-US>Netcat</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，最后测试结果还是没有实现好</span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>Server.java</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:10.5pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:10.5pt;
  color:black'>window.greater;<br>
  <br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>java.io.DataOutputStream;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>java.io.IOException;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>java.io.PrintWriter;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>java.net.ServerSocket;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>java.net.Socket;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>java.util.ArrayList;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>java.util.Arrays;<br>
  </span><b><span lang=EN-US style='font-size:10.5pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>java.util.List;<br>
  <br>
  </span><i><span lang=EN-US style='font-size:10.5pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'> </span>* Created by yw_forWork on 2019/7/26.<br>
<span style='mso-spacerun:yes'> </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:10.5pt;color:navy'>public class </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>Server {<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>private static </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>List&lt;Integer&gt; </span><i><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>letter </span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>= Arrays.<i>asList</i>(</span><span
  lang=EN-US style='font-size:10.5pt;color:blue'>1</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>,</span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>2</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>,</span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>3</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>,</span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>4</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>,</span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>5</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>,</span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>6</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>,</span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>7</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>,</span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>8</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>,</span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>9</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>private static int </span></b><i><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>index </span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>= </span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>0</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>;<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>主入口<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>public static void </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>main(String[] args) </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>throws </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>IOException {<br>
<span style='mso-spacerun:yes'>        </span><i>scoketServer</i>();<br>
<span style='mso-spacerun:yes'>    </span>}<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>开启的<span lang=EN-US>tcp9999</span>监听端口<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>public static void </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>scoketServer() </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>throws </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>IOException {<br>
<span style='mso-spacerun:yes'>        </span>ServerSocket server = </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>ServerSocket(</span><span
  lang=EN-US style='font-size:10.5pt;color:blue'>9999</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>            </span></span><i><span lang=EN-US
  style='font-size:10.5pt;color:gray'>// </span></i><i><span style='font-size:
  10.5pt;color:gray'>阻塞等待连接<span lang=EN-US><br>
<span style='mso-spacerun:yes'>            </span></span></span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>Socket socket = server.accept();<br>
<span style='mso-spacerun:yes'>            </span>System.</span><b><i><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>out</span></i></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>.println(</span><b><span
  lang=EN-US style='font-size:10.5pt;color:green'>&quot;</span></b><b><span
  style='font-size:10.5pt;color:green'>连接进入<span lang=EN-US>&quot;</span></span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>            </span>DataOutputStream out = </span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>DataOutputStream(socket.getOutputStream());<br>
<span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>try </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>{<br>
<span style='mso-spacerun:yes'>                </span></span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>while </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>(</span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>true</span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>) {<br>
<span style='mso-spacerun:yes'>                    </span>Thread.<i>sleep</i>(</span><span
  lang=EN-US style='font-size:10.5pt;color:blue'>1000</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>                    </span></span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>for</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>(</span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>int </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>i=</span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>0</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>; i&lt;</span><i><span lang=EN-US
  style='font-size:10.5pt;color:#660E7A'>letter</span></i><span lang=EN-US
  style='font-size:10.5pt;color:black'>.get(</span><i><span lang=EN-US
  style='font-size:10.5pt;color:#660E7A'>index</span></i><span lang=EN-US
  style='font-size:10.5pt;color:black'>); i++) {<br>
<span style='mso-spacerun:yes'>                        </span>out.writeUTF(</span><b><span
  lang=EN-US style='font-size:10.5pt;color:green'>&quot;a&quot;</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>                       </span><span style='mso-spacerun:yes'> </span></span><i><span
  lang=EN-US style='font-size:10.5pt;color:gray'>// </span></i><i><span
  style='font-size:10.5pt;color:gray'>要换行才会被获取到<span lang=EN-US><br>
<span style='mso-spacerun:yes'>                        </span></span></span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>out.writeUTF(</span><b><span
  lang=EN-US style='font-size:10.5pt;color:green'>&quot;</span></b><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>\r</span></b><b><span
  lang=EN-US style='font-size:10.5pt;color:green'>&quot;</span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>);<br>
<span style='mso-spacerun:yes'>                    </span>}<br>
<span style='mso-spacerun:yes'>                    </span></span><i><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>index </span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>++;<br>
<span style='mso-spacerun:yes'>                    </span></span><b><span
  lang=EN-US style='font-size:10.5pt;color:navy'>if </span></b><span
  lang=EN-US style='font-size:10.5pt;color:black'>(</span><i><span lang=EN-US
  style='font-size:10.5pt;color:#660E7A'>index </span></i><span lang=EN-US
  style='font-size:10.5pt;color:black'>== </span><i><span lang=EN-US
  style='font-size:10.5pt;color:#660E7A'>letter</span></i><span lang=EN-US
  style='font-size:10.5pt;color:black'>.size()) {<br>
<span style='mso-spacerun:yes'>                        </span></span><i><span
  lang=EN-US style='font-size:10.5pt;color:#660E7A'>index </span></i><span
  lang=EN-US style='font-size:10.5pt;color:black'>= </span><span lang=EN-US
  style='font-size:10.5pt;color:blue'>0</span><span lang=EN-US
  style='font-size:10.5pt;color:black'>;<br>
<span style='mso-spacerun:yes'>                    </span>}<br>
<span style='mso-spacerun:yes'>                </span>}<br>
<span style='mso-spacerun:yes'>            </span>} </span><b><span lang=EN-US
  style='font-size:10.5pt;color:navy'>catch </span></b><span lang=EN-US
  style='font-size:10.5pt;color:black'>(Exception e) {<br>
<span style='mso-spacerun:yes'>                </span>e.printStackTrace();<br>
<span style='mso-spacerun:yes'>            </span>}<br>
<span style='mso-spacerun:yes'>    </span>}<br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='mso-bidi-font-size:10.5pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<pre style='background:white'><span lang=EN-US style='color:black;background:
#E4E4FF'>WordCount.scala</span><span lang=EN-US style='color:black'><o:p></o:p></span></pre>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'><pre
  style='background:white'><b><span lang=EN-US style='font-size:8.0pt;
  color:navy'>package </span></b><span lang=EN-US style='font-size:8.0pt;
  color:black'>window.greater<br>
  <br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.spark.SparkConf<br>
  </span><b><span lang=EN-US style='font-size:8.0pt;color:navy'>import </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>org.apache.spark.streaming.{Seconds, StreamingContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:8.0pt;color:gray'>/**<br>
<span style='mso-spacerun:yes'>  </span>* Created by yw_forWork on 2019/7/25.<br>
<span style='mso-spacerun:yes'>  </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:8.0pt;color:navy'>object </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>WordCount {<br>
  <br>
<span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>def </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>main(args: Array[</span><span lang=EN-US
  style='font-size:8.0pt;color:#20999D'>String</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>]): Unit = {<br>
<span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>conf = </span><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>new </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;WordCount&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>).setMaster(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;local[*]&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Seconds(5)</span></i><i><span
  style='font-size:8.0pt;color:gray'>表示每<span lang=EN-US>5</span>秒作为一块数据<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>streamingContext = </span><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>new </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>StreamingContext(conf, <i>Seconds</i>(</span><span
  lang=EN-US style='font-size:8.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>为了使用<span lang=EN-US>reduceByKeyAndWindow</span>，检查点必须可用。<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:8.0pt;color:black'>streamingContext.checkpoint(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;./check&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>)<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// Java</span></i><i><span
  style='font-size:8.0pt;color:gray'>模拟服务器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>lineDStream = streamingContext.socketTextStream(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot;localhost&quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>, </span><span lang=EN-US
  style='font-size:8.0pt;color:blue'>9999</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>)<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// DStream[String]</span></i><i><span
  style='font-size:8.0pt;color:gray'>。空格切割扁平<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>wordDStream = lineDStream.flatMap(_.split(</span><b><span
  lang=EN-US style='font-size:8.0pt;color:green'>&quot; &quot;</span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>))<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>/// DStream[(String, 1)]<br>
<span style='mso-spacerun:yes'>    </span></span></i><b><span lang=EN-US
  style='font-size:8.0pt;color:navy'>val </span></b><span lang=EN-US
  style='font-size:8.0pt;color:black'>kvDStream = wordDStream.map((_, </span><span
  lang=EN-US style='font-size:8.0pt;color:blue'>1</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// DStream[(String, sum)]<br>
<span style='mso-spacerun:yes'>    </span>//val result = kvDStream.reduceByKey(_ + _)<br>
<span style='mso-spacerun:yes'>    </span>// (x: Int, y: Int) =&gt; x + y </span></i><i><span
  style='font-size:8.0pt;color:gray'>加上新进入窗口的批次中的元素；<span lang=EN-US>(a: Int, b: Int) =&gt; a - b </span>移除离开窗口的老批次中的元素。检查点必须可用。<span
  lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:8.0pt;color:navy'>val </span></b><span
  lang=EN-US style='font-size:8.0pt;color:black'>result = kvDStream.reduceByKeyAndWindow((x: Int, y: Int) =&gt; x + y, (a: Int, b: Int) =&gt; a - b, <i>Seconds</i>(</span><span
  lang=EN-US style='font-size:8.0pt;color:blue'>15</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>), <i>Seconds</i>(</span><span
  lang=EN-US style='font-size:8.0pt;color:blue'>10</span><span lang=EN-US
  style='font-size:8.0pt;color:black'>))<br>
  <br>
<span style='mso-spacerun:yes'>    </span>result.print()<br>
  <br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>启动接收器<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:8.0pt;color:black'>streamingContext.start()<br>
<span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:8.0pt;color:gray'>// </span></i><i><span style='font-size:
  8.0pt;color:gray'>线程异常，要等待完成后事，然后再抛出异常退出<span lang=EN-US><br>
<span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:8.0pt;color:black'>streamingContext.awaitTermination()<br>
<span style='mso-spacerun:yes'>  </span>}<br>
  <br>
}<o:p></o:p></span></pre>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:8.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>运行</span><span
lang=EN-US>Server</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类服务器，然后再运行</span><span
lang=EN-US>WordCount</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>程序，可以看到计算</span><span
lang=EN-US>a</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>出现的个数</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2074" o:spid="_x0000_i1042" type="#_x0000_t75" style='width:273.75pt;
 height:49.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image574.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=365 height=66
src="08_Spark.files/image574.png" v:shapes="图片_x0020_2074"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2070" o:spid="_x0000_i1041" type="#_x0000_t75" style='width:4in;
 height:273pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image576.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=384 height=364
src="08_Spark.files/image576.png" v:shapes="图片_x0020_2070"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>然后再把</span><span
lang=EN-US>Server</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>类的</span><span
lang=EN-US>letter</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>变量改一下</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2075" o:spid="_x0000_i1040" type="#_x0000_t75" style='width:313.5pt;
 height:121.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image578.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=418 height=162
src="08_Spark.files/image578.png" v:shapes="图片_x0020_2075"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>再运行一下</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2076" o:spid="_x0000_i1039" type="#_x0000_t75" style='width:270pt;
 height:266.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image580.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=360 height=355
src="08_Spark.files/image580.png" v:shapes="图片_x0020_2076"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这样看不出来速度，应该在计算</span><span
lang=EN-US>a</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的个数的前后算一个时间，然后跟<span
style='color:red'>直接累加</span>的前后结果对比一下。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这个是累加新的，减去旧的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2077" o:spid="_x0000_i1038" type="#_x0000_t75" style='width:447pt;
 height:24pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image582.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=596 height=32
src="08_Spark.files/image582.png" v:shapes="图片_x0020_2077"><![endif]></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>这是<span
style='color:red'>直接累加</span>的</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2080" o:spid="_x0000_i1037" type="#_x0000_t75" style='width:397.5pt;
 height:33pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image584.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=530 height=44
src="08_Spark.files/image584.png" v:shapes="图片_x0020_2080"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>但是我试着打印时间戳，没有打印结果，使用累加器用</span><span
lang=EN-US>print</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>也没有任何输出，所以这问题暂时留着，可能学到后面这个问题就迎刃而解了。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>图解，但数值不对应</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2086" o:spid="_x0000_i1036" type="#_x0000_t75" style='width:394.5pt;
 height:243pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image586.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=526 height=324
src="08_Spark.files/image586.png" v:shapes="图片_x0020_2086"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc500282469"><span style='font-family:宋体;mso-ascii-font-family:
"Calibri Light";mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>高级数据源</span></a></h2>

<h3><span lang=EN-US>Kafka</span></h3>

<p class=MsoNormal><span style='mso-bidi-font-size:10.5pt;line-height:125%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman"'>除核心数据源外，还可以用附加数据源接收器来从一些知名数据获取系统中接收的数据，这些接收器都作为</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>Spark Streaming</span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>的组件进行独立打包了。它们仍然是</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>Spark</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>的一部分，不过你需要在构建文件中添加额外的包才能使用它们。现有的接收器包括</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> Twitter</span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>、</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>Apache Kafka</span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>、</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>Amazon Kinesis</span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>、</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>Apache Flume</span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>，以及</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>ZeroMQ</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>。可以通过添加与</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>Spark</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>版本匹配</span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> </span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>的</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> Maven </span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>工件</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'> spark-streaming-[projectname]_2.10 </span><span
style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman"'>来引入这些附加接收器。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-size:10.5pt;line-height:125%;
font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman"'>演示</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>SparkStreaming</span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>如何从</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>Kafka</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>读取消息，把消息处理完成后再写回</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>Kafka</span><span style='mso-bidi-font-size:10.5pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>（此时</span><span
lang=EN-US style='mso-bidi-font-size:10.5pt;line-height:125%;font-family:"Times New Roman",serif;
mso-fareast-font-family:宋体'>SparkStreaming</span><span style='mso-bidi-font-size:
10.5pt;line-height:125%;font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman"'>是生产者，把该生产者做成一个池），让消费者消费。</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-bidi-font-size:10.5pt;
line-height:125%;mso-no-proof:yes'><!--[if gte vml 1]><v:shape id="Picture_x0020_7"
 o:spid="_x0000_i1035" type="#_x0000_t75" alt="../../../../../../Desktop/New%20Mockup%"
 style='width:438.75pt;height:111.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image588.png" o:title="New%20Mockup%"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=585 height=149
src="08_Spark.files/image589.png" alt="../../../../../../Desktop/New%20Mockup%"
v:shapes="Picture_x0020_7"><![endif]></span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>高级</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>API</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>可能会丢失数据，而低级</span><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>API</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>处理完逻辑再更新</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>offset</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>，不会丢失。手动维护</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>offset</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，保证机器挂了，数据不会丢失，手动维护到</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>offset</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>到</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Zookeeper</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>即可。</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2099" o:spid="_x0000_i1034" type="#_x0000_t75" style='width:365.25pt;
 height:228.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image590.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=487 height=305
src="08_Spark.files/image590.png" v:shapes="图片_x0020_2099"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>代码</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_73" o:spid="_x0000_i1033" type="#_x0000_t75" style='width:209.25pt;
 height:309pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image592.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=279 height=412
src="08_Spark.files/image592.png" v:shapes="图片_x0020_73"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2104" o:spid="_x0000_i1032" type="#_x0000_t75" style='width:429.75pt;
 height:289.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image594.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=573 height=386
src="08_Spark.files/image594.png" v:shapes="图片_x0020_2104"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>pom.xml<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  background:white'><i><span lang=EN-US style='font-size:10.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>&lt;?</span></i><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>xml version</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;1.0&quot; </span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>encoding</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;UTF-8&quot;</span></b><i><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>?&gt;<br>
  </span></i><span lang=EN-US style='font-size:10.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;background:#EFEFEF;mso-font-kerning:0pt'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>project </span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>xmlns</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;http://maven.apache.org/POM/4.0.0&quot;<br>
  <span style='mso-spacerun:yes'>         </span></span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>xmlns:</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;background:#EFEFEF;mso-font-kerning:0pt'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br>
  <span style='mso-spacerun:yes'>         </span></span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;background:#EFEFEF;mso-font-kerning:0pt'>xsi</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:blue;background:#EFEFEF;mso-font-kerning:0pt'>:schemaLocation</span></b><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;background:#EFEFEF;mso-font-kerning:0pt'>=&quot;http://maven.apache.org/POM/4.0.0
  http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>parent</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>spark<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>com.ywforwhat<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>1.0-SNAPSHOT<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>parent</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>4.0.0<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>modelVersion</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>sparkStreaming<span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>org.apache.spark<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>artifactId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>spark-streaming_2.11<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>version</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>2.1.1<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>org.apache.kafka<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>artifactId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>kafka-clients<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>version</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>0.10.2.1<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>org.apache.spark<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>artifactId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>spark-streaming-kafka_2.11<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>version</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>1.6.3<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>&lt;!-- </span></i><i><span style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>为生产者做池子（对象池）<span
  lang=EN-US> --&gt;<br>
  <span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&lt;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>org.apache.commons<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>groupId</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>artifactId</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>commons-pool2<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>artifactId</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>            </span><span style='background:
  #EFEFEF'>&lt;</span></span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;background:#EFEFEF;
  mso-font-kerning:0pt'>version</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;background:#EFEFEF;
  mso-font-kerning:0pt'>&gt;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>2.5.0<span
  style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>version</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><br>
  <span style='mso-spacerun:yes'>        </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependency</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='mso-spacerun:yes'>    </span><span style='background:#EFEFEF'>&lt;/</span></span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;background:#EFEFEF;mso-font-kerning:0pt'>dependencies</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><br>
  <br>
  <span style='background:#EFEFEF'>&lt;/</span></span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  background:#EFEFEF;mso-font-kerning:0pt'>project</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  background:#EFEFEF;mso-font-kerning:0pt'>&gt;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'><o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:10.0pt;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>KafkaUtils.<span
style='background:#E4E4FF'>createDirectStream()</span></span><span
style='font-size:12.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
mso-font-kerning:0pt'>的源码<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2105" o:spid="_x0000_i1031" type="#_x0000_t75" style='width:354pt;
 height:192pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image596.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=472 height=256
src="08_Spark.files/image596.png" v:shapes="图片_x0020_2105"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;color:black;background:#E4E4FF;mso-font-kerning:0pt'>KafkaProxy</span><span
lang=EN-US style='font-size:12.0pt;font-family:宋体;mso-bidi-font-family:宋体;
color:black;mso-font-kerning:0pt'>.scala<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  background:white'><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>package </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>kafka<br>
  <br>
  </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>java.util.Properties<br>
  <br>
  </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.commons.pool2.impl.{DefaultPooledObject,
  GenericObjectPool}<br>
  </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.commons.pool2.{BaseObjectPool,
  BasePooledObjectFactory, PooledObject}<br>
  </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.kafka.clients.producer.{KafkaProducer, ProducerConfig,
  ProducerRecord}<br>
  <br>
  <br>
  </span><i><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:gray;mso-font-kerning:0pt'>/**<br>
  <span style='mso-spacerun:yes'>  </span>* Kafka</span></i><i><span
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>生产者<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>class </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>KafkaProxy(brokers: </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>) {<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>private val </span></b><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>pros</span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>:
  Properties = </span><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>Properties()<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>pros</span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>.put(ProducerConfig.</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>BOOTSTRAP_SERVERS_CONFIG</span></i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, brokers)<br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>pros</span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>.put(ProducerConfig.</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>KEY_SERIALIZER_CLASS_CONFIG</span></i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>)<br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>pros</span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>.put(ProducerConfig.</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>VALUE_SERIALIZER_CLASS_CONFIG</span></i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>)<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><i><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;mso-font-kerning:
  0pt'>kafkaProducer </span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>= </span><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>new </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>KafkaProducer[</span><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:
  0pt'>String</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>, </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>](</span><i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;mso-font-kerning:0pt'>pros</span></i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>)<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>def </span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>send(topic:
  </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>, key: </span><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, value: </span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;
  mso-font-kerning:0pt'>String</span><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>):
  Unit = {<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaProducer</span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>.send(</span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>ProducerRecord[</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;
  mso-font-kerning:0pt'>String</span><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>, </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>](topic, key, value))<br>
  <span style='mso-spacerun:yes'>  </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>重载<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>def </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>send(topic: </span><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:
  0pt'>String</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>, value: </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>): Unit = {<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaProducer</span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>.send(</span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>ProducerRecord[</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;
  mso-font-kerning:0pt'>String</span><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>, </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>](topic, String.<i>valueOf</i>(value)))<br>
  <span style='mso-spacerun:yes'>  </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>def </span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>close:
  Unit = {<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaProducer</span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>.close()<br>
  <span style='mso-spacerun:yes'>  </span>}<br>
  }<br>
  <br>
  </span><i><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:gray;mso-font-kerning:0pt'>// </span></i><i><span style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:
  0pt'>对<span lang=EN-US>Kafka</span>代理进行包装<span lang=EN-US><br>
  </span></span></i><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>class </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>KafkaProxyFactory(brokers: </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>) </span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>extends
  </span></b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:black;mso-font-kerning:0pt'>BasePooledObjectFactory[KafkaProxy] {<br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>创建实例<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>create(): KafkaProxy = </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>new </span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>KafkaProxy(brokers)<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>将池中对象封装<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>wrap(obj: KafkaProxy) = </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>new </span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>DefaultPooledObject[KafkaProxy](obj)<br>
  }<br>
  <br>
  </span><i><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:gray;mso-font-kerning:0pt'>// </span></i><i><span style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:
  0pt'>对象池<span lang=EN-US><br>
  </span></span></i><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>object </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>KafkaPool {<br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>声明池对象<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>var </span></b><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaPool</span></i><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:
  0pt'>: GenericObjectPool[KafkaProxy] = </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>null<br>
  <br>
  <span style='mso-spacerun:yes'>  </span>def </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>apply(broker: </span><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:
  0pt'>String</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>):
  GenericObjectPool[KafkaProxy] = {<br>
  <span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>if</span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>(</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>kafkaPool </span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>== </span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>null</span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>) {<br>
  <span style='mso-spacerun:yes'>      </span>KafkaPool.synchronized {<br>
  <span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>if</span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>(</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>kafkaPool </span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>== </span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>null</span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>) {<br>
  <span style='mso-spacerun:yes'>          </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaPool </span></i><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:
  0pt'>= </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>GenericObjectPool(</span><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>new </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>KafkaProxyFactory(broker))<br>
  <span style='mso-spacerun:yes'>        </span>}<br>
  <span style='mso-spacerun:yes'>      </span>}<br>
  <span style='mso-spacerun:yes'>    </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaPool<br>
  <span style='mso-spacerun:yes'>  </span></span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>}<br>
  }<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;color:black;background:#E4E4FF;mso-font-kerning:0pt'>KafkaStreaming</span><span
lang=EN-US style='font-size:12.0pt;font-family:宋体;mso-bidi-font-family:宋体;
color:black;mso-font-kerning:0pt'>.scala<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  background:white'><b><span lang=EN-US style='font-size:7.5pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>package </span></b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>kafka<br>
  <br>
  </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafka.serializer.StringDecoder<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.kafka.clients.consumer.ConsumerConfig<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.kafka.common.serialization.StringDeserializer<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.spark.SparkConf<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.spark.streaming.kafka.KafkaUtils<br>
  </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.spark.streaming.{Seconds, StreamingContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:gray;mso-font-kerning:0pt'>/**<br>
  <span style='mso-spacerun:yes'>  </span>* Created by yw_forWork on 2019/7/28.<br>
  <span style='mso-spacerun:yes'>  </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>object </span></b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>KafkaStreaming {<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>def </span></b><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>main(args:
  Array[</span><span lang=EN-US style='font-size:7.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>]): Unit = {<br>
  <span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>conf
  = </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;mso-font-kerning:0pt'>&quot;kafka&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>).setMaster(</span><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;local[*]&quot;</span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>)<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// Seconds(5)</span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>表示每<span
  lang=EN-US>5</span>秒作为一块数据<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>streamingContext = </span><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>new </span></b><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>StreamingContext(conf,
  <i>Seconds</i>(</span><span lang=EN-US style='font-size:7.5pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:blue;mso-font-kerning:0pt'>5</span><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>))<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// Kafka</span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>参数<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>brokers = </span><b><span lang=EN-US style='font-size:
  7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;mso-font-kerning:
  0pt'>&quot;slave1:9092,slave2:9092,slave3:9092&quot;<br>
  <span style='mso-spacerun:yes'>    </span></span></b><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>zookeeper
  = </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>&quot;slave1:2181,slave2:2181,slave3:2181&quot;<br>
  <span style='mso-spacerun:yes'>    </span></span></b><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>sourceTopic
  = </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>&quot;source&quot;<br>
  <span style='mso-spacerun:yes'>    </span></span></b><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>targetTopic
  = </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>&quot;target&quot;<br>
  <span style='mso-spacerun:yes'>    </span></span></b><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>consumerGroup
  = </span><b><span lang=EN-US style='font-size:7.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>&quot;consumer-kafka&quot;<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span></b><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>封装<span
  lang=EN-US>Kafka</span>的参数<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafkaParams = </span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>Map</span></i><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>[</span><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>, </span><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>] (<br>
  <span style='mso-spacerun:yes'>      </span>ConsumerConfig.</span><i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>BOOTSTRAP_SERVERS_CONFIG </span></i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>-&gt; brokers,<br>
  <span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// k</span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>、<span
  lang=EN-US>v</span>的反序列化<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>      </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>ConsumerConfig.</span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>KEY_DESERIALIZER_CLASS_CONFIG </span></i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>-&gt; </span><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>,<br>
  <span style='mso-spacerun:yes'>      </span>ConsumerConfig.</span><i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>VALUE_DESERIALIZER_CLASS_CONFIG </span></i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>-&gt; </span><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span></b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>,<br>
  <span style='mso-spacerun:yes'>      </span>ConsumerConfig.</span><i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>GROUP_ID_CONFIG </span></i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>-&gt; consumerGroup<br>
  <span style='mso-spacerun:yes'>    </span>)<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>生产者将会生产消息到<span
  lang=EN-US>sourceTopic</span>，<span lang=EN-US>Streaming</span>从这个主题读就行<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafkaDStream = KafkaUtils.<i>createDirectStream</i>[</span><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>, </span><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, StringDecoder,
  StringDecoder](streamingContext, kafkaParams, </span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>Set</span></i><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>(sourceTopic))<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>测试<span
  lang=EN-US>Kafka</span>作为<span lang=EN-US>SparkStreaming</span>的输入，有没有问题。结果在<span
  lang=EN-US>SparkStreaming</span>上输出<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span>//val result = kafkaDStream.map(x
  =&gt; (x._1, x._2)).reduceByKey(_ + _)<br>
  <span style='mso-spacerun:yes'>    </span>//result.print()<br>
  <br>
  <span style='mso-spacerun:yes'>    </span>// </span>消息处理之后，写回<span
  lang=EN-US>Kafka</span>（此时<span lang=EN-US>SparkStreaming</span>作为生产者）<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafkaDStream.foreachRDD { rdd =&gt;<br>
  <span style='mso-spacerun:yes'>      </span>rdd.foreachPartition { rddPar
  =&gt;<br>
  <span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// &gt;&gt; </span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>这里循环创建、关闭生产者，故做一个池子<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span>// </span>创建生产者<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafkaPool = <i>KafkaPool</i>(brokers)<br>
  <span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>kafkaProducer
  = kafkaPool.borrowObject()<br>
  <br>
  <span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>写出到<span
  lang=EN-US>Kafka</span>（<span lang=EN-US>targetTopic</span>）<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>for</span></b><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>(item &lt;- rddPar) {<br>
  <span style='mso-spacerun:yes'>          </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>生产者发送数据。<span
  lang=EN-US>item._2</span>直接把<span lang=EN-US>value</span>传递出去<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>          </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>kafkaProducer.send(targetTopic, item._2)<br>
  <span style='mso-spacerun:yes'>          </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>//print(item._2) // </span></i><i><span
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>有数据打印说明迭代没有问题，这可以排查<span lang=EN-US>SparkStreaming</span>发送是否有问题<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>}<br>
  <br>
  <span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>关闭生产者（用完还回去）<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>kafkaPool.returnObject(kafkaProducer)<br>
  <span style='mso-spacerun:yes'>      </span>}<br>
  <span style='mso-spacerun:yes'>    </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:7.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>（写到<span
  lang=EN-US>kafka</span>的数据用一个控制的消费者消费）<span lang=EN-US><br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:7.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>streamingContext.start()<br>
  <span style='mso-spacerun:yes'>    </span>streamingContext.awaitTermination()<br>
  <span style='mso-spacerun:yes'>  </span>}<br>
  <br>
  }<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>测试</span></h4>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Zookeeper</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>集群</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2114" o:spid="_x0000_i1030" type="#_x0000_t75" style='width:567pt;
 height:224.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image598.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=299
src="08_Spark.files/image598.png" v:shapes="图片_x0020_2114"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>集群</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_2116" o:spid="_x0000_i1029" type="#_x0000_t75" style='width:567pt;
 height:194.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image600.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=756 height=259
src="08_Spark.files/image600.png" v:shapes="图片_x0020_2116"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>创建</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>source</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>主题（注意，这里的操作中，参数、端口比较错乱的感觉，不要搞错）</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:9.0pt;mso-fareast-font-family:
  宋体'>[root@slave1 ~]# /usr/local/kafka/bin/kafka-topics.sh <span
  style='color:red'>--zookeeper</span> slave1:<span style='color:red'>2181 </span>--create
  --replication-factor 1 --partitions 2 --topic source</span><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动生产者</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'>[root@slave1 ~]# /usr/local/kafka/bin/kafka-console-producer.sh <span
  style='color:red'>--broker-list</span> slave1:<span style='color:red'>9092 </span>--topic
  source<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>创建</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>target</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>主题（如果忘记了创建，则</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>SparkStreaming</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>无法发送数据到</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>target</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>，消费者也无法从</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>target</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>消费数据，哪怕程序不报错）</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='font-size:10.0pt;mso-bidi-font-size:9.0pt;mso-fareast-font-family:
  宋体'>[root@slave1 ~]# /usr/local/kafka/bin/kafka-topics.sh <span
  style='color:red'>--zookeeper </span>slave1:<span style='color:red'>2181</span>
  --create --replication-factor 1 --partitions 2 --topic target</span><span
  lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动消费者</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal'><span lang=EN-US
  style='mso-bidi-font-size:10.0pt;mso-fareast-font-family:宋体'>[root@slave1 ~]#
  /usr/local/kafka/bin/kafka-console-consumer.sh <span style='color:red'>--bootstrap-server</span>
  slave1:<span style='color:red'>9092 </span>--from-beginning --topic target</span><span
  lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;mso-fareast-font-family:
  宋体'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动程序</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_46" o:spid="_x0000_i1028" type="#_x0000_t75" style='width:329.25pt;
 height:84pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image602.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=439 height=112
src="08_Spark.files/image602.png" v:shapes="图片_x0020_46"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>消费会有点慢，因为批处理设置了</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>5</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>秒。</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_39" o:spid="_x0000_i1027" type="#_x0000_t75" style='width:566.25pt;
 height:44.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image604.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=755 height=59
src="08_Spark.files/image604.png" v:shapes="图片_x0020_39"><![endif]></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>Kafka</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>控制台的生产者往</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>source</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主题生产了消息，然后被</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>SparkStreaming</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>消费了（其实也是</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Kafka</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>API</span><span style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>），</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'>SparkStreaming</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>消费消息之后，作为</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>Kafka</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>的生产者（其实也是</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>的</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>API</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>），往</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>target</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>主题生产消息，被</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>Kafka</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>控制台的消费者消费。</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>（看不到</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>offset</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>在</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>zk</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>哪里？）</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h3><span style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>手动维护</span><span lang=EN-US>Kafka</span><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>的</span><span lang=EN-US>offset<span style='mso-spacerun:yes'>   
</span></span></h3>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>尽管测试过了，但是没看到维护的</span><span
lang=EN-US>offset</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>在哪里？</span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>代码</span></h4>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_200" o:spid="_x0000_i1026" type="#_x0000_t75" style='width:179.25pt;
 height:268.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image606.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=239 height=358
src="08_Spark.files/image606.png" v:shapes="图片_x0020_200"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;color:black;background:#E4E4FF;mso-font-kerning:0pt'>KafkaProxy</span><span
lang=EN-US style='font-size:12.0pt;font-family:宋体;mso-bidi-font-family:宋体;
color:black;mso-font-kerning:0pt'>.scala<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  background:white'><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>package </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>offset<br>
  <br>
  </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>java.util.Properties<br>
  <br>
  </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.commons.pool2.BasePooledObjectFactory<br>
  </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.commons.pool2.impl.{DefaultPooledObject,
  GenericObjectPool}<br>
  </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.kafka.clients.producer.{KafkaProducer,
  ProducerConfig, ProducerRecord}<br>
  <br>
  <br>
  </span><i><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:gray;mso-font-kerning:0pt'>/**<br>
  <span style='mso-spacerun:yes'>  </span>* Kafka</span></i><i><span
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>生产者<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span>*/<br>
  </span></span></i><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>class </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>KafkaProxy(brokers: </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>) {<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>private val </span></b><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>pros</span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>:
  Properties = </span><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>Properties()<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>pros</span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>.put(ProducerConfig.</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>BOOTSTRAP_SERVERS_CONFIG</span></i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, brokers)<br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>pros</span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>.put(ProducerConfig.</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>KEY_SERIALIZER_CLASS_CONFIG</span></i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>)<br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>pros</span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>.put(ProducerConfig.</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>VALUE_SERIALIZER_CLASS_CONFIG</span></i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>)<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><i><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;mso-font-kerning:
  0pt'>kafkaProducer </span></i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>= </span><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>new </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>KafkaProducer[</span><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:
  0pt'>String</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>, </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>](</span><i><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;mso-font-kerning:0pt'>pros</span></i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>)<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>def </span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>send(topic:
  </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>, key: </span><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, value: </span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;
  mso-font-kerning:0pt'>String</span><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>):
  Unit = {<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaProducer</span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>.send(</span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>ProducerRecord[</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;
  mso-font-kerning:0pt'>String</span><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>, </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>](topic, key, value))<br>
  <span style='mso-spacerun:yes'>  </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>重载<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>def </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>send(topic: </span><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:
  0pt'>String</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>, value: </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>): Unit = {<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaProducer</span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>.send(</span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>ProducerRecord[</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;
  mso-font-kerning:0pt'>String</span><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>, </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>](topic, String.<i>valueOf</i>(value)))<br>
  <span style='mso-spacerun:yes'>  </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>def </span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>close:
  Unit = {<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaProducer</span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>.close()<br>
  <span style='mso-spacerun:yes'>  </span>}<br>
  }<br>
  <br>
  </span><i><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:gray;mso-font-kerning:0pt'>// </span></i><i><span style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:
  0pt'>对<span lang=EN-US>Kafka</span>代理进行包装<span lang=EN-US><br>
  </span></span></i><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>class </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>KafkaProxyFactory(brokers: </span><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>) </span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>extends
  </span></b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:black;mso-font-kerning:0pt'>BasePooledObjectFactory[KafkaProxy] {<br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>创建实例<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>create(): KafkaProxy = </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>new </span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>KafkaProxy(brokers)<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>将池中对象封装<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>override def </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>wrap(obj: KafkaProxy) = </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>new </span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>DefaultPooledObject[KafkaProxy](obj)<br>
  }<br>
  <br>
  </span><i><span lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:gray;mso-font-kerning:0pt'>// </span></i><i><span style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:
  0pt'>对象池<span lang=EN-US><br>
  </span></span></i><b><span lang=EN-US style='font-size:9.0pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>object </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>KafkaPool {<br>
  <span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>声明池对象<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>  </span></span></span></i><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>var </span></b><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaPool</span></i><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:
  0pt'>: GenericObjectPool[KafkaProxy] = </span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>null<br>
  <br>
  <span style='mso-spacerun:yes'>  </span>def </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>apply(broker: </span><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:
  0pt'>String</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>):
  GenericObjectPool[KafkaProxy] = {<br>
  <span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>if</span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>(</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>kafkaPool </span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>== </span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>null</span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>) {<br>
  <span style='mso-spacerun:yes'>      </span>KafkaPool.synchronized {<br>
  <span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>if</span></b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>(</span><i><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>kafkaPool </span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>== </span><b><span lang=EN-US style='font-size:9.0pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>null</span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>) {<br>
  <span style='mso-spacerun:yes'>          </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaPool </span></i><span lang=EN-US style='font-size:
  9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:
  0pt'>= </span><b><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>GenericObjectPool(</span><b><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>new </span></b><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>KafkaProxyFactory(broker))<br>
  <span style='mso-spacerun:yes'>        </span>}<br>
  <span style='mso-spacerun:yes'>      </span>}<br>
  <span style='mso-spacerun:yes'>    </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>kafkaPool<br>
  <span style='mso-spacerun:yes'>  </span></span></i><span lang=EN-US
  style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>}<br>
  }<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
  lang=EN-US style='font-size:9.0pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;color:black;background:#E4E4FF;mso-font-kerning:0pt'>KafkaStreaming</span><span
lang=EN-US style='font-size:12.0pt;font-family:宋体;mso-bidi-font-family:宋体;
color:black;mso-font-kerning:0pt'>.scala<o:p></o:p></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0cm 5.4pt 0cm 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=755 valign=top style='width:566.4pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
  background:white'><b><span lang=EN-US style='font-size:5.5pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>package </span></b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>offset<br>
  <br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafka.common.TopicAndPartition<br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafka.message.MessageAndMetadata<br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafka.serializer.StringDecoder<br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafka.utils.{ZKConfig, ZKGroupTopicDirs, ZkUtils}<br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.I0Itec.zkclient.ZkClient<br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.kafka.clients.consumer.ConsumerConfig<br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.spark.SparkConf<br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.spark.streaming.dstream.InputDStream<br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.spark.streaming.kafka.{HasOffsetRanges,
  KafkaUtils, OffsetRange}<br>
  </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:navy;mso-font-kerning:0pt'>import </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>org.apache.spark.streaming.{Seconds, StreamingContext}<br>
  <br>
  </span><i><span lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:
  宋体;color:gray;mso-font-kerning:0pt'>/**<br>
  <span style='mso-spacerun:yes'>  </span>* Created by yw_forWork on 2019/7/28.<br>
  <span style='mso-spacerun:yes'>  </span>*/<br>
  </span></i><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>object </span></b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>KafkaStreaming {<br>
  <br>
  <span style='mso-spacerun:yes'>  </span></span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>def </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>main(args:
  Array[</span><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>]): Unit = {<br>
  <span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>conf
  = </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>SparkConf().setAppName(</span><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;mso-font-kerning:0pt'>&quot;kafka&quot;</span></b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>).setMaster(</span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;local[*]&quot;</span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>)<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// Seconds(5)</span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>表示每<span
  lang=EN-US>5</span>秒作为一块数据<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>streamingContext = </span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>new </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>StreamingContext(conf,
  <i>Seconds</i>(</span><span lang=EN-US style='font-size:5.5pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:blue;mso-font-kerning:0pt'>5</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>))<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// Kafka</span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>参数<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>brokers = </span><b><span lang=EN-US style='font-size:
  5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;mso-font-kerning:
  0pt'>&quot;slave1:9092,slave2:9092,slave3:9092&quot;<br>
  <span style='mso-spacerun:yes'>    </span></span></b><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>zookeeper
  = </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>&quot;slave1:2181,slave2:2181,slave3:2181&quot;<br>
  <span style='mso-spacerun:yes'>    </span></span></b><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>sourceTopic
  = </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>&quot;source&quot;<br>
  <span style='mso-spacerun:yes'>    </span></span></b><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>targetTopic
  = </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>&quot;target&quot;<br>
  <span style='mso-spacerun:yes'>    </span></span></b><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>consumerGroup
  = </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:green;mso-font-kerning:0pt'>&quot;consumer-kafka&quot;<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span></b><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>封装<span
  lang=EN-US>Kafka</span>的参数<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafkaParams = </span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>Map</span></i><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>[</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>, </span><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>] (<br>
  <span style='mso-spacerun:yes'>      </span>ConsumerConfig.</span><i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>BOOTSTRAP_SERVERS_CONFIG </span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>-&gt; brokers,<br>
  <span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// k</span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>、<span
  lang=EN-US>v</span>的反序列化<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>      </span></span></span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>ConsumerConfig.</span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>KEY_DESERIALIZER_CLASS_CONFIG </span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>-&gt; </span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span></b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>,<br>
  <span style='mso-spacerun:yes'>      </span>ConsumerConfig.</span><i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>VALUE_DESERIALIZER_CLASS_CONFIG </span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>-&gt; </span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span></b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>,<br>
  <span style='mso-spacerun:yes'>      </span>ConsumerConfig.</span><i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>GROUP_ID_CONFIG </span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>-&gt; consumerGroup,<br>
  <span style='mso-spacerun:yes'>      </span>ConsumerConfig.</span><i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#660E7A;mso-font-kerning:0pt'>AUTO_OFFSET_RESET_CONFIG </span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>-&gt; </span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;largest&quot;<br>
  <span style='mso-spacerun:yes'>    </span></span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>)<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>var </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>kafkaDStream:
  InputDStream[(</span><span lang=EN-US style='font-size:5.5pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, </span><span lang=EN-US style='font-size:
  5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:
  0pt'>String</span><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>)] = </span><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>null<br>
  <span style='mso-spacerun:yes'>    </span></span></b><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>创建<span
  lang=EN-US>zk</span>路径<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>topicDirs = </span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>new </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>ZKGroupTopicDirs(consumerGroup,
  targetTopic)<br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>一开始无法指定分区，只能指定<span
  lang=EN-US>offset</span>的路径<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>zkTopicPath = </span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>s&quot;</span></b><b><span lang=EN-US style='font-size:
  5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#00B8BB;mso-font-kerning:
  0pt'>$</span></b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>{topicDirs.consumerOffsetDir}</span><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;mso-font-kerning:0pt'>&quot;<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span></b><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>从<span
  lang=EN-US>zk</span>获取<span lang=EN-US>offset<br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>zkClient = </span><b><span lang=EN-US style='font-size:
  5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;mso-font-kerning:
  0pt'>new </span></b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>ZkClient(zookeeper)<br>
  <span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>children
  = zkClient.countChildren(zkTopicPath)<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>如果有保存，就从上一次状态恢复<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>if</span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>(children &gt; </span><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:blue;
  mso-font-kerning:0pt'>0</span><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>)
  {<span style='mso-spacerun:yes'>  </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// []</span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>就是第一次创建，即<span
  lang=EN-US>children=0<br>
  <span style='mso-spacerun:yes'>      </span>// </span>最终保存的上一次的信息<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>      </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>var </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>fromOffset: </span><span lang=EN-US style='font-size:
  5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:
  0pt'>Map</span><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>[TopicAndPartition,
  Long] = </span><i><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:#660E7A;mso-font-kerning:0pt'>Map</span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>()<br>
  <br>
  <span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// Kafka</span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>有<span
  lang=EN-US>7</span>天之后就删除数据，如果数据超过<span lang=EN-US>7</span>天了再启动<span
  lang=EN-US>Kafka</span>（这情况一般都被老板骂死了），<span lang=EN-US>Kafka</span>消息的<span
  lang=EN-US>offset</span>与<span lang=EN-US>zk</span>的<span lang=EN-US>offset</span>就不一样了，<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>      </span>// </span>但是这个时候不应该做校准（就是把<span
  lang=EN-US>Kafka</span>的<span lang=EN-US>offset</span>更新到<span lang=EN-US>zk</span>中，然后从这个<span
  lang=EN-US>offset</span>开始算，以前的丢失了），而是从头开始计算数据，哪怕校准了，还是有部分数据丢失了<span
  lang=EN-US><br>
  <br>
  <span style='mso-spacerun:yes'>      </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>messageHandler = (mmd: MessageAndMetadata[</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>, </span><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>]) =&gt; (mmd.topic, mmd.message())<br>
  <span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// offset</span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>从<span
  lang=EN-US>zk</span>中拿<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>      </span></span></span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>kafkaDStream = KafkaUtils.<i>createDirectStream</i>[</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>, </span><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, StringDecoder, StringDecoder, (</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>, </span><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>)](streamingContext, kafkaParams,
  fromOffset, messageHandler)<br>
  <span style='mso-spacerun:yes'>    </span>} </span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>else </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>{<br>
  <span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>直接创建<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>      </span>// </span>生产者将会生产消息到<span
  lang=EN-US>sourceTopic</span>，<span lang=EN-US>Streaming</span>从这个主题读就行<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>      </span></span></span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>kafkaDStream = KafkaUtils.<i>createDirectStream</i>[</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:#20999D;mso-font-kerning:0pt'>String</span><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>, </span><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:#20999D;mso-font-kerning:0pt'>String</span><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>, StringDecoder,
  StringDecoder](streamingContext, kafkaParams, </span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#660E7A;
  mso-font-kerning:0pt'>Set</span></i><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>(sourceTopic))<br>
  <span style='mso-spacerun:yes'>    </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>获取更新的<span
  lang=EN-US>offset</span>（拿<span lang=EN-US>offset</span>要在处理数据之前）<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>var </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>offsetRange = <i>Array</i>[OffsetRange]()<br>
  <span style='mso-spacerun:yes'>    </span></span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>kafkaDSStream2
  = kafkaDStream.transform { rdd =&gt;<br>
  <span style='mso-spacerun:yes'>      </span>offsetRange =
  rdd.asInstanceOf[HasOffsetRanges].offsetRanges<br>
  <span style='mso-spacerun:yes'>      </span>rdd<br>
  <span style='mso-spacerun:yes'>    </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>    </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>消息处理之后，写回<span
  lang=EN-US>Kafka</span>（此时<span lang=EN-US>SparkStreaming</span>作为生产者）<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>    </span></span></span></i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafkaDStream.map(s =&gt; </span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;
  mso-font-kerning:0pt'>&quot;key:&quot; </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>+ s._1 + </span><b><span lang=EN-US style='font-size:
  5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;mso-font-kerning:
  0pt'>&quot;,value:&quot; </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>+
  s._2).foreachRDD { rdd =&gt;<br>
  <span style='mso-spacerun:yes'>      </span>rdd.foreachPartition { rddPar
  =&gt;<br>
  <span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// &gt;&gt; </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>这里循环创建、关闭生产者，故做一个池子<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span>// </span>创建生产者<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>kafkaPool = <i>KafkaPool</i>(brokers)<br>
  <span style='mso-spacerun:yes'>        </span></span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>kafkaProducer
  = kafkaPool.borrowObject()<br>
  <br>
  <span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>写出到<span
  lang=EN-US>Kafka</span>（<span lang=EN-US>targetTopic</span>）<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>for</span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>(item &lt;- rddPar) {<br>
  <span style='mso-spacerun:yes'>          </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>生产者发送数据。<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>          </span></span></span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>kafkaProducer.send(targetTopic, item)<br>
  <span style='mso-spacerun:yes'>        </span>}<br>
  <span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>关闭生产者（用完还回去）<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span></span></span></i><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>kafkaPool.returnObject(kafkaProducer)<br>
  <span style='mso-spacerun:yes'>      </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>      </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>更新<span
  lang=EN-US>zk</span>中的数据<span lang=EN-US><br>
  <span style='mso-spacerun:yes'>      </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>updataTopicDirs = </span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>new </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>ZKGroupTopicDirs(consumerGroup,
  sourceTopic)<br>
  <span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>val </span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>updataZKCli
  = </span><b><span lang=EN-US style='font-size:5.5pt;font-family:宋体;
  mso-bidi-font-family:宋体;color:navy;mso-font-kerning:0pt'>new </span></b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>ZkClient(zookeeper)<br>
  <br>
  <span style='mso-spacerun:yes'>      </span></span><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:navy;
  mso-font-kerning:0pt'>for</span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>(offset
  &lt;- offsetRange) {<br>
  <span style='mso-spacerun:yes'>        </span></span><i><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:gray;
  mso-font-kerning:0pt'>// </span></i><i><span style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:gray;mso-font-kerning:0pt'>拼接路径<span
  lang=EN-US><br>
  <span style='mso-spacerun:yes'>        </span></span></span></i><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:navy;mso-font-kerning:0pt'>val </span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>zkPath = </span><b><span lang=EN-US style='font-size:
  5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:green;mso-font-kerning:
  0pt'>s&quot;</span></b><b><span lang=EN-US style='font-size:5.5pt;font-family:
  宋体;mso-bidi-font-family:宋体;color:#00B8BB;mso-font-kerning:0pt'>$</span></b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'>{updataTopicDirs.consumerOffsetDir}</span><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;mso-font-kerning:0pt'>/</span></b><b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:#00B8BB;
  mso-font-kerning:0pt'>$</span></b><span lang=EN-US style='font-size:5.5pt;
  font-family:宋体;mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'>{offset.partition}</span><b><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:green;mso-font-kerning:0pt'>&quot;<br>
  <span style='mso-spacerun:yes'>        </span></span></b><span lang=EN-US
  style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;color:black;
  mso-font-kerning:0pt'>ZkUtils.<i>updatePersistentPath</i>(zkClient, zkPath,
  offset.fromOffset.toString)<br>
  <span style='mso-spacerun:yes'>      </span>}<br>
  <span style='mso-spacerun:yes'>      </span>updataZKCli.close()<br>
  <span style='mso-spacerun:yes'>    </span>}<br>
  <br>
  <span style='mso-spacerun:yes'>    </span>streamingContext.start()<br>
  <span style='mso-spacerun:yes'>    </span>streamingContext.awaitTermination()<br>
  <span style='mso-spacerun:yes'>  </span>}<br>
  <br>
  }<o:p></o:p></span></p>
  <p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
  lang=EN-US style='font-size:5.5pt;font-family:宋体;mso-bidi-font-family:宋体;
  color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'> </span></span></p>

<h4><span style='font-family:宋体;mso-ascii-font-family:"Calibri Light";
mso-ascii-theme-font:major-latin;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:"Calibri Light";mso-hansi-theme-font:major-latin'>测试</span></h4>

<p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>启动生产者、消费者、程序，可以看到下图输出（有上次的测试数据）</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="图片_x0020_197" o:spid="_x0000_i1025" type="#_x0000_t75" style='width:567.75pt;
 height:47.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="08_Spark.files/image608.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=757 height=63
src="08_Spark.files/image608.png" v:shapes="图片_x0020_197"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>Spark</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>内核机制</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:22.0pt;line-height:240%;
mso-fareast-font-family:宋体'><o:p></o:p></span></h1>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>见“</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>09_Spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>内核解析</span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:宋体'>.docx</span><span
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;font-family:
宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>”</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>Spark</span><span style='font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>性能调优</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:22.0pt;line-height:240%;
mso-fareast-font-family:宋体'><o:p></o:p></span></h1>

<p class=MsoNormal><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>见“</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'>10_Spark</span><span style='font-size:12.0pt;
mso-bidi-font-size:11.0pt;line-height:125%;font-family:宋体;mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>性能调优与故障处理</span><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;mso-fareast-font-family:
宋体'>.docx</span><span style='font-size:12.0pt;mso-bidi-font-size:11.0pt;
line-height:125%;font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>”</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:125%;
mso-fareast-font-family:宋体'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:125%;mso-fareast-font-family:宋体'><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>
